---
title: "Base de données de la Configuration préalable Optimizations1 | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: ebd0b32a-490d-4db2-a1fc-bf3bef93aeea
caps.latest.revision: "9"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ad75319054ced87d449ee50c8e0fea65ab108ade
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/01/2017
---
# <a name="pre-configuration-database-optimizations"></a><span data-ttu-id="57454-102">Optimisations de la base de données de la Configuration préalable</span><span class="sxs-lookup"><span data-stu-id="57454-102">Pre-Configuration Database Optimizations</span></span>
<span data-ttu-id="57454-103">BizTalk Server est une application de beaucoup de ressources de base de données qui peut-être nécessiter la création de bases de données distinctes jusqu'à 13 dans Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-103">BizTalk Server is an extremely database-intensive application that may require the creation of up to 13 separate databases in Microsoft SQL Server.</span></span> <span data-ttu-id="57454-104">Le rôle critique que SQL Server joue dans n’importe quel environnement BizTalk Server, il est vital que SQL Server est configuré/paramétrés pour des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="57454-104">Because of the critical role that SQL Server plays in any BizTalk Server environment, it is of paramount importance that SQL Server is configured/tuned for optimal performance.</span></span> <span data-ttu-id="57454-105">Si SQL Server n’est pas paramétrée pour effectuer correctement, puis les bases de données utilisées par BizTalk Server devient un goulot d’étranglement et les performances globales de l’environnement BizTalk Server seront affectées.</span><span class="sxs-lookup"><span data-stu-id="57454-105">If SQL Server is not tuned to perform well, then the databases used by BizTalk Server will become a bottleneck and the overall performance of the BizTalk Server environment will suffer.</span></span> <span data-ttu-id="57454-106">Cette rubrique décrit plusieurs optimisations de performances de SQL Server qui doivent être suivies avant d’installer BizTalk Server et de configurer les bases de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="57454-106">This topic describes several SQL Server performance optimizations that should be followed before installing BizTalk Server and configuring the BizTalk Server databases.</span></span>  
  
## <a name="set-ntfs-file-allocation-unit"></a><span data-ttu-id="57454-107">Définir l’unité d’Allocation de fichier NTFS</span><span class="sxs-lookup"><span data-stu-id="57454-107">Set NTFS File Allocation Unit</span></span>  
 <span data-ttu-id="57454-108">SQL Server stocke ses données dans **étendues**, qui sont des groupes de huit pages de 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="57454-108">SQL Server stores its data in **Extents**, which are groups of eight 8K pages.</span></span> <span data-ttu-id="57454-109">Par conséquent, pour optimiser les performances du disque, définir la taille d’unité d’Allocation NTFS à 64 Ko comme décrit dans la section « Disque meilleures pratiques de Configuration » de SQL Server meilleures pratiques de l’article « Prédéploiement d’e/s meilleures pratiques » disponible à l’adresse [http:// go.Microsoft.com/fwlink/ ? LinkId = 140818](http://go.microsoft.com/fwlink/?LinkId=140818).</span><span class="sxs-lookup"><span data-stu-id="57454-109">Therefore, to optimize disk performance, set the NTFS Allocation Unit size to 64KB as described in the “Disk Configuration Best Practices” section of the SQL Server best practices article “Predeployment I/O Best Practices” available at [http://go.microsoft.com/fwlink/?LinkId=140818](http://go.microsoft.com/fwlink/?LinkId=140818).</span></span> <span data-ttu-id="57454-110">Pour plus d’informations sur SQL Server pages et étendues Voir la rubrique de la documentation en ligne de SQL Server [présentation des Pages et étendues](http://go.microsoft.com/fwlink/?LinkId=148939) (lien hypertexte « http://go.microsoft.com/fwlink/?LinkId=148939 » http://go.microsoft.com/fwlink/?LinkId=148939).</span><span class="sxs-lookup"><span data-stu-id="57454-110">For more information about SQL Server pages and extents see the SQL Server Books Online topic [Understanding Pages and Extents](http://go.microsoft.com/fwlink/?LinkId=148939) ( HYPERLINK "http://go.microsoft.com/fwlink/?LinkId=148939" http://go.microsoft.com/fwlink/?LinkId=148939).</span></span>  
  
## <a name="database-planning-considerations"></a><span data-ttu-id="57454-111">Planification des considérations relatives à la base de données</span><span class="sxs-lookup"><span data-stu-id="57454-111">Database planning considerations</span></span>  
 <span data-ttu-id="57454-112">Nous vous recommandons d’héberger votre [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] bases de données sur un stockage rapide (par exemple, des disques SAN rapides ou des disques SCSI rapides).</span><span class="sxs-lookup"><span data-stu-id="57454-112">We recommend that you host your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] databases on fast storage (for example, fast SAN disks or fast SCSI disks).</span></span> <span data-ttu-id="57454-113">Nous vous recommandons de RAID 10 (1 + 0) au lieu de RAID 5 étant donné que raid 5 est plus lente à l’écriture.</span><span class="sxs-lookup"><span data-stu-id="57454-113">We recommend RAID 10 (1+0) instead of RAID 5 because raid 5 is slower at writing.</span></span> <span data-ttu-id="57454-114">Des disques SAN plus récentes ont des caches de la mémoire de très grande taille, dans que ces cas, la sélection RAID n’est pas aussi importante.</span><span class="sxs-lookup"><span data-stu-id="57454-114">Newer SAN disks have very large memory caches, so in these cases, the RAID selection is not as important.</span></span> <span data-ttu-id="57454-115">Pour améliorer les performances, les bases de données et leurs fichiers journaux peuvent résider sur différents disques physiques.</span><span class="sxs-lookup"><span data-stu-id="57454-115">To increase performance, databases and their log files can reside on different physical disks.</span></span>  
  
## <a name="install-the-latest-service-pack-and-cumulative-updates-for-sql-server"></a><span data-ttu-id="57454-116">Installez le dernier service pack et les mises à jour cumulatives pour SQL Server</span><span class="sxs-lookup"><span data-stu-id="57454-116">Install the latest service pack and cumulative updates for SQL Server</span></span>  
 <span data-ttu-id="57454-117">Installez les derniers service packs et dernières mises à jour cumulatives pour SQL Server 2005 et SQL Server 2008, ainsi que les derniers service packs pour .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="57454-117">Install the latest service packs and the latest cumulative updates for SQL Server 2005 and SQL Server 2008 as well as the latest .NET Framework service packs.</span></span>  
  
## <a name="install-sql-service-packs-on-both-biztalk-server-and-sql-server"></a><span data-ttu-id="57454-118">Installer les Service Packs SQL sur BizTalk Server et SQL Server</span><span class="sxs-lookup"><span data-stu-id="57454-118">Install SQL Service Packs on both BizTalk Server and SQL Server</span></span>  
 <span data-ttu-id="57454-119">Lorsque vous installez les service packs pour SQL Server, vous devez également installer le service pack sur l’ordinateur BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="57454-119">When installing service packs for SQL Server, also install the service pack on the BizTalk Server computer.</span></span> <span data-ttu-id="57454-120">BizTalk Server utilise les composants du Client SQL sont mises à jour par les service packs SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-120">BizTalk Server uses SQL Client components that are updated by the SQL Server service packs.</span></span>  
  
## <a name="consider-implementing-the-sql-server-2008-data-collector-and-management-data-warehouse"></a><span data-ttu-id="57454-121">Envisagez d’implémenter le collecteur de données SQL Server 2008 et l’entrepôt de données de gestion</span><span class="sxs-lookup"><span data-stu-id="57454-121">Consider implementing the SQL Server 2008 Data Collector and Management Data Warehouse</span></span>  
 <span data-ttu-id="57454-122">SQL Server 2008 prend en charge l’utilisation du nouveau collecteur de données et de l’entrepôt de données de gestion pour collecter les performances de l’environnement/base de données des données de test et analyse des tendances liées.</span><span class="sxs-lookup"><span data-stu-id="57454-122">SQL Server 2008 accommodates the use of the new Data Collector and Management Data Warehouse to collect environment/database performance related data for test and trend analysis.</span></span> <span data-ttu-id="57454-123">Le collecteur de données persistantes toutes les données collectées dans l’entrepôt de données de gestion spécifié.</span><span class="sxs-lookup"><span data-stu-id="57454-123">The Data Collector persists all collected data to the specified Management Data Warehouse.</span></span> <span data-ttu-id="57454-124">Bien que cela ne soit pas une optimisation des performances, ce sera utile pour l’analyse des problèmes de performances.</span><span class="sxs-lookup"><span data-stu-id="57454-124">While this is not a performance optimization, this will be useful for analysis of any performance issues.</span></span>  
  
## <a name="grant-the-account-which-is-used-for-sql-server-the-windows-lock-pages-in-memory-privilege"></a><span data-ttu-id="57454-125">Accordez au compte qui est utilisé pour le verrouillage de Windows des Pages dans le privilège de la mémoire de SQL Server</span><span class="sxs-lookup"><span data-stu-id="57454-125">Grant the account which is used for SQL Server the Windows Lock Pages In Memory privilege</span></span>  
 <span data-ttu-id="57454-126">Accorder des privilèges Windows « Verrouiller les Pages en mémoire » pour le compte de service SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-126">Grant the Windows “Lock Pages in Memory” privilege to the SQL Server service account.</span></span> <span data-ttu-id="57454-127">Cela doit être effectuée pour empêcher le système d’exploitation Windows à partir de la pagination de la mémoire de pool de mémoire tampon du processus SQL Server en verrouillant la mémoire allouée pour le pool de mémoires tampons en mémoire physique.</span><span class="sxs-lookup"><span data-stu-id="57454-127">This should be done to prevent the Windows operating system from paging out the buffer pool memory of the SQL Server process by locking memory that is allocated for the buffer pool in physical memory.</span></span> <span data-ttu-id="57454-128">Pour plus d’informations, consultez Base de connaissances Microsoft l’article 914483 « comment réduire la pagination de la mémoire tampon dans la version 64 bits de SQL Server 2005 » à [http://go.microsoft.com/fwlink/?LinkId=148948](http://go.microsoft.com/fwlink/?LinkId=148948).</span><span class="sxs-lookup"><span data-stu-id="57454-128">For more information, see Microsoft Knowledge Base article 914483 “How to reduce paging of buffer pool memory in the 64-bit version of SQL Server 2005” at [http://go.microsoft.com/fwlink/?LinkId=148948](http://go.microsoft.com/fwlink/?LinkId=148948).</span></span>  
  
## <a name="grant-the-semanagevolumename-right-to-the-sql-server-service-account"></a><span data-ttu-id="57454-129">Accorder l’autorisation SE_MANAGE_VOLUME_NAME droit au compte de Service SQL Server</span><span class="sxs-lookup"><span data-stu-id="57454-129">Grant the SE_MANAGE_VOLUME_NAME right to the SQL Server Service account</span></span>  
 <span data-ttu-id="57454-130">Vérifiez que le compte exécutant le service SQL Server dispose du privilège « Effectuer des tâches de Maintenance de Volume » Windows ou assurez-vous qu’il appartient à un groupe de sécurité qui.</span><span class="sxs-lookup"><span data-stu-id="57454-130">Ensure the account running the SQL Server service has the “Perform Volume Maintenance Tasks” Windows privilege or ensure it belongs to a security group which does.</span></span> <span data-ttu-id="57454-131">Cela autorise l’initialisation instantanée des fichiers en garantissant des performances optimales si une base de données à croissance automatique.</span><span class="sxs-lookup"><span data-stu-id="57454-131">This will allow instant file initialization ensuring optimum performance if a database has to auto-grow.</span></span>  
  
## <a name="set-min-and-max-server-memory"></a><span data-ttu-id="57454-132">Valeur Min et Max Server Memory</span><span class="sxs-lookup"><span data-stu-id="57454-132">Set Min and Max Server Memory</span></span>  
 <span data-ttu-id="57454-133">Les ordinateurs qui exécutent [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] qui hébergent les bases de données BizTalk Server doivent être dédiés à l’exécution de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-133">The computers running [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] that host the BizTalk Server databases should be dedicated to running SQL Server.</span></span> <span data-ttu-id="57454-134">Nous recommandons de définir les options « max server memory » sur chaque instance de SQL Server « min server memory » pour spécifier la quantité fixe de mémoire à allouer à SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-134">We recommend that the “min server memory” and “max server memory” options on each SQL Server instance are set to specify the fixed amount of memory to allocate to SQL Server.</span></span> <span data-ttu-id="57454-135">Dans ce cas, vous devez définir la « min server memory » et « max server memory » sur la même valeur (égal à la quantité maximale de mémoire physique qui utilise SQL Server).</span><span class="sxs-lookup"><span data-stu-id="57454-135">In this case, you should set the “min server memory” and “max server memory” to the same value (equal to the maximum amount of physical memory that SQL Server will use).</span></span> <span data-ttu-id="57454-136">Cela va réduire les frais généraux qui serait sinon utilisé par SQL Server de gestion dynamique de ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="57454-136">This will reduce overhead that would otherwise be used by SQL Server dynamically managing these values.</span></span> <span data-ttu-id="57454-137">Exécutez les commandes T-SQL suivantes sur chaque ordinateur SQL Server pour spécifier la quantité fixe de mémoire à allouer à SQL Server :</span><span class="sxs-lookup"><span data-stu-id="57454-137">Run the following T-SQL commands on each SQL Server computer to specify the fixed amount of memory to allocate to SQL Server:</span></span>  
  
```  
sp_configure ‘Max Server memory (MB)’,(max size in MB)  
sp_configure ‘Min Server memory (MB)’,(min size in MB)  
```  
  
 <span data-ttu-id="57454-138">Avant de définir la quantité de mémoire pour SQL Server, déterminez le paramètre approprié de mémoire en soustrayant la mémoire requise pour Windows Server à partir de la mémoire physique totale.</span><span class="sxs-lookup"><span data-stu-id="57454-138">Before you set the amount of memory for SQL Server, determine the appropriate memory setting by subtracting the memory required for Windows Server from the total physical memory.</span></span> <span data-ttu-id="57454-139">Il s’agit de la quantité maximale de mémoire que pouvant être allouée à SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-139">This is the maximum amount of memory you can assign to SQL Server.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="57454-140">Si l’ou les ordinateurs exécutant SQL Server qui hébergent les bases de données BizTalk Server hébergent également l’entreprise seule l’authentification serveur de secret principal, il vous faudra peut-être ajuster cette valeur pour vous assurer qu’il existe suffisamment de mémoire disponible pour exécuter l’Enterprise Single Sign-On Service.</span><span class="sxs-lookup"><span data-stu-id="57454-140">If the computer(s) running SQL Server that host the BizTalk Server databases also host the Enterprise Single Sign-On Master Secret Server, then you may need to adjust this value to ensure that there is sufficient memory available to run the Enterprise Single Sign-On Service.</span></span> <span data-ttu-id="57454-141">Il n’est pas une pratique peu courante pour exécuter une instance en cluster du service Enterprise Single Sign-On sur un cluster de SQL Server pour fournir une haute disponibilité pour le serveur de secret principal.</span><span class="sxs-lookup"><span data-stu-id="57454-141">It is not an uncommon practice to run a clustered instance of the Enterprise Single Sign-On service on a SQL Server cluster to provide high availability for the Master Secret Server.</span></span> <span data-ttu-id="57454-142">Pour plus d’informations sur le clustering de l’entreprise seule l’authentification serveur de secret principal, consultez la rubrique « Comment au Cluster le serveur de secret principal » dans la BizTalk Serverdocumentation à [http://go.microsoft.com/fwlink/?LinkID=106874](http://go.microsoft.com/fwlink/?LinkID=106874).</span><span class="sxs-lookup"><span data-stu-id="57454-142">For more information about clustering the Enterprise Single Sign-On Master Secret Server, see the topic “How to Cluster the Master Secret Server” in the BizTalk Serverdocumentation at [http://go.microsoft.com/fwlink/?LinkID=106874](http://go.microsoft.com/fwlink/?LinkID=106874).</span></span>  
  
## <a name="split-the-tempdb-database-into-multiple-data-files-of-equal-size-on-each-sql-server-instance-used-by-biztalk-server"></a><span data-ttu-id="57454-143">Fractionner la base de données tempdb en plusieurs fichiers de données de taille égale sur chaque instance de SQL Server utilisée par BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="57454-143">Split the tempdb database into multiple data files of equal size on each SQL Server instance used by BizTalk Server</span></span>  
 <span data-ttu-id="57454-144">S’assurer que les fichiers de données utilisés pour la base de données tempdb sont de taille égale est critique, car l’algorithme de remplissage proportionnel utilisé par [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] est basée sur la taille des fichiers de données.</span><span class="sxs-lookup"><span data-stu-id="57454-144">Ensuring that the data files used for the tempdb are of equal size is critical because the proportional fill algorithm used by [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] is based on the size of the data files.</span></span> <span data-ttu-id="57454-145">Cet algorithme tente de s’assurer que [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] remplit chaque fichier en fonction de l’espace libre restant dans ce fichier afin qu’ils atteignent leur capacité maximale en même temps.</span><span class="sxs-lookup"><span data-stu-id="57454-145">This algorithm attempts to ensure that [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] fills each file in proportion to the free space left in that file so that they reach their maximum capacity at about the same time.</span></span> <span data-ttu-id="57454-146">Si les fichiers de données sont créés avec la taille inégale, l’algorithme de remplissage proportionnel utilisera le plus grand fichier plus pour les allocations GAM plutôt qu’en se propageant les allocations entre tous les fichiers, invalidant ainsi le but de créer plusieurs fichiers de données.</span><span class="sxs-lookup"><span data-stu-id="57454-146">If data files are created with unequal sizes, the proportional fill algorithm will use the largest file more for GAM allocations rather than spreading the allocations between all the files, thereby defeating the purpose of creating multiple data files.</span></span> <span data-ttu-id="57454-147">Le nombre de fichiers de données pour la base de données tempdb doit être configuré pour être au moins égal au nombre de processeurs affectées pour SQL Server.</span><span class="sxs-lookup"><span data-stu-id="57454-147">The number of data files for the tempdb database should be configured to be at least equal to the number of processors assigned for SQL Server.</span></span>  
  
## <a name="enable-trace-flag-t1118-as-a-startup-parameter-for-all-instances-of-sql-server"></a><span data-ttu-id="57454-148">Activer T1118 d’indicateur de Trace en tant que paramètre de démarrage pour toutes les instances de SQL Server</span><span class="sxs-lookup"><span data-stu-id="57454-148">Enable Trace Flag T1118 as a startup parameter for all instances of SQL Server</span></span>  
 <span data-ttu-id="57454-149">Mise en œuvre de la Trace à l’indicateur-T1118 permet de réduire la contention parmi les instances de SQL Server en supprimant presque toutes les allocations de page unique.</span><span class="sxs-lookup"><span data-stu-id="57454-149">Implementing Trace Flag –T1118 helps reduce contention across the SQL Server instances by removing almost all single page allocations.</span></span> <span data-ttu-id="57454-150">Pour plus d’informations, consultez l’article 328551 de la Base de connaissances Microsoft « PRB : améliorations de la concurrence pour la base de données tempdb » à [http://go.microsoft.com/fwlink/?LinkID=103713](http://go.microsoft.com/fwlink/?LinkID=103713).</span><span class="sxs-lookup"><span data-stu-id="57454-150">For more information, see Microsoft Knowledge Base article 328551 "PRB: Concurrency enhancements for the tempdb database" at [http://go.microsoft.com/fwlink/?LinkID=103713](http://go.microsoft.com/fwlink/?LinkID=103713).</span></span>  
  
## <a name="do-not-change-default-sql-server-settings-for-max-degree-of-parallelism-sql-server-statistics-or-database-index-rebuilds-and-defragmentation"></a><span data-ttu-id="57454-151">Ne modifiez pas les paramètres de SQL Server par défaut pour le degré maximal de parallélisme, les statistiques SQL Server, ou les reconstructions d’index de base de données et la défragmentation</span><span class="sxs-lookup"><span data-stu-id="57454-151">Do not change default SQL Server settings for max degree of parallelism, SQL Server statistics, or database index rebuilds and defragmentation</span></span>  
 <span data-ttu-id="57454-152">Si une instance de SQL Server va héberger les bases de données BizTalk Server, certains paramètres de SQL Server ne doivent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="57454-152">If a SQL Server instance will house BizTalk Server databases, then certain SQL Server settings should not be changed.</span></span> <span data-ttu-id="57454-153">Plus précisément, les statistiques de SQL Server sur la base de données MessageBox et les paramètres pour l’index de base de données de le SQL Server max degree of parallelism, reconstruit et défragmentation ne doit pas être modifiée.</span><span class="sxs-lookup"><span data-stu-id="57454-153">Specifically, the SQL Server max degree of parallelism, the SQL Server statistics on the MessageBox database, and the settings for the database index rebuilds and defragmentation should not be modified.</span></span> <span data-ttu-id="57454-154">Pour plus d’informations, consultez la rubrique « SQL Server paramètres que doit pas être modifiée » dans le Guide des opérations BizTalk Server à [http://go.microsoft.com/fwlink/?LinkId=114358](http://go.microsoft.com/fwlink/?LinkId=114358).</span><span class="sxs-lookup"><span data-stu-id="57454-154">For more information, see the topic “SQL Server Settings That Should Not Be Changed” in the BizTalk Server Operations Guide at [http://go.microsoft.com/fwlink/?LinkId=114358](http://go.microsoft.com/fwlink/?LinkId=114358).</span></span>