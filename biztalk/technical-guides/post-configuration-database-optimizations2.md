---
title: "À la Configuration de base de données Optimizations2 | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 609eda22-8399-4b7c-b860-21b495d2f68d
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 168323f1e7dfdbb796fe29e0025c5d2a6f40c957
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="post-configuration-database-optimizations"></a><span data-ttu-id="c617a-102">Optimisations de la base de données à la Configuration</span><span class="sxs-lookup"><span data-stu-id="c617a-102">Post-Configuration Database Optimizations</span></span>
<span data-ttu-id="c617a-103">En plus des recommandations de [Optimizations2 de base de données de Configuration préalable](../technical-guides/pre-configuration-database-optimizations2.md), plusieurs étapes à suivre pour optimiser les performances de base de données BizTalk Server sur SQL Server *après* BizTalk Server a été installé et les bases de données BizTalk Server ont été configurés.</span><span class="sxs-lookup"><span data-stu-id="c617a-103">In addition to following the recommendations in [Pre-Configuration Database Optimizations2](../technical-guides/pre-configuration-database-optimizations2.md), several steps should be followed to optimize BizTalk Server database performance on SQL Server *after* BizTalk Server has been installed and the BizTalk Server databases have been configured.</span></span> <span data-ttu-id="c617a-104">Cette rubrique fournit une liste de ces optimisations.</span><span class="sxs-lookup"><span data-stu-id="c617a-104">This topic provides a list of these optimizations.</span></span>  
  
## <a name="consider-setting-the-text-in-row-table-option-on-specific-messagebox-database-tables"></a><span data-ttu-id="c617a-105">Envisagez de définir l’option de table 'text in row' sur des tables de base de données MessageBox spécifiques</span><span class="sxs-lookup"><span data-stu-id="c617a-105">Consider setting the 'text in row' table option on specific MessageBox database tables</span></span>  
 <span data-ttu-id="c617a-106">SQL Server fournit une option de table appelée **texte dans la ligne** pour déclarer que le contenu des champs de type **texte**, **ntext**, ou **image** les données dont les dimensions sont inférieures à celles d’une page de données (8 Ko) doivent être stockées dans une ligne de données.</span><span class="sxs-lookup"><span data-stu-id="c617a-106">SQL Server provides a table option called **text in row** to declare that the contents of the fields of type **text**, **ntext**, or **image** data whose dimensions are smaller than those of a data page (8Kb) must be stored in a data row.</span></span> <span data-ttu-id="c617a-107">En définissant cette option sur les tables BizTalkMsgBoxDb (table des parties, table du spouleur et DynamicStateInfo Tables), vous pouvez augmenter le débit des messages lorsque vous travaillez avec des messages de petite taille qui ont un contexte de petite et des orchestrations qui ont une taille de la persistance de petits.</span><span class="sxs-lookup"><span data-stu-id="c617a-107">By setting this option on BizTalkMsgBoxDb tables (Parts table, Spool table and DynamicStateInfo Tables) , you can increase message throughput when working with small messages which have a small context and orchestrations that have a small persistence size.</span></span>  
  
-   <span data-ttu-id="c617a-108">**Table de pièces**: lorsque la taille du message est plus petit que les dimensions d’une page de données de 8 Ko, appliquer la **texte dans la ligne** option de table sur la table des parties risque d’amélioration des performances de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-108">**Parts Table**: When the message size is smaller than the dimensions of a data page that are of 8kb, applying the **text in row** table option on the Parts table can lead to BizTalk Server performance improvement.</span></span> <span data-ttu-id="c617a-109">La table des parties contient les champs suivants :</span><span class="sxs-lookup"><span data-stu-id="c617a-109">The Parts table contains the following fields:</span></span>  
  
    -   <span data-ttu-id="c617a-110">**ImgPart**: contient un fragment de partie de message ou de la partie message.</span><span class="sxs-lookup"><span data-stu-id="c617a-110">**ImgPart**: Contains a message part or message part fragment.</span></span>  
  
    -   <span data-ttu-id="c617a-111">**ImgPropBag**: contient le jeu de propriétés de partie de message.</span><span class="sxs-lookup"><span data-stu-id="c617a-111">**ImgPropBag**: Contains the message part property bag.</span></span>  
  
     <span data-ttu-id="c617a-112">De cette manière, lors de la boucle par rapport à la MessageBox, l’Agent des messages en cours d’exécution dans un hôte BizTalk peut récupérer un lot de messages à partir de la table des parties en lisant la petite quantité de pages.</span><span class="sxs-lookup"><span data-stu-id="c617a-112">This way, when looping against the MessageBox, the Message Agent running within a BizTalk host can retrieve a batch of messages from the Parts table by reading small amount of pages.</span></span> <span data-ttu-id="c617a-113">Selon le scénario spécifique et la configuration matérielle, cette technique peut réduire l’utilisation du processeur à la fois sur SQL Server et BizTalk Server et fournir une amélioration significative en termes de latence et le débit.</span><span class="sxs-lookup"><span data-stu-id="c617a-113">Depending on the specific scenario and hardware configuration, this technique can reduce CPU utilization both on the SQL Server and BizTalk Server, and provide a significant improvement in terms of latency and throughput.</span></span>  
  
-   <span data-ttu-id="c617a-114">**Table de spoule**: lorsque la taille moyenne du contexte de message est inférieure à 8 Ko, l’activation de la **texte dans la ligne** option de table sur la table Spool vous permet de réduire le nombre d’accès lors de la lecture de messages à partir de la MessageBox le long avec leur contexte.</span><span class="sxs-lookup"><span data-stu-id="c617a-114">**Spool Table**: When the average size of the message context is less than 8 kb, enabling the **text in row** table option on the Spool table helps you reduce the number of accesses when reading messages from the MessageBox along with their context.</span></span> <span data-ttu-id="c617a-115">Pour appliquer cette option à la table du spouleur, vous devez éliminer les propriétés de contexte inutiles et les champs distinctifs afin de réduire la taille du contexte du message est inférieure à 8 Ko.</span><span class="sxs-lookup"><span data-stu-id="c617a-115">To apply this option to the Spool table, you must eliminate unnecessary context properties and distinguished fields to reduce the size of the message context lower than 8 Kb.</span></span>  
  
-   <span data-ttu-id="c617a-116">**Les Tables DynamicStateInfo** ces tables, une pour chaque hôte, contient un champ de type image appelé imgData qui contient l’état de l’orchestration de binaire sérialisé lorsqu’elles rencontrent un point de persistance lors de leur exécution.</span><span class="sxs-lookup"><span data-stu-id="c617a-116">**DynamicStateInfo Tables** These tables, one for each host, contain a field of type image called imgData that contains binary-serialized orchestration state when they encounter a persistence point during their execution.</span></span> <span data-ttu-id="c617a-117">Lorsque l’état interne d’orchestrations dans un hôte HostA est si petit que sa taille qu’une seule fois sérialisé est inférieure à 8 Ko, le **texte dans la ligne** technique correctement peut être appliquée à la table DynamicStateInfo_HostA.</span><span class="sxs-lookup"><span data-stu-id="c617a-117">When the internal state of orchestrations within a host HostA is so small that its size once serialized is less than 8 kb, the **text in row** technique can successfully be applied to the DynamicStateInfo_HostA table.</span></span> <span data-ttu-id="c617a-118">Par conséquent, nous vous recommandons de conserver l’état interne d’orchestrations aussi petite que possible.</span><span class="sxs-lookup"><span data-stu-id="c617a-118">Therefore we recommend that you keep the internal state of orchestrations as small as possible.</span></span> <span data-ttu-id="c617a-119">Cette technique peut réduire considérablement le temps passé par le moteur XLANG à sérialiser, rendre persistants, désérialiser et restaurer l’état interne d’une orchestration en cas de point de persistance.</span><span class="sxs-lookup"><span data-stu-id="c617a-119">This technique can significantly reduce the time that is spent by the XLANG Engine to serialize, persist, de-serialize and restore the internal state of an orchestration in case of persistence point.</span></span>  
  
 <span data-ttu-id="c617a-120">Nous avons utilisé les paramètres suivants dans nos tests de laboratoire :</span><span class="sxs-lookup"><span data-stu-id="c617a-120">We used the following settings in our lab tests:</span></span>  
  
-   <span data-ttu-id="c617a-121">EXEC sp_tableoption N'Spool', 'text in row', '6000'</span><span class="sxs-lookup"><span data-stu-id="c617a-121">EXEC sp_tableoption N'Spool', 'text in row', '6000'</span></span>  
  
-   <span data-ttu-id="c617a-122">EXEC sp_tableoption de N'Parts, 'text in row', '6000'</span><span class="sxs-lookup"><span data-stu-id="c617a-122">EXEC sp_tableoption N'Parts', 'text in row', '6000'</span></span>  
  
## <a name="define-auto-growth-settings-for-biztalk-server-databases-to-a-fixed-value-instead-of-a-percentage-value"></a><span data-ttu-id="c617a-123">Définir les paramètres de croissance automatique pour les bases de données BizTalk Server sur une valeur fixe au lieu d’une valeur de pourcentage</span><span class="sxs-lookup"><span data-stu-id="c617a-123">Define auto-growth settings for BizTalk Server databases to a fixed value instead of a percentage value</span></span>  
  
-   <span data-ttu-id="c617a-124">Croissance automatique de base de données SQL Server est une opération de blocage, ce qui entraîne une dégradation des performances de base de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-124">SQL Server database auto-growth is a blocking operation, which hinders BizTalk Server database performance.</span></span> <span data-ttu-id="c617a-125">Par conséquent, il est important d’en allouer suffisamment d’espace pour les bases de données BizTalk Server à l’avance afin de réduire la fréquence de croissance automatique de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c617a-125">Therefore it is important to allocate sufficient space for the BizTalk Server databases in advance to minimize the occurrence of database auto-growth.</span></span>  
  
-   <span data-ttu-id="c617a-126">La croissance automatique de la base de données doit être définie sur un nombre fixe de mégaoctets au lieu d’un pourcentage (spécifier la croissance des fichiers **en mégaoctets**).</span><span class="sxs-lookup"><span data-stu-id="c617a-126">Database auto-growth should be set to a fixed number of megabytes instead of to a percentage (specify file growth **In Megabytes**).</span></span> <span data-ttu-id="c617a-127">Cela doit être effectuée, afin que, si la croissance automatique se produit, il le fait de manière mesuré.</span><span class="sxs-lookup"><span data-stu-id="c617a-127">This should be done so that, if auto-growth occurs, it does so in a measured fashion.</span></span> <span data-ttu-id="c617a-128">Cela réduit la probabilité d’une croissance excessive de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c617a-128">This reduces the likelihood of excessive database growth.</span></span> <span data-ttu-id="c617a-129">L’incrément de croissance pour les bases de données BizTalk Server doit généralement être non inférieure à 100 Mo.</span><span class="sxs-lookup"><span data-stu-id="c617a-129">The growth increment for BizTalk Server databases should generally be no lower than 100 MB.</span></span>  
  
## <a name="pre-size-biztalk-server-databases-to-appropriate-size-with-multiple-data-files"></a><span data-ttu-id="c617a-130">La taille des bases de données BizTalk Server de taille appropriées avec plusieurs fichiers de données</span><span class="sxs-lookup"><span data-stu-id="c617a-130">Pre-size BizTalk Server databases to appropriate size with multiple data files</span></span>  
 <span data-ttu-id="c617a-131">Lorsque SQL Server augmente la taille d’un fichier, il doit d’abord initialiser le nouvel espace avant de pouvoir être utilisé.</span><span class="sxs-lookup"><span data-stu-id="c617a-131">When SQL Server increases the size of a file, it must first initialize the new space before it can be used.</span></span> <span data-ttu-id="c617a-132">Il s’agit d’une opération de blocage qui implique le remplissage du nouvel espace de pages vides.</span><span class="sxs-lookup"><span data-stu-id="c617a-132">This is a blocking operation that involves filling the new space with empty pages.</span></span> <span data-ttu-id="c617a-133">SQL Server 2005 ou version ultérieure sur Windows Server 2003 ou version ultérieure prend en charge le « initialisation instantanée des fichiers. »</span><span class="sxs-lookup"><span data-stu-id="c617a-133">SQL Server 2005 or later running on Windows Server 2003 or later supports “instant file initialization.”</span></span> <span data-ttu-id="c617a-134">Cela peut considérablement réduire l’impact sur les performances d’une opération de croissance de fichier.</span><span class="sxs-lookup"><span data-stu-id="c617a-134">This can greatly reduce the performance impact of a file growth operation.</span></span> <span data-ttu-id="c617a-135">Pour plus d’informations, consultez [l’initialisation des fichiers de base de données](http://go.microsoft.com/fwlink/?LinkId=132063) (http://go.microsoft.com/fwlink/?LinkId=132063) dans la documentation en ligne de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-135">For more information, see [Database File Initialization](http://go.microsoft.com/fwlink/?LinkId=132063) (http://go.microsoft.com/fwlink/?LinkId=132063) in the SQL Server books online.</span></span> <span data-ttu-id="c617a-136">Cette rubrique explique comment activer l’initialisation instantanée des fichiers.</span><span class="sxs-lookup"><span data-stu-id="c617a-136">This topic provides steps for enabling instant file initialization.</span></span>  
  
 <span data-ttu-id="c617a-137">La liste suivante décrit les configurations de base de données BizTalk Server utilisées dans nos tests de laboratoire :</span><span class="sxs-lookup"><span data-stu-id="c617a-137">The following list describes the BizTalk Server database configurations used in our lab tests:</span></span>  
  
-   <span data-ttu-id="c617a-138">**BizTalk DTADB (fichiers de base de données des suivis BizTalk) :** le fichier de données ayant une taille de 2 048 Mo, avec une croissance de 100 Mo et un fichier journal de 1 024 Mo avec une croissance de 100 Mo.</span><span class="sxs-lookup"><span data-stu-id="c617a-138">**BizTalk DTADB (BizTalk Tracking database files):** Data file having a file size of 2048 MB with 100 MB growth and a log file of 1024 MB with 100 MB growth.</span></span>  
  
-   <span data-ttu-id="c617a-139">**BizTalkMgmtdb (fichiers de base de données de gestion BizTalk) :** le fichier de données ayant une taille de fichier de 512 Mo, avec une croissance de 100 Mo et un fichier journal de 512 Mo avec une croissance de 100 Mo.</span><span class="sxs-lookup"><span data-stu-id="c617a-139">**BizTalkMgmtdb (BizTalk Management database files):** Data file having a file size of 512 MB with 100 MB growth and a log file of 512 MB with 100 MB growth.</span></span>  
  
-   <span data-ttu-id="c617a-140">**SSODB :** le fichier de données ayant une taille de fichier de 512 Mo, avec une croissance de 100 Mo et un fichier journal de 512 Mo avec une croissance de 100 Mo.</span><span class="sxs-lookup"><span data-stu-id="c617a-140">**SSODB:** Data file having a file size of 512 MB with 100 MB growth and a log file of 512 MB with 100 MB growth.</span></span>  
  
-   <span data-ttu-id="c617a-141">**BizTalkMsgBoxDb (bases de données BizTalk MessageBox) :** les fichiers de données de 8, chacun ayant une taille de 2 Go avec une croissance de 100 Mo et un fichier journal de 20 Go avec une croissance de 100 Mo.</span><span class="sxs-lookup"><span data-stu-id="c617a-141">**BizTalkMsgBoxDb (BizTalk MessageBox databases):** 8 data files, each having a file size of 2 GB with 100 MB growth and a log file of 20 GB with 100 MB growth.</span></span> <span data-ttu-id="c617a-142">Étant donné que les bases de données BizTalk MessageBox sont les plus actifs, nous vous recommandons de que vous placez les fichiers de données et les fichiers journaux des transactions sur des lecteurs dédiés pour réduire le risque de problèmes de contention d’e/s de disque.</span><span class="sxs-lookup"><span data-stu-id="c617a-142">Because the BizTalk MessageBox databases are the most active, we recommend you place the data files and transaction log files on dedicated drives to reduce the likelihood of problems with disk I/O contention.</span></span> <span data-ttu-id="c617a-143">Dans notre environnement de laboratoire, nous avons utilisé un lecteur pour chacun des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c617a-143">In our lab environment, we used one drive for each of the following:</span></span>  
  
    -   <span data-ttu-id="c617a-144">Fichiers de données MessageBox</span><span class="sxs-lookup"><span data-stu-id="c617a-144">MessageBox data files</span></span>  
  
    -   <span data-ttu-id="c617a-145">Fichiers journaux des transactions MessageBox</span><span class="sxs-lookup"><span data-stu-id="c617a-145">MessageBox transaction log files</span></span>  
  
 <span data-ttu-id="c617a-146">Le script SQL suivant peut servir à la taille des BizTalkMsgBoxDb ayant initialement un fichier de données sur le lecteur J (J:\BizTalkMsgBoxDb.mdf) et un fichier journal sur le lecteur K (K:\BizTalkMsgBoxDb_log. LDF) :</span><span class="sxs-lookup"><span data-stu-id="c617a-146">The following SQL script can be used to pre-size BizTalkMsgBoxDb which initially has a data file on drive J (J:\BizTalkMsgBoxDb.mdf) and a log file on drive K (K:\BizTalkMsgBoxDb_log.LDF):</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="c617a-147">Ce script est fourni « en l’état, » est destinée uniquement à titre éducatif de démonstration ou et doit être utilisé à vos propres risques.</span><span class="sxs-lookup"><span data-stu-id="c617a-147">This script is provided “as is,” is intended for demo or educational purposes only, and is to be used at your own risk.</span></span> <span data-ttu-id="c617a-148">Utilisation de ce script n’est pas prise en charge par Microsoft et Microsoft n’apporte aucune garantie quant à l’adéquation de ce script.</span><span class="sxs-lookup"><span data-stu-id="c617a-148">Use of this script is not supported by Microsoft, and Microsoft makes no guarantees about the suitability of this script.</span></span>  
  
```  
EXEC dbo.sp_helpdb BizTalkMsgBoxDb  
ALTER DATABASE BizTalkMsgBoxDb MODIFY FILE (NAME = BizTalkMsgBoxDb , FILENAME = 'J:\BizTalkMsgBoxDb.mdf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_2 , FILENAME = 'J:\BizTalkMsgBoxDb_2.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_3 , FILENAME = 'J:\BizTalkMsgBoxDb_3.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_4 , FILENAME = 'J:\BizTalkMsgBoxDb_4.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_5 , FILENAME = 'J:\BizTalkMsgBoxDb_5.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_6 , FILENAME = 'J:\BizTalkMsgBoxDb_6.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_7 , FILENAME = 'J:\BizTalkMsgBoxDb_7.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
ALTER DATABASE BizTalkMsgBoxDb ADD FILE    (NAME = BizTalkMsgBoxDb_8 , FILENAME = 'J:\BizTalkMsgBoxDb_8.ndf' , SIZE = 2GB , FILEGROWTH = 100MB)  
GO  
ALTER DATABASE BizTalkMsgBoxDb MODIFY FILE (NAME = BizTalkMsgBoxDb_log , FILENAME = 'K:\BizTalkMsgBoxDb_log.LDF', SIZE =  20GB , FILEGROWTH = 100MB)  
GO  
```  
  
## <a name="move-the-backup-biztalk-server-output-directory-to-a-dedicated-lun"></a><span data-ttu-id="c617a-149">Déplacer le répertoire de sortie de sauvegarde de BizTalk Server à un numéro d’unité logique dédié</span><span class="sxs-lookup"><span data-stu-id="c617a-149">Move the Backup BizTalk Server output directory to a dedicated LUN</span></span>  
 <span data-ttu-id="c617a-150">Déplacer le répertoire de sortie de sauvegarde de BizTalk (sauvegarde complète et de journal) à un numéro d’unité logique dédié, puis modifiez la tâche de sauvegarde de BizTalk Server pour pointer vers le numéro d’unité logique dédié.</span><span class="sxs-lookup"><span data-stu-id="c617a-150">Move the Backup BizTalk (Full and Log backup) output directory to a dedicated LUN, and then edit the Backup BizTalk Server job to point to the dedicated LUN.</span></span> <span data-ttu-id="c617a-151">Déplacer le répertoire de sortie de sauvegarde de BizTalk Server à un numéro d’unité logique dédié réduira la contention d’e/s de disque lors de l’exécution du travail en écrivant sur un disque différent de celui de la tâche de lecture à partir de.</span><span class="sxs-lookup"><span data-stu-id="c617a-151">Moving the Backup BizTalk Server output directory to a dedicated LUN will reduce disk I/O contention when the job is running by writing to a different disk than the job is reading from.</span></span> <span data-ttu-id="c617a-152">Pour plus d’informations sur la configuration de la tâche de sauvegarde de BizTalk Server, consultez [comment configurer le travail de sauvegarde de BizTalk Server](http://go.microsoft.com/fwlink/?LinkID=153813) (http://go.microsoft.com/fwlink/?LinkID=153813) dans l’aide de BizTalk Server 2010.</span><span class="sxs-lookup"><span data-stu-id="c617a-152">For more information about configuring the Backup BizTalk Server job see [How to Configure the Backup BizTalk Server Job](http://go.microsoft.com/fwlink/?LinkID=153813) (http://go.microsoft.com/fwlink/?LinkID=153813) in BizTalk Server 2010 help.</span></span>  
  
## <a name="verify-that-the-biztalk-server-sql-agent-jobs-are-running"></a><span data-ttu-id="c617a-153">Vérifiez que les travaux de l’Agent SQL de BizTalk Server sont en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="c617a-153">Verify that the BizTalk Server SQL Agent Jobs are running</span></span>  
 <span data-ttu-id="c617a-154">BizTalk Server inclut plusieurs travaux de l’Agent SQL Server qui exécutent des fonctions importantes pour conserver vos serveurs de fonctionnement.</span><span class="sxs-lookup"><span data-stu-id="c617a-154">BizTalk Server includes several SQL Server Agent jobs that perform important functions to keep your servers operational and healthy.</span></span> <span data-ttu-id="c617a-155">Vous devez surveiller l’intégrité de ces travaux et assurez-vous qu’ils sont en cours d’exécution sans erreurs.</span><span class="sxs-lookup"><span data-stu-id="c617a-155">You should monitor the health of these jobs and ensure they are running without errors.</span></span> <span data-ttu-id="c617a-156">Une des causes plus courantes des problèmes de performances dans BizTalk Server est les travaux de l’Agent SQL de BizTalk Server ne sont pas en cours d’exécution, ce qui à son tour la peut entraîner la MessageBox et suivi des bases de données à croissance est désactivée.</span><span class="sxs-lookup"><span data-stu-id="c617a-156">One of the most common causes of performance problems in BizTalk Server is the BizTalk Server SQL Agent Jobs are not running, which in turn can cause the MessageBox and Tracking databases to grow unchecked.</span></span> <span data-ttu-id="c617a-157">Suivez ces étapes pour vérifier que les travaux de l’Agent SQL de BizTalk Server s’exécutent sans problème :</span><span class="sxs-lookup"><span data-stu-id="c617a-157">Follow these steps to ensure the BizTalk Server SQL Agent Jobs are running without problems:</span></span>  
  
1.  <span data-ttu-id="c617a-158">**Vérifiez que le service SQL Server Agent est en cours d’exécution**.</span><span class="sxs-lookup"><span data-stu-id="c617a-158">**Verify that the SQL Server Agent service is running**.</span></span>  
  
2.  <span data-ttu-id="c617a-159">**Vérifiez que les travaux de l’Agent SQL Server installés par BizTalk Server sont activés et en cours d’exécution avec succès**.</span><span class="sxs-lookup"><span data-stu-id="c617a-159">**Verify that the SQL Server Agent jobs installed by BizTalk Server are enabled and running successfully**.</span></span>  
    <span data-ttu-id="c617a-160">Les travaux de SQL Server Agent BizTalk Server sont cruciaux : s’ils n’exécutent pas, les performances du système se dégradent au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="c617a-160">The BizTalk Server SQL Server Agent jobs are crucial: if they are not running, system performance will degrade over time.</span></span>  
  
3.  <span data-ttu-id="c617a-161">**Vérifiez que les travaux de SQL Server Agent BizTalk Server sont achèvent en temps voulu**.</span><span class="sxs-lookup"><span data-stu-id="c617a-161">**Verify that the BizTalk Server SQL Server Agent jobs are completing in a timely manner**.</span></span>   
    <span data-ttu-id="c617a-162">Configurer la version la plus récente de Microsoft System Center Operations Manager pour surveiller les travaux.</span><span class="sxs-lookup"><span data-stu-id="c617a-162">Set up the most recent version of Microsoft System Center Operations Manager to monitor the jobs.</span></span>  
    <span data-ttu-id="c617a-163">Vous devez être conscient des planifications qui sont spécifiques à certaines tâches :</span><span class="sxs-lookup"><span data-stu-id="c617a-163">You should be aware of schedules that are particular to certain jobs:</span></span>  
  
    -   <span data-ttu-id="c617a-164">Le travail MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb s’exécute en continu par défaut.</span><span class="sxs-lookup"><span data-stu-id="c617a-164">The MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job runs continuously by default.</span></span> <span data-ttu-id="c617a-165">Logiciel de surveillance doit tenir compte de cette planification et pas génèrent des avertissements.</span><span class="sxs-lookup"><span data-stu-id="c617a-165">Monitoring software should take this schedule into account and not produce warnings.</span></span>  
  
    -   <span data-ttu-id="c617a-166">Le travail MessageBox_Message_Cleanup_BizTalkMsgBoxDb n’est pas activé ou planifié, mais elle est démarrée par le travail MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb toutes les 10 secondes.</span><span class="sxs-lookup"><span data-stu-id="c617a-166">The MessageBox_Message_Cleanup_BizTalkMsgBoxDb job is not enabled or scheduled, but it is started by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job every 10 seconds.</span></span> <span data-ttu-id="c617a-167">Par conséquent, cette tâche de ne doit pas être activée, planifiée ou démarrée manuellement.</span><span class="sxs-lookup"><span data-stu-id="c617a-167">Therefore, this job should not be enabled, scheduled, or manually started.</span></span>  
  
4.  <span data-ttu-id="c617a-168">**Vérifiez que le type de démarrage du service SQL Server Agent est configuré correctement**.</span><span class="sxs-lookup"><span data-stu-id="c617a-168">**Verify that the Startup type of the SQL Server Agent service is configured correctly**.</span></span>  
    <span data-ttu-id="c617a-169">Vérifiez que le service SQL Server Agent est configuré avec un **type de démarrage** de **automatique** , sauf si le service de l’Agent SQL Server est configuré en tant que ressource de cluster sur un cluster Windows Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-169">Verify the SQL Server Agent service is configured with a **Startup type** of **Automatic** unless the SQL Server Agent service is configured as a cluster resource on a Windows Server cluster.</span></span> <span data-ttu-id="c617a-170">Si le service de l’Agent SQL Server est configuré en tant que ressource de cluster, vous devez configurer le **type de démarrage** en tant que **manuel** , car le service est géré par le service de Cluster.</span><span class="sxs-lookup"><span data-stu-id="c617a-170">If the SQL Server Agent service is configured as a cluster resource, then you should configure the **Startup type** as **Manual** because the service will be managed by the Cluster service.</span></span>  
  
## <a name="configure-purging-and-archiving-of-tracking-data"></a><span data-ttu-id="c617a-171">Configurer l’archivage des données de suivi et la purge</span><span class="sxs-lookup"><span data-stu-id="c617a-171">Configure Purging and Archiving of Tracking Data</span></span>  
 <span data-ttu-id="c617a-172">Suivez ces étapes pour vous assurer que la purge et d’archivage de données de suivi sont configuré correctement :</span><span class="sxs-lookup"><span data-stu-id="c617a-172">Follow these steps to ensure that purging and archiving of tracking data is configured correctly:</span></span>  
  
1.  <span data-ttu-id="c617a-173">Vérifiez que le travail de l’Agent SQL « DTA Purge et archivage » est correctement configuré, activé et exécution.</span><span class="sxs-lookup"><span data-stu-id="c617a-173">Ensure the SQL Agent job “DTA Purge and Archive” is properly configured, enabled, and successfully completing.</span></span> <span data-ttu-id="c617a-174">Pour plus d’informations, consultez [la configuration de la Purge et archivage](http://go.microsoft.com/fwlink/?LinkID=153814) (http://go.microsoft.com/fwlink/?LinkID=153814) dans la documentation de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-174">For more information, see [How to Configure the DTA Purge and Archive Job](http://go.microsoft.com/fwlink/?LinkID=153814) (http://go.microsoft.com/fwlink/?LinkID=153814) in the BizTalk Server documentation.</span></span>  
  
2.  <span data-ttu-id="c617a-175">Vérifiez que le travail est en mesure de purger les données de suivi aussi vite que les données de suivi entrantes sont générées.</span><span class="sxs-lookup"><span data-stu-id="c617a-175">Ensure the job is able to purge the tracking data as fast as the incoming tracking data is generated.</span></span> <span data-ttu-id="c617a-176">Pour plus d’informations, consultez [mesure de débit maximal acceptable de suivi](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815) dans la documentation de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-176">For more information, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815) in the BizTalk Server documentation.</span></span>  
  
3.  <span data-ttu-id="c617a-177">Passez en revue la purge normale et les paramètres de purge dur afin de que vous conservez les données pendant la durée optimale.</span><span class="sxs-lookup"><span data-stu-id="c617a-177">Review the soft purge and hard purge parameters to ensure you are keeping data for the optimal length of time.</span></span> <span data-ttu-id="c617a-178">Pour plus d’informations, consultez [l’archivage et la purge de la base de données de suivi BizTalk](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816) dans la documentation de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-178">For more information, see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816) in the BizTalk Server documentation.</span></span>  
  
4.  <span data-ttu-id="c617a-179">Si vous devez uniquement purger les anciennes données et ne pas pour archiver les modifications tout d’abord, l’Agent SQL la fonction pour appeler la procédure stockée « dtasp_PurgeTrackingDatabase. »</span><span class="sxs-lookup"><span data-stu-id="c617a-179">If you only need to purge the old data and do not need to archive it first, change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase.”</span></span> <span data-ttu-id="c617a-180">Pour plus d’informations, consultez [comment vider les données à partir de la base de données de suivi BizTalk](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817) dans la documentation de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-180">For more information, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817) in the BizTalk Server documentation.</span></span>  
  
## <a name="monitor-and-reduce-dtc-log-file-disk-io-contention"></a><span data-ttu-id="c617a-181">Contrôler et réduire la contention d’e/s de DTC journal fichier sur le disque</span><span class="sxs-lookup"><span data-stu-id="c617a-181">Monitor and reduce DTC log file disk I/O contention</span></span>  
 <span data-ttu-id="c617a-182">Le fichier journal de coordinateur de transactions distribuées (DTC, Distributed Transaction Coordinator) peut devenir un goulot d’étranglement d’e/s de disque dans des environnements riches en transactions.</span><span class="sxs-lookup"><span data-stu-id="c617a-182">The Distributed Transaction Coordinator (DTC) log file can become a disk I/O bottleneck in transaction-intensive environments.</span></span> <span data-ttu-id="c617a-183">Cela est particulièrement vrai lors de l’utilisation des adaptateurs qui prennent en charge les transactions, telles que SQL Server, MSMQ ou MQSeries, ou dans un environnement multi-MessageBox.</span><span class="sxs-lookup"><span data-stu-id="c617a-183">This is especially true when using adapters that support transactions, such as SQL Server, MSMQ, or MQSeries, or in a multi-MessageBox environment.</span></span> <span data-ttu-id="c617a-184">Adaptateurs transactionnels utilisent les transactions DTC et les environnements de multi-MessageBox utilisent beaucoup des transactions DTC.</span><span class="sxs-lookup"><span data-stu-id="c617a-184">Transactional adapters use DTC transactions, and multi-MessageBox environments make extensive use of DTC transactions.</span></span> <span data-ttu-id="c617a-185">Pour garantir que le fichier journal DTC ne devient-elle pas un goulet d’étranglement d’e/s de disque, vous devez surveiller l’utilisation d’e/s pour le disque contenant le fichier journal DTC sur les serveurs de base de données SQL Server du disque.</span><span class="sxs-lookup"><span data-stu-id="c617a-185">To ensure the DTC log file does not become a disk I/O bottleneck, you should monitor the disk I/O usage for the disk where the DTC log file resides on the SQL Server database servers.</span></span> <span data-ttu-id="c617a-186">Si le disque, l’utilisation des e/s pour le disque où se trouve le fichier journal DTC devient excessive, déplacez le fichier journal DTC sur un disque plus rapide.</span><span class="sxs-lookup"><span data-stu-id="c617a-186">If disk I/O usage for the disk where the DTC log file resides becomes excessive, consider moving the DTC log file to a faster disk.</span></span> <span data-ttu-id="c617a-187">Dans un environnement où SQL Server est en cluster, il n’est pas autant d’un critère important, car le fichier journal sera déjà sur un lecteur partagé, qui sera probablement un lecteur SAN rapide avec plusieurs piles.</span><span class="sxs-lookup"><span data-stu-id="c617a-187">In an environment where SQL Server is clustered, this is not as much of a concern because the log file will already be on a shared drive, which will likely be a fast SAN drive with multiple spindles.</span></span> <span data-ttu-id="c617a-188">Vous devez néanmoins toujours surveiller l’utilisation des e/s disque.</span><span class="sxs-lookup"><span data-stu-id="c617a-188">You should nevertheless still monitor the disk I/O usage.</span></span> <span data-ttu-id="c617a-189">Il s’agit, car il peut devenir un goulot d’étranglement dans les environnements non cluster ou lorsque le fichier journal DTC est sur un disque partagé avec d’autres fichiers de disques de manière intensive.</span><span class="sxs-lookup"><span data-stu-id="c617a-189">This is because it can become a bottleneck in non-clustered environments or when the DTC log file is on a shared disk with other disk-intensive files.</span></span>  
  
## <a name="separate-the-messagebox-and-tracking-databases"></a><span data-ttu-id="c617a-190">Séparer la MessageBox et le suivi des bases de données</span><span class="sxs-lookup"><span data-stu-id="c617a-190">Separate the MessageBox and Tracking Databases</span></span>  
 <span data-ttu-id="c617a-191">Étant donné que les bases de données BizTalk MessageBox et des suivis BizTalk sont les plus actifs, nous vous recommandons de que vous placez les fichiers de données et les fichiers journaux des transactions pour chacun d’eux sur des lecteurs dédiés pour réduire le risque de problèmes de contention d’e/s de disque.</span><span class="sxs-lookup"><span data-stu-id="c617a-191">Because the BizTalk MessageBox and BizTalk Tracking databases are the most active, we recommend you place the data files and transaction log files for each of these on dedicated drives to reduce the likelihood of problems with disk I/O contention.</span></span> <span data-ttu-id="c617a-192">Par exemple, vous devez quatre disques pour les fichiers de base de données MessageBox et des suivis BizTalk, un pour chacun des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c617a-192">For example, you would need four drives for the MessageBox and BizTalk Tracking database files, one drive for each of the following:</span></span>  
  
-   <span data-ttu-id="c617a-193">Fichiers de données MessageBox</span><span class="sxs-lookup"><span data-stu-id="c617a-193">MessageBox data files</span></span>  
  
-   <span data-ttu-id="c617a-194">Fichiers journaux des transactions MessageBox</span><span class="sxs-lookup"><span data-stu-id="c617a-194">MessageBox transaction log files</span></span>  
  
-   <span data-ttu-id="c617a-195">Fichiers de données de suivi BizTalk (DTA)</span><span class="sxs-lookup"><span data-stu-id="c617a-195">BizTalk Tracking (DTA) data files</span></span>  
  
-   <span data-ttu-id="c617a-196">Fichiers journaux des transactions de suivi BizTalk (DTA)</span><span class="sxs-lookup"><span data-stu-id="c617a-196">BizTalk Tracking (DTA) transaction log files</span></span>  
  
 <span data-ttu-id="c617a-197">Séparer les bases de données BizTalk MessageBox et des suivis BizTalk et en séparant les fichiers de base de données et les fichiers journaux des transactions sur des disques différents sont considérés comme des meilleures pratiques pour réduire la contention d’e/s disque.</span><span class="sxs-lookup"><span data-stu-id="c617a-197">Separating the BizTalk MessageBox and BizTalk Tracking databases and separating the database files and transaction log files on different physical disks are considered best practices for reducing disk I/O contention.</span></span> <span data-ttu-id="c617a-198">Essayez afin de répartir l’e/s disque piles de disques physiques autant que possible.</span><span class="sxs-lookup"><span data-stu-id="c617a-198">Try to spread the disk I/O across as many physical spindles as possible.</span></span> <span data-ttu-id="c617a-199">Vous pouvez également réduire la contention d’e/s de disque en plaçant la base de données des suivis BizTalk sur un serveur SQL dédié ; Toutefois, vous devez toujours suivre les pratiques ci-dessus en ce qui concerne la séparation des fichiers de données et fichiers journaux des transactions.</span><span class="sxs-lookup"><span data-stu-id="c617a-199">You can also reduce disk I/O contention by placing the BizTalk Tracking database on a dedicated SQL Server; however, you should still follow the practices above with regards to separating data files and transaction log files.</span></span>  
  
## <a name="optimize-filegroups-for-the-biztalk-server-databases"></a><span data-ttu-id="c617a-200">Optimiser les groupes de fichiers pour les bases de données BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="c617a-200">Optimize filegroups for the BizTalk Server databases</span></span>  
 <span data-ttu-id="c617a-201">Suivez les étapes de [optimisation de groupes de fichiers pour le Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md) et [l’optimisation de base de données BizTalk Server](http://go.microsoft.com/fwlink/?LinkId=101578) livre blanc ([http://go.microsoft.com/fwlink/? LinkId = 101578](http://go.microsoft.com/fwlink/?LinkId=101578)) pour créer des groupes de fichiers supplémentaires et des fichiers pour les bases de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="c617a-201">Follow the steps in [Optimizing Filegroups for the Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md) and the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkId=101578) white paper ([http://go.microsoft.com/fwlink/?LinkId=101578](http://go.microsoft.com/fwlink/?LinkId=101578)) to create additional filegroups and files for the BizTalk Server databases.</span></span> <span data-ttu-id="c617a-202">Cela augmente considérablement les performances des bases de données BizTalk Server à partir d’une configuration de disque unique.</span><span class="sxs-lookup"><span data-stu-id="c617a-202">This will greatly increase the performance of the BizTalk Server databases from a single disk configuration.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c617a-203">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c617a-203">See Also</span></span>  
 [<span data-ttu-id="c617a-204">Optimisation des performances de la base de données</span><span class="sxs-lookup"><span data-stu-id="c617a-204">Optimizing Database Performance</span></span>](../technical-guides/optimizing-database-performance.md)