---
title: "Optimisation des performances de l’adaptateur WCF BizTalk Server | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 2900c845-15be-4466-8fa0-b51b2486842f
caps.latest.revision: "12"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5d5ce620e7d9da984081b0f0874985bfe762eeae
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="optimizing-biztalk-server-wcf-adapter-performance"></a>Optimisation des performances de l’adaptateur WCF BizTalk Server
Cette rubrique fournit des recommandations pour la sélection appropriés de l’adaptateur WCF ou type de liaison et des conseils pour l’application des différentes options de configuration de l’adaptateur WCF.  
  
## <a name="considerations-when-choosing-which-wcf-adapter-to-use-or-which-wcf-customwcf-customisolated-binding-type-to-use"></a>Considérations lors du choix de carte à utiliser WCF ou le type de liaison WCF-Custom/WCF-CustomIsolated à utiliser  
  
-   N’utilisez pas la sécurité de niveau message si pas strictement obligatoire, car elle augmente la taille des messages. Cela peut à son tour réduire le débit global de la solution.  
  
-   Lorsque vous choisissez de carte à utiliser WCF ou le WCF-Custom/WCF-CustomIsolated **type de liaison** pour utiliser, soigneusement prendre en compte les exigences d’application telles que la compatibilité, les performances, plateforme d’hébergement, sécurité et prise en charge transports. Les instructions ci-dessous sont applique à WCF en général et ne sont pas spécifiques à BizTalk Server :  
  
    -   **BasicHttpBinding** doit être utilisé si le service WCF doit prendre en charge des clients hérités, tels que les services Web de WebSphere ou des applications .NET 1.1 qui attendent un service Web ASMX. Étant donné que BasicHttpBinding n’implémente pas toute la sécurité par défaut, si vous avez besoin de sécurité de message ou du transport, vous devez le configurer explicitement sur cette liaison. Utiliser BasicHttpBinding pour exposer des points de terminaison qui sont en mesure de communiquer avec les services Web basés sur ASMX et les clients et autres services conformes à WS-I Basic Profile 1.1. Lors de la configuration de la sécurité de transport, valeurs par défaut de BasicHttpBinding à n’utiliser aucune information d’identification uniquement comme un service Web ASMX classique. BasicHttpBinding vous permet d’héberger le service WCF dans IIS 7.5 ou IIS 7.0.  
  
    -   **WsHttpBinding** doit être utilisé si le service WCF est appelé par les clients WCF via Internet. WsHttpBinding est un bon choix pour les scénarios Internet dans laquelle vous n’êtes pas obligé de prendre en charge les clients hérités qui attendent un service Web ASMX et WsHttpBinding vous permet d’héberger le service WCF dans IIS 7.5 ou IIS 7.0. Si vous n’avez pas besoin de prendre en charge les clients hérités, envisagez plutôt d’utiliser BasicHttpBinding.   
        WsHttpBinding doit être utilisé lorsque vous avez besoin d’exposer des emplacements de réception WCF ou arrêter des Ports d’envoi qui prennent en charge WS-* protocoles tels que WS-Security ou WS-AtomicTransactions.  
  
    -   **NetTcpBinding** constitue un excellent choix si vous avez besoin prendre en charge les clients au sein de votre intranet. NetTcpBinding est un bon choix pour les scénarios intranet si les performances de transport sont importantes pour vous, et s’il est acceptable pour héberger le service dans un service Windows au lieu de dans IIS. Utilisez cette liaison lorsque vous souhaitez fournir un environnement de liaison sécurisée et fiable pour. NET-.NET la communication entre ordinateurs. Notez que la liaison NetTcpBinding doit être hébergée dans un service Windows ou IIS 7.5/7.0.  
  
    -   **NetNamedPipeBinding** doit être utilisé si vous avez besoin prendre en charge des clients WCF sur le même ordinateur que votre service. Cette liaison fournit un environnement de liaison sécurisée et fiable pour la communication interprocessus, le même ordinateur. Utiliser cette liaison lorsque vous souhaitez utiliser le NamedPipe protocole. Notez que le NetNamedPipeBinding doit être hébergé dans un service Windows ou IIS 7.5/7.0.  
  
    -   **NetMsmqBinding** doit être utilisé si vous avez besoin prendre en charge le queuing déconnecté. Queuing est fournie à l’aide de Message Queuing (également appelé MSMQ) comme transport, ce qui permet la prise en charge des opérations déconnectées, isolation de défaillance et nivellement de charge. Vous pouvez utiliser NetMsmqBinding quand le client et le service n’ont pas d’être en ligne en même temps. Vous pouvez également gérer n’importe quel nombre de messages entrants à l’aide de nivellement de charge. Message Queuing prend en charge l’isolation de défaillance, où les messages peuvent échouer sans affecter le traitement des autres messages. Notez que le NetMsmqBinding doit être hébergé dans un service Windows ou IIS 7.5/7.0.  
  
    -   **WsDualHttpBinding** doit être utilisé si vous avez besoin prendre en charge d’un service en duplex. Un service duplex est un service qui utilise des modèles de messages duplex, et offrir la possibilité pour un service communiquer au client via un rappel. Notez que WsDualHttpBinding doit être hébergé dans un service Windows ou IIS 7.5/7.0.  
  
## <a name="wcf-binding-comparison"></a>Comparaison de liaison WCF  
 Liaisons fournissent un mécanisme pour configurer les piles de canaux. Une liaison crée un processus pour générer une pile de canaux à l’aide d’un canal de transport, un encodeur de message et un ensemble de canaux de protocole. Windows Communication Foundation est fourni avec plusieurs liaisons intégrées qui sont préconfigurées pour résoudre des scénarios de communication les plus courants.  
  
|Nom de classe de liaison|Transport|Encodage de message|Mode de sécurité|Messagerie fiable|Flux de transaction (désactivé par défaut)|  
|------------------------|---------------|----------------------|-------------------|------------------------|----------------------------------------------|  
|BasicHttpBinding|HTTP|Texte|Aucune|Non pris en charge|Non pris en charge|  
|WSHttpBinding|HTTP|Texte|Message|Désactivé|WS-AtomicTransactions|  
|NetTcpBinding|TCP|Binaire|Transport|Désactivé|OleTransactions|  
|NetNamedPipesBinding|Canaux nommés|Binaire|Transport|Non pris en charge|OleTransactions|  
|NetMsmqBinding|MSMQ|Binaire|Message|Non pris en charge|Non pris en charge|  
|CustomBinding|Vous décidez|Vous décidez|Vous décidez|Vous décidez|Vous décidez|  
  
 Vous pouvez sélectionner une liaison particulière en fonction de vos besoins de communication. Exemple :  
  
-   **BasicHttpBinding** est conçue pour l’interopérabilité avec les services Web simples. BasicHttpBinding utilise HTTP pour le transport et le texte pour l’encodage de message.  
  
-   **WSHttpBinding** est conçue pour l’interopérabilité avec les services Web plus avancées qui pourraient exploiter différents WS-* protocoles.  WSHttpBinding utilise également le protocole HTTP pour le transport et le texte pour l’encodage de message.  
  
-   **NetTcpBinding** et **NetNamedPipeBinding** conçues pour être efficace et effectuer communication ant avec d’autres applications WCF sur plusieurs ordinateurs ou sur le même ordinateur.  
  
-   Si vous avez besoin d’une flexibilité maximale à l’aide d’un ou plusieurs canaux de protocole personnalisé lors de l’exécution, vous pouvez utiliser la **CustomBinding** qui vous donne la possibilité de décider quels éléments de liaison composent votre liaison.  
  
> [!NOTE]  
>  Liaisons ont des caractéristiques différentes en termes de temps de réponse et le débit. Par conséquent, les conseils généraux pour augmenter les performances sont à l’aide de la NetTcpBindind et NetNamesPipeBinding lorsque cela est possible.  
  
## <a name="use-the-tcp-transport-and-binary-message-encoding-to-maximize-wcf-adapter-throughput-and-minimize-wcf-adapter-latency"></a>Utiliser le message de transport et binaires TCP encodage pour maximiser le débit de l’adaptateur WCF et de réduire la latence de l’adaptateur WCF  
 Utilisez l’adaptateur WCF-NetTcp lorsque cela est possible optimiser le débit. L’adaptateur WCF-NetTcp utilise le protocole de transport TCP/IP et de message binaire encodage qui constituent des performances améliorées par rapport aux autres WCF-* cartes.  
  
 Vous pouvez également configurer le WCF-Custom (ou l’adaptateur WCF-CustomIsolated pour les emplacements de réception) avec un **customBinding** type de liaison. Ensuite, ajoutez le **binaryMessageEncoding** extension pour implémenter l’encodage de message binaire de liaison et la **tcpTransport** extension pour implémenter le protocole TCP/IP comme protocole de transport de message de liaison. Cette approche est très flexible, car il vous permet de sélectionner et configurer les éléments de liaison que vous avez besoin et créer des canaux personnalisés pour étendre le comportement par défaut du moteur de messagerie BizTalk. Si vous implémentez l’adaptateur WCF-Custom avec la **customBinding** type de liaison de spécifier ces valeurs pour les paramètres de Configuration de liaison extension maximiser le débit et de réduire la latence.  
  
 **Valeurs de Configuration du Port d’envoi :**  
  
|Paramètre|Valeur par défaut|Valeur recommandée|  
|-------------|-------------------|-----------------------|  
|**TcpTransportBindingElement.ConnectionPoolSettings.maxOutboundConnectionsPerEndpoint** : Obtient ou définit le nombre maximal de connexions sortantes pour chaque point de terminaison de mise en cache dans le pool de connexions. Cela limite le nombre de connexions sortantes mises en cache pour chaque point de terminaison unique distant. Si cette valeur est dépassée en ayant des connexions client plus actif, le service ne semble pas répondu au client, et cette valeur doit être ajustée pour accueillir le nombre maximal de connexions attendues qui sont mis en cache pour chaque point de terminaison distant unique. Pour plus d’informations sur cette propriété, consultez [TcpConnectionPoolSettings.MaxOutboundConnectionsPerEndpoint propriété](http://go.microsoft.com/fwlink/?LinkId=157737) (http://go.microsoft.com/fwlink/?LinkId=157737) sur MSDN.|10|Essayez de > = 20|  
  
 **Les valeurs de Configuration de Port de réception :**  
  
|Paramètre|Valeur par défaut pour le .NET Framework 4|Valeur recommandée pour le .NET Framework 4|Valeur par défaut pour le .NET Framework 3.5|Valeur recommandée pour le .NET Framework 3.5|  
|-------------|----------------------------------------|--------------------------------------------|------------------------------------------|----------------------------------------------|  
|**TcpTransportBindingElement.MaxPendingAccepts** : Obtient ou définit la valeur maximale nombre en attente d’acceptation asynchrones les opérations qui sont disponibles pour les connexions entrantes vers le service de traitement. Pour les scénarios avec des niveaux élevés de déclenchements de connexions simultanées, cette valeur peut être inadéquate et doit être ajustée avec la **MaxPendingConnections** propriété pour gérer les niveaux supérieurs de la connexion client simultanées tentatives. Il ne doit pas être nécessaire de définir cette propriété sur une valeur supérieure au nombre de processeurs présents sur l’ordinateur qui héberge le service. Pour plus d’informations sur cette propriété, consultez [ConnectionOrientedTransportBindingElement.MaxPendingAccepts propriété](http://go.microsoft.com/fwlink/?LinkId=157738) (http://go.microsoft.com/fwlink/?LinkId=157738) sur MSDN.|1|2 * vitesse du processeur|1|Essayez de > = 20|  
|**TcpTransportBindingElement.MaxPendingConnections** : Obtient ou définit le nombre maximal de connexions en attente de distribution sur le service. Cela limite le nombre de connexions clientes simultanées en attente de distribution. Si cette valeur est trop faible, les tentatives de connexions clientes peuvent être rejetés par le service. Si elle est trop élevée, le service peut sembler lent ou ne répond pas aux clients pendant les périodes de charge élevée. Cette propriété doit être définie à une valeur qui permet au service d’exécution atteint sa pleine capacité et non plus. Lorsqu’une couche supérieure de la pile appelle **AcceptDispatch**, cette connexion est supprimée à partir de la file d’attente des connexions en attente de distribution. Pour plus d’informations sur cette propriété, consultez [ConnectionOrientedTransportBindingElement.MaxPendingConnections propriété](http://go.microsoft.com/fwlink/?LinkId=157735) (http://go.microsoft.com/fwlink/?LinkId=157735) sur MSDN.|10|16 * vitesse du processeur|10|Essayez de > = 20|  
|**TcpTransportBindingElement.ListenBacklog** : Obtient ou définit le nombre maximal de demandes de connexion en file d’attente qui peuvent être en attente. **ListenBacklog** est une propriété de niveau socket qui décrit le nombre de « en attente d’acceptation » demandes en file d’attente. Assurez-vous que la file d’attente du socket sous-jacent n’est pas dépassée par le nombre maximal de connexions simultanées. Pour plus d’informations sur cette propriété, consultez [TcpTransportBindingElement.ListenBacklog propriété](http://go.microsoft.com/fwlink/?LinkId=157734) (http://go.microsoft.com/fwlink/?LinkId=157734) sur MSDN.|10|16 * vitesse du processeur|10|Essayez de > = 20|  
  
 **Ajouter le comportement de service ServiceThrottlingBehavior un WCF-Custom ou l’emplacement de réception WCF-CustomIsolated et utilisez les paramètres suivants :**  
  
> [!NOTE]  
>  Avant que tous les éléments du comportement ServiceThrottlingBehavior service peuvent être modifiées, vous devez d’abord ajouter le **serviceThrottling** extension de comportement à la **comportements** onglet du  **WCF-Custom\* propriétés du Transport** boîte de dialogue. Pour ajouter serviceThrottling à la liste de comportements, sélectionnez le **comportements** onglet de la **WCF-Custom\* propriétés du Transport** boîte de dialogue, avec le bouton droit **ServiceBehavior**  sous **comportement**, cliquez sur **ajouter une extension**, sélectionnez **serviceThrottling**, puis cliquez sur **OK**. Cliquez pour sélectionner les propriétés disponibles sous **ServiceThrottlingElement** et modifiez la valeur pour les propriétés en fonction des besoins.  
  
|Paramètre|Valeur par défaut pour le .NET Framework 4|Valeur recommandée pour le .NET Framework 4|Valeur par défaut pour le .NET Framework 3.5|Valeur recommandée pour .net Framework 3.5|  
|-------------|----------------------------------------|--------------------------------------------|------------------------------------------|----------------------------------------------|  
|**ServiceThrottlingBehavior.MaxConcurrentCalls** : Obtient ou définit une valeur qui spécifie le nombre maximal de messages de traitement actif sur un **ServiceHost**. Le **maxconcurrentcalls** propriété spécifie le nombre maximal de messages de traitement actif sur un **ServiceHost** objet. Chaque canal peut avoir un message en attente qui ne compte pas par rapport à la valeur de **maxconcurrentcalls** jusqu'à ce que WCF commence à le traiter. Pour plus d’informations sur cette propriété, consultez [ServiceThrottlingBehavior.MaxConcurrentCalls](http://go.microsoft.com/fwlink/?LinkId=157838) (http://go.microsoft.com/fwlink/?LinkId=157838) sur MSDN. Adaptateurs de réception de la valeur par défaut pour le BizTalk WCF-Custom et WCF-CustomIsolated **maxconcurrentcalls** propriété **16** par UC. **Remarque :** adaptateurs autres que du exposer l’adaptateur WCF-Custom et WCF-CustomIsolated de réception de BizTalk Server WCF un **nombre maximal d’appels simultanés** propriété sur le **liaison** onglet du  **WCF -\* propriétés du Transport** boîte de dialogue pour configurer ce comportement. La valeur par défaut de la **nombre maximal d’appels simultanés** comportement est **200**.|16 * vitesse du processeur|16 * vitesse du processeur|-adaptateurs de réception 16 pour le BizTalk WCF-Custom et WCF-CustomIsolated.<br />-adaptateurs de réception 200 pour l’autres WCF.|-Essayez de > = 200 pour adaptateurs de réception le WCF-Custom et WCF-CustomIsolated.<br />-Essayez de 200 > pour le **nombre maximal d’appels simultanés** propriété sur le **liaison** onglet de la **WCF -\* propriétés du Transport** boîte de dialogue de WCF de BizTalk Server les adaptateurs de réception que l’adaptateur WCF-Custom et WCF-CustomIsolated.|  
|**ServiceThrottlingBehavior.maxConcurrentInstances** : Obtient ou définit une valeur qui spécifie le nombre maximal de **InstanceContext** objets dans le service qui peuvent s’exécuter à la fois. Le **MaxConcurrentInstances** propriété spécifie le nombre maximal de **InstanceContext** objets dans le service. Il est important de ne pas oublier la relation entre la **MaxConcurrentInstances** propriété et la **InstanceContextMode** propriété. Si **InstanceContextMode** soit PerSession, la valeur résultante est le nombre total de sessions. Si **InstanceContextMode** est PerCall, la valeur résultante est le nombre d’appels simultanés. Si un message arrive alors que le nombre maximal de **InstanceContext** objets existent déjà, le message est conservé jusqu'à ce qu’une **InstanceContext** ferme l’objet. Pour plus d’informations sur cette propriété, consultez [ServiceThrottlingBehavior.MaxConcurrentInstances propriété](http://go.microsoft.com/fwlink/?LinkId=157897) (http://go.microsoft.com/fwlink/?LinkId=157897) sur MSDN. La valeur par défaut pour la propriété de l’adaptateur de réception le WCF-Custom et WCF-CustomIsolated est **116** par UC. **Remarque :** étant donné que de réception WCF emplacements sont implémentés en tant qu’instances de la classe BizTalkServiceInstance contenus dans l’assembly Microsoft.BizTalk.Adapter.Wcf.Runtime.dll et étant donné que cette classe est marquée comme ServiceBehavior (InstanceContextMode (= InstanceContextMode.Single, ConcurrencyMode=ConcurrencyMode.Multiple). toutes les demandes entrantes sont gérées par le même objet singleton, et ce paramètre est ignoré. Afin de définir la propriété de maxConcurrentInstances sur certaine WCF-Custom des emplacements de réception n’a aucun effet, car le nombre d’instances actives est toujours égal à 1.|116 * vitesse du processeur|116 * vitesse du processeur|26|Essayez de > = 200|  
|**ServiceThrottlingBehavior.MaxConcurrentSessions** - le **MaxConcurrentSessions** propriété obtient ou définit le nombre maximal de sessions un **ServiceHost** objet peut accepter à la fois . Il est important de comprendre que les sessions dans ce cas ne n’est pas limité aux seuls les canaux qui prennent en charge des sessions fiables. Chaque objet écouteur peut avoir l’une en attente de la session de canal qui ne compte pas par rapport à la valeur de **MaxConcurrentSessions** jusqu'à ce que WCF accepte la session de canal et commence à traiter les messages de session de canal. Cette propriété est particulièrement utile dans les scénarios qui utilisent des sessions. Lorsque cette propriété est définie sur une valeur inférieure au nombre de threads clients, les demandes émanant de plusieurs clients peuvent obtenir en file d’attente dans la même connexion de socket. Les demandes du client qui n’a pas créé une session avec le service seront bloquées. Ils reste bloqués jusqu'à ce que le service ferme sa session avec les autres clients, si le nombre de sessions ouvertes sur le service a atteint la valeur spécifiée pour **MaxConcurrentSessions**. Les demandes de client qui ne sont pas traitées sont ensuite expirées, et le service ferme la session. Pour éviter cette situation, envisagez d’exécuter le client threads à partir de différents domaines d’application afin que les messages de demande sont acceptés par les connexions de socket différentes. Pour plus d’informations sur cette propriété, consultez [ServiceThrottlingBehavior.MaxConcurrentSessions propriété](http://go.microsoft.com/fwlink/?LinkID=157864) (http://go.microsoft.com/fwlink/?LinkId=157864) sur MSDN.|100 * vitesse du processeur|100 * vitesse du processeur|10|Essayez de > = 200|  
  
 Lorsque les paramètres de configuration de port modification appliquent les modifications méthodique ; modifier chaque paramètre individuellement et tester les effets de la modification sur les performances et la stabilité globale. Comme toujours, la valeur appropriée à appliquer varie selon le scénario particulier : si une valeur est trop faible, l’extensibilité peut être réduite ; alors que si une valeur est trop élevée, la spécification de l’application peut dépasser la capacité des ressources physiques sur l’ordinateur. En outre, étant donné que ces propriétés sont liées, elles doivent être définies de façon cohérente. Pour plus d’informations sur l’utilisation de ServiceThrottlingBehavior pour contrôler les performances de Service WCF, consultez [à l’aide de ServiceThrottlingBehavior pour contrôler les performances de Service WCF](http://go.microsoft.com/fwlink/?LinkId=157908) (http://go.microsoft.com/fwlink/?LinkId=157908) sur MSDN.  
  
## <a name="see-also"></a>Voir aussi  
 [Optimisation des performances de BizTalk Server](../technical-guides/optimizing-biztalk-server-performance.md)