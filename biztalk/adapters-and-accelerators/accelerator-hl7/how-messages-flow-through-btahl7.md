---
title: Le flux des Messages via BTAHL7 | Documents Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- messages, message processing
- messages, message flow
- BTAHL7, message flow
ms.assetid: dd4599af-500d-4e52-85b2-8b6a28fd3f0a
caps.latest.revision: "9"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 40ac6defd3b0cf99d2f0e53b3173b32e09efa0c8
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-messages-flow-through-btahl7"></a><span data-ttu-id="88deb-102">Le flux des Messages via BTAHL7</span><span class="sxs-lookup"><span data-stu-id="88deb-102">How Messages Flow through BTAHL7</span></span>
<span data-ttu-id="88deb-103">Lorsque vous installez [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] BizTalk Accelerator pour HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) sur [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServer2006r3](../../includes/btsbiztalkserver2006r3-md.md)], vous ajoutez [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] composants à la [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] architecture.</span><span class="sxs-lookup"><span data-stu-id="88deb-103">When you install [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) on top of [!INCLUDE[btsCoName](../../includes/btsconame-md.md)][!INCLUDE[btsBizTalkServer2006r3](../../includes/btsbiztalkserver2006r3-md.md)], you add [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] components to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] architecture.</span></span> <span data-ttu-id="88deb-104">La figure suivante illustre le système combiné, qui fournit une présentation de l’architecture de [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)].</span><span class="sxs-lookup"><span data-stu-id="88deb-104">The following figure shows the combined system, which provides an architectural overview of [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)].</span></span>  
  
 ![](../../adapters-and-accelerators/accelerator-hl7/media/bcd-hl7-sys-archc.gif "bcd_hl7_sys_archc")  
  
## <a name="message-processing-flow"></a><span data-ttu-id="88deb-105">Flux de traitement de message</span><span class="sxs-lookup"><span data-stu-id="88deb-105">Message Processing Flow</span></span>  
 <span data-ttu-id="88deb-106">Lorsqu’une application métier-envoie un message à la [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] système, les éléments suivants se produisent :</span><span class="sxs-lookup"><span data-stu-id="88deb-106">When a line-of-business application sends a message to the [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] system, the following occurs:</span></span>  
  
1.  <span data-ttu-id="88deb-107">Si le message est un message HL7, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] reçoit via un adaptateur (généralement un adaptateur MLLP).</span><span class="sxs-lookup"><span data-stu-id="88deb-107">If the message is an HL7 message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] receives it through an adapter (usually an MLLP adapter).</span></span> <span data-ttu-id="88deb-108">S’il s’agit d’un message XML, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] reçoit via un adaptateur (généralement un adaptateur HTTP).</span><span class="sxs-lookup"><span data-stu-id="88deb-108">If it is an XML message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] receives it through an adapter (usually an HTTP adapter).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="88deb-109">Vous pouvez acheminer des messages XML 2.X et 2. sur n’importe quelle carte ; Toutefois, vous serez généralement transport V2. X via un adaptateur MLLP et que vous feraient généralement transport des messages de 2. des messages XML via un adaptateur HTTP.</span><span class="sxs-lookup"><span data-stu-id="88deb-109">You can transport both 2.X and 2.XML messages over any adapter; however, you would usually transport V2.X messages over an MLLP adapter, and you would usually transport 2.XML messages over an HTTP adapter.</span></span>  
  
2.  <span data-ttu-id="88deb-110">Le message est routé via le pipeline de réception pour l’analyse par le désassembleur et la validation.</span><span class="sxs-lookup"><span data-stu-id="88deb-110">The message is routed through the receive pipeline for parsing by the disassembler, and validation.</span></span>  
  
    1.  <span data-ttu-id="88deb-111">Si le message entrant est un message HL7, le désassembleur de fichier plat (DASM) le désassemble en XML.</span><span class="sxs-lookup"><span data-stu-id="88deb-111">If the incoming message is an HL7 message, the flat file disassembler (DASM) disassembles it into XML.</span></span> <span data-ttu-id="88deb-112">Si le message entrant est un message XML, le XML DASM désassemble il.</span><span class="sxs-lookup"><span data-stu-id="88deb-112">If the incoming message is an XML message, the XML DASM disassembles it.</span></span>  
  
    2.  <span data-ttu-id="88deb-113">Si le message entrant est un lot de messages, le désassembleur désassemble dans les messages individuels.</span><span class="sxs-lookup"><span data-stu-id="88deb-113">If the incoming message is a batch message, the disassembler disassembles into the individual messages.</span></span> <span data-ttu-id="88deb-114">(Pour plus d’informations, consultez [Message de traitement par lot](../../adapters-and-accelerators/accelerator-hl7/batch-message-processing.md) et [le traitement par lot des messages](../../adapters-and-accelerators/accelerator-hl7/message-batching.md).)</span><span class="sxs-lookup"><span data-stu-id="88deb-114">(For more details, see [Batch Message Processing](../../adapters-and-accelerators/accelerator-hl7/batch-message-processing.md) and [Message Batching](../../adapters-and-accelerators/accelerator-hl7/message-batching.md).)</span></span>  
  
    3.  <span data-ttu-id="88deb-115">Le DASM puis valide le message.</span><span class="sxs-lookup"><span data-stu-id="88deb-115">The DASM then validates the message.</span></span>  
  
    4.  <span data-ttu-id="88deb-116">Si vous utilisez un texte bidirectionnel, l’adaptateur de réception MLLP et si le message a été validé par le désassembleur [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] envoie un accusé de réception (ACK) à l’expéditeur d’origine du message via le même adaptateur qui a reçu le message d’origine.</span><span class="sxs-lookup"><span data-stu-id="88deb-116">If you use a two-way MLLP receive adapter, and if the disassembler has validated the message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] sends an acknowledgment (ACK) to the original sender of the message through the same adapter that received the original message.</span></span> <span data-ttu-id="88deb-117">Si ce n’est pas le cas, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] envoie un accusé de réception négatif (NAK).</span><span class="sxs-lookup"><span data-stu-id="88deb-117">If not, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] sends a negative acknowledgment (NAK).</span></span> <span data-ttu-id="88deb-118">(Comment est effectuée cette étape dépend de la configuration de l’accusé de réception.</span><span class="sxs-lookup"><span data-stu-id="88deb-118">(How this step is accomplished depends on the ACK configuration.</span></span> <span data-ttu-id="88deb-119">Pour plus d’informations, consultez [Modes d’accusé de réception du Message](../../adapters-and-accelerators/accelerator-hl7/ack-message-modes.md).)</span><span class="sxs-lookup"><span data-stu-id="88deb-119">For details, see [ACK Message Modes](../../adapters-and-accelerators/accelerator-hl7/ack-message-modes.md).)</span></span>  
  
    5.  <span data-ttu-id="88deb-120">Si vous n’utilisez pas bidirectionnel MLLP de réception, puis [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] génère un accusé de réception ou les accusés de réception (ou NAK ou NAKs) et le dépose dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88deb-120">If you do not use a two-way MLLP receive adapter, then [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] generates an ACK or ACKs (or NAK or NAKs) and deposits it into the MessageBox database.</span></span> [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]<span data-ttu-id="88deb-121">puis l’achemine vers les parties appropriées en fonction de la configuration de port d’envoi, qui utilise une des autres cartes (outre MLLP).</span><span class="sxs-lookup"><span data-stu-id="88deb-121"> then routes it to the appropriate parties based on the send port configuration, which could use any of the other adapters (besides MLLP).</span></span>  
  
     <span data-ttu-id="88deb-122">Pour une liste plus complète des processus effectuée dans le fichier plat et des désassembleurs XML, consultez [BizTalk Accelerator pour HL7 composants](../../adapters-and-accelerators/accelerator-hl7/biztalk-accelerator-for-hl7-components.md).</span><span class="sxs-lookup"><span data-stu-id="88deb-122">For a more complete listing of the processes performed in the flat file and XML disassemblers, see [BizTalk Accelerator for HL7 Components](../../adapters-and-accelerators/accelerator-hl7/biztalk-accelerator-for-hl7-components.md).</span></span>  
  
3.  <span data-ttu-id="88deb-123">Une fois que le message passe par l’adaptateur et le pipeline de réception, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] transmet le message dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88deb-123">After the message passes through the adapter and the receive pipeline, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] passes the message into the MessageBox database.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="88deb-124">Ensuite, détermine où envoyer le message suivant.</span><span class="sxs-lookup"><span data-stu-id="88deb-124"> then determines where to send the message next.</span></span> <span data-ttu-id="88deb-125">Si le message fait partie d’une orchestration, il envoie le message au moteur d’Orchestration.</span><span class="sxs-lookup"><span data-stu-id="88deb-125">If the message is part of an orchestration, it sends the message to the Orchestration Engine.</span></span>  
  
4.  <span data-ttu-id="88deb-126">Le moteur d’Orchestration traite le message.</span><span class="sxs-lookup"><span data-stu-id="88deb-126">The Orchestration Engine processes the message.</span></span>  
  
    1.  <span data-ttu-id="88deb-127">Si un mappage affecte le message, le mappage transforme le message en fonction de ses règles.</span><span class="sxs-lookup"><span data-stu-id="88deb-127">If a map affects the message, the map transforms the message according to its rules.</span></span>  
  
    2.  <span data-ttu-id="88deb-128">Si vous avez configuré une règle d’entreprise, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] appelle le moteur de règles d’entreprise (BRE) en dehors des pipelines, éventuellement dans le moteur d’Orchestration.</span><span class="sxs-lookup"><span data-stu-id="88deb-128">If you have set up a business rule, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] invokes the Business Rule Engine (BRE) outside of the pipelines, potentially in the Orchestration Engine.</span></span>  
  
    3.  <span data-ttu-id="88deb-129">Le moteur d’Orchestration envoie le message à la base de données MessageBox, puis poursuit le traitement de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="88deb-129">The Orchestration Engine sends the message back to the MessageBox database, and then continues processing the orchestration.</span></span>  
  
5.  <span data-ttu-id="88deb-130">En fonction de l’abonnement, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] achemine le message vers le port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="88deb-130">Based on the subscription, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes the message to the send port.</span></span>  
  
6.  [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]<span data-ttu-id="88deb-131">achemine le message via le pipeline d’envoi pour le traitement suivant (le cas échéant) : assembly et la validation.</span><span class="sxs-lookup"><span data-stu-id="88deb-131"> routes the message through the send pipeline for the following processing (if applicable): assembly and validation.</span></span>  
  
    1.  <span data-ttu-id="88deb-132">Si le message sera un HL7 2.X message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] assemble le message à partir de XML dans HL7 par l’assembleur de fichier plat (ASM).</span><span class="sxs-lookup"><span data-stu-id="88deb-132">If the message will be an HL7 2.X message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] assembles the message from XML into HL7 by the flat file assembler (ASM).</span></span> <span data-ttu-id="88deb-133">Si le message entrant est un message XML, le XML DASM assemble.</span><span class="sxs-lookup"><span data-stu-id="88deb-133">If the incoming message will be an XML message, the XML DASM assembles it.</span></span>  
  
    2.  <span data-ttu-id="88deb-134">Si le message doit faire partie d’un lot de messages, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] assemble chaque message dans le message du lot.</span><span class="sxs-lookup"><span data-stu-id="88deb-134">If the message will be part of a batch message, [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)] assembles each message into the batch message.</span></span> <span data-ttu-id="88deb-135">(Pour plus d’informations, consultez [Message de traitement par lot](../../adapters-and-accelerators/accelerator-hl7/batch-message-processing.md) et [le traitement par lot des messages](../../adapters-and-accelerators/accelerator-hl7/message-batching.md).)</span><span class="sxs-lookup"><span data-stu-id="88deb-135">(For more details, see [Batch Message Processing](../../adapters-and-accelerators/accelerator-hl7/batch-message-processing.md) and [Message Batching](../../adapters-and-accelerators/accelerator-hl7/message-batching.md).)</span></span>  
  
    3.  <span data-ttu-id="88deb-136">Le module ASM valide le message (si activé dans les paramètres de configuration de la partie de l’envoi).</span><span class="sxs-lookup"><span data-stu-id="88deb-136">The ASM validates the message (if enabled through send-party configuration settings).</span></span>  
  
     <span data-ttu-id="88deb-137">Pour une liste plus complète des processus effectuée dans le fichier plat et les assembleurs XML, consultez [BizTalk Accelerator pour HL7 composants](../../adapters-and-accelerators/accelerator-hl7/biztalk-accelerator-for-hl7-components.md).</span><span class="sxs-lookup"><span data-stu-id="88deb-137">For a more complete listing of the processes performed in the flat file and XML assemblers, see [BizTalk Accelerator for HL7 Components](../../adapters-and-accelerators/accelerator-hl7/biztalk-accelerator-for-hl7-components.md).</span></span>  
  
7.  [!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]<span data-ttu-id="88deb-138">envoie le message via un adaptateur.</span><span class="sxs-lookup"><span data-stu-id="88deb-138"> sends the message through an adapter.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="88deb-139">Vous pouvez transporter les messages 2.X et des messages XML 2. sur un nombre de cartes ; Toutefois, la plupart des systèmes de transport 2.X via un adaptateur MLLP 2 XML des messages et via un adaptateur HTTP.</span><span class="sxs-lookup"><span data-stu-id="88deb-139">You can transport 2.X messages and 2.XML messages over a number of adapters; however, most systems transport 2.X messages over an MLLP adapter, and 2.XML messages over an HTTP adapter.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="88deb-140">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="88deb-140">See Also</span></span>  
 [<span data-ttu-id="88deb-141">Comment BTAHL7 route les Messages</span><span class="sxs-lookup"><span data-stu-id="88deb-141">How BTAHL7 Routes Messages</span></span>](../../adapters-and-accelerators/accelerator-hl7/how-btahl7-routes-messages.md)