---
title: Comment BTAHL7 route les Messages | Documents Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- routing, about routing
- routing, messages
- messages, routing
- BTAHL7, message routing
ms.assetid: 555696c7-6023-44eb-b13d-cf7527bbc92f
caps.latest.revision: "7"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 61dd223a014ae8ea7de35d8d73f1a7cf7ef35449
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-btahl7-routes-messages"></a><span data-ttu-id="46275-102">Comment BTAHL7 route les Messages</span><span class="sxs-lookup"><span data-stu-id="46275-102">How BTAHL7 Routes Messages</span></span>
[!INCLUDE[btsCoName](../../includes/btsconame-md.md)]<span data-ttu-id="46275-103">BizTalk Accelerator pour HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) s’appuie sur les fonctionnalités de traitement des messages [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], mais il permet également d’étendre de plusieurs façons qui sont spécifiques à la configuration requise de la messagerie de HL7.</span><span class="sxs-lookup"><span data-stu-id="46275-103"> BizTalk Accelerator for HL7 ([!INCLUDE[btaBTAHL71.3abbrevnonumber](../../includes/btabtahl71-3abbrevnonumber-md.md)]) leverages the message processing capabilities of [!INCLUDE[btsCoName](../../includes/btsconame-md.md)] [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], but also extends it in several ways that are specific to HL7 messaging requirements.</span></span>  

## <a name="routing-overview"></a><span data-ttu-id="46275-104">Vue d’ensemble du routage</span><span class="sxs-lookup"><span data-stu-id="46275-104">Routing overview</span></span>

<span data-ttu-id="46275-105">HL7 reçoit des messages à partir d’un système métier (LOB) et peut s’afficher à l’aide de l’adaptateur MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-105">HL7 receives messages from a Line of Business (LOB) system, and may receive them using the MLLP adapter.</span></span> <span data-ttu-id="46275-106">Le système métier se connecte à l’adaptateur MLLP sur [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] via un port TCP, puis envoie des messages à l’adaptateur MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-106">The LOB system connects to MLLP adapter on [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] over a TCP port, and then sends messages to the MLLP adapter.</span></span>

<span data-ttu-id="46275-107">Dans  **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] et les versions antérieures**, le MLLP HL7 recevoir l’adaptateur de transport attend le système métier à distance pour se connecter à MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-107">In **[!INCLUDE[bts2013r2_md](../../includes/bts2013r2-md.md)] and older versions**, the HL7 MLLP receive transport adapter waits for the remote LOB system to connect to MLLP.</span></span> <span data-ttu-id="46275-108">Une fois que le système métier à distance se connecte, le système métier envoie les messages à l’aide de MLLP à la [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="46275-108">Once the remote LOB system connects, the LOB system sends the messages using MLLP to the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="46275-109">Plus précisément :</span><span class="sxs-lookup"><span data-stu-id="46275-109">Specifically:</span></span> 

1. <span data-ttu-id="46275-110">Le système LOB distant se connecte à l’adaptateur MLLP local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] à l’aide d’un port TCP</span><span class="sxs-lookup"><span data-stu-id="46275-110">The remote LOB system connects to the MLLP adapter on the local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] using a TCP port</span></span> 
2. <span data-ttu-id="46275-111">Le BTA4HL7 emplacement de réception avec l’adaptateur MLLP accepte la connexion</span><span class="sxs-lookup"><span data-stu-id="46275-111">The BTA4HL7 receive location with MLLP Adapter accepts the connection</span></span> 
3. <span data-ttu-id="46275-112">Le système métier à distance offre un ou plusieurs messages</span><span class="sxs-lookup"><span data-stu-id="46275-112">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="46275-113">Le système métier à distance se déconnecte.</span><span class="sxs-lookup"><span data-stu-id="46275-113">The remote LOB system disconnects</span></span>

<span data-ttu-id="46275-114">Dans  **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] et les versions plus récentes**, la connexion au système métier est lancée par l’adaptateur MLLP et recevoir les messages de push système LOB à la MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-114">In **[!INCLUDE[bts2016_md](../../includes/bts2016-md.md)] and newer versions**, the connection to the LOB system is initiated by the MLLP adapter, and then the LOB system pushes messages to the MLLP receive.</span></span> <span data-ttu-id="46275-115">En d’autres termes, le système métier à distance attend que la connexion avant d’envoyer des messagings à MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-115">In other words, the remote LOB system waits for the connection before sending messagings to MLLP.</span></span> <span data-ttu-id="46275-116">Plus précisément :</span><span class="sxs-lookup"><span data-stu-id="46275-116">Specifically:</span></span> 

1. <span data-ttu-id="46275-117">Local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] se connecte au système métier à distance à l’aide d’un port TCP</span><span class="sxs-lookup"><span data-stu-id="46275-117">The local [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] connects to the remote LOB system using a TCP port</span></span> 
2. <span data-ttu-id="46275-118">Le BTA4HL7 emplacement de réception avec MLLP adaptateur lance la connexion</span><span class="sxs-lookup"><span data-stu-id="46275-118">The BTA4HL7 receive location with MLLP adapter initiates the connection</span></span> 
3. <span data-ttu-id="46275-119">Le système métier à distance offre un ou plusieurs messages</span><span class="sxs-lookup"><span data-stu-id="46275-119">The remote LOB system delivers one or more messages</span></span> 
4. <span data-ttu-id="46275-120">Le système métier à distance se déconnecte.</span><span class="sxs-lookup"><span data-stu-id="46275-120">The remote LOB system disconnects</span></span> 

<span data-ttu-id="46275-121">Pour la compatibilité descendante, vous pouvez utiliser le comportement par défaut d’origine en où le système métier à distance établit les connexions.</span><span class="sxs-lookup"><span data-stu-id="46275-121">For backwards-compatibility, you can use the original default behavior where the remote LOB system initiates the connections.</span></span> <span data-ttu-id="46275-122">Cette option est configurable dans le MLLP propriétés de l’emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="46275-122">This option is configurable in the MLLP receive location properties.</span></span> 
 
<span data-ttu-id="46275-123">Une fois le message HL7 est reçu, il est ensuite soumis à une HL7 pipeline de réception.</span><span class="sxs-lookup"><span data-stu-id="46275-123">Once the HL7 message is received, it is then submitted to an HL7 receive pipeline.</span></span> <span data-ttu-id="46275-124">Dans ce pipeline, le désassembleur HL7 analysera le message et permet de valider le message en fonction de la configuration de définition et la validation de schéma approprié.</span><span class="sxs-lookup"><span data-stu-id="46275-124">Within this pipeline, the HL7 disassembler will parse the message, and will validate the message according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="46275-125">À ce stade, un message d’accusé de réception peut être de HL7 généré (succès ou erreur), en fonction de la validité du message et la configuration de l’accusé de réception approprié.</span><span class="sxs-lookup"><span data-stu-id="46275-125">At this point, an HL7 acknowledgment message may be generated (success or error), according to the validity of the message and the relevant acknowledgment configuration.</span></span> <span data-ttu-id="46275-126">À ce stade, le pipeline envoie l’instance de message et un accusé de réception facultatif pour la base de données MessageBox pour traitement ultérieur et de routage.</span><span class="sxs-lookup"><span data-stu-id="46275-126">From here, the pipeline will submit the message instance and optional acknowledgment to the MessageBox database for further processing and routing.</span></span>  
  
 <span data-ttu-id="46275-127">Une fois qu’une instance de message arrive dans la base de données MessageBox, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] vérifie par filtrage les abonnements et achemine le message vers un ou plusieurs ports d’envoi (éventuellement les ports MLLP) via un pipeline d’envoi HL7.</span><span class="sxs-lookup"><span data-stu-id="46275-127">Once a message instance arrives in the MessageBox database, [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] checks filter-based subscriptions and routes the message to one or more send ports (possibly MLLP ports) through an HL7 send pipeline.</span></span> <span data-ttu-id="46275-128">Le pipeline d’envoi peut valider les instances de message en fonction de la configuration de définition et la validation de schéma approprié.</span><span class="sxs-lookup"><span data-stu-id="46275-128">The send pipeline may validate the message instances according to the appropriate schema definition and validation configuration.</span></span> <span data-ttu-id="46275-129">En plus de la validation, il est possible de remplacer certaines valeurs de champ dans le segment MSH du message sortant.</span><span class="sxs-lookup"><span data-stu-id="46275-129">In addition to validation, it is possible to override certain field values in the MSH segment of the outgoing message.</span></span> <span data-ttu-id="46275-130">Cette possibilité de remplacement est particulièrement utile si plusieurs ports sont abonnés à un message et que chaque application de réception a attentes uniques au sein des valeurs de segment MSH.</span><span class="sxs-lookup"><span data-stu-id="46275-130">This override ability is especially useful if multiple ports have subscribed to a message and each receiving application has unique expectations within the MSH segment values.</span></span>  
  
 <span data-ttu-id="46275-131">Bien entendu, toutes les autres [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] d’envoi et de port de réception fonctionnalités seront disponibles pour les messages HL7, ainsi que certaines des fonctionnalités qui peuvent être uniques pour le type de port sélectionné, telles que les paramètres de port d’envoi MLLP.</span><span class="sxs-lookup"><span data-stu-id="46275-131">Of course, all of the other [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] send and receive port capabilities will be available to HL7 messages, along with some capabilities that may be unique to the selected port type, such as MLLP send-port parameters.</span></span> <span data-ttu-id="46275-132">Un exemple de la [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] fonctionnalités serait la possibilité d’appliquer un mappage de transformation à un message sortant.</span><span class="sxs-lookup"><span data-stu-id="46275-132">An example of the relevant [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] capabilities would be the ability to apply a transformation map to an outbound message.</span></span>  
  
## <a name="how-routing-works"></a><span data-ttu-id="46275-133">Fonctionnement du routage</span><span class="sxs-lookup"><span data-stu-id="46275-133">How Routing Works</span></span>

<span data-ttu-id="46275-134">Le [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] itinéraires HL7 message instances en fonction des abonnements qui gère de la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="46275-134">The [!INCLUDE[btaBTAHL7NoNumber_md](../../includes/btabtahl7nonumber-md.md)] routes HL7 message instances according to subscriptions that the MessageBox database manages.</span></span> <span data-ttu-id="46275-135">Ces abonnements utilisent des filtres que vous définissez pour chaque port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="46275-135">These subscriptions use filters that you define for each send port.</span></span> <span data-ttu-id="46275-136">Exemple de filtre peut inclure le routage basé sur type de message ID et/ou HL7 port de réception (ADT ^ A03, par exemple) et/ou en envoyant l’application (valeur MSH3.1).</span><span class="sxs-lookup"><span data-stu-id="46275-136">Example filters might include routing based on receive port ID and/or HL7 message type (ADT^A03, for example) and/or sending application (MSH3.1 value).</span></span>  
  
 <span data-ttu-id="46275-137">En plus de définir [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] abonnements, vous devez effectuer une configuration de messagerie HL7 spécifiques qui affecte les instances de message HL7 comme [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] les route.</span><span class="sxs-lookup"><span data-stu-id="46275-137">In addition to setting up [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] subscriptions, you need to perform some HL7-specific messaging configuration that will affect HL7 message instances as [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] routes them.</span></span> <span data-ttu-id="46275-138">Cette configuration supplémentaire vous permet d’appliquer des règles de validation HL7 uniques, la génération automatique des accusés de réception et la possibilité de remplacer les valeurs MSH.</span><span class="sxs-lookup"><span data-stu-id="46275-138">This additional configuration enables you to apply unique HL7 validation rules, automatic generation of acknowledgments, and the ability to override MSH values.</span></span> [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)]<span data-ttu-id="46275-139">s’applique cette configuration au niveau du tiers.</span><span class="sxs-lookup"><span data-stu-id="46275-139"> applies this configuration at the party level.</span></span> <span data-ttu-id="46275-140">Vous devez définir les parties de l’Explorateur BizTalk et effectuer la configuration HL7 connexe dans [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] l’Explorateur de Configuration.</span><span class="sxs-lookup"><span data-stu-id="46275-140">You need to define parties within BizTalk Explorer and perform the related HL7 configuration within [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] Configuration Explorer.</span></span>  
  
 <span data-ttu-id="46275-141">Pour appliquer HL7 messagerie configuration unique (par exemple, la validation ou les remplacements MSH) à plusieurs ports d’envoi qui s’abonnent à un message, vous devez créer des associations entre les parties et les ports d’envoi.</span><span class="sxs-lookup"><span data-stu-id="46275-141">To apply unique HL7 messaging configuration (for example, validation or MSH overrides) to multiple send ports that subscribe to a message, you need to create associations between parties and send ports.</span></span> <span data-ttu-id="46275-142">Vous configurez les associations de port de tiers à envoyer en tant que propriétés de tiers dans l’Explorateur BizTalk.</span><span class="sxs-lookup"><span data-stu-id="46275-142">You configure party-to-send port associations as party properties within BizTalk Explorer.</span></span>  
  
 <span data-ttu-id="46275-143">Si vous ne pas devez router HL7 vers plusieurs ports d’envoi des messages, ou appliquer une configuration de traitement HL7 unique à plusieurs ports d’envoi, vous pouvez éliminer l’étape d’association des parties avec les ports d’envoi.</span><span class="sxs-lookup"><span data-stu-id="46275-143">If you do not need to route HL7 messages to multiple send ports, or apply unique HL7 processing configuration to multiple send ports, you can eliminate the step of associating parties with send ports.</span></span> <span data-ttu-id="46275-144">Dans ce cas, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associe la partie de sa configuration de messagerie HL7 via le champ d’application réceptrice dans le message HL7 (MSH 3.1).</span><span class="sxs-lookup"><span data-stu-id="46275-144">In this case, [!INCLUDE[HL7_CurrentVersion_abbrev_md](../../includes/hl7-currentversion-abbrev-md.md)] associates the party with its HL7 messaging configuration through the receiving application field in the HL7 message (MSH 3.1).</span></span> <span data-ttu-id="46275-145">Cette situation est susceptible de se produire dans un interrogative HL7 (requête/réponse) exchange du message.</span><span class="sxs-lookup"><span data-stu-id="46275-145">This situation is most likely to occur in an HL7 interrogative (request/response) message exchange.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="46275-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="46275-146">See Also</span></span>  
 [<span data-ttu-id="46275-147">Validation de message</span><span class="sxs-lookup"><span data-stu-id="46275-147">Message Validation</span></span>](../../adapters-and-accelerators/accelerator-hl7/message-validation.md)