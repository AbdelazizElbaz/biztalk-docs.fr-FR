---
title: "Classe SAPConnection dans l’adaptateur SAP | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cb5a1778fac8577efb3c3c21a10b16f47a026397
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="28dc1-102">Classe SAPConnection dans l’adaptateur SAP</span><span class="sxs-lookup"><span data-stu-id="28dc1-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="28dc1-103">La section suivante répertorie les méthodes et propriétés pour le **SAPConnection** classe.</span><span class="sxs-lookup"><span data-stu-id="28dc1-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="28dc1-104">Représente une connexion ADO.NET pour le serveur d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="28dc1-105">Elle est dérivée de **System.Data.Common.DbConnection**.</span><span class="sxs-lookup"><span data-stu-id="28dc1-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="28dc1-106">Propriétés prises en charge</span><span class="sxs-lookup"><span data-stu-id="28dc1-106">Supported Properties</span></span>  
  
|<span data-ttu-id="28dc1-107">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-107">Name</span></span>|<span data-ttu-id="28dc1-108">Get/Set.</span><span class="sxs-lookup"><span data-stu-id="28dc1-108">Get/Set</span></span>|<span data-ttu-id="28dc1-109"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="28dc1-110">**ConnectionString**</span><span class="sxs-lookup"><span data-stu-id="28dc1-110">**ConnectionString**</span></span>|<span data-ttu-id="28dc1-111">Get et Set</span><span class="sxs-lookup"><span data-stu-id="28dc1-111">Get and Set</span></span>|<span data-ttu-id="28dc1-112">Consultez [en savoir plus sur les types de fournisseur de données pour la chaîne de connexion SAP](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="28dc1-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="28dc1-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="28dc1-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="28dc1-114">Obtenir</span><span class="sxs-lookup"><span data-stu-id="28dc1-114">Get</span></span>|<span data-ttu-id="28dc1-115">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="28dc1-115">Not supported.</span></span> <span data-ttu-id="28dc1-116">Retourne 0.</span><span class="sxs-lookup"><span data-stu-id="28dc1-116">Returns 0.</span></span>|  
|<span data-ttu-id="28dc1-117">**Base de données**</span><span class="sxs-lookup"><span data-stu-id="28dc1-117">**Database**</span></span>|<span data-ttu-id="28dc1-118">Obtenir</span><span class="sxs-lookup"><span data-stu-id="28dc1-118">Get</span></span>|<span data-ttu-id="28dc1-119">ID du système SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-119">SAP System ID.</span></span>|  
|<span data-ttu-id="28dc1-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="28dc1-120">**DataSource**</span></span>|<span data-ttu-id="28dc1-121">Obtenir</span><span class="sxs-lookup"><span data-stu-id="28dc1-121">Get</span></span>|<span data-ttu-id="28dc1-122">Cela retourne le nom de l’hôte de serveur d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="28dc1-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="28dc1-123">**ServerVersion**</span></span>|<span data-ttu-id="28dc1-124">Obtenir</span><span class="sxs-lookup"><span data-stu-id="28dc1-124">Get</span></span>|<span data-ttu-id="28dc1-125">Cela affiche le numéro de version de l’instance SAP et non la version du serveur SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="28dc1-126">Par exemple, si le client ADO.NET se connecte au serveur de SAP version 4.6 avec le numéro de version de l’instance 620, cette propriété affiche 620.</span><span class="sxs-lookup"><span data-stu-id="28dc1-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="28dc1-127">**État**</span><span class="sxs-lookup"><span data-stu-id="28dc1-127">**State**</span></span>|<span data-ttu-id="28dc1-128">Obtenir</span><span class="sxs-lookup"><span data-stu-id="28dc1-128">Get</span></span>|<span data-ttu-id="28dc1-129">État de la connexion.</span><span class="sxs-lookup"><span data-stu-id="28dc1-129">Connection state.</span></span> <span data-ttu-id="28dc1-130">Les états pris en charge sont :</span><span class="sxs-lookup"><span data-stu-id="28dc1-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="28dc1-131">-[System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="28dc1-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="28dc1-132">-Fermé</span><span class="sxs-lookup"><span data-stu-id="28dc1-132">- Closed</span></span><br /><br /> <span data-ttu-id="28dc1-133">-Permet d’ouvrir</span><span class="sxs-lookup"><span data-stu-id="28dc1-133">- Open</span></span><br /><br /> <span data-ttu-id="28dc1-134">-Connexion</span><span class="sxs-lookup"><span data-stu-id="28dc1-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="28dc1-135">Méthodes prises en charge</span><span class="sxs-lookup"><span data-stu-id="28dc1-135">Supported Methods</span></span>  
  
|<span data-ttu-id="28dc1-136">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-136">Name</span></span>|<span data-ttu-id="28dc1-137"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="28dc1-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="28dc1-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="28dc1-139">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="28dc1-139">Not supported.</span></span>|  
|<span data-ttu-id="28dc1-140">**Close()**</span><span class="sxs-lookup"><span data-stu-id="28dc1-140">**Close()**</span></span>|<span data-ttu-id="28dc1-141">Ferme la connexion au système SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="28dc1-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="28dc1-142">**CreateCommand()**</span></span>|<span data-ttu-id="28dc1-143">Retourne un nouveau SAPCommand associé à cette connexion.</span><span class="sxs-lookup"><span data-stu-id="28dc1-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="28dc1-144">**GetSchema()**</span><span class="sxs-lookup"><span data-stu-id="28dc1-144">**GetSchema()**</span></span>|<span data-ttu-id="28dc1-145">Obtient la liste des tables SAP détectés.</span><span class="sxs-lookup"><span data-stu-id="28dc1-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="28dc1-146">Toutes les découvertes de tables sont disponibles dans un fichier XML SAPDiscoveredObjects.xml.</span><span class="sxs-lookup"><span data-stu-id="28dc1-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="28dc1-147">Le fichier se trouve dans \<lecteur d’installation\>: \Program Files\Microsoft Shared\Adapters\SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-147">The file is located at \<installation drive\>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="28dc1-148">**GetSchema (String)**</span><span class="sxs-lookup"><span data-stu-id="28dc1-148">**GetSchema(string)**</span></span>|<span data-ttu-id="28dc1-149">Obtient le schéma basé sur le nom de la collection.</span><span class="sxs-lookup"><span data-stu-id="28dc1-149">Gets schema based on collection name.</span></span> <span data-ttu-id="28dc1-150">Prend en charge le nom de la collection « Tables ».</span><span class="sxs-lookup"><span data-stu-id="28dc1-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="28dc1-151">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-151">Name</span></span>|<span data-ttu-id="28dc1-152"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="28dc1-153">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-154">Obtient le schéma basé sur les restrictions et le nom de la collection.</span><span class="sxs-lookup"><span data-stu-id="28dc1-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="28dc1-155">Le tableau suivant représente les noms de collection et les restrictions prises en charge :</span><span class="sxs-lookup"><span data-stu-id="28dc1-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="28dc1-156">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-156">Name</span></span>|<span data-ttu-id="28dc1-157">Nom de la collection</span><span class="sxs-lookup"><span data-stu-id="28dc1-157">Collection Name</span></span>|<span data-ttu-id="28dc1-158">Restrictions</span><span class="sxs-lookup"><span data-stu-id="28dc1-158">Restrictions</span></span>|<span data-ttu-id="28dc1-159"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="28dc1-160">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-161">Tables</span><span class="sxs-lookup"><span data-stu-id="28dc1-161">Tables</span></span>|-|<span data-ttu-id="28dc1-162">Liste des Tables de SAP détectés</span><span class="sxs-lookup"><span data-stu-id="28dc1-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="28dc1-163">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-164">Procédures</span><span class="sxs-lookup"><span data-stu-id="28dc1-164">Procedures</span></span>|-|<span data-ttu-id="28dc1-165">Liste de RFC détectés</span><span class="sxs-lookup"><span data-stu-id="28dc1-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="28dc1-166">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="28dc1-167">SearchRFCs</span></span>|<span data-ttu-id="28dc1-168">arr [0] : recherche expr</span><span class="sxs-lookup"><span data-stu-id="28dc1-168">arr[0]: Search expr</span></span>|<span data-ttu-id="28dc1-169">Liste de mise en correspondance les RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="28dc1-170">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="28dc1-171">ImportParameters</span></span>|<span data-ttu-id="28dc1-172">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-172">arr[1]: RFC name</span></span>|<span data-ttu-id="28dc1-173">Paramètres d’importation de RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="28dc1-174">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="28dc1-175">ImportParameterColumn</span></span>|<span data-ttu-id="28dc1-176">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="28dc1-177">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="28dc1-177">arr[2]: Param name</span></span>|<span data-ttu-id="28dc1-178">Importer le schéma de paramètre</span><span class="sxs-lookup"><span data-stu-id="28dc1-178">Import parameter schema</span></span>|  
|<span data-ttu-id="28dc1-179">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="28dc1-180">ExportParameters</span></span>|<span data-ttu-id="28dc1-181">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-181">arr[1]: RFC name</span></span>|<span data-ttu-id="28dc1-182">Paramètres d’exportation de RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="28dc1-183">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="28dc1-184">ExportParameterColumn</span></span>|<span data-ttu-id="28dc1-185">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="28dc1-186">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="28dc1-186">arr[2]: Param name</span></span>|<span data-ttu-id="28dc1-187">Exporter le schéma de paramètres</span><span class="sxs-lookup"><span data-stu-id="28dc1-187">Export parameter schema</span></span>|  
|<span data-ttu-id="28dc1-188">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="28dc1-189">TableParameters</span></span>|<span data-ttu-id="28dc1-190">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-190">arr[1]: RFC name</span></span>|<span data-ttu-id="28dc1-191">Paramètres de la table de RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="28dc1-192">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="28dc1-193">TableParameterColumn</span></span>|<span data-ttu-id="28dc1-194">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="28dc1-195">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="28dc1-195">arr[2]: Param name</span></span>|<span data-ttu-id="28dc1-196">Schéma de paramètres table</span><span class="sxs-lookup"><span data-stu-id="28dc1-196">Table parameter schema</span></span>|  
|<span data-ttu-id="28dc1-197">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="28dc1-198">ChangingParameters</span></span>|<span data-ttu-id="28dc1-199">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-199">arr[1]: RFC name</span></span>|<span data-ttu-id="28dc1-200">Modification des paramètres de RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="28dc1-201">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="28dc1-202">ChangingParameterColumn</span></span>|<span data-ttu-id="28dc1-203">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="28dc1-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="28dc1-204">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="28dc1-204">arr[2]: Param name</span></span>|<span data-ttu-id="28dc1-205">La modification du schéma de paramètres</span><span class="sxs-lookup"><span data-stu-id="28dc1-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="28dc1-206">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="28dc1-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="28dc1-207">colonnes</span><span class="sxs-lookup"><span data-stu-id="28dc1-207">columns</span></span>|<span data-ttu-id="28dc1-208">arr [1] : nom de la Table</span><span class="sxs-lookup"><span data-stu-id="28dc1-208">arr[1]: Table name</span></span>|<span data-ttu-id="28dc1-209">Schéma de colonne de Table SAP</span><span class="sxs-lookup"><span data-stu-id="28dc1-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="28dc1-210">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-210">Name</span></span>|<span data-ttu-id="28dc1-211"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="28dc1-212">**Open()**</span><span class="sxs-lookup"><span data-stu-id="28dc1-212">**Open()**</span></span>|<span data-ttu-id="28dc1-213">Ouvre une connexion SAP en fonction de la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="28dc1-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="28dc1-214">À l’exception des entrées de la collection de Table, procédure et SearchRFCs, pour toutes les autres entrées de la collection, vous devez spécifier une valeur factice pour arr [0].</span><span class="sxs-lookup"><span data-stu-id="28dc1-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="28dc1-215">Constructeur pris en charge</span><span class="sxs-lookup"><span data-stu-id="28dc1-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="28dc1-216">Nom</span><span class="sxs-lookup"><span data-stu-id="28dc1-216">Name</span></span>|<span data-ttu-id="28dc1-217"> Description</span><span class="sxs-lookup"><span data-stu-id="28dc1-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="28dc1-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="28dc1-218">**SAPConnection()**</span></span>|<span data-ttu-id="28dc1-219">Crée une instance d’objet SAPConnection.</span><span class="sxs-lookup"><span data-stu-id="28dc1-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="28dc1-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="28dc1-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="28dc1-221">Accepte une chaîne de connexion SAP.</span><span class="sxs-lookup"><span data-stu-id="28dc1-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="28dc1-222">Lève une exception si la chaîne de connexion n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="28dc1-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="28dc1-223">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="28dc1-223">See Also</span></span>  
 [<span data-ttu-id="28dc1-224">Étendre des Interfaces ADO.NET avec l’adaptateur SAP</span><span class="sxs-lookup"><span data-stu-id="28dc1-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)