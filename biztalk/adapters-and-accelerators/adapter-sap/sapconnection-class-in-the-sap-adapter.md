---
title: "Classe SAPConnection dans l’adaptateur SAP | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b27bb8f88686fe1726aed16113ce227347151996
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="04d15-102">Classe SAPConnection dans l’adaptateur SAP</span><span class="sxs-lookup"><span data-stu-id="04d15-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="04d15-103">La section suivante répertorie les méthodes et propriétés pour le **SAPConnection** classe.</span><span class="sxs-lookup"><span data-stu-id="04d15-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="04d15-104">Représente une connexion ADO.NET pour le serveur d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="04d15-105">Elle est dérivée de **System.Data.Common.DbConnection**.</span><span class="sxs-lookup"><span data-stu-id="04d15-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="04d15-106">Propriétés prises en charge</span><span class="sxs-lookup"><span data-stu-id="04d15-106">Supported Properties</span></span>  
  
|<span data-ttu-id="04d15-107">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-107">Name</span></span>|<span data-ttu-id="04d15-108">Get/Set.</span><span class="sxs-lookup"><span data-stu-id="04d15-108">Get/Set</span></span>|<span data-ttu-id="04d15-109"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="04d15-110">**ConnectionString**</span><span class="sxs-lookup"><span data-stu-id="04d15-110">**ConnectionString**</span></span>|<span data-ttu-id="04d15-111">Get et Set</span><span class="sxs-lookup"><span data-stu-id="04d15-111">Get and Set</span></span>|<span data-ttu-id="04d15-112">Consultez [en savoir plus sur les types de fournisseur de données pour la chaîne de connexion SAP](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span><span class="sxs-lookup"><span data-stu-id="04d15-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="04d15-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="04d15-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="04d15-114">Obtenir</span><span class="sxs-lookup"><span data-stu-id="04d15-114">Get</span></span>|<span data-ttu-id="04d15-115">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="04d15-115">Not supported.</span></span> <span data-ttu-id="04d15-116">Retourne 0.</span><span class="sxs-lookup"><span data-stu-id="04d15-116">Returns 0.</span></span>|  
|<span data-ttu-id="04d15-117">**Base de données**</span><span class="sxs-lookup"><span data-stu-id="04d15-117">**Database**</span></span>|<span data-ttu-id="04d15-118">Obtenir</span><span class="sxs-lookup"><span data-stu-id="04d15-118">Get</span></span>|<span data-ttu-id="04d15-119">ID du système SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-119">SAP System ID.</span></span>|  
|<span data-ttu-id="04d15-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="04d15-120">**DataSource**</span></span>|<span data-ttu-id="04d15-121">Obtenir</span><span class="sxs-lookup"><span data-stu-id="04d15-121">Get</span></span>|<span data-ttu-id="04d15-122">Cela retourne le nom de l’hôte de serveur d’applications SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="04d15-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="04d15-123">**ServerVersion**</span></span>|<span data-ttu-id="04d15-124">Obtenir</span><span class="sxs-lookup"><span data-stu-id="04d15-124">Get</span></span>|<span data-ttu-id="04d15-125">Cela affiche le numéro de version de l’instance SAP et non la version du serveur SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="04d15-126">Par exemple, si le client ADO.NET se connecte au serveur de SAP version 4.6 avec le numéro de version de l’instance 620, cette propriété affiche 620.</span><span class="sxs-lookup"><span data-stu-id="04d15-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="04d15-127">**État**</span><span class="sxs-lookup"><span data-stu-id="04d15-127">**State**</span></span>|<span data-ttu-id="04d15-128">Obtenir</span><span class="sxs-lookup"><span data-stu-id="04d15-128">Get</span></span>|<span data-ttu-id="04d15-129">État de la connexion.</span><span class="sxs-lookup"><span data-stu-id="04d15-129">Connection state.</span></span> <span data-ttu-id="04d15-130">Les états pris en charge sont :</span><span class="sxs-lookup"><span data-stu-id="04d15-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="04d15-131">-[System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="04d15-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="04d15-132">-Fermé</span><span class="sxs-lookup"><span data-stu-id="04d15-132">- Closed</span></span><br /><br /> <span data-ttu-id="04d15-133">-Permet d’ouvrir</span><span class="sxs-lookup"><span data-stu-id="04d15-133">- Open</span></span><br /><br /> <span data-ttu-id="04d15-134">-Connexion</span><span class="sxs-lookup"><span data-stu-id="04d15-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="04d15-135">Méthodes prises en charge</span><span class="sxs-lookup"><span data-stu-id="04d15-135">Supported Methods</span></span>  
  
|<span data-ttu-id="04d15-136">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-136">Name</span></span>|<span data-ttu-id="04d15-137"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="04d15-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="04d15-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="04d15-139">Non pris en charge.</span><span class="sxs-lookup"><span data-stu-id="04d15-139">Not supported.</span></span>|  
|<span data-ttu-id="04d15-140">**Close()**</span><span class="sxs-lookup"><span data-stu-id="04d15-140">**Close()**</span></span>|<span data-ttu-id="04d15-141">Ferme la connexion au système SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="04d15-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="04d15-142">**CreateCommand()**</span></span>|<span data-ttu-id="04d15-143">Retourne un nouveau SAPCommand associé à cette connexion.</span><span class="sxs-lookup"><span data-stu-id="04d15-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="04d15-144">**GetSchema()**</span><span class="sxs-lookup"><span data-stu-id="04d15-144">**GetSchema()**</span></span>|<span data-ttu-id="04d15-145">Obtient la liste des tables SAP détectés.</span><span class="sxs-lookup"><span data-stu-id="04d15-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="04d15-146">Toutes les découvertes de tables sont disponibles dans un fichier XML SAPDiscoveredObjects.xml.</span><span class="sxs-lookup"><span data-stu-id="04d15-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="04d15-147">Le fichier se trouve dans \<lecteur d’installation > : \Program Files\Microsoft Shared\Adapters\SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-147">The file is located at \<installation drive>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="04d15-148">**GetSchema (String)**</span><span class="sxs-lookup"><span data-stu-id="04d15-148">**GetSchema(string)**</span></span>|<span data-ttu-id="04d15-149">Obtient le schéma basé sur le nom de la collection.</span><span class="sxs-lookup"><span data-stu-id="04d15-149">Gets schema based on collection name.</span></span> <span data-ttu-id="04d15-150">Prend en charge le nom de la collection « Tables ».</span><span class="sxs-lookup"><span data-stu-id="04d15-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="04d15-151">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-151">Name</span></span>|<span data-ttu-id="04d15-152"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="04d15-153">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-154">Obtient le schéma basé sur les restrictions et le nom de la collection.</span><span class="sxs-lookup"><span data-stu-id="04d15-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="04d15-155">Le tableau suivant représente les noms de collection et les restrictions prises en charge :</span><span class="sxs-lookup"><span data-stu-id="04d15-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="04d15-156">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-156">Name</span></span>|<span data-ttu-id="04d15-157">Nom de la collection</span><span class="sxs-lookup"><span data-stu-id="04d15-157">Collection Name</span></span>|<span data-ttu-id="04d15-158">Restrictions</span><span class="sxs-lookup"><span data-stu-id="04d15-158">Restrictions</span></span>|<span data-ttu-id="04d15-159"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="04d15-160">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-161">Tables</span><span class="sxs-lookup"><span data-stu-id="04d15-161">Tables</span></span>|-|<span data-ttu-id="04d15-162">Liste des Tables de SAP détectés</span><span class="sxs-lookup"><span data-stu-id="04d15-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="04d15-163">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-164">Procédures</span><span class="sxs-lookup"><span data-stu-id="04d15-164">Procedures</span></span>|-|<span data-ttu-id="04d15-165">Liste de RFC détectés</span><span class="sxs-lookup"><span data-stu-id="04d15-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="04d15-166">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="04d15-167">SearchRFCs</span></span>|<span data-ttu-id="04d15-168">arr [0] : recherche expr</span><span class="sxs-lookup"><span data-stu-id="04d15-168">arr[0]: Search expr</span></span>|<span data-ttu-id="04d15-169">Liste de mise en correspondance les RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="04d15-170">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="04d15-171">ImportParameters</span></span>|<span data-ttu-id="04d15-172">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-172">arr[1]: RFC name</span></span>|<span data-ttu-id="04d15-173">Paramètres d’importation de RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="04d15-174">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="04d15-175">ImportParameterColumn</span></span>|<span data-ttu-id="04d15-176">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="04d15-177">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="04d15-177">arr[2]: Param name</span></span>|<span data-ttu-id="04d15-178">Importer le schéma de paramètre</span><span class="sxs-lookup"><span data-stu-id="04d15-178">Import parameter schema</span></span>|  
|<span data-ttu-id="04d15-179">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="04d15-180">ExportParameters</span></span>|<span data-ttu-id="04d15-181">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-181">arr[1]: RFC name</span></span>|<span data-ttu-id="04d15-182">Paramètres d’exportation de RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="04d15-183">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="04d15-184">ExportParameterColumn</span></span>|<span data-ttu-id="04d15-185">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="04d15-186">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="04d15-186">arr[2]: Param name</span></span>|<span data-ttu-id="04d15-187">Exporter le schéma de paramètres</span><span class="sxs-lookup"><span data-stu-id="04d15-187">Export parameter schema</span></span>|  
|<span data-ttu-id="04d15-188">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="04d15-189">TableParameters</span></span>|<span data-ttu-id="04d15-190">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-190">arr[1]: RFC name</span></span>|<span data-ttu-id="04d15-191">Paramètres de la table de RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="04d15-192">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="04d15-193">TableParameterColumn</span></span>|<span data-ttu-id="04d15-194">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="04d15-195">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="04d15-195">arr[2]: Param name</span></span>|<span data-ttu-id="04d15-196">Schéma de paramètres table</span><span class="sxs-lookup"><span data-stu-id="04d15-196">Table parameter schema</span></span>|  
|<span data-ttu-id="04d15-197">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="04d15-198">ChangingParameters</span></span>|<span data-ttu-id="04d15-199">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-199">arr[1]: RFC name</span></span>|<span data-ttu-id="04d15-200">Modification des paramètres de RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="04d15-201">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="04d15-202">ChangingParameterColumn</span></span>|<span data-ttu-id="04d15-203">arr [1] : nom de la RFC</span><span class="sxs-lookup"><span data-stu-id="04d15-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="04d15-204">arr [2] : nom de paramètre</span><span class="sxs-lookup"><span data-stu-id="04d15-204">arr[2]: Param name</span></span>|<span data-ttu-id="04d15-205">La modification du schéma de paramètres</span><span class="sxs-lookup"><span data-stu-id="04d15-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="04d15-206">**GetSchema (string, qu'**</span><span class="sxs-lookup"><span data-stu-id="04d15-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="04d15-207">colonnes</span><span class="sxs-lookup"><span data-stu-id="04d15-207">columns</span></span>|<span data-ttu-id="04d15-208">arr [1] : nom de la Table</span><span class="sxs-lookup"><span data-stu-id="04d15-208">arr[1]: Table name</span></span>|<span data-ttu-id="04d15-209">Schéma de colonne de Table SAP</span><span class="sxs-lookup"><span data-stu-id="04d15-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="04d15-210">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-210">Name</span></span>|<span data-ttu-id="04d15-211"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="04d15-212">**Open()**</span><span class="sxs-lookup"><span data-stu-id="04d15-212">**Open()**</span></span>|<span data-ttu-id="04d15-213">Ouvre une connexion SAP en fonction de la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="04d15-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="04d15-214">À l’exception des entrées de la collection de Table, procédure et SearchRFCs, pour toutes les autres entrées de la collection, vous devez spécifier une valeur factice pour arr [0].</span><span class="sxs-lookup"><span data-stu-id="04d15-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="04d15-215">Constructeur pris en charge</span><span class="sxs-lookup"><span data-stu-id="04d15-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="04d15-216">Nom</span><span class="sxs-lookup"><span data-stu-id="04d15-216">Name</span></span>|<span data-ttu-id="04d15-217"> Description</span><span class="sxs-lookup"><span data-stu-id="04d15-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="04d15-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="04d15-218">**SAPConnection()**</span></span>|<span data-ttu-id="04d15-219">Crée une instance d’objet SAPConnection.</span><span class="sxs-lookup"><span data-stu-id="04d15-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="04d15-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="04d15-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="04d15-221">Accepte une chaîne de connexion SAP.</span><span class="sxs-lookup"><span data-stu-id="04d15-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="04d15-222">Lève une exception si la chaîne de connexion n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="04d15-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="04d15-223">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="04d15-223">See Also</span></span>  
 [<span data-ttu-id="04d15-224">Étendre des Interfaces ADO.NET avec l’adaptateur SAP</span><span class="sxs-lookup"><span data-stu-id="04d15-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)