---
title: "Exécutez BAPI Transactions dans SAP à l’aide de BizTalk Server | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 75ff5cf7-5e98-4d74-a13f-4de65c215d41
caps.latest.revision: "11"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 79cfa3f1b799c4a96cdad7f4c9b89b4b594dc4d8
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="run-bapi-transactions-in-sap-using-biztalk-server"></a><span data-ttu-id="f8022-102">Exécutez BAPI Transactions dans SAP à l’aide de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="f8022-102">Run BAPI Transactions in SAP using BizTalk Server</span></span>
<span data-ttu-id="f8022-103">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] permet aux clients d’adaptateur effectuer des transactions sur un système SAP à l’aide de [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-103">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] enables adapter clients to perform transactions on an SAP system by using [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="f8022-104">Avant de créer une orchestration pour une transaction, vous devez d’abord comprendre un scénario de base dans lequel les transactions seront effectuées.</span><span class="sxs-lookup"><span data-stu-id="f8022-104">Before creating an orchestration for a transaction, you must first understand a basic scenario in which transactions will be performed.</span></span> <span data-ttu-id="f8022-105">Dans un scénario classique de transaction, un message de demande avec plusieurs opérations (par exemple, appeler une commande BAPI) est envoyé au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-105">In a typical transaction scenario, a request message with multiple operations (such as invoking a BAPI) is sent to the SAP system.</span></span> <span data-ttu-id="f8022-106">Cela est appelé un message « opération ».</span><span class="sxs-lookup"><span data-stu-id="f8022-106">This will be referred to as an "operation message."</span></span> <span data-ttu-id="f8022-107">L’orchestration doit extraire chaque message d’opération à partir du message de demande et envoyer les messages d’opération individuelle au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-107">The orchestration must extract each operation message from the request message and send the individual operation messages to the SAP system.</span></span> <span data-ttu-id="f8022-108">L’orchestration envoie les unes après les autres à l’aide de la même connexion.</span><span class="sxs-lookup"><span data-stu-id="f8022-108">The orchestration sends them one after the other using the same connection.</span></span> <span data-ttu-id="f8022-109">L’orchestration extrait les messages individuels à partir du message « opération » à l’aide d’une transformation XML via un mappage BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-109">The orchestration extracts the individual messages from the "operation message" by using an XML transform via a BizTalk map.</span></span>  
  
 <span data-ttu-id="f8022-110">Une fois que les opérations sont effectuées, l’orchestration doit valider ou abandonner la transaction en envoyant des messages pour BAPI_TRANSACTION_COMMIT ou BAPI_TRANSACTION_ROLLBACK, respectivement.</span><span class="sxs-lookup"><span data-stu-id="f8022-110">After the operations are performed, the orchestration must commit or abort the transaction by sending messages for BAPI_TRANSACTION_COMMIT or BAPI_TRANSACTION_ROLLBACK, respectively.</span></span> <span data-ttu-id="f8022-111">Il seront appelés « messages de transaction ».</span><span class="sxs-lookup"><span data-stu-id="f8022-111">These will be referred to as "transaction messages."</span></span>  
  
## <a name="how-does-the-adapter-enable-transactions-through-biztalk-server"></a><span data-ttu-id="f8022-112">Comment l’adaptateur n’active pas les Transactions via BizTalk Server ?</span><span class="sxs-lookup"><span data-stu-id="f8022-112">How Does the Adapter Enable Transactions Through BizTalk Server?</span></span>  
 <span data-ttu-id="f8022-113">Pour activer les transactions sur un système SAP à l’aide du [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="f8022-113">To enable transactions on an SAP system using the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)]:</span></span>  
  
-   <span data-ttu-id="f8022-114">Fournit les propriétés de contexte de message ouvrir, RÉUTILISENT, CLOSE et abandonner.</span><span class="sxs-lookup"><span data-stu-id="f8022-114">Provides message context properties OPEN, REUSE, CLOSE, and ABORT.</span></span>  
  
-   <span data-ttu-id="f8022-115">Utilise BAPI_TRANSACTION_COMMIT et BAPI_TRANSACTION_ROLLBACK pour valider ou annuler les opérations.</span><span class="sxs-lookup"><span data-stu-id="f8022-115">Uses BAPI_TRANSACTION_COMMIT and BAPI_TRANSACTION_ROLLBACK to commit or abort the operations.</span></span> <span data-ttu-id="f8022-116">Ceux-ci sont exposés par le système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-116">These are exposed by the SAP system.</span></span>  
  
 <span data-ttu-id="f8022-117">Le tableau suivant répertorie certaines des recommandations sur l’utilisation de propriétés avec BAPI_TRANSACTION_COMMIT ou BAPI_TRANSACTION_ROLLBACK :</span><span class="sxs-lookup"><span data-stu-id="f8022-117">The following table lists some guidelines on using the properties with BAPI_TRANSACTION_COMMIT or BAPI_TRANSACTION_ROLLBACK:</span></span>  
  
|<span data-ttu-id="f8022-118">Message</span><span class="sxs-lookup"><span data-stu-id="f8022-118">Message</span></span>|<span data-ttu-id="f8022-119">OPEN</span><span class="sxs-lookup"><span data-stu-id="f8022-119">OPEN</span></span>|<span data-ttu-id="f8022-120">RÉUTILISER</span><span class="sxs-lookup"><span data-stu-id="f8022-120">REUSE</span></span>|<span data-ttu-id="f8022-121">CLOSE</span><span class="sxs-lookup"><span data-stu-id="f8022-121">CLOSE</span></span>|<span data-ttu-id="f8022-122">ABANDON</span><span class="sxs-lookup"><span data-stu-id="f8022-122">ABORT</span></span>|  
|-------------|----------|-----------|-----------|-----------|  
|<span data-ttu-id="f8022-123">Premier message (message d’opération)</span><span class="sxs-lookup"><span data-stu-id="f8022-123">First message (operation message)</span></span>|<span data-ttu-id="f8022-124">Oui</span><span class="sxs-lookup"><span data-stu-id="f8022-124">Yes</span></span>|<span data-ttu-id="f8022-125">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-125">No</span></span>|<span data-ttu-id="f8022-126">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-126">No</span></span>|<span data-ttu-id="f8022-127">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-127">No</span></span>|  
|<span data-ttu-id="f8022-128">Messages suivants (messages d’opération)</span><span class="sxs-lookup"><span data-stu-id="f8022-128">Subsequent messages (operation messages)</span></span>|<span data-ttu-id="f8022-129">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-129">No</span></span>|<span data-ttu-id="f8022-130">Oui</span><span class="sxs-lookup"><span data-stu-id="f8022-130">Yes</span></span>|<span data-ttu-id="f8022-131">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-131">No</span></span>|<span data-ttu-id="f8022-132">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-132">No</span></span>|  
|<span data-ttu-id="f8022-133">BAPI_TRANSACTION_COMMIT (message de transaction)</span><span class="sxs-lookup"><span data-stu-id="f8022-133">BAPI_TRANSACTION_COMMIT (transaction message)</span></span>|<span data-ttu-id="f8022-134">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-134">No</span></span>|<span data-ttu-id="f8022-135">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-135">No</span></span>|<span data-ttu-id="f8022-136">Oui</span><span class="sxs-lookup"><span data-stu-id="f8022-136">Yes</span></span>|<span data-ttu-id="f8022-137">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-137">No</span></span>|  
|<span data-ttu-id="f8022-138">BAPI_TRANSACTION_ROLLBACK (message de transaction)</span><span class="sxs-lookup"><span data-stu-id="f8022-138">BAPI_TRANSACTION_ROLLBACK (transaction message)</span></span>|<span data-ttu-id="f8022-139">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-139">No</span></span>|<span data-ttu-id="f8022-140">Non</span><span class="sxs-lookup"><span data-stu-id="f8022-140">No</span></span>|<span data-ttu-id="f8022-141">Oui</span><span class="sxs-lookup"><span data-stu-id="f8022-141">Yes</span></span>|<span data-ttu-id="f8022-142">Oui</span><span class="sxs-lookup"><span data-stu-id="f8022-142">Yes</span></span>|  
  
 <span data-ttu-id="f8022-143">Dans la table, un « Oui » désigne la propriété de contexte de message à utiliser pour un message.</span><span class="sxs-lookup"><span data-stu-id="f8022-143">In the table, a "Yes" denotes the message context property to be used for a message.</span></span> <span data-ttu-id="f8022-144">De même, un « non » indique la propriété de contexte de message doit ne pas être utilisée avec un message.</span><span class="sxs-lookup"><span data-stu-id="f8022-144">Similarly, a "No" denotes the message context property not to be used with a message.</span></span>  
  
 <span data-ttu-id="f8022-145">Résumé de la table :</span><span class="sxs-lookup"><span data-stu-id="f8022-145">To summarize the table:</span></span>  
  
-   <span data-ttu-id="f8022-146">Le premier message doit toujours être un message d’opération et devez utiliser uniquement la propriété ouverte.</span><span class="sxs-lookup"><span data-stu-id="f8022-146">The first message must always be an operation message and must only use the OPEN property.</span></span>  
  
-   <span data-ttu-id="f8022-147">Les messages d’opération ultérieure doivent utiliser la propriété de réutilisation.</span><span class="sxs-lookup"><span data-stu-id="f8022-147">The subsequent operation messages must use the REUSE property.</span></span>  
  
-   <span data-ttu-id="f8022-148">Le message de transaction correspondant à BAPI_TRANSACTION_COMMIT pour valider la transaction doit utiliser la propriété ferme.</span><span class="sxs-lookup"><span data-stu-id="f8022-148">The transaction message corresponding to BAPI_TRANSACTION_COMMIT for committing the transaction must use the CLOSE property.</span></span>  
  
-   <span data-ttu-id="f8022-149">Le message de transaction correspondant à BAPI_TRANSACTION_ROLLBACK pour abandonner la transaction peut utiliser les propriétés de fermer ou abandonner.</span><span class="sxs-lookup"><span data-stu-id="f8022-149">The transaction message corresponding to BAPI_TRANSACTION_ROLLBACK to abort the transaction can use either the CLOSE or ABORT properties.</span></span> <span data-ttu-id="f8022-150">Si l’abandon, dans l’idéal, le message doit être dans le bloc d’exception d’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-150">If using ABORT, ideally the message must be in the orchestration exception block.</span></span>  
  
## <a name="key-considerations-related-to-transactions-using-biztalk-server"></a><span data-ttu-id="f8022-151">Points clés liés aux Transactions à l’aide de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="f8022-151">Key Considerations Related to Transactions Using BizTalk Server</span></span>  
  
-   <span data-ttu-id="f8022-152">S’il existe plus d’un port d’envoi dans une orchestration, l’adaptateur sépare automatiquement les transactions pour les messages reçus à partir de chaque port.</span><span class="sxs-lookup"><span data-stu-id="f8022-152">If there is more than one send port in an orchestration, the adapter automatically separates transaction for messages received from each port.</span></span> <span data-ttu-id="f8022-153">Autrement dit, une transaction ne peut pas couvrir les ports.</span><span class="sxs-lookup"><span data-stu-id="f8022-153">That is, a transaction cannot span across ports.</span></span>  
  
-   <span data-ttu-id="f8022-154">Nouvelle tentative n’est pas pris en charge pour les messages dans une transaction de SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-154">Message retry attempts are not supported for messages in an SAP transaction.</span></span> <span data-ttu-id="f8022-155">Par conséquent, les utilisateurs doivent définir la message nouvelle tentative à zéro.</span><span class="sxs-lookup"><span data-stu-id="f8022-155">Therefore, users should set the message retry attempt to zero.</span></span>  
  
-   <span data-ttu-id="f8022-156">L’adaptateur peut produire des résultats inattendus pour les combinaisons marqués comme « Non » dans le tableau précédent.</span><span class="sxs-lookup"><span data-stu-id="f8022-156">The adapter might produce undesirable results for the combinations marked as "No" in the preceding table.</span></span> <span data-ttu-id="f8022-157">Vous devez utiliser les combinaisons de la mention « Oui ».</span><span class="sxs-lookup"><span data-stu-id="f8022-157">You should use combinations marked as "Yes".</span></span>  
  
-   <span data-ttu-id="f8022-158">Les messages envoyés à l’adaptateur et qui n’ont pas d’une propriété de contexte de message seront effectués normalement sans être lié au contexte de transaction actuel.</span><span class="sxs-lookup"><span data-stu-id="f8022-158">Messages sent to the adapter that do not have a message context property will be executed normally without being bound to the current transaction context.</span></span>  
  
-   <span data-ttu-id="f8022-159">BAPI_TRANSACTION_COMMIT ou BAPI_TRANSACTION_ROLLBACK doit être dans l’idéal, le dernier message dans le contexte de transaction actuel dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-159">BAPI_TRANSACTION_COMMIT or BAPI_TRANSACTION_ROLLBACK should ideally be the last message in the current transaction context in the orchestration.</span></span>  
  
 <span data-ttu-id="f8022-160">Les sections suivantes fournissent des instructions sur la façon d’effectuer des transactions dans SAP à l’aide du [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-160">The following sections provide instructions on how to perform transactions in SAP using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span>  
  
## <a name="how-to-perform-a-transaction-on-an-sap-system"></a><span data-ttu-id="f8022-161">Comment effectuer une Transaction sur un système SAP ?</span><span class="sxs-lookup"><span data-stu-id="f8022-161">How to Perform a Transaction on an SAP System?</span></span>  
 <span data-ttu-id="f8022-162">Une opération sur un système SAP à l’aide du [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] avec [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] implique les tâches de procédures décrites dans [blocs de construction pour créer des applications SAP](../../adapters-and-accelerators/adapter-sap/building-blocks-to-create-sap-applications.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-162">Performing an operation on an SAP system using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves procedural tasks described in [Building blocks to create SAP applications](../../adapters-and-accelerators/adapter-sap/building-blocks-to-create-sap-applications.md).</span></span> <span data-ttu-id="f8022-163">Pour effectuer des transactions sur un système SAP, ces tâches sont :</span><span class="sxs-lookup"><span data-stu-id="f8022-163">To perform transactions on an SAP system, these tasks are:</span></span>  
  
1.  <span data-ttu-id="f8022-164">Créez un projet BizTalk et générer le schéma pour le document RFC sur lequel vous souhaitez effectuer la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-164">Create a BizTalk project and generate schema for the RFC on which you want to perform the transaction.</span></span> <span data-ttu-id="f8022-165">En outre, vous devez générer le schéma pour BAPI_TRANSACTION_COMMIT et BAPI_TRANSACTION_ROLLBACK RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-165">Additionally, you must generate schema for BAPI_TRANSACTION_COMMIT and BAPI_TRANSACTION_ROLLBACK RFCs.</span></span>  
  
2.  <span data-ttu-id="f8022-166">Créer des messages dans le projet BizTalk pour envoyer et recevoir des messages à partir du système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-166">Create messages in the BizTalk project for sending and receiving messages from the SAP system.</span></span>  
  
3.  <span data-ttu-id="f8022-167">Créez une orchestration qui extrait individuels « messages d’opération » du message de demande et l’envoie au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-167">Create an orchestration that extracts individual "operation messages" from the request message and sends it to the SAP system.</span></span> <span data-ttu-id="f8022-168">En se basant sur le message de demande, l’orchestration également décide s’il faut valider ou annuler la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-168">Based on the request message, the orchestration also decides whether to commit or roll back the transaction.</span></span>  
  
4.  <span data-ttu-id="f8022-169">Générez et déployez le projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-169">Build and deploy the BizTalk project.</span></span>  
  
5.  <span data-ttu-id="f8022-170">Configurer l’application en créant physique d’envoi et ports de réception BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-170">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
6.  <span data-ttu-id="f8022-171">Démarrez l’application BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-171">Start the BizTalk application.</span></span>  
  
 <span data-ttu-id="f8022-172">Cette rubrique fournit des instructions pour effectuer ces tâches.</span><span class="sxs-lookup"><span data-stu-id="f8022-172">This topic provides instructions to perform these tasks.</span></span>  
  
## <a name="sample-based-on-this-topic"></a><span data-ttu-id="f8022-173">Exemple basé sur cette rubrique</span><span class="sxs-lookup"><span data-stu-id="f8022-173">Sample Based On This Topic</span></span>  
 <span data-ttu-id="f8022-174">Un exemple SAPTransaction, en fonction de cette rubrique est fourni avec le [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-174">A sample, SAPTransaction, based on this topic is provided with the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="f8022-175">Pour plus d’informations, consultez [exemples pour l’adaptateur SAP](../../adapters-and-accelerators/adapter-sap/samples-for-the-sap-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-175">For more information, see [Samples for the SAP adapter](../../adapters-and-accelerators/adapter-sap/samples-for-the-sap-adapter.md).</span></span>  
  
## <a name="generating-schema"></a><span data-ttu-id="f8022-176">Génération du schéma</span><span class="sxs-lookup"><span data-stu-id="f8022-176">Generating Schema</span></span>  
 <span data-ttu-id="f8022-177">Pour montrer comment effectuer des transactions sur un système SAP, vous devez les schémas suivants :</span><span class="sxs-lookup"><span data-stu-id="f8022-177">To demonstrate how to perform transactions on an SAP system, you need the following schemas:</span></span>  
  
-   <span data-ttu-id="f8022-178">Pour le message « opération » pour effectuer des opérations sur un système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-178">For the "operation message" to perform operations on an SAP system.</span></span> <span data-ttu-id="f8022-179">Le message de demande envoyé à l’adaptateur doit être conforme à ce schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-179">The request message sent to the adapter must conform to this schema.</span></span> <span data-ttu-id="f8022-180">Cela peut être n’importe quel schéma spécifiques à l’utilisateur contenant n’importe quel nombre de nœuds de l’opération.</span><span class="sxs-lookup"><span data-stu-id="f8022-180">This can be any user-specific schema containing any number of operation nodes.</span></span> <span data-ttu-id="f8022-181">Dans cette rubrique, le schéma MultipleOrders.xsd est utilisé.</span><span class="sxs-lookup"><span data-stu-id="f8022-181">In this topic, the schema MultipleOrders.xsd is used.</span></span> <span data-ttu-id="f8022-182">Le schéma est également fourni comme partie de l’exemple de transaction fourni avec le [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] exemples.</span><span class="sxs-lookup"><span data-stu-id="f8022-182">The schema is also provided as part of the transaction sample shipped with the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] samples.</span></span> <span data-ttu-id="f8022-183">Pour plus d’informations, consultez [exemples de schéma](../../adapters-and-accelerators/accelerator-rosettanet/schema-samples.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-183">For more information, see [Schema Samples](../../adapters-and-accelerators/accelerator-rosettanet/schema-samples.md).</span></span>  
  
-   <span data-ttu-id="f8022-184">Pour effectuer les opérations sur un système SAP, comme l’appel d’une demande de changement.</span><span class="sxs-lookup"><span data-stu-id="f8022-184">For performing the operations on an SAP system, such as invoking an RFC.</span></span> <span data-ttu-id="f8022-185">Le message de demande d’effectuer une opération doit être conforme à ce schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-185">The request message to perform an operation must conform to this schema.</span></span> <span data-ttu-id="f8022-186">Ce schéma doit être généré à l’aide de la [!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-186">This schema must be generated by using the [!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)].</span></span> <span data-ttu-id="f8022-187">Dans cette rubrique, le document RFC BAPI_SALESORDER_CREATEFROMDAT2 est appelé.</span><span class="sxs-lookup"><span data-stu-id="f8022-187">In this topic, the BAPI_SALESORDER_CREATEFROMDAT2 RFC is invoked.</span></span> <span data-ttu-id="f8022-188">Pour plus d’informations sur la génération de schéma pour RFC, consultez [Parcourir, rechercher et obtenir de métadonnées pour les opérations de RFC dans SAP](../../adapters-and-accelerators/adapter-sap/browse-search-and-get-metadata-for-rfc-operations-in-sap.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-188">For information about generating schema for RFC, see [Browse, search and get Metadata for RFC Operations in SAP](../../adapters-and-accelerators/adapter-sap/browse-search-and-get-metadata-for-rfc-operations-in-sap.md).</span></span>  
  
-   <span data-ttu-id="f8022-189">Pour l’abandon ou de valider une transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-189">For aborting or committing a transaction.</span></span> <span data-ttu-id="f8022-190">La demande pour valider ou annuler une transaction doit être conforme à ce schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-190">The request to commit or abort a transaction must conform to this schema.</span></span> <span data-ttu-id="f8022-191">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] utilise le BAPI_TRANSACTION_COMMIT et BAPI_TRANSACTION_ROLLBACK RFC pour commit et rollback les opérations respectivement.</span><span class="sxs-lookup"><span data-stu-id="f8022-191">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] uses the BAPI_TRANSACTION_COMMIT and BAPI_TRANSACTION_ROLLBACK RFC to commit and rollback the operations respectively.</span></span> <span data-ttu-id="f8022-192">Vous devez générer le schéma pour ces RFC à l’aide de la [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-192">You must generate schema for these RFCs using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f8022-193">Vous devez vous assurer que tous les schémas requis sont ajoutés au projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-193">You must ensure that all the required schemas are added to the BizTalk project.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="f8022-194">Vous devez ajouter une référence au schéma de propriété BizTalk pour [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] à votre projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-194">You must add a reference to the BizTalk property schema for [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] to your BizTalk project.</span></span> <span data-ttu-id="f8022-195">Le fichier de schéma, *Microsoft.Adapters.SAP.BiztalkPropertySchema.dll*, est installé par le [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] le programme d’installation, en général au \<lecteur d’installation\>: \Program Files\Microsoft Pack d’adaptateurs BizTalk \Bin.</span><span class="sxs-lookup"><span data-stu-id="f8022-195">The schema file, *Microsoft.Adapters.SAP.BiztalkPropertySchema.dll*, is installed by the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] setup, typically at \<installation drive\>:\Program Files\Microsoft BizTalk Adapter Pack\bin.</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="f8022-196">Définition des Messages et les Types de messages</span><span class="sxs-lookup"><span data-stu-id="f8022-196">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="f8022-197">Le schéma que vous avez généré précédemment décrit les « types » requis pour les messages dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-197">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="f8022-198">Un message est généralement une variable, le type est défini par le schéma correspondant.</span><span class="sxs-lookup"><span data-stu-id="f8022-198">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="f8022-199">Vous devez lier le schéma généré à la première étape pour les messages à partir de la fenêtre Vue Orchestration du projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-199">You must link the schema you generated in the first step to the messages from the Orchestration View window of the BizTalk project.</span></span>  
  
 <span data-ttu-id="f8022-200">Avant de créer des messages, vous devez déterminer le nombre de nœuds de « opération » le message de demande (de type de MultipleOrders.xsd) a.</span><span class="sxs-lookup"><span data-stu-id="f8022-200">Before creating messages, you must determine the number of "operation" nodes the request message (of MultipleOrders.xsd type) has.</span></span> <span data-ttu-id="f8022-201">Pour cet exemple, supposons que le message de demande possède deux messages d’opération à appeler la RFC BAPI_SALESORDER_CREATEFROMDAT2.</span><span class="sxs-lookup"><span data-stu-id="f8022-201">For this example, assume that the request message has two operation messages to invoke the BAPI_SALESORDER_CREATEFROMDAT2 RFC.</span></span> <span data-ttu-id="f8022-202">Par conséquent, vous devez créer un ensemble de messages de demande-réponse qui mappe au schéma généré pour ce document RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-202">Therefore, you must create one request-response message set that maps to the schema generated for this RFC.</span></span>  
  
 <span data-ttu-id="f8022-203">Vous devez créer les messages suivants dans le projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-203">You must create the following messages in the BizTalk project.</span></span>  
  
-   <span data-ttu-id="f8022-204">Un message, SendtoAdapter, pour le message de demande qui sera envoyé à l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-204">A message, SendtoAdapter, for the request message that will be sent to the orchestration.</span></span> <span data-ttu-id="f8022-205">Ce message doit être mappé au schéma du message d’entrée, MultipleOrders.xsd.</span><span class="sxs-lookup"><span data-stu-id="f8022-205">This message must be mapped to the schema for the input message, MultipleOrders.xsd.</span></span>  
  
-   <span data-ttu-id="f8022-206">Un message, BAPIMessage, pour la première opération envoyé au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-206">A message, BAPIMessage, for the first operation sent to the SAP system.</span></span> <span data-ttu-id="f8022-207">Vous devez également créer un message de réponse, BAPIResponse, pour la réponse de la première opération.</span><span class="sxs-lookup"><span data-stu-id="f8022-207">You must also create a response message, BAPIResponse, for the response of the first operation.</span></span> <span data-ttu-id="f8022-208">Les messages de demande et de réponse doivent être mappés au schéma généré pour le document RFC BAPI_SALESORDER_CREATEFROMDAT2.</span><span class="sxs-lookup"><span data-stu-id="f8022-208">The request and response messages must be mapped to the schema generated for the BAPI_SALESORDER_CREATEFROMDAT2 RFC.</span></span>  
  
-   <span data-ttu-id="f8022-209">Un message, BAPICommitMessage, pour l’opération de validation.</span><span class="sxs-lookup"><span data-stu-id="f8022-209">A message, BAPICommitMessage, for the commit operation.</span></span> <span data-ttu-id="f8022-210">Vous devez également créer un message de réponse, BAPICommitResponse, pour le message de réponse correspondant.</span><span class="sxs-lookup"><span data-stu-id="f8022-210">You must also create a response message, BAPICommitResponse, for the corresponding response message.</span></span> <span data-ttu-id="f8022-211">Les messages de demande et de réponse doivent être mappés au schéma de BAPI_TRANSACTION_COMMIT RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-211">The request and response messages must be mapped to the schema of BAPI_TRANSACTION_COMMIT RFC.</span></span>  
  
-   <span data-ttu-id="f8022-212">Un message, BAPIRollbackMessage, pour l’opération de restauration.</span><span class="sxs-lookup"><span data-stu-id="f8022-212">A message, BAPIRollbackMessage, for the rollback operation.</span></span> <span data-ttu-id="f8022-213">Vous devez également créer un message de réponse, BAPIRollbackResponse, pour le message de réponse correspondant.</span><span class="sxs-lookup"><span data-stu-id="f8022-213">You must also create a response message, BAPIRollbackResponse, for the corresponding response message.</span></span> <span data-ttu-id="f8022-214">Les messages de demande et de réponse doivent être mappés au schéma de BAPI_TRANSACTION_ROLLBACK RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-214">The request and response messages must be mapped to the schema of BAPI_TRANSACTION_ROLLBACK RFC.</span></span>  
  
 <span data-ttu-id="f8022-215">Procédez comme suit pour créer des messages et les lier au schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-215">Perform the following steps to create messages and link them to the schema.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="f8022-216">Pour créer des messages et le lier au schéma</span><span class="sxs-lookup"><span data-stu-id="f8022-216">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="f8022-217">Ouvrez la vue orchestration au projet BizTalk, si elle n’est pas déjà ouvert.</span><span class="sxs-lookup"><span data-stu-id="f8022-217">Open the orchestration view the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="f8022-218">Cliquez sur **vue**, pointez sur **autres fenêtres**, puis cliquez sur **Vue Orchestration**.</span><span class="sxs-lookup"><span data-stu-id="f8022-218">Click **View**, point to **Other Windows**, and click **Orchestration View**.</span></span>  
  
2.  <span data-ttu-id="f8022-219">Dans le **Vue Orchestration**, avec le bouton droit **Messages**, puis cliquez sur **nouveau Message**.</span><span class="sxs-lookup"><span data-stu-id="f8022-219">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
3.  <span data-ttu-id="f8022-220">Avec le bouton droit le nouvellement créé le message, puis **fenêtre Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="f8022-220">Right-click the newly create message, and then select **Properties Window**.</span></span>  
  
4.  <span data-ttu-id="f8022-221">Dans le **propriétés** volet pour **Message_1**, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="f8022-221">In the **Properties** pane for **Message_1**, do the following.</span></span>  
  
    |<span data-ttu-id="f8022-222">Utiliser</span><span class="sxs-lookup"><span data-stu-id="f8022-222">Use this</span></span>|<span data-ttu-id="f8022-223">Pour effectuer cette opération</span><span class="sxs-lookup"><span data-stu-id="f8022-223">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="f8022-224">Identificateur</span><span class="sxs-lookup"><span data-stu-id="f8022-224">Identifier</span></span>|<span data-ttu-id="f8022-225">Type **SendToAdapter**.</span><span class="sxs-lookup"><span data-stu-id="f8022-225">Type **SendToAdapter**.</span></span>|  
    |<span data-ttu-id="f8022-226">Type de message</span><span class="sxs-lookup"><span data-stu-id="f8022-226">Message Type</span></span>|<span data-ttu-id="f8022-227">Dans la liste déroulante, développez **schémas**, puis sélectionnez *SAPTransaction.MultipleOrders*, où *SAPTransaction* est le nom de votre projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-227">From the drop-down list, expand **Schemas**, and select *SAPTransaction.MultipleOrders*, where *SAPTransaction* is the name of your BizTalk project.</span></span> <span data-ttu-id="f8022-228">*MultipleOrders* est le schéma du message de demande.</span><span class="sxs-lookup"><span data-stu-id="f8022-228">*MultipleOrders* is the schema for the request message.</span></span>|  
  
5.  <span data-ttu-id="f8022-229">Répétez l’étape précédente pour créer les six plus de messages.</span><span class="sxs-lookup"><span data-stu-id="f8022-229">Repeat the previous step to create six more messages.</span></span> <span data-ttu-id="f8022-230">Dans le **propriétés** volet pour les nouveaux messages, procédez comme suit.</span><span class="sxs-lookup"><span data-stu-id="f8022-230">In the **Properties** pane for the new messages, do the following.</span></span>  
  
    |<span data-ttu-id="f8022-231">Identificateur de la valeur</span><span class="sxs-lookup"><span data-stu-id="f8022-231">Set Identifier to</span></span>|<span data-ttu-id="f8022-232">Définissez le Type de Message</span><span class="sxs-lookup"><span data-stu-id="f8022-232">Set Message Type to</span></span>|  
    |-----------------------|-------------------------|  
    |<span data-ttu-id="f8022-233">BAPIMessage</span><span class="sxs-lookup"><span data-stu-id="f8022-233">BAPIMessage</span></span>|<span data-ttu-id="f8022-234">*SAPTransaction.SAPBindingSchema.BAPI_SALESORDER_CREATEFROMDAT2*</span><span class="sxs-lookup"><span data-stu-id="f8022-234">*SAPTransaction.SAPBindingSchema.BAPI_SALESORDER_CREATEFROMDAT2*</span></span>|  
    |<span data-ttu-id="f8022-235">BAPIResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-235">BAPIResponse</span></span>|<span data-ttu-id="f8022-236">*SAPTransaction.SAPBindingSchema.BAPI_SALESORDER_CREATEFROMDAT2Response*</span><span class="sxs-lookup"><span data-stu-id="f8022-236">*SAPTransaction.SAPBindingSchema.BAPI_SALESORDER_CREATEFROMDAT2Response*</span></span>|  
    |<span data-ttu-id="f8022-237">BAPICommitMessage</span><span class="sxs-lookup"><span data-stu-id="f8022-237">BAPICommitMessage</span></span>|<span data-ttu-id="f8022-238">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_COMMIT*</span><span class="sxs-lookup"><span data-stu-id="f8022-238">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_COMMIT*</span></span>|  
    |<span data-ttu-id="f8022-239">BAPICommitResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-239">BAPICommitResponse</span></span>|<span data-ttu-id="f8022-240">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_COMMITResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-240">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_COMMITResponse*</span></span>|  
    |<span data-ttu-id="f8022-241">BAPIRollbackMessage</span><span class="sxs-lookup"><span data-stu-id="f8022-241">BAPIRollbackMessage</span></span>|<span data-ttu-id="f8022-242">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_ROLLBACK*</span><span class="sxs-lookup"><span data-stu-id="f8022-242">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_ROLLBACK*</span></span>|  
    |<span data-ttu-id="f8022-243">BAPIRollbackResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-243">BAPIRollbackResponse</span></span>|<span data-ttu-id="f8022-244">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_ROLLBACKResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-244">*SAPTransaction.SAPBindingSchema.BAPI_TRANSACTION_ROLLBACKResponse*</span></span>|  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="f8022-245">Configuration de l’Orchestration</span><span class="sxs-lookup"><span data-stu-id="f8022-245">Setting up the Orchestration</span></span>  
 <span data-ttu-id="f8022-246">Vous devez créer une orchestration BizTalk à utiliser [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] pour effectuer des transactions dans un système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-246">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for performing transactions in an SAP system.</span></span> <span data-ttu-id="f8022-247">Dans cette orchestration, vous déposez un message de demande à une emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="f8022-247">In this orchestration, you drop a request message at a defined receive location.</span></span> <span data-ttu-id="f8022-248">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] consomme le message et le transmet au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-248">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] consumes the message and passes it to the SAP system.</span></span> <span data-ttu-id="f8022-249">La réponse du système SAP est enregistrée dans un autre emplacement.</span><span class="sxs-lookup"><span data-stu-id="f8022-249">The response from the SAP system is saved to another location.</span></span>  
  
 <span data-ttu-id="f8022-250">Une autre considération à prendre lors de la création d’une orchestration consiste à :</span><span class="sxs-lookup"><span data-stu-id="f8022-250">Another consideration to make when creating an orchestration is to:</span></span>  
  
-   <span data-ttu-id="f8022-251">Mapper le schéma du message de demande à celle de la RFC BAPI_SALESORDER_CREATEFROMDAT2.</span><span class="sxs-lookup"><span data-stu-id="f8022-251">Map the schema of the request message to that of the BAPI_SALESORDER_CREATEFROMDAT2 RFC.</span></span>  
  
-   <span data-ttu-id="f8022-252">Mapper le schéma du message de demande à celle du BAPI_TRANSACTION_COMMIT et BAPI_TRANSACTION_ROLLBACK RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-252">Map the schema of the request message to that of the BAPI_TRANSACTION_COMMIT and BAPI_TRANSACTION_ROLLBACK RFC.</span></span>  
  
 <span data-ttu-id="f8022-253">Vous pouvez mapper les schémas à l’aide d’une transformation XML via un mappage BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-253">You can map the schemas by using an XML transform via a BizTalk map.</span></span> <span data-ttu-id="f8022-254">Pour ce faire, inclure des formes transformer dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-254">To achieve this, include Transform shapes in the orchestration.</span></span>  
  
 <span data-ttu-id="f8022-255">Enfin, selon si le message de demande possède des informations pour valider ou abandonner la transaction, l’orchestration doit décider sur le message approprié pour être envoyé au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-255">Finally, based on whether the request message has information to commit or abort the transaction, the orchestration must decide on the appropriate message to be sent to the SAP system.</span></span> <span data-ttu-id="f8022-256">Pour ce faire, inclure une forme décider de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-256">To achieve this, include a Decide shape in the orchestration.</span></span>  
  
 <span data-ttu-id="f8022-257">Pour plus d’informations sur les différentes formes incluses dans l’orchestration, consultez le **l’interface utilisateur du Concepteur d’Orchestration** [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-257">For more information about the different shapes included in the orchestration, see the **Orchestration Designer UI** [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span></span>
  
 <span data-ttu-id="f8022-258">Un exemple d’orchestration pour une transaction SAP ressemble à ceci.</span><span class="sxs-lookup"><span data-stu-id="f8022-258">A sample orchestration for an SAP transaction resembles the following.</span></span>  
  
 <span data-ttu-id="f8022-259">![Orchestration permettant d’effectuer des transactions dans SAP](../../adapters-and-accelerators/adapter-sap/media/727f82e9-51a9-4a94-9d0a-d05c17904bde.gif "727f82e9-51a9-4a94-9d0a-d05c17904bde")</span><span class="sxs-lookup"><span data-stu-id="f8022-259">![Orchestrations to perform transactions in SAP](../../adapters-and-accelerators/adapter-sap/media/727f82e9-51a9-4a94-9d0a-d05c17904bde.gif "727f82e9-51a9-4a94-9d0a-d05c17904bde")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="f8022-260">Ajouter des formes de Message</span><span class="sxs-lookup"><span data-stu-id="f8022-260">Adding Message Shapes</span></span>  
 <span data-ttu-id="f8022-261">Assurez-vous que vous spécifiez les propriétés suivantes pour chacune des formes de message.</span><span class="sxs-lookup"><span data-stu-id="f8022-261">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="f8022-262">Les noms répertoriés dans la colonne de forme sont les noms des formes de message tel qu’affiché dans l’orchestration précédente.</span><span class="sxs-lookup"><span data-stu-id="f8022-262">The names listed in the Shape column are the names of the message shapes as displayed in the preceding orchestration.</span></span>  
  
|<span data-ttu-id="f8022-263">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="f8022-263">Shape</span></span>|<span data-ttu-id="f8022-264">Type de forme</span><span class="sxs-lookup"><span data-stu-id="f8022-264">Shape Type</span></span>|<span data-ttu-id="f8022-265">Propriétés</span><span class="sxs-lookup"><span data-stu-id="f8022-265">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="f8022-266">ReceiveInputXML</span><span class="sxs-lookup"><span data-stu-id="f8022-266">ReceiveInputXML</span></span>|<span data-ttu-id="f8022-267">Recevoir</span><span class="sxs-lookup"><span data-stu-id="f8022-267">Receive</span></span>|<span data-ttu-id="f8022-268">-Définissez **nom** à *ReceiveInputXML*</span><span class="sxs-lookup"><span data-stu-id="f8022-268">- Set **Name** to *ReceiveInputXML*</span></span><br /><br /> <span data-ttu-id="f8022-269">-Définissez **activer** à *True*</span><span class="sxs-lookup"><span data-stu-id="f8022-269">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="f8022-270">SendToLOB</span><span class="sxs-lookup"><span data-stu-id="f8022-270">SendToLOB</span></span>|<span data-ttu-id="f8022-271">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-271">Send</span></span>|<span data-ttu-id="f8022-272">-Définissez **nom** à *SendToLOB*</span><span class="sxs-lookup"><span data-stu-id="f8022-272">- Set **Name** to *SendToLOB*</span></span>|  
|<span data-ttu-id="f8022-273">Réception réponse</span><span class="sxs-lookup"><span data-stu-id="f8022-273">ReceiveResponse</span></span>|<span data-ttu-id="f8022-274">Recevoir</span><span class="sxs-lookup"><span data-stu-id="f8022-274">Receive</span></span>|<span data-ttu-id="f8022-275">-Définissez **nom** à *ReceiveResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-275">- Set **Name** to *ReceiveResponse*</span></span><br /><br /> <span data-ttu-id="f8022-276">-Définissez **activer** à *False*</span><span class="sxs-lookup"><span data-stu-id="f8022-276">- Set **Activate** to *False*</span></span>|  
|<span data-ttu-id="f8022-277">SendResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-277">SendResponse</span></span>|<span data-ttu-id="f8022-278">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-278">Send</span></span>|<span data-ttu-id="f8022-279">-Définissez **nom** à *SendResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-279">- Set **Name** to *SendResponse*</span></span>|  
  
 <span data-ttu-id="f8022-280">Étant donné que le message de demande possède deux messages insert, vous devez créer un autre ensemble d’envoi et reçoivent des formes pour envoyer des messages à SAP et de recevoir une réponse.</span><span class="sxs-lookup"><span data-stu-id="f8022-280">Because the request message has two insert messages, you must create another set of send and receive shapes to send messages to SAP and to receive a response.</span></span> <span data-ttu-id="f8022-281">Toutefois, les messages insert peuvent être validées ou restaurées, le deuxième ensemble de formes doit être créé dans un bloc de décision.</span><span class="sxs-lookup"><span data-stu-id="f8022-281">However, because the insert messages might be committed or rolled back, the second set of shapes must be created within a decision block.</span></span> <span data-ttu-id="f8022-282">Vous devez créer un ensemble de formes de validation et un autre ensemble de formes à la restauration.</span><span class="sxs-lookup"><span data-stu-id="f8022-282">You must create one set of shapes for commit and another set of shapes for rollback.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f8022-283">Vous pouvez ajouter un bloc de décision en faisant glisser la forme décider à partir de la boîte à outils Orchestrations BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-283">You can add a decision block by dragging and dropping the Decide shape from the BizTalk Orchestrations toolbox.</span></span>  
  
#### <a name="message-shapes-for-commit"></a><span data-ttu-id="f8022-284">Les formes de message pour valider</span><span class="sxs-lookup"><span data-stu-id="f8022-284">Message Shapes for Commit</span></span>  
 <span data-ttu-id="f8022-285">Le tableau suivant répertorie les formes pour le chemin « validation » de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-285">The following table lists the shapes for the "commit path" of the orchestration.</span></span> <span data-ttu-id="f8022-286">Ici, vous n’avez pas besoin de créer un message de réception pour un message de demande.</span><span class="sxs-lookup"><span data-stu-id="f8022-286">Here, you do not need to create a receive message for a request message.</span></span> <span data-ttu-id="f8022-287">Le message de demande est passé à partir de la forme d’un message précédent.</span><span class="sxs-lookup"><span data-stu-id="f8022-287">The request message will be passed on from the previous message shape.</span></span>  
  
|<span data-ttu-id="f8022-288">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="f8022-288">Shape</span></span>|<span data-ttu-id="f8022-289">Type de forme</span><span class="sxs-lookup"><span data-stu-id="f8022-289">Shape Type</span></span>|<span data-ttu-id="f8022-290">Propriétés</span><span class="sxs-lookup"><span data-stu-id="f8022-290">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="f8022-291">SendBAPICommit</span><span class="sxs-lookup"><span data-stu-id="f8022-291">SendBAPICommit</span></span>|<span data-ttu-id="f8022-292">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-292">Send</span></span>|<span data-ttu-id="f8022-293">-Définissez **nom** à *SendBAPICommit*</span><span class="sxs-lookup"><span data-stu-id="f8022-293">- Set **Name** to *SendBAPICommit*</span></span>|  
|<span data-ttu-id="f8022-294">ReceiveCommitResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-294">ReceiveCommitResponse</span></span>|<span data-ttu-id="f8022-295">Recevoir</span><span class="sxs-lookup"><span data-stu-id="f8022-295">Receive</span></span>|<span data-ttu-id="f8022-296">-Définissez **nom** à *ReceiveCommitResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-296">- Set **Name** to *ReceiveCommitResponse*</span></span><br /><br /> <span data-ttu-id="f8022-297">-Définissez **activer** à *False*</span><span class="sxs-lookup"><span data-stu-id="f8022-297">- Set **Activate** to *False*</span></span>|  
|<span data-ttu-id="f8022-298">SendResponse2</span><span class="sxs-lookup"><span data-stu-id="f8022-298">SendResponse2</span></span>|<span data-ttu-id="f8022-299">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-299">Send</span></span>|<span data-ttu-id="f8022-300">-Définissez **nom** à *SendResponse2*</span><span class="sxs-lookup"><span data-stu-id="f8022-300">- Set **Name** to *SendResponse2*</span></span>|  
  
#### <a name="message-shapes-for-abort"></a><span data-ttu-id="f8022-301">Les formes de message pour abandonner</span><span class="sxs-lookup"><span data-stu-id="f8022-301">Message Shapes for Abort</span></span>  
 <span data-ttu-id="f8022-302">Le tableau suivant répertorie les formes pour le chemin « restauration » de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-302">The following table lists the shapes for the "rollback path" of the orchestration.</span></span>  
  
|<span data-ttu-id="f8022-303">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="f8022-303">Shape</span></span>|<span data-ttu-id="f8022-304">Type de forme</span><span class="sxs-lookup"><span data-stu-id="f8022-304">Shape Type</span></span>|<span data-ttu-id="f8022-305">Propriétés</span><span class="sxs-lookup"><span data-stu-id="f8022-305">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="f8022-306">SendBAPIRollback</span><span class="sxs-lookup"><span data-stu-id="f8022-306">SendBAPIRollback</span></span>|<span data-ttu-id="f8022-307">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-307">Send</span></span>|<span data-ttu-id="f8022-308">-Définissez **nom** à *SendBAPIRollback*</span><span class="sxs-lookup"><span data-stu-id="f8022-308">- Set **Name** to *SendBAPIRollback*</span></span>|  
|<span data-ttu-id="f8022-309">ReceiveRollbackResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-309">ReceiveRollbackResponse</span></span>|<span data-ttu-id="f8022-310">Recevoir</span><span class="sxs-lookup"><span data-stu-id="f8022-310">Receive</span></span>|<span data-ttu-id="f8022-311">-Définissez **nom** à *ReceiveRollbackResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-311">- Set **Name** to *ReceiveRollbackResponse*</span></span><br /><br /> <span data-ttu-id="f8022-312">-Définissez **activer** à *False*</span><span class="sxs-lookup"><span data-stu-id="f8022-312">- Set **Activate** to *False*</span></span>|  
|<span data-ttu-id="f8022-313">SendResponse3</span><span class="sxs-lookup"><span data-stu-id="f8022-313">SendResponse3</span></span>|<span data-ttu-id="f8022-314">Send</span><span class="sxs-lookup"><span data-stu-id="f8022-314">Send</span></span>|<span data-ttu-id="f8022-315">-Définissez **nom** à *SendResponse3*</span><span class="sxs-lookup"><span data-stu-id="f8022-315">- Set **Name** to *SendResponse3*</span></span>|  
  
### <a name="setting-the-rule-expression"></a><span data-ttu-id="f8022-316">Définition de l’Expression de la règle</span><span class="sxs-lookup"><span data-stu-id="f8022-316">Setting the Rule Expression</span></span>  
 <span data-ttu-id="f8022-317">Inclus les formes de message pour la validation et de l’abandon d’opérations au sein d’un bloc de décision en ajoutant une forme décider.</span><span class="sxs-lookup"><span data-stu-id="f8022-317">You included the message shapes for the commit and abort operations within a decision block by adding a Decide shape.</span></span> <span data-ttu-id="f8022-318">Pour spécifier la condition sur laquelle l’orchestration est une décision, vous devez spécifier une expression de la forme de la règle en fonction sur laquelle la transaction est soit être validée ou restaurée.</span><span class="sxs-lookup"><span data-stu-id="f8022-318">To specify the condition on which the orchestration will make a decision, you must specify an expression on the Rule shape based on which the transaction will either be committed or rolled back.</span></span> <span data-ttu-id="f8022-319">Par exemple, vous devez spécifier l’expression suivante pour la forme de règle :</span><span class="sxs-lookup"><span data-stu-id="f8022-319">For example, you must specify the following expression for the Rule shape:</span></span>  
  
```  
SendToAdapter.isCommit == true  
```  
  
 <span data-ttu-id="f8022-320">WHERE, SendToAdapter est le message que vous avez créé pour le schéma du message de demande.</span><span class="sxs-lookup"><span data-stu-id="f8022-320">Where, SendToAdapter is the message you created for the schema of the request message.</span></span> <span data-ttu-id="f8022-321">Ainsi, dans le message de demande, si le `isCommit` a la valeur de balise **True**, l’orchestration prend l’itinéraire « commit ».</span><span class="sxs-lookup"><span data-stu-id="f8022-321">So, in the request message, if the `isCommit` tag is set to **True**, the orchestration takes the "commit" route.</span></span> <span data-ttu-id="f8022-322">Sinon, l’orchestration met l’itinéraire « restauration ».</span><span class="sxs-lookup"><span data-stu-id="f8022-322">Otherwise, the orchestration takes the "rollback" route.</span></span>  
  
 <span data-ttu-id="f8022-323">Pour être en mesure de spécifier cette condition dans l’éditeur d’expression, vous devez avoir promu le `isCommit` propriété dans le schéma de message du message de demande envoyé à l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="f8022-323">For you to be able to specify this condition in the expression editor, you must have promoted the `isCommit` property in the message schema for the request message sent to the adapter.</span></span> <span data-ttu-id="f8022-324">Pour cette rubrique, le schéma d’entrée à utiliser est MultipleOrders.xsd.</span><span class="sxs-lookup"><span data-stu-id="f8022-324">For this topic, the input schema to use is MultipleOrders.xsd.</span></span> <span data-ttu-id="f8022-325">Vous devez promouvoir le `isCommit` propriété dans ce schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-325">You must promote the `isCommit` property in this schema.</span></span> <span data-ttu-id="f8022-326">Pour plus d’informations sur la promotion d’une propriété, consultez [promotion des propriétés](../../core/promoting-properties.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-326">For more information about promoting a property, see [Promoting Properties](../../core/promoting-properties.md).</span></span>
  
### <a name="adding-construct-message-shapes"></a><span data-ttu-id="f8022-327">Ajouter des formes de Message de construction</span><span class="sxs-lookup"><span data-stu-id="f8022-327">Adding Construct Message Shapes</span></span>  
 <span data-ttu-id="f8022-328">Comme indiqué précédemment, le message de demande envoyé à l’adaptateur contient insérer deux messages, puis un message de validation ou d’abandon.</span><span class="sxs-lookup"><span data-stu-id="f8022-328">As discussed earlier, the request message sent to the adapter contains two insert messages and then a commit or abort message.</span></span> <span data-ttu-id="f8022-329">Vous devez ajouter une forme construire un Message, et dans laquelle une transformation de forme pour extraire des messages d’opération individuelle à envoyer au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-329">You must add a Construct Message shape, and within that a Transform shape to extract individual operation messages to be sent to the SAP system.</span></span> <span data-ttu-id="f8022-330">Vous devez également ajouter une forme assignation du Message pour définir des propriétés de contexte pour l’activation des transactions le message.</span><span class="sxs-lookup"><span data-stu-id="f8022-330">You must also add a Message Assignment shape to set the message context properties for enabling transactions.</span></span>  
  
#### <a name="the-first-construct-message-shape"></a><span data-ttu-id="f8022-331">La première forme construire un Message</span><span class="sxs-lookup"><span data-stu-id="f8022-331">The First Construct Message Shape</span></span>  
 <span data-ttu-id="f8022-332">Supposons que la première forme construire un Message est appelée « ReceiveXML. »</span><span class="sxs-lookup"><span data-stu-id="f8022-332">Suppose the first Construct Message shape is called "ReceiveXML."</span></span> <span data-ttu-id="f8022-333">Pour cette forme, spécifiez la propriété Messages construits en tant que « BAPIMessage ».</span><span class="sxs-lookup"><span data-stu-id="f8022-333">For this shape, specify the Messages Constructed property as "BAPIMessage".</span></span> <span data-ttu-id="f8022-334">Double-cliquez sur la forme Transformer pour ouvrir la **transformer la Configuration** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f8022-334">Double-click the Transform shape to open the **Transform Configuration** dialog box.</span></span> <span data-ttu-id="f8022-335">Dans la boîte de dialogue :</span><span class="sxs-lookup"><span data-stu-id="f8022-335">In the dialog box:</span></span>  
  
-   <span data-ttu-id="f8022-336">Choisissez cette option pour créer un nouveau mappage.</span><span class="sxs-lookup"><span data-stu-id="f8022-336">Choose to create a new map.</span></span>  
  
-   <span data-ttu-id="f8022-337">Dans le volet gauche, sélectionnez **Source** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *SendToAdapter*.</span><span class="sxs-lookup"><span data-stu-id="f8022-337">From the left pane, select **Source** and from the **Variable name** drop-down select *SendToAdapter*.</span></span>  
  
-   <span data-ttu-id="f8022-338">Dans le volet gauche, sélectionnez **Destination** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *BAPIMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-338">From the left pane, select **Destination** and from the **Variable name** drop-down select *BAPIMessage*.</span></span>  
  
-   <span data-ttu-id="f8022-339">Cliquez sur **OK** pour démarrer le mappeur.</span><span class="sxs-lookup"><span data-stu-id="f8022-339">Click **OK** to start the mapper.</span></span> <span data-ttu-id="f8022-340">Mapper le schéma du message de demande pour le schéma de la BAPI_SALESORDER_CREATEFROMDAT2.</span><span class="sxs-lookup"><span data-stu-id="f8022-340">Map the schema of the request message to the schema of the BAPI_SALESORDER_CREATEFROMDAT2.</span></span> <span data-ttu-id="f8022-341">Vous pouvez utiliser la **Index** fonctoid pour créer un mappage entre la schémas source et les destination.</span><span class="sxs-lookup"><span data-stu-id="f8022-341">You can use the **Index** functoid to create a map between the source and the destination schemas.</span></span> <span data-ttu-id="f8022-342">Un **Index** fonctoid vous permet de sélectionner des informations pour un enregistrement spécifique dans une série d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="f8022-342">An **Index** functoid enables you to select information for a specific record in a series of records.</span></span>  
  
     <span data-ttu-id="f8022-343">La figure suivante illustre les schémas mappés en utilisant un **Index** fonctoid.</span><span class="sxs-lookup"><span data-stu-id="f8022-343">The following figure shows the schemas mapped using an **Index** functoid.</span></span>  
  
     <span data-ttu-id="f8022-344">![Schémas mappés à l’aide d’un fonctoid Index](../../adapters-and-accelerators/adapter-sap/media/d0ade577-ea74-4be3-a724-4ba19397d8d3.gif "d0ade577-ea74-4be3-a724-4ba19397d8d3")</span><span class="sxs-lookup"><span data-stu-id="f8022-344">![Schemas mapped using an Index functoid](../../adapters-and-accelerators/adapter-sap/media/d0ade577-ea74-4be3-a724-4ba19397d8d3.gif "d0ade577-ea74-4be3-a724-4ba19397d8d3")</span></span>  
  
     <span data-ttu-id="f8022-345">Pour plus d’informations sur l’utilisation de la **transformer la Configuration** boîte de dialogue, consultez la **boîte de dialogue de Configuration transformer** [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-345">For more information about using the **Transform Configuration** dialog box, see the **Transform Configuration Dialog Box** [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span></span>
  
     <span data-ttu-id="f8022-346">Pour plus d’informations sur l’utilisation du fonctoid Index, consultez [fonctoid Index](../../core/index-functoid.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-346">For more information about using the Index functoid, see [Index Functoid](../../core/index-functoid.md).</span></span>
       
     <span data-ttu-id="f8022-347">Après avoir mappé les schémas, vous pouvez tester le mappage à l’aide de la page de propriétés du fichier de mappage.</span><span class="sxs-lookup"><span data-stu-id="f8022-347">After you have mapped the schemas, you can test the mapping using the property page of the map file.</span></span> <span data-ttu-id="f8022-348">Pour plus d’informations, consultez la  **<Map File> boîte de dialogue Page de propriétés, de tester le mappage** onglet [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-348">For more information, see the **<Map File> Property Page Dialog Box, Test Map** tab [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span></span>
  
 <span data-ttu-id="f8022-349">Dans la forme assignation du Message, spécifiez la propriété de contexte de message pour démarrer la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-349">In the Message Assignment shape, specify the message context property to start the transaction.</span></span> <span data-ttu-id="f8022-350">Par exemple, la propriété de contexte de message pour le premier message peut être :</span><span class="sxs-lookup"><span data-stu-id="f8022-350">For example, the message context property for the first message could be:</span></span>  
  
```  
BAPIMessage(Microsoft.Adapters.SAP.BiztalkPropertySchema.ConnectionState) = "OPEN";  
```  
  
#### <a name="the-commit-construct-message-shape"></a><span data-ttu-id="f8022-351">La forme construire un Message de la validation</span><span class="sxs-lookup"><span data-stu-id="f8022-351">The Commit Construct Message Shape</span></span>  
 <span data-ttu-id="f8022-352">Supposons que la forme construire un Message pour l’opération de validation est appelée « CommitMessage ».</span><span class="sxs-lookup"><span data-stu-id="f8022-352">Suppose the Construct Message shape for the commit operation is called "CommitMessage."</span></span> <span data-ttu-id="f8022-353">Pour cette forme, spécifiez la propriété Messages construits en tant que « BAPICommitMessage ».</span><span class="sxs-lookup"><span data-stu-id="f8022-353">For this shape, specify the Messages Constructed property as "BAPICommitMessage".</span></span> <span data-ttu-id="f8022-354">Double-cliquez sur la forme Transformer pour ouvrir la **transformer la Configuration** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f8022-354">Double-click the Transform shape to open the **Transform Configuration** dialog box.</span></span> <span data-ttu-id="f8022-355">Dans la boîte de dialogue :</span><span class="sxs-lookup"><span data-stu-id="f8022-355">In the dialog box:</span></span>  
  
-   <span data-ttu-id="f8022-356">Choisissez cette option pour créer un nouveau mappage.</span><span class="sxs-lookup"><span data-stu-id="f8022-356">Choose to create a new map.</span></span>  
  
-   <span data-ttu-id="f8022-357">Dans le volet gauche, sélectionnez **Source** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *SendToAdapter*.</span><span class="sxs-lookup"><span data-stu-id="f8022-357">From the left pane, select **Source** and from the **Variable name** drop-down select *SendToAdapter*.</span></span>  
  
-   <span data-ttu-id="f8022-358">Dans le volet gauche, sélectionnez **Destination** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *BAPICommitMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-358">From the left pane, select **Destination** and from the **Variable name** drop-down select *BAPICommitMessage*.</span></span>  
  
-   <span data-ttu-id="f8022-359">Cliquez sur OK pour lancer le mappeur.</span><span class="sxs-lookup"><span data-stu-id="f8022-359">Click OK to launch the mapper.</span></span> <span data-ttu-id="f8022-360">Mapper le schéma du message de demande pour le schéma de BAPI_TRANSACTION_COMMIT.</span><span class="sxs-lookup"><span data-stu-id="f8022-360">Map the schema of the request message to the schema of BAPI_TRANSACTION_COMMIT.</span></span> <span data-ttu-id="f8022-361">Vous ne devez pas inclure un fonctoid Index pour ce mappage, car le nœud BAPI_TRANSACTION_COMMIT ne contient pas d’une hiérarchie de l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="f8022-361">You need not include an Index functoid for this mapping because the BAPI_TRANSACTION_COMMIT node does not contain a record hierarchy.</span></span>  
  
 <span data-ttu-id="f8022-362">Dans la forme assignation du Message, spécifiez la propriété de contexte de message pour valider la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-362">In the Message Assignment shape, specify the message context property to commit the transaction.</span></span> <span data-ttu-id="f8022-363">Par exemple, la propriété de contexte de message pour le premier message peut être :</span><span class="sxs-lookup"><span data-stu-id="f8022-363">For example, the message context property for the first message could be:</span></span>  
  
```  
BAPICommitMessage(Microsoft.Adapters.SAP.BiztalkPropertySchema.ConnectionState) = "CLOSE";  
```  
  
#### <a name="the-rollback-construct-message-shape"></a><span data-ttu-id="f8022-364">La forme construire un Message Rollback</span><span class="sxs-lookup"><span data-stu-id="f8022-364">The Rollback Construct Message Shape</span></span>  
 <span data-ttu-id="f8022-365">Supposons que la forme construire un Message pour l’opération de restauration est appelée « RollbackMessage ».</span><span class="sxs-lookup"><span data-stu-id="f8022-365">Suppose the Construct Message shape for the rollback operation is called "RollbackMessage."</span></span> <span data-ttu-id="f8022-366">Pour cette forme, spécifiez la propriété Messages construits en tant que « BAPIRollbackMessage ».</span><span class="sxs-lookup"><span data-stu-id="f8022-366">For this shape, specify the Messages Constructed property as "BAPIRollbackMessage".</span></span> <span data-ttu-id="f8022-367">Double-cliquez sur la forme Transformer pour ouvrir la **transformer la Configuration** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="f8022-367">Double-click the Transform shape to open the **Transform Configuration** dialog box.</span></span> <span data-ttu-id="f8022-368">Dans la boîte de dialogue :</span><span class="sxs-lookup"><span data-stu-id="f8022-368">In the dialog box:</span></span>  
  
-   <span data-ttu-id="f8022-369">Choisissez cette option pour créer un nouveau mappage.</span><span class="sxs-lookup"><span data-stu-id="f8022-369">Choose to create a new map.</span></span>  
  
-   <span data-ttu-id="f8022-370">Dans le volet gauche, sélectionnez **Source** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *SendToAdapter*.</span><span class="sxs-lookup"><span data-stu-id="f8022-370">From the left pane, select **Source** and from the **Variable name** drop-down select *SendToAdapter*.</span></span>  
  
-   <span data-ttu-id="f8022-371">Dans le volet gauche, sélectionnez **Destination** et à partir de la **nom de la Variable** liste déroulante Sélectionnez *BAPIRollbackMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-371">From the left pane, select **Destination** and from the **Variable name** drop-down select *BAPIRollbackMessage*.</span></span>  
  
-   <span data-ttu-id="f8022-372">Cliquez sur OK pour lancer le mappeur.</span><span class="sxs-lookup"><span data-stu-id="f8022-372">Click OK to launch the mapper.</span></span> <span data-ttu-id="f8022-373">Mapper le schéma du message de demande pour le schéma de BAPI_TRANSACTION_ROLLBACK.</span><span class="sxs-lookup"><span data-stu-id="f8022-373">Map the schema of the request message to the schema of BAPI_TRANSACTION_ROLLBACK.</span></span> <span data-ttu-id="f8022-374">Vous ne devez pas inclure un fonctoid Index pour ce mappage, car le nœud BAPI_TRANSACTION_ROLLBACK ne contient pas d’une hiérarchie de l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="f8022-374">You need not include an Index functoid for this mapping because the BAPI_TRANSACTION_ROLLBACK node does not contain a record hierarchy.</span></span>  
  
 <span data-ttu-id="f8022-375">Dans la forme assignation du Message, spécifiez la propriété de contexte de message pour annuler la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-375">In the Message Assignment shape, specify the message context property to rollback the transaction.</span></span> <span data-ttu-id="f8022-376">Par exemple, la propriété de contexte de message pour le premier message peut être :</span><span class="sxs-lookup"><span data-stu-id="f8022-376">For example, the message context property for the first message could be:</span></span>  
  
```  
BAPIRollbackMessage(Microsoft.Adapters.SAP.BiztalkPropertySchema.ConnectionState) = "ABORT";  
```  
  
> [!IMPORTANT]
>  <span data-ttu-id="f8022-377">Dans les scénarios classiques, le message correspondant à BAPI_TRANSACTION_ROLLBACK avec la propriété de contexte d’annulation doit être utilisé dans un bloc d’exception.</span><span class="sxs-lookup"><span data-stu-id="f8022-377">In typical scenarios, the message corresponding to BAPI_TRANSACTION_ROLLBACK with the ABORT context property must be used in an exception block.</span></span>  
  
### <a name="adding-ports"></a><span data-ttu-id="f8022-378">Ajout de Ports</span><span class="sxs-lookup"><span data-stu-id="f8022-378">Adding Ports</span></span>  
 <span data-ttu-id="f8022-379">Assurez-vous que vous spécifiez les propriétés suivantes pour chacun des ports logiques.</span><span class="sxs-lookup"><span data-stu-id="f8022-379">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="f8022-380">Les noms répertoriés dans le *Port* colonne sont les noms des ports que ceux affichés dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-380">The names listed in the *Port* column are the names of the ports as displayed in the orchestration.</span></span>  
  
 <span data-ttu-id="f8022-381">Pour cette orchestration, trois ports sont créés.</span><span class="sxs-lookup"><span data-stu-id="f8022-381">For this orchestration, three ports are created.</span></span> <span data-ttu-id="f8022-382">Le premier port récupère le message de demande à partir d’un dossier spécifié.</span><span class="sxs-lookup"><span data-stu-id="f8022-382">The first port picks request message from a specified folder.</span></span> <span data-ttu-id="f8022-383">Le deuxième port envoie les messages au système SAP et reçoit une réponse.</span><span class="sxs-lookup"><span data-stu-id="f8022-383">The second port sends the messages to the SAP system and receives a response.</span></span> <span data-ttu-id="f8022-384">Le troisième port enregistre la réponse à un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="f8022-384">The third port will save the response to another folder.</span></span> <span data-ttu-id="f8022-385">Par conséquent :</span><span class="sxs-lookup"><span data-stu-id="f8022-385">Therefore:</span></span>  
  
-   <span data-ttu-id="f8022-386">Le premier port reçoit uniquement des messages pour un schéma unique, c'est-à-dire MultipleOrders.xsd.</span><span class="sxs-lookup"><span data-stu-id="f8022-386">The first port only receives messages for a single schema, that is, MultipleOrders.xsd.</span></span>  
  
-   <span data-ttu-id="f8022-387">Le deuxième port envoie et reçoit des messages pour le schéma de BAPI_SALESORDER_CREATEFROMDAT2 RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-387">The second port sends and receives messages for the schema of BAPI_SALESORDER_CREATEFROMDAT2 RFC.</span></span> <span data-ttu-id="f8022-388">En outre, le même port servira à valider ou restaurer la transaction.</span><span class="sxs-lookup"><span data-stu-id="f8022-388">Also, the same port will be used to commit or roll back the transaction.</span></span> <span data-ttu-id="f8022-389">Par conséquent, ce port reçoit également des messages de schémas pour BAPI_TRANSACTION_COMMIT et BAPI_TRANSACTION_ROLLBACK RFC.</span><span class="sxs-lookup"><span data-stu-id="f8022-389">So, this port also receives messages of schemas for BAPI_TRANSACTION_COMMIT and BAPI_TRANSACTION_ROLLBACK RFCs.</span></span> <span data-ttu-id="f8022-390">Pour ce faire, trois opérations différents sont créées sur ce port, chacun correspondant à un schéma de message spécifique.</span><span class="sxs-lookup"><span data-stu-id="f8022-390">To enable this, three different operations are created on this port, each corresponding to a specific message schema.</span></span>  
  
-   <span data-ttu-id="f8022-391">Comme pour le deuxième port, ce port sera également recevoir les messages avec trois schémas différents.</span><span class="sxs-lookup"><span data-stu-id="f8022-391">Similar to the second port, this port will also be receiving messages with three different schemas.</span></span> <span data-ttu-id="f8022-392">Par conséquent, il est nécessaire de créer les trois différentes opérations sur ce port.</span><span class="sxs-lookup"><span data-stu-id="f8022-392">So, it is necessary to create three different operations on this port.</span></span>  
  
|<span data-ttu-id="f8022-393">Port</span><span class="sxs-lookup"><span data-stu-id="f8022-393">Port</span></span>|<span data-ttu-id="f8022-394">Propriétés</span><span class="sxs-lookup"><span data-stu-id="f8022-394">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="f8022-395">Fichier</span><span class="sxs-lookup"><span data-stu-id="f8022-395">FileIn</span></span>|<span data-ttu-id="f8022-396">-Définissez **identificateur** à *FileIn*</span><span class="sxs-lookup"><span data-stu-id="f8022-396">- Set **Identifier** to *FileIn*</span></span><br /><br /> <span data-ttu-id="f8022-397">-Définissez **Type** à *FileInType*</span><span class="sxs-lookup"><span data-stu-id="f8022-397">- Set **Type** to *FileInType*</span></span><br /><br /> <span data-ttu-id="f8022-398">-Définissez **modèle de Communication** à *à sens unique*</span><span class="sxs-lookup"><span data-stu-id="f8022-398">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="f8022-399">-Définissez **Direction de Communication** à *de réception*</span><span class="sxs-lookup"><span data-stu-id="f8022-399">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="f8022-400">LOBPort</span><span class="sxs-lookup"><span data-stu-id="f8022-400">LOBPort</span></span>|<span data-ttu-id="f8022-401">-Définissez **identificateur** à *LOBPort*</span><span class="sxs-lookup"><span data-stu-id="f8022-401">- Set **Identifier** to *LOBPort*</span></span><br /><br /> <span data-ttu-id="f8022-402">-Définissez **Type** à *LOBPortType*</span><span class="sxs-lookup"><span data-stu-id="f8022-402">- Set **Type** to *LOBPortType*</span></span><br /><br /> <span data-ttu-id="f8022-403">-Définissez **modèle de Communication** à *demande-réponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-403">- Set **Communication Pattern** to *Request-Response*</span></span><br /><br /> <span data-ttu-id="f8022-404">-Définissez **Direction de Communication** à *envoi / réception*</span><span class="sxs-lookup"><span data-stu-id="f8022-404">- Set **Communication Direction** to *Send-Receive*</span></span><br /><br /> <span data-ttu-id="f8022-405">-Créer une opération *BAPIMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-405">- Create an operation *BAPIMessage*.</span></span><br /><br /> <span data-ttu-id="f8022-406">-Créer une opération *CommitMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-406">- Create an operation *CommitMessage*.</span></span> <span data-ttu-id="f8022-407">Cette opération sera utilisée pour envoyer le message de validation.</span><span class="sxs-lookup"><span data-stu-id="f8022-407">This operation will be used to send commit message.</span></span><br /><br /> <span data-ttu-id="f8022-408">-Créer une opération *RollbackMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-408">- Create an operation *RollbackMessage*.</span></span> <span data-ttu-id="f8022-409">Cette opération sera utilisée pour envoyer le message de la restauration.</span><span class="sxs-lookup"><span data-stu-id="f8022-409">This operation will be used to send rollback message.</span></span>|  
|<span data-ttu-id="f8022-410">SaveResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-410">SaveResponse</span></span>|<span data-ttu-id="f8022-411">-Définissez **identificateur** à *SaveResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-411">- Set **Identifier** to *SaveResponse*</span></span><br /><br /> <span data-ttu-id="f8022-412">-Définissez **Type** à *SaveResponseType*</span><span class="sxs-lookup"><span data-stu-id="f8022-412">- Set **Type** to *SaveResponseType*</span></span><br /><br /> <span data-ttu-id="f8022-413">-Définissez **modèle de Communication** à *à sens unique*</span><span class="sxs-lookup"><span data-stu-id="f8022-413">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="f8022-414">-Définissez **Direction de Communication** à *envoyer*.</span><span class="sxs-lookup"><span data-stu-id="f8022-414">- Set **Communication Direction** to *Send*.</span></span><br /><br /> <span data-ttu-id="f8022-415">-Créer une opération *BAPIMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-415">- Create an operation *BAPIMessage*.</span></span><br /><br /> <span data-ttu-id="f8022-416">-Créer une opération *CommitMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-416">- Create an operation *CommitMessage*.</span></span> <span data-ttu-id="f8022-417">Cette opération permet de sauvegarder les réponses pour le message de validation.</span><span class="sxs-lookup"><span data-stu-id="f8022-417">This operation will be used to save responses for the commit message.</span></span><br /><br /> <span data-ttu-id="f8022-418">-Créer une opération *RollbackMessage*.</span><span class="sxs-lookup"><span data-stu-id="f8022-418">- Create an operation *RollbackMessage*.</span></span> <span data-ttu-id="f8022-419">Cette opération permet de sauvegarder les réponses pour le message de la restauration.</span><span class="sxs-lookup"><span data-stu-id="f8022-419">This operation will be used to save responses for the rollback message.</span></span>|  
  
## <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="f8022-420">Spécifier des Messages pour les formes d’Action et de se connecter à des Ports</span><span class="sxs-lookup"><span data-stu-id="f8022-420">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="f8022-421">Le tableau suivant indique les propriétés et leurs valeurs à définir pour spécifier les messages de formes d’action et les lier aux ports.</span><span class="sxs-lookup"><span data-stu-id="f8022-421">The following table specifies the properties and their values to be set to specify messages for action shapes and linking them to the ports.</span></span> <span data-ttu-id="f8022-422">Les noms répertoriés dans le *forme* colonne sont les noms des formes de message, tel qu’affiché dans l’orchestration précédente.</span><span class="sxs-lookup"><span data-stu-id="f8022-422">The names listed in the *Shape* column are the names of the message shapes as displayed in the preceding orchestration.</span></span>  
  
|<span data-ttu-id="f8022-423">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="f8022-423">Shape</span></span>|<span data-ttu-id="f8022-424">Propriétés</span><span class="sxs-lookup"><span data-stu-id="f8022-424">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="f8022-425">ReceiveInputXML</span><span class="sxs-lookup"><span data-stu-id="f8022-425">ReceiveInputXML</span></span>|<span data-ttu-id="f8022-426">-Définissez **Message** à *SendToAdapter*</span><span class="sxs-lookup"><span data-stu-id="f8022-426">- Set **Message** to *SendToAdapter*</span></span><br /><br /> <span data-ttu-id="f8022-427">-Définissez **opération** à *FileIn.Transaction.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-427">- Set **Operation** to *FileIn.Transaction.Request*</span></span>|  
|<span data-ttu-id="f8022-428">SendToLOB</span><span class="sxs-lookup"><span data-stu-id="f8022-428">SendToLOB</span></span>|<span data-ttu-id="f8022-429">-Définissez **Message** à *BAPIMessage*</span><span class="sxs-lookup"><span data-stu-id="f8022-429">- Set **Message** to *BAPIMessage*</span></span><br /><br /> <span data-ttu-id="f8022-430">-Définissez **opération** à *LOBPort.BAPIMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-430">- Set **Operation** to *LOBPort.BAPIMessage.Request*</span></span>|  
|<span data-ttu-id="f8022-431">Réception réponse</span><span class="sxs-lookup"><span data-stu-id="f8022-431">ReceiveResponse</span></span>|<span data-ttu-id="f8022-432">-Définissez **Message** à *BAPIResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-432">- Set **Message** to *BAPIResponse*</span></span><br /><br /> <span data-ttu-id="f8022-433">-Définissez **opération** à *LOBPort.BAPIMessage.Response*</span><span class="sxs-lookup"><span data-stu-id="f8022-433">- Set **Operation** to *LOBPort.BAPIMessage.Response*</span></span>|  
|<span data-ttu-id="f8022-434">SendResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-434">SendResponse</span></span>|<span data-ttu-id="f8022-435">-Définissez **Message** à *BAPIResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-435">- Set **Message** to *BAPIResponse*</span></span><br /><br /> <span data-ttu-id="f8022-436">-Définissez **opération** à *SaveResponse.BAPIMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-436">- Set **Operation** to *SaveResponse.BAPIMessage.Request*</span></span>|  
|<span data-ttu-id="f8022-437">SendBAPICommit</span><span class="sxs-lookup"><span data-stu-id="f8022-437">SendBAPICommit</span></span>|<span data-ttu-id="f8022-438">-Définissez **Message** à *BAPICommitMessage*</span><span class="sxs-lookup"><span data-stu-id="f8022-438">- Set **Message** to *BAPICommitMessage*</span></span><br /><br /> <span data-ttu-id="f8022-439">-Définissez **opération** à *LOBPort.CommitMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-439">- Set **Operation** to *LOBPort.CommitMessage.Request*</span></span>|  
|<span data-ttu-id="f8022-440">ReceiveCommitResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-440">ReceiveCommitResponse</span></span>|<span data-ttu-id="f8022-441">-Définissez **Message** à *BAPICommitResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-441">- Set **Message** to *BAPICommitResponse*</span></span><br /><br /> <span data-ttu-id="f8022-442">-Définissez **opération** à *LOBPort.CommitMessage.Response*</span><span class="sxs-lookup"><span data-stu-id="f8022-442">- Set **Operation** to *LOBPort.CommitMessage.Response*</span></span>|  
|<span data-ttu-id="f8022-443">SendResponse2</span><span class="sxs-lookup"><span data-stu-id="f8022-443">SendResponse2</span></span>|<span data-ttu-id="f8022-444">-Définissez **Message** à *BAPICommitResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-444">- Set **Message** to *BAPICommitResponse*</span></span><br /><br /> <span data-ttu-id="f8022-445">-Définissez **opération** à *SaveResponse.CommitMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-445">- Set **Operation** to *SaveResponse.CommitMessage.Request*</span></span>|  
|<span data-ttu-id="f8022-446">SendBAPIRollback</span><span class="sxs-lookup"><span data-stu-id="f8022-446">SendBAPIRollback</span></span>|<span data-ttu-id="f8022-447">-Définissez **Message** à *BAPIRollbackMessage*</span><span class="sxs-lookup"><span data-stu-id="f8022-447">- Set **Message** to *BAPIRollbackMessage*</span></span><br /><br /> <span data-ttu-id="f8022-448">-Définissez **opération** à *LOBPort.RollbackMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-448">- Set **Operation** to *LOBPort.RollbackMessage.Request*</span></span>|  
|<span data-ttu-id="f8022-449">ReceiveRollbackResponse</span><span class="sxs-lookup"><span data-stu-id="f8022-449">ReceiveRollbackResponse</span></span>|<span data-ttu-id="f8022-450">-Définissez **Message** à *BAPIRollbackResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-450">- Set **Message** to *BAPIRollbackResponse*</span></span><br /><br /> <span data-ttu-id="f8022-451">-Définissez **opération** à *LOBPort.RollbackMessage.Response*</span><span class="sxs-lookup"><span data-stu-id="f8022-451">- Set **Operation** to *LOBPort.RollbackMessage.Response*</span></span>|  
|<span data-ttu-id="f8022-452">SendResponse3</span><span class="sxs-lookup"><span data-stu-id="f8022-452">SendResponse3</span></span>|<span data-ttu-id="f8022-453">-Définissez **Message** à *BAPIRollbackResponse*</span><span class="sxs-lookup"><span data-stu-id="f8022-453">- Set **Message** to *BAPIRollbackResponse*</span></span><br /><br /> <span data-ttu-id="f8022-454">-Définissez **opération** à *SaveResponse.RollbackMessage.Request*</span><span class="sxs-lookup"><span data-stu-id="f8022-454">- Set **Operation** to *SaveResponse.RollbackMessage.Request*</span></span>|  
  
 <span data-ttu-id="f8022-455">Une fois que vous avez défini ces propriétés, les formes de message et les ports sont connectés et l’orchestration est terminée.</span><span class="sxs-lookup"><span data-stu-id="f8022-455">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="f8022-456">La gestion des Exceptions</span><span class="sxs-lookup"><span data-stu-id="f8022-456">Handling Exceptions</span></span>  
 <span data-ttu-id="f8022-457">Dans les orchestrations complexes semblable à celui pour effectuer des transactions de BAPI, il est important d’effectuer le suivi de l’état de l’orchestration, signaler des erreurs lorsqu’ils se produisent, afin que vous pouvez résoudre les problèmes qu’ils se produisent.</span><span class="sxs-lookup"><span data-stu-id="f8022-457">In complex orchestrations like the one for performing BAPI transactions, it is important that you keep track of the state of the orchestration, report errors as they occur, so that you can resolve the problems as they occur.</span></span> <span data-ttu-id="f8022-458">L’orchestration BizTalk fournit des outils pour gérer les erreurs, pour maintenir l’état d’une orchestration et pour résoudre les problèmes qu’ils ont lieu via les transactions, la compensation et la gestion des exceptions.</span><span class="sxs-lookup"><span data-stu-id="f8022-458">BizTalk orchestration provides tools to handle errors, to maintain the state of an orchestration, and to fix problems as they occur through transactions, compensation, and exception handling.</span></span>  
  
 <span data-ttu-id="f8022-459">En tant qu’infrastructure pour les transactions et la gestion des exceptions, le Concepteur d’Orchestration fournit le **étendue** forme.</span><span class="sxs-lookup"><span data-stu-id="f8022-459">As a framework for transactions and exception handling, Orchestration Designer provides the **Scope** shape.</span></span> <span data-ttu-id="f8022-460">Une étendue peut avoir un type de transaction, une compensation et n'importe quel nombre de gestionnaires d'exception.</span><span class="sxs-lookup"><span data-stu-id="f8022-460">A scope can have a transaction type, a compensation, and any number of exception handlers.</span></span> <span data-ttu-id="f8022-461">Une étendue contient un ou plusieurs blocs.</span><span class="sxs-lookup"><span data-stu-id="f8022-461">A scope contains one or more blocks.</span></span> <span data-ttu-id="f8022-462">Il a un corps et peut éventuellement avoir n’importe quel nombre de blocs de gestion des exceptions est ajoutée.</span><span class="sxs-lookup"><span data-stu-id="f8022-462">It has a body and can optionally have any number of exception-handling blocks appended to it.</span></span> <span data-ttu-id="f8022-463">Dans le cas des transactions BAPI, l’intégralité de l’orchestration (voir la figure précédente) peut être inclus dans une étendue.</span><span class="sxs-lookup"><span data-stu-id="f8022-463">In the case of BAPI transactions, the entire orchestration (see earlier figure) can be included in a scope.</span></span>  
  
 <span data-ttu-id="f8022-464">Pour intercepter l’exception, vous devez ajouter un **intercepter l’Exception** bloc à l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-464">To catch the exception, you must add a **Catch Exception** block to the orchestration.</span></span> <span data-ttu-id="f8022-465">**Intercepter Exception** blocs sont attachés à la fin d’un **étendue** forme dans le Concepteur d’Orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-465">**Catch Exception** blocks are attached to the end of a **Scope** shape in Orchestration Designer.</span></span> <span data-ttu-id="f8022-466">Dans le cas des transactions BAPI, vous devez ajouter la routine « Annulation » pour le **intercepter l’Exception** bloquer, autrement dit, vous devez ajouter les éléments suivants à la routine « Annulation » :</span><span class="sxs-lookup"><span data-stu-id="f8022-466">In the case of BAPI transactions, you must add the “ABORT” routine to the **Catch Exception** block, that is, you must add the following to the “ABORT” routine:</span></span>  
  
-   <span data-ttu-id="f8022-467">Forme construire un Message comprenant une transformation (pour extraire le message de demande à partir du message d’entrée) et une forme assignation du Message (pour définir la propriété de contexte)</span><span class="sxs-lookup"><span data-stu-id="f8022-467">A Construct Message shape consisting of a Transform (to extract the request message from the input message) and a Message Assignment shape (to set the context property)</span></span>  
  
-   <span data-ttu-id="f8022-468">Envoyer et recevoir des formes.</span><span class="sxs-lookup"><span data-stu-id="f8022-468">Send and Receive shapes.</span></span>  
  
 <span data-ttu-id="f8022-469">L’exemple de transaction de SAP pour [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] (SAPTransaction) livré avec [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] illustre la gestion des exceptions, trop.</span><span class="sxs-lookup"><span data-stu-id="f8022-469">The SAP transaction sample for [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] (SAPTransaction) shipped with [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] demonstrates exception handling, too.</span></span> <span data-ttu-id="f8022-470">Pour plus d’informations sur l’exemple, consultez [exemples pour l’adaptateur SAP](../../adapters-and-accelerators/adapter-sap/samples-for-the-sap-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-470">For more information about the sample, see [Samples for the SAP adapter](../../adapters-and-accelerators/adapter-sap/samples-for-the-sap-adapter.md).</span></span>  
  
 <span data-ttu-id="f8022-471">Pour plus d’informations sur la gestion des exceptions, en général, à l’aide de [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], consultez [à l’aide de Transactions et gestion des Exceptions](../../core/using-transactions-and-handling-exceptions.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-471">For more information about how to handle exceptions, in general, using [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], see [Using Transactions and Handling Exceptions](../../core/using-transactions-and-handling-exceptions.md).</span></span>
  
## <a name="add-the-biztalk-property-schema-to-biztalk"></a><span data-ttu-id="f8022-472">Ajoutez le schéma de propriété BizTalk à BizTalk</span><span class="sxs-lookup"><span data-stu-id="f8022-472">Add the BizTalk Property Schema to BizTalk</span></span>  
 <span data-ttu-id="f8022-473">Dans votre projet BizTalk, vous avez ajouté une référence d’assembly au schéma de propriété BizTalk pour [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f8022-473">In your BizTalk project, you added an assembly reference to the BizTalk property schema for [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="f8022-474">Vous devez ajouter le même assembly en tant que ressource dans l’application BizTalk, autrement dit, l’application où sera déployé le projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-474">You must add the same assembly as a resource in the BizTalk application, that is, the application where the BizTalk project will be deployed.</span></span> <span data-ttu-id="f8022-475">Le fichier de schéma, *Microsoft.Adapters.SAP.BiztalkPropertySchema.dll*, est installé par le [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] le programme d’installation en général sous \<lecteur d’installation\>: \Program Files\Microsoft l’adaptateur BizTalk Pack\bin.</span><span class="sxs-lookup"><span data-stu-id="f8022-475">The schema file, *Microsoft.Adapters.SAP.BiztalkPropertySchema.dll*, is installed by the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)] setup typically under \<installation drive\>:\Program Files\Microsoft BizTalk Adapter Pack\bin.</span></span> <span data-ttu-id="f8022-476">Sans cette ressource, vous ne serez pas en mesure de déployer votre projet.</span><span class="sxs-lookup"><span data-stu-id="f8022-476">Without this resource, you will not be able to deploy your project.</span></span>  
  
#### <a name="to-add-an-assembly-as-a-resource-in-biztalk"></a><span data-ttu-id="f8022-477">Pour ajouter un assembly en tant que ressource dans BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="f8022-477">To add an assembly as a resource in BizTalk</span></span>  
  
1.  <span data-ttu-id="f8022-478">Démarrer le [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] console d’Administration.</span><span class="sxs-lookup"><span data-stu-id="f8022-478">Start the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
2.  <span data-ttu-id="f8022-479">Dans l’arborescence de la console, développez **groupe BizTalk**, développez **Applications**et puis l’application à laquelle vous souhaitez ajouter un assembly BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-479">In the console tree, expand **BizTalk Group**, expand **Applications**, and then the application to which you want to add a BizTalk assembly.</span></span>  
  
3.  <span data-ttu-id="f8022-480">Avec le bouton droit **ressources**, pointez sur **ajouter** puis cliquez sur **assemblys BizTalk**.</span><span class="sxs-lookup"><span data-stu-id="f8022-480">Right-click **Resources**, point to **Add** and then click **BizTalk Assemblies**.</span></span>  
  
4.  <span data-ttu-id="f8022-481">Dans le **ajouter une ressource** boîte de dialogue, cliquez sur **ajouter**, accédez au dossier contenant le fichier d’assembly BizTalk, sélectionnez le fichier d’assembly BizTalk, puis cliquez sur **ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="f8022-481">In the **Add Resource** dialog box, click **Add**, navigate to the folder containing the BizTalk assembly file, select the BizTalk assembly file, and then click **Open**.</span></span>  
  
5.  <span data-ttu-id="f8022-482">Dans **Options**, spécifiez les options d’installation de l’assembly BizTalk dans le GAC, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="f8022-482">In **Options**, specify the options for installing the BizTalk assembly to the GAC, and then click **OK**.</span></span>  
  
 <span data-ttu-id="f8022-483">Vous devez maintenant créer la solution BizTalk et déployez-le sur un serveur BizTalk.</span><span class="sxs-lookup"><span data-stu-id="f8022-483">You must now build the BizTalk solution and then deploy it to a BizTalk Server.</span></span> <span data-ttu-id="f8022-484">Pour plus d’informations, consultez [génération et exécution des Orchestrations](../../core/building-and-running-orchestrations.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-484">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="f8022-485">Configuration de l’Application BizTalk</span><span class="sxs-lookup"><span data-stu-id="f8022-485">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="f8022-486">Après avoir déployé le projet BizTalk, l’orchestration que vous avez créé précédemment est répertoriée sous le **Orchestrations** volet de la console Administration de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="f8022-486">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="f8022-487">Vous devez utiliser la console Administration de BizTalk Server pour configurer l’application.</span><span class="sxs-lookup"><span data-stu-id="f8022-487">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="f8022-488">Pour plus d’informations sur la configuration d’une application, consultez [comment configurer une Application](../../core/how-to-configure-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-488">For more information about configuring an application, see [How to Configure an Application](../../core/how-to-configure-an-application.md).</span></span>
  
 <span data-ttu-id="f8022-489">Configuration d’une application implique :</span><span class="sxs-lookup"><span data-stu-id="f8022-489">Configuring an application involves:</span></span>  
  
-   <span data-ttu-id="f8022-490">Sélection d’un hôte de l’application.</span><span class="sxs-lookup"><span data-stu-id="f8022-490">Selecting a host for the application.</span></span>  
  
-   <span data-ttu-id="f8022-491">Mappage de ports que vous avez créé dans l’orchestration aux ports physiques dans la console Administration de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="f8022-491">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="f8022-492">Pour cette orchestration, vous devez :</span><span class="sxs-lookup"><span data-stu-id="f8022-492">For this orchestration you must:</span></span>  
  
    -   <span data-ttu-id="f8022-493">Définir un emplacement sur le disque dur et un port de fichier correspondant où vous allez déposer un message de demande.</span><span class="sxs-lookup"><span data-stu-id="f8022-493">Define a location on the hard disk and a corresponding file port where you will drop a request message.</span></span> <span data-ttu-id="f8022-494">L’orchestration BizTalk consommer le message de demande et l’envoyer au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-494">The BizTalk orchestration will consume the request message and send it to the SAP system.</span></span>  
  
    -   <span data-ttu-id="f8022-495">Définir un emplacement sur le disque dur et un port de fichier correspondant dans lequel l’orchestration BizTalk supprimera le message de réponse contenant la réponse du système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-495">Define a location on the hard disk and a corresponding file port where the BizTalk orchestration will drop the response message containing the response from the SAP system.</span></span>  
  
    -   <span data-ttu-id="f8022-496">Définir un port d’envoi WCF-Custom ou WCF-SAP physique pour envoyer des messages au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-496">Define a physical WCF-Custom or WCF-SAP send port to send messages to the SAP system.</span></span> <span data-ttu-id="f8022-497">Pour plus d’informations sur la création de ports, consultez [configurer manuellement une liaison de port physique à l’adaptateur SAP](../../adapters-and-accelerators/adapter-sap/manually-configure-a-physical-port-binding-to-the-sap-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-497">For information about how to create ports, see [Manually configure a physical port binding to the SAP adapter](../../adapters-and-accelerators/adapter-sap/manually-configure-a-physical-port-binding-to-the-sap-adapter.md).</span></span> <span data-ttu-id="f8022-498">Étant donné que l’envoi envoie le port et recevoir des messages conformes à plusieurs schémas et effectue deux opérations, vous devez définir une action dynamique pour les opérations.</span><span class="sxs-lookup"><span data-stu-id="f8022-498">Because the send port sends and receive messages conforming to more than one schema and performs two operations, you must set dynamic action for both the operations.</span></span> <span data-ttu-id="f8022-499">Pour plus d’informations sur les actions, consultez [configurer l’action SOAP pour le système SAP](../../adapters-and-accelerators/adapter-sap/configure-the-soap-action-for-the-sap-system.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-499">For more information about actions, see [Configure the SOAP action for the SAP system](../../adapters-and-accelerators/adapter-sap/configure-the-soap-action-for-the-sap-system.md).</span></span> <span data-ttu-id="f8022-500">Assurez-vous que vous respectiez les points clés suivants lors de la création d’un WCF-Custom ou WCF-SAP port d’envoi pour effectuer des transactions.</span><span class="sxs-lookup"><span data-stu-id="f8022-500">Make sure you adhere to the following key considerations while creating a WCF-Custom or WCF-SAP send port to perform transactions.</span></span>  
  
        |<span data-ttu-id="f8022-501">Définissez les paramètres suivants</span><span class="sxs-lookup"><span data-stu-id="f8022-501">Set the following</span></span>|<span data-ttu-id="f8022-502">Cette valeur</span><span class="sxs-lookup"><span data-stu-id="f8022-502">To this value</span></span>|  
        |-----------------------|-------------------|  
        |<span data-ttu-id="f8022-503">Action</span><span class="sxs-lookup"><span data-stu-id="f8022-503">Action</span></span>|<span data-ttu-id="f8022-504">Le port d’envoi envoie et reçoit des messages pour plusieurs opérations.</span><span class="sxs-lookup"><span data-stu-id="f8022-504">The send port sends and receives messages for more than one operation.</span></span> <span data-ttu-id="f8022-505">Par conséquent, l’action sur le port d’envoi doit être définie pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="f8022-505">So, the action on the send port must be set for each operation.</span></span><br /><br /> `<BtsActionMapping>   <Operation Name="BAPIMessage" Action="http://Microsoft.LobServices.Sap/2007/03/Rfc/BAPI_SALESORDER_CREATEFROMDAT2" />   <Operation Name="CommitMessage" Action="http://Microsoft.LobServices.Sap/2007/03/Rfc/BAPI_TRANSACTION_COMMIT" />   <Operation Name="RollbackMessage" Action="http://Microsoft.LobServices.Sap/2007/03/Rfc/BAPI_TRANSACTION_ROLLBACK" /> </BtsActionMapping>`|  
        |<span data-ttu-id="f8022-506">EnableBizTalkCompatibilityMode</span><span class="sxs-lookup"><span data-stu-id="f8022-506">EnableBizTalkCompatibilityMode</span></span>|<span data-ttu-id="f8022-507">Affectez à cette propriété de liaison **True**.</span><span class="sxs-lookup"><span data-stu-id="f8022-507">Set this binding property to **True**.</span></span>|  
        |<span data-ttu-id="f8022-508">EnableConnectionPooling</span><span class="sxs-lookup"><span data-stu-id="f8022-508">EnableConnectionPooling</span></span>|<span data-ttu-id="f8022-509">Affectez à cette propriété de liaison **False** avant d’effectuer des transactions.</span><span class="sxs-lookup"><span data-stu-id="f8022-509">Set this binding property to **False** before performing any transactions.</span></span> <span data-ttu-id="f8022-510">Dans les scénarios où le canal entre l’adaptateur et BizTalk est inattendue, la connexion correspondante est ajoutée au pool de connexions.</span><span class="sxs-lookup"><span data-stu-id="f8022-510">In scenarios where the channel set up between the adapter and BizTalk is unexpectedly terminated, the corresponding connection is added to the connection pool.</span></span> <span data-ttu-id="f8022-511">Lorsqu’un autre canal est ouvert, et le nouveau canal choisit le même objet de connexion, les transactions non validées sur l’ancien objet de connexion sera également validées lorsque les transactions sont validées sur le nouveau canal.</span><span class="sxs-lookup"><span data-stu-id="f8022-511">When another channel is opened, and the new channel picks the same connection object, the uncommitted transactions on the old connection object will also be committed when the transactions are committed over the new channel.</span></span> <span data-ttu-id="f8022-512">Pour éviter cela, le regroupement de connexions doit être désactivé lors de l’exécution de transactions.</span><span class="sxs-lookup"><span data-stu-id="f8022-512">To avoid this, connection pooling must be disabled while performing transactions.</span></span>|  
  
        > [!NOTE]
        >  <span data-ttu-id="f8022-513">Génération de schéma à l’aide du [!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)] crée également un fichier de liaison contenant des informations sur les ports et les actions à définir pour ces ports.</span><span class="sxs-lookup"><span data-stu-id="f8022-513">Generating the schema using the [!INCLUDE[consumeadapterservlong](../../includes/consumeadapterservlong-md.md)] also creates a binding file containing information about the ports and the actions to be set for those ports.</span></span> <span data-ttu-id="f8022-514">Vous pouvez importer ce fichier de liaison à partir de la console Administration de BizTalk Server pour créer des ports d’envoi (pour les appels sortants) ou de ports de réception (d’appels entrants).</span><span class="sxs-lookup"><span data-stu-id="f8022-514">You can import this binding file from the BizTalk Server Administration console to create send ports (for outbound calls) or receive ports (for inbound calls).</span></span> <span data-ttu-id="f8022-515">Pour plus d’informations, consultez [configurer une liaison de port physique à l’aide d’un fichier de liaison de port à SAP](../../adapters-and-accelerators/adapter-sap/configure-a-physical-port-binding-using-a-port-binding-file-to-sap.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-515">For more information, see [Configure a physical port binding using a port binding file to SAP](../../adapters-and-accelerators/adapter-sap/configure-a-physical-port-binding-using-a-port-binding-file-to-sap.md).</span></span>
  
        > [!IMPORTANT]
        >  <span data-ttu-id="f8022-516">Vous pouvez configurer un transport secondaire sur un WCF-Custom ou WCF-SAP port d’envoi qui vous permet d’envoyer des messages à un autre système SAP si le transport principal ne fonctionne pas.</span><span class="sxs-lookup"><span data-stu-id="f8022-516">You can configure a backup transport on a WCF-Custom or WCF-SAP send port that enables you to send messages to another SAP system if the primary transport fails to function.</span></span> <span data-ttu-id="f8022-517">Toutefois, pour effectuer des transactions sur un système SAP, basée sur le WCF [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] ne prend pas en charge la spécification d’un transport secondaire qui pointe vers un autre serveur SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-517">However, for performing transactions on an SAP system, the WCF-based [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] does not support specifying a backup transport pointing to another SAP server.</span></span>  
  
## <a name="starting-the-application"></a><span data-ttu-id="f8022-518">Démarrage de l’Application</span><span class="sxs-lookup"><span data-stu-id="f8022-518">Starting the Application</span></span>  
 <span data-ttu-id="f8022-519">Vous devez démarrer l’exécution de transactions BizTalk application d’un système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-519">You must start the BizTalk application performing transactions an SAP system.</span></span> <span data-ttu-id="f8022-520">Pour obtenir des instructions sur le démarrage d’une application BizTalk, consultez [comment démarrer une Orchestration](../../core/how-to-start-an-orchestration.md), [comment démarrer une application](../../core/how-to-start-and-stop-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-520">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md), [How to Start an application](../../core/how-to-start-and-stop-a-biztalk-application.md).</span></span>
  
 <span data-ttu-id="f8022-521">À ce stade, vérifiez que :</span><span class="sxs-lookup"><span data-stu-id="f8022-521">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="f8022-522">Le fichier de port de réception pour recevoir des messages de demande pour l’orchestration est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="f8022-522">The FILE receive port to receive request messages for the orchestration is running.</span></span>  
  
-   <span data-ttu-id="f8022-523">Le port d’envoi FILE pour recevoir les messages de réponse à partir de l’orchestration est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="f8022-523">The FILE send port to receive the response messages from the orchestration is running.</span></span>  
  
-   <span data-ttu-id="f8022-524">Le port d’envoi WCF-Custom ou WCF-SAP pour envoyer des messages au système SAP est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="f8022-524">The WCF-Custom or WCF-SAP send port to send messages to the SAP system is running.</span></span>  
  
-   <span data-ttu-id="f8022-525">L’orchestration BizTalk pour l’opération est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="f8022-525">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="f8022-526">L’exécution de l’opération</span><span class="sxs-lookup"><span data-stu-id="f8022-526">Executing the Operation</span></span>  
 <span data-ttu-id="f8022-527">Après avoir exécuté l’application, vous devez supprimer un message de demande pour l’orchestration à un emplacement prédéfini.</span><span class="sxs-lookup"><span data-stu-id="f8022-527">After you run the application, you must drop a request message for the orchestration at a predefined location.</span></span> <span data-ttu-id="f8022-528">Le message de demande doit être conforme à un schéma spécifique, par exemple, MultipleOrders.xsd schéma.</span><span class="sxs-lookup"><span data-stu-id="f8022-528">The request message must conform to a specific schema, for instance, MultipleOrders.xsd schema.</span></span> <span data-ttu-id="f8022-529">Par exemple, un message de demande pour créer des commandes client dans un système SAP, puis pour valider l’opération est :</span><span class="sxs-lookup"><span data-stu-id="f8022-529">For example, a request message to create sales orders in an SAP system and then to commit the operation is:</span></span>  
  
```  
<ns0:Orders xmlns:ns0="http://BAPISend.MultipleOrders">  
  <Order>  
      <ORDER_HEADER_IN>  
        <DOC_TYPE>TA</DOC_TYPE>  
        <SALES_ORG>1000</SALES_ORG>  
        <DISTR_CHAN>10</DISTR_CHAN>  
        <DIVISION>00</DIVISION>  
        <SALES_OFF>1000</SALES_OFF>  
        <REQ_DATE_H>20060901</REQ_DATE_H>  
        <PURCH_DATE>20060901</PURCH_DATE>  
        <PURCH_NO_C>Cust A</PURCH_NO_C>  
        <CURRENCY>EUR</CURRENCY>  
      </ORDER_HEADER_IN>  
      <ORDER_ITEMS_IN>  
          <MATERIAL>P-109</MATERIAL>  
          <PLANT>1000</PLANT>  
          <TARGET_QU>ST</TARGET_QU>  
      </ORDER_ITEMS_IN>  
      <ORDER_PARTNERS>  
          <PARTN_ROLE>AG</PARTN_ROLE>  
          <PARTN_NUMB>0000000257</PARTN_NUMB>  
      </ORDER_PARTNERS>  
    <RETURN></RETURN>  
  </Order>  
  <isCommit>true</isCommit>  
  <BAPI_TRANSACTION_COMMIT>  
  </BAPI_TRANSACTION_COMMIT>  
</ns0:Orders>  
```  
  
 <span data-ttu-id="f8022-530">L’orchestration consomme le message et l’envoie au système SAP.</span><span class="sxs-lookup"><span data-stu-id="f8022-530">The orchestration consumes the message and sends it to the SAP system.</span></span> <span data-ttu-id="f8022-531">La réponse du système SAP est enregistrée à un autre emplacement de fichier définie dans le cadre de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="f8022-531">The response from the SAP system is saved at other file location defined as part of the orchestration.</span></span> <span data-ttu-id="f8022-532">Pour le message de demande ci-dessus, vous obtenez deux messages de réponse, une pour l’appel de la RFC BAPI_SALESORDER_CREATEFROMDAT2 et l’autre pour l’opération de validation à l’aide de BAPI_TRANSACTION_COMMIT.</span><span class="sxs-lookup"><span data-stu-id="f8022-532">For the above request message, you get two response messages—one for invoking the BAPI_SALESORDER_CREATEFROMDAT2 RFC and the other for the commit operation using BAPI_TRANSACTION_COMMIT.</span></span>  
  
 <span data-ttu-id="f8022-533">La réponse pour BAPI_SALESORDER_CREATEFROMDAT2 est :</span><span class="sxs-lookup"><span data-stu-id="f8022-533">The response for BAPI_SALESORDER_CREATEFROMDAT2 is:</span></span>  
  
```  
<?xml version="1.0" encoding="utf-8" ?>   
<BAPI_SALESORDER_CREATEFROMDAT2Response xmlns="http://Microsoft.LobServices.Sap/2007/03/Rfc/">  
  <SALESDOCUMENT />   
  <ORDER_ITEMS_IN>  
    <BAPISDITM xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/">  
      <ITM_NUMBER>0</ITM_NUMBER>   
      <HG_LV_ITEM>0</HG_LV_ITEM>   
      <PO_ITM_NO />   
      ......  
    </BAPISDITM>  
  </ORDER_ITEMS_IN>  
  <ORDER_PARTNERS>  
    <BAPIPARNR xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/">  
      <PARTN_ROLE>AG</PARTN_ROLE>   
      <PARTN_NUMB>0000000257</PARTN_NUMB>   
      <ITM_NUMBER>0</ITM_NUMBER>   
      ......   
    </BAPIPARNR>  
  </ORDER_PARTNERS>  
</BAPI_SALESORDER_CREATEFROMDAT2Response>  
```  
  
 <span data-ttu-id="f8022-534">La réponse pour BAPI_TRANSACTION_COMMIT est :</span><span class="sxs-lookup"><span data-stu-id="f8022-534">The response for BAPI_TRANSACTION_COMMIT is:</span></span>  
  
```  
<?xml version="1.0" encoding="utf-8" ?>   
<BAPI_TRANSACTION_COMMITResponse xmlns="http://Microsoft.LobServices.Sap/2007/03/Rfc/">  
  <RETURN>  
    <TYPE xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <ID xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <NUMBER xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/">0</NUMBER>   
    <MESSAGE xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <LOG_NO xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <LOG_MSG_NO xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/">0</LOG_MSG_NO>   
    <MESSAGE_V1 xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <MESSAGE_V2 xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <MESSAGE_V3 xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <MESSAGE_V4 xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <PARAMETER xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <ROW xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/">0</ROW>   
    <FIELD xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
    <SYSTEM xmlns="http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/" />   
  </RETURN>  
</BAPI_TRANSACTION_COMMITResponse>  
```  
  
> [!NOTE]
>  <span data-ttu-id="f8022-535">Si le message de requête appelé le RFC BAPI_TRANSACTION_ROLLBACK, la seconde réponse sera pour BAPI_TRANSACTION_ROLLBACK.</span><span class="sxs-lookup"><span data-stu-id="f8022-535">If the request message invoked the BAPI_TRANSACTION_ROLLBACK RFC, the second response will be for BAPI_TRANSACTION_ROLLBACK.</span></span>  
  
## <a name="possible-exceptions"></a><span data-ttu-id="f8022-536">Exceptions possibles</span><span class="sxs-lookup"><span data-stu-id="f8022-536">Possible Exceptions</span></span>  
 <span data-ttu-id="f8022-537">Pour plus d’informations sur les exceptions que vous pouvez rencontrer lors de l’exécution des transactions sur un système SAP à l’aide de BizTalk Server, consultez [Exceptions et gestion des erreurs avec l’adaptateur SAP](../../adapters-and-accelerators/adapter-sap/exceptions-and-error-handling-with-the-sap-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-537">For information about the exceptions you might encounter while performing transactions on an SAP system by using BizTalk Server, see [Exceptions and Error Handling with the SAP adapter](../../adapters-and-accelerators/adapter-sap/exceptions-and-error-handling-with-the-sap-adapter.md).</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="f8022-538">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="f8022-538">Best Practices</span></span>  
 <span data-ttu-id="f8022-539">Après avoir déployé et configuré le projet BizTalk, vous pouvez exporter les paramètres de configuration dans un fichier XML appelé le fichier de liaisons.</span><span class="sxs-lookup"><span data-stu-id="f8022-539">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the bindings file.</span></span> <span data-ttu-id="f8022-540">Une fois que vous générez un fichier de liaison, vous pouvez importer les paramètres de configuration à partir du fichier afin que vous n’avez pas besoin de créer les ports d’envoi et de réception, de l’orchestration même.</span><span class="sxs-lookup"><span data-stu-id="f8022-540">Once you generate a bindings file, you can import the configuration settings from the file so that you do not need to create the send ports and receive ports, for the same orchestration.</span></span> <span data-ttu-id="f8022-541">Pour plus d’informations sur les fichiers de liaison, consultez [liaisons de l’adaptateur SAP de réutiliser](../../adapters-and-accelerators/adapter-sap/reuse-sap-adapter-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="f8022-541">For more information about binding files, see [Reuse SAP adapter bindings](../../adapters-and-accelerators/adapter-sap/reuse-sap-adapter-bindings.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8022-542">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f8022-542">See Also</span></span>  
[<span data-ttu-id="f8022-543">Développer des applications BizTalk</span><span class="sxs-lookup"><span data-stu-id="f8022-543">Develop BizTalk applications</span></span>](../../adapters-and-accelerators/adapter-sap/develop-biztalk-applications-using-the-sap-adapter.md)