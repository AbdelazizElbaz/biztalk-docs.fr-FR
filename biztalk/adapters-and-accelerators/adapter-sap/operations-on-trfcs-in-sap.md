---
title: "Opérations sur tRFCs dans SAP | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- RFCs, invoking transactional RFCs in an SAP System
- TID database
- transactional RFCs
- tRFCs, receiving inbound iransactional RFC calls from an SAP system
- tRFCs
- GUID parameter
- RFCs, processing inbound
- RfcConfirmTransID
- transaction ID (TID)
- tRFC Operations
- IDOCS, receiving IDOCs as a tRFC server
- adapters, operations on tRFCs
- RFC, invoking an RFC
ms.assetid: d6a5c515-d6aa-4b70-9c23-32d1dd94d473
caps.latest.revision: "5"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4eac8dab219e46dc569b604a63e195f4613eb344
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="operations-on-trfcs-in-sap"></a><span data-ttu-id="c5be6-102">Opérations sur tRFCs dans SAP</span><span class="sxs-lookup"><span data-stu-id="c5be6-102">Operations on tRFCs in SAP</span></span>
<span data-ttu-id="c5be6-103">RFC transactionnelles (tRFCs) sont les RFC qui sont appelées en tant que partie d’une unité logique de travail (LUW).</span><span class="sxs-lookup"><span data-stu-id="c5be6-103">Transactional RFCs (tRFCs) are RFCs that are invoked as part of a logical unit of work (LUW).</span></span> <span data-ttu-id="c5be6-104">Sur un système SAP, un LUW contient toutes les étapes nécessaires pour effectuer une entreprise ou une tâche de programmation.</span><span class="sxs-lookup"><span data-stu-id="c5be6-104">On an SAP system, an LUW contains all of the steps necessary to complete a business or programming task.</span></span> <span data-ttu-id="c5be6-105">Un tRFC représente un moyen d’appeler une commande RFC ; Il n’est pas un artefact SAP unique.</span><span class="sxs-lookup"><span data-stu-id="c5be6-105">A tRFC represents a way of invoking an RFC; it is not a unique SAP artifact.</span></span>  
  
 <span data-ttu-id="c5be6-106">Vous pouvez utiliser la [!INCLUDE[adaptersap](../../includes/adaptersap-md.md)] comme un client tRFC et comme un serveur tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-106">You can use the [!INCLUDE[adaptersap](../../includes/adaptersap-md.md)] both as a tRFC client and as a tRFC server.</span></span>  
  
-   <span data-ttu-id="c5be6-107">**Comme un client tRFC**, l’adaptateur permet à votre application appeler un RFC unique dans un LUW sur le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-107">**As a tRFC client**, the adapter enables your application to invoke a single RFC in an LUW on the SAP system.</span></span> <span data-ttu-id="c5be6-108">Cela garantit l’exécution seule unique de la RFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-108">This guarantees one-time only execution of the RFC.</span></span> <span data-ttu-id="c5be6-109">Il n’implique pas le comportement transactionnel.</span><span class="sxs-lookup"><span data-stu-id="c5be6-109">It does not imply transactional behavior.</span></span>  
  
-   <span data-ttu-id="c5be6-110">**Comme un serveur tRFC**, l’adaptateur vous permet de recevoir plusieurs RFC à l’intérieur d’un LUW.</span><span class="sxs-lookup"><span data-stu-id="c5be6-110">**As a tRFC server**, the adapter enables you to receive multiple RFCs inside an LUW.</span></span> <span data-ttu-id="c5be6-111">L’adaptateur prend en charge les appels entrants tRFC dans un contexte transactionnel ; qui est la validation et le comportement précédent de restauration sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c5be6-111">The adapter supports inbound tRFC calls in a transactional context; that is commit and roll back behavior are supported.</span></span>  
  
## <a name="trfc-operations"></a><span data-ttu-id="c5be6-112">Opérations tRFC</span><span class="sxs-lookup"><span data-stu-id="c5be6-112">tRFC Operations</span></span>  
 <span data-ttu-id="c5be6-113">Un tRFC implique un moyen d’appeler une commande RFC ; Il n’est pas un artefact SAP distinct.</span><span class="sxs-lookup"><span data-stu-id="c5be6-113">A tRFC implies a way of invoking an RFC; it is not a separate SAP artifact.</span></span> <span data-ttu-id="c5be6-114">Par conséquent, chaque RFC sur le système SAP (pour laquelle l’adaptateur peut récupérer les métadonnées) est également exposé en tant qu’un tRFC par le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5be6-114">Therefore, every RFC on the SAP system (for which the adapter can retrieve metadata) is also surfaced as a tRFC by the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="c5be6-115">tRFCs sont signalées par le nom de la RFC en tant qu’opérations sous le nœud de catégorie de métadonnées TRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-115">tRFCs are surfaced by RFC name as operations under the TRFC metadata category node.</span></span> <span data-ttu-id="c5be6-116">(Vous pouvez parcourir ou rechercher tRFCs sous le **TRFC** nœud lorsque vous utilisez la [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] ou [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="c5be6-116">(You can browse or search for tRFCs under the **TRFC** node when you use the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] or the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].)</span></span>  
  
 <span data-ttu-id="c5be6-117">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] prend en charge les éléments suivants sur tRFCs :</span><span class="sxs-lookup"><span data-stu-id="c5be6-117">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] supports the following on tRFCs:</span></span>  
  
-   <span data-ttu-id="c5be6-118">Paramètres d’importation</span><span class="sxs-lookup"><span data-stu-id="c5be6-118">IMPORT parameters</span></span>  
  
-   <span data-ttu-id="c5be6-119">MODIFICATION des paramètres (uniquement la partie entrée de la modification de paramètre est pris en charge)</span><span class="sxs-lookup"><span data-stu-id="c5be6-119">CHANGING parameters (only the input side of the CHANGING parameter is supported)</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5be6-120">tRFCs sont exécutées de façon asynchrone, aucune valeur de sortie (paramètres d’exportation ou de modification) n’est retournées pour les.</span><span class="sxs-lookup"><span data-stu-id="c5be6-120">tRFCs are executed asynchronously, so no output values (EXPORT or CHANGING parameters) are returned for them.</span></span>  
  
 <span data-ttu-id="c5be6-121">Un paramètre GUID est visible par l’adaptateur pour les opérations tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-121">A GUID parameter is surfaced by the adapter for tRFC operations.</span></span> <span data-ttu-id="c5be6-122">Ce GUID est mappé par l’adaptateur à la transaction SAP ID (TID) qui est associé à le tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-122">This GUID is mapped by the adapter to the SAP transaction ID (TID) that is associated with the tRFC.</span></span> <span data-ttu-id="c5be6-123">Vous pouvez utiliser ce paramètre GUID pour :</span><span class="sxs-lookup"><span data-stu-id="c5be6-123">You can use this GUID parameter to:</span></span>  
  
-   <span data-ttu-id="c5be6-124">Confirmer le tRFC sur le système SAP dans les appels du client tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-124">Confirm the tRFC on the SAP system in tRFC client calls.</span></span> <span data-ttu-id="c5be6-125">Pour cela, en appelant l’opération RfcConfirmTransId.</span><span class="sxs-lookup"><span data-stu-id="c5be6-125">You do this by invoking the RfcConfirmTransId operation.</span></span> <span data-ttu-id="c5be6-126">Il s’agit d’une opération particulière par l’adaptateur pour confirmer un TID sur le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-126">This is a special operation surfaced by the adapter to confirm a TID on the SAP system.</span></span>  
  
-   <span data-ttu-id="c5be6-127">Obtenir le TID SAP réelle utilisée pour un tRFC à partir de l’adaptateur au client tRFC et scénarios de serveur tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-127">Get the actual SAP TID used for a tRFC from the adapter in both tRFC client and tRFC server scenarios.</span></span> <span data-ttu-id="c5be6-128">Pour cela, vous devez en appelant la méthode utilitaire SAP, ConvertGuidToTid.</span><span class="sxs-lookup"><span data-stu-id="c5be6-128">You do this by invoking the SAP utility method, ConvertGuidToTid.</span></span>  
  
 <span data-ttu-id="c5be6-129">Pour plus d’informations sur ces opérations, consultez [des opérations spéciales](../../adapters-and-accelerators/adapter-sap/special-operations.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-129">For more information about these operations, see [Special Operations](../../adapters-and-accelerators/adapter-sap/special-operations.md).</span></span> <span data-ttu-id="c5be6-130">Pour plus d’informations sur les structures de message et les actions de SOAP utilisées pour tRFCs par l’adaptateur, consultez [des schémas de Message pour des opérations tRFC](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-130">For more information about the message structures and SOAP actions used for tRFCs by the adapter, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="invoking-transactional-rfcs-in-an-sap-system"></a><span data-ttu-id="c5be6-131">L’appel de la RFC transactionnels dans un système SAP</span><span class="sxs-lookup"><span data-stu-id="c5be6-131">Invoking Transactional RFCs in an SAP System</span></span>  
 <span data-ttu-id="c5be6-132">En règle générale, les tRFCs sont utilisés pour exécuter un ou plusieurs appels RFC à l’intérieur d’un seul LUW ; Toutefois, en raison des limitations dans le SDK de RFC SAP, le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] prend en charge uniquement un seul tRFC par LUW.</span><span class="sxs-lookup"><span data-stu-id="c5be6-132">Typically, tRFCs are used to execute one or more RFC calls inside a single LUW; however, due to limitations in the SAP RFC SDK, the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] supports only a single tRFC per LUW.</span></span> <span data-ttu-id="c5be6-133">Pour cette raison, l’adaptateur crée un LUW (TID SAP) pour chaque tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-133">For this reason, the adapter creates an LUW (SAP TID) for each tRFC.</span></span> <span data-ttu-id="c5be6-134">Pour ces clients, SAP définit un LUW comme un mécanisme permettant de garantir l’exécution de « unique » de la RFC et n’implique pas de validation et basé sur la restauration des transactions.</span><span class="sxs-lookup"><span data-stu-id="c5be6-134">For such clients, SAP defines an LUW as a mechanism to guarantee "one-time" execution of the RFC and does not imply commit and rollback-based transactions.</span></span>  
  
 <span data-ttu-id="c5be6-135">Les étapes suivantes récapitulent les tâches qui sont exécutées dans un appel de client RFC à l’aide du [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5be6-135">The following steps summarize the tasks that are performed in an RFC client call using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="c5be6-136">Certaines de ces étapes sont effectuées par le client de carte, et certaines sont effectuées par l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="c5be6-136">Some of these steps are performed by the adapter client, and some are performed by the adapter.</span></span>  
  
1.  <span data-ttu-id="c5be6-137">Le client de l’adaptateur envoie un message de demande pour l’opération tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-137">The adapter client sends a request message for the tRFC operation.</span></span> <span data-ttu-id="c5be6-138">Le client de l’adaptateur peut éventuellement fournir un GUID dans ce message.</span><span class="sxs-lookup"><span data-stu-id="c5be6-138">The adapter client can optionally supply a GUID in this message.</span></span>  
  
2.  <span data-ttu-id="c5be6-139">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] reçoit le message de demande et utilise le SDK RFC pour obtenir une ID (TID) de la transaction à partir du système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-139">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] receives the request message and uses the RFC SDK to get a transaction ID (TID) from the SAP system.</span></span> <span data-ttu-id="c5be6-140">Si le message de demande contient un GUID, l’adaptateur mappe ce GUID pour le TID SAP ; dans le cas contraire, l’adaptateur crée un nouveau GUID et le mappe le TID SAP</span><span class="sxs-lookup"><span data-stu-id="c5be6-140">If the request message contains a GUID, the adapter maps this GUID to the SAP TID; otherwise, the adapter creates a new GUID and maps it to the SAP TID</span></span>  
  
3.  <span data-ttu-id="c5be6-141">L’adaptateur utilise le TID pour appeler le tRFC sur le serveur SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-141">The adapter uses the TID to make the tRFC call to the SAP server.</span></span> <span data-ttu-id="c5be6-142">L’état du TID est marqué comme **terminé** sur le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-142">The status of the TID is marked as **FINISHED** on the SAP system.</span></span>  
  
4.  <span data-ttu-id="c5be6-143">L’adaptateur retourne le GUID (qui est mappé au TID) pour le client de l’adaptateur dans le message de réponse.</span><span class="sxs-lookup"><span data-stu-id="c5be6-143">The adapter returns the GUID (that is mapped to the TID) to the adapter client in the response message.</span></span>  
  
5.  <span data-ttu-id="c5be6-144">Le client de l’adaptateur appelle l’opération RfcConfirmTransID sur la carte avec le GUID retourné à l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="c5be6-144">The adapter client invokes the RfcConfirmTransID operation on the adapter with the GUID returned in the previous step.</span></span>  
  
6.  <span data-ttu-id="c5be6-145">L’adaptateur utilise le GUID dans le message de demande RfcConfirmTransID pour identifier le TID SAP et confirme que l’appel de tRFC sur le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-145">The adapter uses the GUID in the RfcConfirmTransID request message to identify the SAP TID and confirms the tRFC call on the SAP system.</span></span> <span data-ttu-id="c5be6-146">Cela entraîne le serveur SAP afin de supprimer l’entrée TID sa base de données.</span><span class="sxs-lookup"><span data-stu-id="c5be6-146">This causes the SAP server to delete the TID entry from its database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5be6-147">appels du client tRFC ne retournent pas de paramètres d’exportation ou de modification.</span><span class="sxs-lookup"><span data-stu-id="c5be6-147">tRFC client calls do not return EXPORT or CHANGING parameters.</span></span>  
  
 <span data-ttu-id="c5be6-148">Pour plus d’informations sur :</span><span class="sxs-lookup"><span data-stu-id="c5be6-148">For more information about:</span></span>  
  
-   <span data-ttu-id="c5be6-149">Appel d’un tRFC à l’aide de BizTalk Server, consultez [appeler tRFCs dans SAP à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-biztalk-server.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-149">Invoking a tRFC using BizTalk Server, see [Invoke tRFCs in SAP using BizTalk Server](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="c5be6-150">Appel d’un tRFC à l’aide du modèle de service WCF, consultez [appeler tRFCs dans SAP à l’aide du modèle de Service WCF](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-the-wcf-service-model.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-150">Invoking a tRFC using the WCF service model, see [Invoke tRFCs in SAP using the WCF Service Model](../../adapters-and-accelerators/adapter-sap/invoke-trfcs-in-sap-using-the-wcf-service-model.md).</span></span>  
  
-   <span data-ttu-id="c5be6-151">Structures et action SOAP pour appeler un tRFC des messages, consultez [des schémas de Message pour des opérations tRFC](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-151">Message structures and SOAP action for invoking a tRFC, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="receiving-inbound-transactional-rfc-calls-from-an-sap-system"></a><span data-ttu-id="c5be6-152">Appels entrants RFC transactionnelle réception à partir d’un système SAP</span><span class="sxs-lookup"><span data-stu-id="c5be6-152">Receiving Inbound Transactional RFC Calls from an SAP System</span></span>  
 <span data-ttu-id="c5be6-153">Vous pouvez utiliser l’adaptateur comme un serveur tRFC pour recevoir des tRFCs à partir de SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-153">You can use the adapter as a tRFC server to receive tRFCs from SAP.</span></span> <span data-ttu-id="c5be6-154">En tant que tRFC serveur, lorsque l’adaptateur reçoit un tRFC, appelle l’opération tRFC correspondante sur votre application.</span><span class="sxs-lookup"><span data-stu-id="c5be6-154">As a tRFC server, when the adapter receives a tRFC, it invokes the corresponding tRFC operation on your application.</span></span> <span data-ttu-id="c5be6-155">L’adaptateur prend en charge les fonctionnalités suivantes lorsqu’il agit comme un serveur tRFC :</span><span class="sxs-lookup"><span data-stu-id="c5be6-155">The adapter supports the following functionality when it acts as a tRFC server:</span></span>  
  
-   <span data-ttu-id="c5be6-156">Un LUW (identifiée par un TID SAP) peut contenir plusieurs tRFCs (RFC appels).</span><span class="sxs-lookup"><span data-stu-id="c5be6-156">An LUW (identified by a SAP TID) can contain multiple tRFCs (RFC calls).</span></span>  
  
-   <span data-ttu-id="c5be6-157">L’adaptateur crée une transaction validable pour chaque TID SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-157">The adapter creates a committable transaction for each SAP TID.</span></span> <span data-ttu-id="c5be6-158">Code de votre application peut s’inscrire dans cette transaction.</span><span class="sxs-lookup"><span data-stu-id="c5be6-158">Your application code can enlist in this transaction.</span></span>  
  
-   <span data-ttu-id="c5be6-159">La validation et restauration sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="c5be6-159">Commit and roll back are supported.</span></span>  
  
 <span data-ttu-id="c5be6-160">Le reste de cette section fournit des informations générales sur l’utilisation de l’adaptateur comme un serveur tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-160">The rest of this section provides general information about using the adapter as a tRFC server.</span></span> <span data-ttu-id="c5be6-161">Pour plus d’informations sur :</span><span class="sxs-lookup"><span data-stu-id="c5be6-161">For more specific information about:</span></span>  
  
-   <span data-ttu-id="c5be6-162">Réception d’un tRFC entrant appels à l’aide de BizTalk Server, reportez-vous à la section [tRFC de réception entrant appels à partir de SAP à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-from-sap-using-biztalk-server.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-162">Receiving a inbound tRFC calls using BizTalk Server, see [Receive Inbound tRFC Calls from SAP using BizTalk Server](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-from-sap-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="c5be6-163">Recevoir un tRFC entrant appels à l’aide du modèle de service WCF, reportez-vous à la section [tRFC de réception entrant appelle dans SAP à l’aide du modèle de Service WCF](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-in-sap-using-the-wcf-service-model.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-163">Receiving a inbound tRFC calls using the WCF service model, see [Receive Inbound tRFC Calls in SAP using the WCF Service Model](../../adapters-and-accelerators/adapter-sap/receive-inbound-trfc-calls-in-sap-using-the-wcf-service-model.md).</span></span>  
  
### <a name="the-tid-database"></a><span data-ttu-id="c5be6-164">La base de données TID</span><span class="sxs-lookup"><span data-stu-id="c5be6-164">The TID Database</span></span>  
 <span data-ttu-id="c5be6-165">Lorsqu’il agit comme un serveur tRFC, l’adaptateur utilise une base de données SQL Server, la base de données TID — pour gérer la transaction ID qu’il reçoit à partir du système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-165">When it acts as a tRFC server, the adapter uses a SQL Server database—the TID database—to manage the transaction IDs that it receives from the SAP system.</span></span> <span data-ttu-id="c5be6-166">Par exemple, il utilise la base de données TID pour aider à gérer les appels à partir du système SAP pour la validation, la restauration, et confirmer le TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-166">For example, it uses the TID database to help manage calls from the SAP system to commit, rollback, and confirm the TID.</span></span> <span data-ttu-id="c5be6-167">L’adaptateur stocke également le GUID qu’il crée et associe chaque TID SAP dans la base de données TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-167">The adapter also stores the GUID that it creates and associates with each SAP TID in the TID database.</span></span>  
  
### <a name="prerequisites"></a><span data-ttu-id="c5be6-168">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="c5be6-168">Prerequisites</span></span>  
 <span data-ttu-id="c5be6-169">Pour l’adaptateur comme un serveur tRFC, vous devez vous assurer que les conditions suivantes sont remplies :</span><span class="sxs-lookup"><span data-stu-id="c5be6-169">For the adapter to perform as a tRFC server, you must ensure that the following are true:</span></span>  
  
-   <span data-ttu-id="c5be6-170">Le document RFC doit être déclaré dans le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-170">The RFC must be declared on the SAP system.</span></span> <span data-ttu-id="c5be6-171">Il s’agit donc de l’adaptateur peut récupérer les métadonnées qui décrivent la RFC à partir du système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-171">This is so the adapter can retrieve metadata that describes the RFC from the SAP system.</span></span> <span data-ttu-id="c5be6-172">Le document RFC est réellement implémenté dans votre application.</span><span class="sxs-lookup"><span data-stu-id="c5be6-172">The RFC is actually implemented in your application.</span></span>  
  
-   <span data-ttu-id="c5be6-173">L’adaptateur doit inscrire avec une destination RFC sur la passerelle SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-173">The adapter must register with an RFC destination on an SAP gateway.</span></span> <span data-ttu-id="c5be6-174">L’inscription est basée sur un nom logique est appelé un ID de programme.</span><span class="sxs-lookup"><span data-stu-id="c5be6-174">The registration is based on a logical name called a program ID.</span></span> <span data-ttu-id="c5be6-175">Spécifier des paramètres dans l’URI de connexion pour spécifier l’ID de programme, passerelle SAP et le serveur SAP pour cet enregistrement.</span><span class="sxs-lookup"><span data-stu-id="c5be6-175">You supply parameters in the connection URI to specify the program ID, SAP gateway, and SAP server for this registration.</span></span>  
  
-   <span data-ttu-id="c5be6-176">La base de données TID doit être créée dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c5be6-176">The TID database must be created in SQL Server.</span></span> <span data-ttu-id="c5be6-177">Pour ce faire, vous devez exécuter un script SQL qui est installé par le programme d’installation.</span><span class="sxs-lookup"><span data-stu-id="c5be6-177">To do this, you must run a SQL script that is installed by the setup.</span></span> <span data-ttu-id="c5be6-178">Le script SQL est généralement installé sur \<lecteur d’installation\>: \Program Files\Microsoft [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5be6-178">The SQL script is typically installed at \<installation drive\>:\Program Files\Microsoft [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="c5be6-179">Pour plus d’informations, consultez [l’installation de BizTalk Adapter Pack](http://msdn.microsoft.com/library/2ae27db5-b11b-42c3-a568-e2331badf80e).</span><span class="sxs-lookup"><span data-stu-id="c5be6-179">For more information see, [Installing the BizTalk Adapter Pack](http://msdn.microsoft.com/library/2ae27db5-b11b-42c3-a568-e2331badf80e).</span></span>  
  
-   <span data-ttu-id="c5be6-180">Le **TidDatabaseConnectionString** liaison de la propriété doit être définie sur la chaîne de connexion de base de données SQL pour la base de données TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-180">The **TidDatabaseConnectionString** binding property must be set to the SQL database connection string for the TID database.</span></span> <span data-ttu-id="c5be6-181">Pour plus d’informations sur la **TidDatabaseConnectionString** liaison de propriété, consultez [en savoir plus sur l’adaptateur BizTalk pour les propriétés de liaison mySAP Business Suite](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-181">For more information about the **TidDatabaseConnectionString** binding property, see [Read about BizTalk Adapter for mySAP Business Suite binding properties](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5be6-182">Définition de la **TidDatabaseConnectionString** propriété de liaison configure l’adaptateur pour agir comme un serveur tRFC plutôt que comme un serveur RFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-182">Setting the **TidDatabaseConnectionString** binding property configures the adapter to act as a tRFC server rather than as an RFC server.</span></span> <span data-ttu-id="c5be6-183">Si le **TidDatabaseConnectionString** liaison de la propriété est définie et vous spécifiez une destination RFC dans l’URI de connexion, l’adaptateur fait Office de serveur pour les appels entrants à partir de la destination RFC tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-183">If the **TidDatabaseConnectionString** binding property is set and you specify an RFC destination in the connection URI, the adapter acts as a tRFC server for incoming calls from the RFC destination.</span></span> <span data-ttu-id="c5be6-184">Si cette propriété de liaison n’est pas définie, l’adaptateur agit comme un serveur RFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-184">If this binding property is not set, the adapter acts as an RFC server.</span></span>  
  
### <a name="how-the-adapter-processes-inbound-trfcs"></a><span data-ttu-id="c5be6-185">Comment le tRFCs entrant des processus d’adaptateur</span><span class="sxs-lookup"><span data-stu-id="c5be6-185">How the Adapter Processes Inbound tRFCs</span></span>  
 <span data-ttu-id="c5be6-186">Les étapes suivantes récapitulent les tâches qui sont effectuées par l’appel de client RFC à l’aide du [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5be6-186">The following steps summarize the tasks that are performed by the RFC client call using the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)].</span></span> <span data-ttu-id="c5be6-187">Certaines de ces étapes sont effectuées par le client de carte, et certaines sont effectuées par l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="c5be6-187">Some of these steps are performed by the adapter client, and some are performed by the adapter.</span></span>  
  
1.  <span data-ttu-id="c5be6-188">Les appels du système SAP dans l’adaptateur pour demander si un TID a déjà été utilisé.</span><span class="sxs-lookup"><span data-stu-id="c5be6-188">The SAP system calls into the adapter to enquire whether a TID has already been used.</span></span> <span data-ttu-id="c5be6-189">L’adaptateur renvoie la réponse appropriée au système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-189">The adapter returns the appropriate response to the SAP system.</span></span> <span data-ttu-id="c5be6-190">Si le TID est nouveau, l’adaptateur crée une transaction validable.</span><span class="sxs-lookup"><span data-stu-id="c5be6-190">If the TID is new, the adapter creates a committable transaction.</span></span> <span data-ttu-id="c5be6-191">Cette opération permet de conserver le TID à la base de données TID de façon transactionnelle lorsque le programme SAP effectue une validation (COMMIT WORK).</span><span class="sxs-lookup"><span data-stu-id="c5be6-191">This transaction is used to persist the TID to the TID database in a transactional manner when the SAP program performs a commit (COMMIT WORK).</span></span> <span data-ttu-id="c5be6-192">Il est également exposé au code d’application qui gère le trafic entrant tRFCs.</span><span class="sxs-lookup"><span data-stu-id="c5be6-192">It is also exposed to application code that handles the inbound tRFCs.</span></span> <span data-ttu-id="c5be6-193">En outre, l’adaptateur crée un GUID il associe le TID SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-193">Additionally, the adapter creates a GUID that it associates with the SAP TID.</span></span>  
  
2.  <span data-ttu-id="c5be6-194">Le système SAP envoie un ou plusieurs RFC transactionnelles à l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="c5be6-194">The SAP system sends one or more transactional RFCs to the adapter.</span></span> <span data-ttu-id="c5be6-195">Pour chaque tRFC, l’adaptateur appelle l’opération tRFC approprié sur votre application.</span><span class="sxs-lookup"><span data-stu-id="c5be6-195">For each tRFC, the adapter invokes the appropriate tRFC operation on your application.</span></span> <span data-ttu-id="c5be6-196">L’adaptateur transmet la transaction créée à l’étape 1 à votre application pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="c5be6-196">The adapter flows the transaction created in step 1 to your application for each operation.</span></span> <span data-ttu-id="c5be6-197">L’adaptateur transmet le GUID créé à l’étape 1 dans le message de demande pour l’opération.</span><span class="sxs-lookup"><span data-stu-id="c5be6-197">The adapter passes the GUID created in step 1 in the request message for the operation.</span></span>  
  
3.  <span data-ttu-id="c5be6-198">Système SAP valide le LUW (COMMIT WORK).</span><span class="sxs-lookup"><span data-stu-id="c5be6-198">SAP system commits the LUW (COMMIT WORK).</span></span> <span data-ttu-id="c5be6-199">L’adaptateur tente de valider la transaction avec le TID SAP (créé à l’étape 1).</span><span class="sxs-lookup"><span data-stu-id="c5be6-199">The adapter tries to commit the transaction associated with the SAP TID (created in step 1).</span></span>  
  
    1.  <span data-ttu-id="c5be6-200">Si la transaction est abandonnée (par votre application) au cours d’un des appels à l’étape 2, une erreur se produit lorsque l’adaptateur tente de valider la transaction.</span><span class="sxs-lookup"><span data-stu-id="c5be6-200">If the transaction was aborted (by your application) during any of the calls in step 2, then an error occurs when the adapter tries to commit the transaction.</span></span> <span data-ttu-id="c5be6-201">L’erreur est retournée à SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-201">The error is returned to SAP.</span></span> <span data-ttu-id="c5be6-202">Passez à l’étape 4.</span><span class="sxs-lookup"><span data-stu-id="c5be6-202">Go to step 4.</span></span>  
  
    2.  <span data-ttu-id="c5be6-203">Si la validation est réussie, le TID est désormais dans la base de données TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-203">If the commit is successful, the TID is now in the TID database.</span></span> <span data-ttu-id="c5be6-204">Passez à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="c5be6-204">Go to step 5.</span></span>  
  
4.  <span data-ttu-id="c5be6-205">Si une erreur s’est produite dans l’étape 3, ou si SAP est restaurée LUW (RESTART_OF_BACKGROUNDTASK) au lieu de sa validation, l’adaptateur annule la transaction.</span><span class="sxs-lookup"><span data-stu-id="c5be6-205">If an error occurred in step 3, or if SAP rolls back the LUW (RESTART_OF_BACKGROUNDTASK) instead of committing it, the adapter rolls back the transaction.</span></span> <span data-ttu-id="c5be6-206">Dans ce cas le TID n’est jamais enregistré sur la base de données TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-206">In this case the TID is never persisted to the TID database.</span></span>  
  
5.  <span data-ttu-id="c5be6-207">Le système SAP confirme le TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-207">The SAP system confirms the TID.</span></span> <span data-ttu-id="c5be6-208">L’adaptateur supprime le TID de la base de données TID (en supposant que l’étape 3 s’est terminée avec succès et le TID existe dans la base de données TID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-208">The adapter removes the TID from the TID database (assuming that step 3 completed successfully and the TID exists in the TID database.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5be6-209">Si une erreur se produit, essayez de vous connecter à la base de données TID pendant une opération de serveur tRFC, un code d’erreur indiquant que l’appel entrant à partir de SAP n'a pas été traitée par le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] est retournée à SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-209">If an error occurs attempting to connect to the TID Database during a tRFC server operation, an error code indicating that the incoming call from SAP was not processed by the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] is returned to SAP.</span></span>  
  
### <a name="receiving-idocs-as-a-trfc-server"></a><span data-ttu-id="c5be6-210">Recevoir des IDOC comme serveur tRFC</span><span class="sxs-lookup"><span data-stu-id="c5be6-210">Receiving IDOCs as a tRFC server</span></span>  
 <span data-ttu-id="c5be6-211">Vous utilisez la [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] comme un serveur RFC ou un serveur tRFC pour recevoir des IDOC à partir du système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-211">You use the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] as either an RFC server or a tRFC server to receive IDOCs from the SAP system.</span></span> <span data-ttu-id="c5be6-212">Dans les deux cas, vous devez définir le **ReceiveIdocFormat** liaison de propriété pour spécifier le format dans lequel l’adaptateur doit émettre les données IDOC à votre application.</span><span class="sxs-lookup"><span data-stu-id="c5be6-212">In either case, you must set the **ReceiveIdocFormat** binding property to specify the format in which the adapter should emit the IDOC data to your application.</span></span> <span data-ttu-id="c5be6-213">Pour plus d’informations sur la réception IDOC avec l’adaptateur, consultez [opérations sur IDOC dans SAP](../../adapters-and-accelerators/adapter-sap/operations-on-idocs-in-sap.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-213">For more information about receiving IDOCs with the adapter, see [Operations on IDOCs in SAP](../../adapters-and-accelerators/adapter-sap/operations-on-idocs-in-sap.md).</span></span> <span data-ttu-id="c5be6-214">Pour plus d’informations sur la [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] propriétés de liaison, consultez [en savoir plus sur l’adaptateur BizTalk pour les propriétés de liaison mySAP Business Suite](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-214">For more information about the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] binding properties, see [Read about BizTalk Adapter for mySAP Business Suite binding properties](../../adapters-and-accelerators/adapter-sap/read-about-biztalk-adapter-for-mysap-business-suite-binding-properties.md).</span></span>  
  
## <a name="special-trfc-operations"></a><span data-ttu-id="c5be6-215">Opérations tRFC spécial</span><span class="sxs-lookup"><span data-stu-id="c5be6-215">Special tRFC Operations</span></span>  
 <span data-ttu-id="c5be6-216">Le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] peut également effectuer certaines opérations tRFC spéciale sur le système SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-216">The [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] can also perform certain special tRFC operations on the SAP system.</span></span> <span data-ttu-id="c5be6-217">Une telle opération est RfcConfirmTransID.</span><span class="sxs-lookup"><span data-stu-id="c5be6-217">One such operation is RfcConfirmTransID.</span></span>  
  
-   <span data-ttu-id="c5be6-218">**RfcConfirmTransID.**</span><span class="sxs-lookup"><span data-stu-id="c5be6-218">**RfcConfirmTransID.**</span></span> <span data-ttu-id="c5be6-219">Vous appelez cette opération sur le [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] pour confirmer les appels tRFC effectués sur le serveur SAP.</span><span class="sxs-lookup"><span data-stu-id="c5be6-219">You invoke this operation on the [!INCLUDE[adaptersap_short](../../includes/adaptersap-short-md.md)] to confirm tRFC calls made to the SAP server.</span></span> <span data-ttu-id="c5be6-220">RfcConfirmTransID peut être nécessaire dans les scénarios où l’adaptateur est utilisé pour envoyer l’IDOC au serveur SAP comme un tRFC.</span><span class="sxs-lookup"><span data-stu-id="c5be6-220">RfcConfirmTransID might be required in scenarios where the adapter is used to send IDOCs to the SAP server as a tRFC.</span></span> <span data-ttu-id="c5be6-221">L’opération n’est disponible sous la **TRFC** nœud lorsque vous utilisez la [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] et [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c5be6-221">The operation is available under the **TRFC** node when using the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] and [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  
  
 <span data-ttu-id="c5be6-222">Pour plus d’informations sur la structure de message et l’action SOAP pour l’opération RfcConfirmTransID, consultez [des schémas de Message pour des opérations tRFC](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span><span class="sxs-lookup"><span data-stu-id="c5be6-222">For more information about the message structure and SOAP action for the RfcConfirmTransID operation, see [Message Schemas for tRFC Operations](../../adapters-and-accelerators/adapter-sap/message-schemas-for-trfc-operations.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5be6-223">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c5be6-223">See Also</span></span>  
 [<span data-ttu-id="c5be6-224">Se connecter à un système SAP à l’aide de l’adaptateur</span><span class="sxs-lookup"><span data-stu-id="c5be6-224">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)