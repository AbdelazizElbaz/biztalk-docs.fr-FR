---
title: "Considérations relatives à la réception de Notifications de requête à l’aide de l’adaptateur SQL | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 0142f385-3d55-41a7-a50e-dda94b96d0a4
caps.latest.revision: "7"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 20bb7019a993e47137ec2e4f71334c5b6b3f663c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="considerations-for-receiving-query-notifications-using-the-sql-adapter"></a><span data-ttu-id="f59a7-102">Considérations relatives à la réception de Notifications de requête à l’aide de l’adaptateur SQL</span><span class="sxs-lookup"><span data-stu-id="f59a7-102">Considerations for Receiving Query Notifications Using the SQL adapter</span></span>
<span data-ttu-id="f59a7-103">Cette rubrique fournit quelques considérations et les meilleures pratiques à prendre en compte lors de l’utilisation du [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] pour recevoir des notifications de requête à partir d’une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f59a7-103">This topic provides some considerations and best practices to keep in mind while using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive query notifications from a SQL Server database.</span></span>  
  
## <a name="considerations-while-using-the-adapter-to-receive-notifications"></a><span data-ttu-id="f59a7-104">Considérations lors de l’utilisation de l’adaptateur pour recevoir des Notifications</span><span class="sxs-lookup"><span data-stu-id="f59a7-104">Considerations While Using the Adapter to Receive Notifications</span></span>  
 <span data-ttu-id="f59a7-105">Vous devez prendre en compte les éléments suivants lors de l’utilisation du [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] pour recevoir des notifications de requête :</span><span class="sxs-lookup"><span data-stu-id="f59a7-105">You must consider the following while using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive query notifications:</span></span>  
  
-   <span data-ttu-id="f59a7-106">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] reçoit la notification de requête à partir de SQL Server, puis transmet simplement sur la notification pour les clients de la carte.</span><span class="sxs-lookup"><span data-stu-id="f59a7-106">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] receives the query notification from SQL Server, and then simply passes on the notification to the adapter clients.</span></span> <span data-ttu-id="f59a7-107">L’adaptateur ne distingue pas les notifications pour différentes opérations (par exemple, l’adaptateur n’a pas d’informations si une notification spécifique s’applique à une opération d’insertion ou d’une opération de mise à jour).</span><span class="sxs-lookup"><span data-stu-id="f59a7-107">The adapter does not distinguish between the notifications for different operations (i.e., the adapter does not have any information whether a particular notification is for an Insert operation or an Update operation).</span></span>  
  
-   <span data-ttu-id="f59a7-108">Le message de notification pour une opération n’est pas affecté par le nombre d’enregistrements concernés par cette opération.</span><span class="sxs-lookup"><span data-stu-id="f59a7-108">The notification message for an operation is not affected by the number of records affected by that operation.</span></span> <span data-ttu-id="f59a7-109">Par exemple, quel que soit le nombre d’enregistrements insérés, mis à jour ou supprimées dans une table de base de données SQL Server, le client de l’adaptateur ne reçoit qu’un seul message de notification.</span><span class="sxs-lookup"><span data-stu-id="f59a7-109">For example, regardless of the number of records inserted, updated, or deleted in a SQL Server database table, the adapter client receives only one notification message.</span></span>  
  
-   <span data-ttu-id="f59a7-110">Nous recommandons que l’application cliente de carte contiennent la logique pour interpréter le type de notification reçue de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f59a7-110">We recommend that the adapter client application contain the logic to interpret the type of notification received from SQL Server.</span></span> <span data-ttu-id="f59a7-111">Le type de notification peut être déterminé en extrayant les informations à partir, le  **\<Info >** élément du message de notification a été reçue.</span><span class="sxs-lookup"><span data-stu-id="f59a7-111">The notification type can be determined by extracting the information from, the **\<Info>** element of the received notification message.</span></span> <span data-ttu-id="f59a7-112">Voici un exemple d’un message de notification reçu pour une opération d’insertion :</span><span class="sxs-lookup"><span data-stu-id="f59a7-112">Here’s an example of a notification message received for an Insert operation:</span></span>  
  
    ```  
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Insert</Info>  
      <Source>Data</Source>  
      <Type>Change</Type>  
    </Notification>  
    ```  
  
     <span data-ttu-id="f59a7-113">Notez la valeur dans la  **\<Info >** élément.</span><span class="sxs-lookup"><span data-stu-id="f59a7-113">Notice the value within the **\<Info>** element.</span></span> <span data-ttu-id="f59a7-114">Cette valeur fournit des informations sur l’opération pour laquelle le message de notification a été reçu.</span><span class="sxs-lookup"><span data-stu-id="f59a7-114">This value provides information on the operation for which the notification message was received.</span></span> <span data-ttu-id="f59a7-115">Votre application doit avoir les fonctionnalités pour extraire la valeur dans la  **\<Info >** élément, puis en fonction de la valeur, effectuez les tâches suivantes.</span><span class="sxs-lookup"><span data-stu-id="f59a7-115">Your application should have the functionality to extract the value within the **\<Info>** element and then based on the value, perform subsequent tasks.</span></span> <span data-ttu-id="f59a7-116">La rubrique [traiter les Messages de Notification pour effectuer des tâches spécifiques dans SQL à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md) contient des instructions sur la façon d’extraire la valeur dans la  **\<Info >** élément.</span><span class="sxs-lookup"><span data-stu-id="f59a7-116">The topic [Process Notification Messages to complete Specific Tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md) has instructions on how to extract the value within the **\<Info>** element.</span></span> <span data-ttu-id="f59a7-117">Un didacticiel détaillé qui effectue des tâches similaires est également disponible à l’adresse [didacticiel 2 : employé - processus de bon de commande à l’aide de l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f59a7-117">A detailed tutorial that performs similar tasks is also available at [Tutorial 2: Employee - Purchase Order Process using the SQL adapter](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span></span>  
  
-   <span data-ttu-id="f59a7-118">Dans l’idéal, une fois que l’application cliente reçoit une notification pour un enregistrement spécifique, cet enregistrement doit être mis à jour afin que les notifications supplémentaires ne sont pas reçues.</span><span class="sxs-lookup"><span data-stu-id="f59a7-118">Ideally, after the client application receives a notification for a specific record, that record should be updated so that additional notifications are not received.</span></span> <span data-ttu-id="f59a7-119">Par exemple, considérez un **employé** table qui a un **état** colonne.</span><span class="sxs-lookup"><span data-stu-id="f59a7-119">For example, consider an **Employee** table that has a **Status** column.</span></span> <span data-ttu-id="f59a7-120">Pour tous les nouveaux enregistrements insérés dans le **employé** table, la valeur de la **état** colonne est toujours « 0 » et la table ressemblera à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="f59a7-120">For all new records inserted into the **Employee** table, the value in the **Status** column is always “0” so the table will look like the following:</span></span>  
  
    |<span data-ttu-id="f59a7-121">Nom de l’employé</span><span class="sxs-lookup"><span data-stu-id="f59a7-121">Employee Name</span></span>|<span data-ttu-id="f59a7-122">État</span><span class="sxs-lookup"><span data-stu-id="f59a7-122">Status</span></span>|  
    |-------------------|------------|  
    |<span data-ttu-id="f59a7-123">John</span><span class="sxs-lookup"><span data-stu-id="f59a7-123">John</span></span>|<span data-ttu-id="f59a7-124">0</span><span class="sxs-lookup"><span data-stu-id="f59a7-124">0</span></span>|  
  
     <span data-ttu-id="f59a7-125">Pour recevoir des notifications pour l’enregistrement inséré, le client de carte définira la **NotificatonStatement** de la propriété de liaison :</span><span class="sxs-lookup"><span data-stu-id="f59a7-125">To receive notifications for the newly inserted record, the adapter client will set the **NotificatonStatement** binding property as:</span></span>  
  
    ```  
    SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0  
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="f59a7-126">Vous devez spécifiquement spécifier les noms de colonnes dans l’instruction comme indiqué dans cette instruction de sélection.</span><span class="sxs-lookup"><span data-stu-id="f59a7-126">You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="f59a7-127">En outre, vous devez toujours spécifier le nom de table, ainsi que le nom du schéma.</span><span class="sxs-lookup"><span data-stu-id="f59a7-127">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="f59a7-128">Par exemple, dbo. Employé.</span><span class="sxs-lookup"><span data-stu-id="f59a7-128">For example, dbo.Employee.</span></span>  
  
     <span data-ttu-id="f59a7-129">Après avoir reçu la notification, l’application cliente doit réinitialiser la valeur de la **état** colonne sur « 1 » afin que l’instruction de notification ne fonctionne pas à nouveau sur l’enregistrement.</span><span class="sxs-lookup"><span data-stu-id="f59a7-129">After receiving the notification, the client application must reset the value of the **Status** column to “1” so that the notification statement does not operate on the record again.</span></span> <span data-ttu-id="f59a7-130">Pour ce faire, l’application cliente doit effectuer une opération de mise à jour sur le **employé** table.</span><span class="sxs-lookup"><span data-stu-id="f59a7-130">To achieve this, the client application must perform an Update operation on the **Employee** table.</span></span> <span data-ttu-id="f59a7-131">Après l’opération de mise à jour, le même enregistrement dans le **employé** table doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="f59a7-131">After the Update operation, the same record in the **Employee** table will look like the following:</span></span>  
  
    |<span data-ttu-id="f59a7-132">Nom de l’employé</span><span class="sxs-lookup"><span data-stu-id="f59a7-132">Employee Name</span></span>|<span data-ttu-id="f59a7-133">État</span><span class="sxs-lookup"><span data-stu-id="f59a7-133">Status</span></span>|  
    |-------------------|------------|  
    |<span data-ttu-id="f59a7-134">John</span><span class="sxs-lookup"><span data-stu-id="f59a7-134">John</span></span>|<span data-ttu-id="f59a7-135">1</span><span class="sxs-lookup"><span data-stu-id="f59a7-135">1</span></span>|  
  
     <span data-ttu-id="f59a7-136">Chose intéressante, l’opération de mise à jour à nouveau envoie une notification au client de carte et l’ensemble du processus est répété à nouveau, par conséquent, l’application cliente doit avoir la logique nécessaire pour ignorer ces notifications inutiles.</span><span class="sxs-lookup"><span data-stu-id="f59a7-136">Interestingly, the Update operation will again send a notification to the adapter client and the whole process will be repeated again, therefore, the client application must have the required logic to discard such unwanted notifications.</span></span>  
  
-   <span data-ttu-id="f59a7-137">Si le **NotifyOnListenerStart** liaison de la propriété a la valeur true, le client de l’adaptateur reçoit un message de notification chaque fois que l’emplacement de réception démarre.</span><span class="sxs-lookup"><span data-stu-id="f59a7-137">If the **NotifyOnListenerStart** binding property is true, the adapter client will receive a notification message every time the receive location starts.</span></span> <span data-ttu-id="f59a7-138">Pour plus d’informations sur la façon d’utiliser la propriété de liaison et d’interpréter le message de notification, consultez [de réception requête Notifications après une réception emplacement répartition dans SQL à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-query-notifications-after-a-sql-receive-location-stops-in-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="f59a7-138">For more information on how to use the binding property and interpret the notification message, see [Receive Query Notifications After a Receive Location Breakdown in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-query-notifications-after-a-sql-receive-location-stops-in-biztalk.md).</span></span>  
  
## <a name="typical-orchestration-for-receiving-notifications"></a><span data-ttu-id="f59a7-139">Orchestration classique pour recevoir des Notifications</span><span class="sxs-lookup"><span data-stu-id="f59a7-139">Typical Orchestration for Receiving Notifications</span></span>  
 <span data-ttu-id="f59a7-140">Cette section décrit le flux typique d’orchestration pour recevoir des notifications à l’aide de la [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f59a7-140">This section outlines the typical orchestration flow for receiving notifications using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span>  
  
1.  <span data-ttu-id="f59a7-141">La première chose que l’orchestration doit effectuer consiste à déterminer le type de notification reçue, y compris :</span><span class="sxs-lookup"><span data-stu-id="f59a7-141">The first thing that the orchestration must do is to determine the type of notification received, including:</span></span>  
  
    -   <span data-ttu-id="f59a7-142">Indique si la notification a été reçue après redémarrage d’un emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="f59a7-142">Whether the notification was received after a receive location restarts.</span></span>  
  
    -   <span data-ttu-id="f59a7-143">Si la notification a été reçue pour une opération sur une table de base de données, telles que Insert, Update ou Delete.</span><span class="sxs-lookup"><span data-stu-id="f59a7-143">Whether the notification was received for an operation on a database table, such as Insert, Update, or Delete.</span></span>  
  
     <span data-ttu-id="f59a7-144">L’orchestration doit inclure un **Expression** forme et dans laquelle une requête xpath pour déterminer le type de message est reçu.</span><span class="sxs-lookup"><span data-stu-id="f59a7-144">The orchestration must include an **Expression** shape, and within that, an xpath query to decide what kind of message is received.</span></span>  
  
2.  <span data-ttu-id="f59a7-145">Après la notification de type est déterminé, l’orchestration doit inclure un bloc de décision pour effectuer des actions spécifiques en fonction du type de notification reçue.</span><span class="sxs-lookup"><span data-stu-id="f59a7-145">After the notification type is determined, the orchestration must include a decision block to perform specific actions based on the type of notification received.</span></span> <span data-ttu-id="f59a7-146">Pour ce faire, l’orchestration doit inclure un **décider** forme, qui inclut un **règle** bloc et un **Else** bloc :</span><span class="sxs-lookup"><span data-stu-id="f59a7-146">To achieve this, the orchestration must include a **Decide** shape, which includes a **Rule** block and an **Else** block:</span></span>  
  
    -   <span data-ttu-id="f59a7-147">Dans le **règle** bloc, vous devez spécifier la condition et ensuite inclure des formes d’orchestration pour effectuer certaines opérations si la condition est remplie.</span><span class="sxs-lookup"><span data-stu-id="f59a7-147">Within the **Rule** block, you must specify the condition and then include orchestration shapes to perform certain operations if the condition is met.</span></span>  
  
    -   <span data-ttu-id="f59a7-148">Dans le **Else** bloc, vous devez inclure des formes d’orchestration pour effectuer certaines opérations si la condition est *pas* remplie.</span><span class="sxs-lookup"><span data-stu-id="f59a7-148">Within the **Else** block, you must include orchestration shapes to perform certain operations if the condition is *not* met.</span></span>  
  
 <span data-ttu-id="f59a7-149">Détails de la configuration requise ci-dessus sont décrits dans [traiter les Messages de Notification pour effectuer des tâches spécifiques dans SQL à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="f59a7-149">Details of the preceding requirements are described in [Process Notification Messages to complete Specific Tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span></span> <span data-ttu-id="f59a7-150">Un didacticiel détaillé est également disponible dans [didacticiel 2 : employé - processus de bon de commande à l’aide de l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="f59a7-150">A detailed tutorial is also available in [Tutorial 2: Employee - Purchase Order Process using the SQL adapter](../../adapters-and-accelerators/adapter-sql/tutorial-2-employee-purchase-order-process-using-the-sql-adapter.md).</span></span>