---
title: "Recevoir des Notifications de requête par incréments de SQL à l’aide de BizTalk Server | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: a6972e01-80be-47be-986a-c2e4e0fb0cd1
caps.latest.revision: "21"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 62b6137964c493ae8dff3c0ab635a3145f2d9348
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="receive-query-notifications-incrementally-from-sql-using-biztalk-server"></a><span data-ttu-id="b2fc7-102">Recevoir des Notifications de requête par incréments de SQL à l’aide de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="b2fc7-102">Receive Query Notifications Incrementally from SQL using BizTalk Server</span></span>
> [!IMPORTANT]
>  <span data-ttu-id="b2fc7-103">Pour plus de concision, cette rubrique décrit uniquement comment recevoir des notifications de façon incrémentielle.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-103">For the sake of brevity, this topic only describes how to receive notifications incrementally.</span></span> <span data-ttu-id="b2fc7-104">Dans les scénarios d’entreprise, l’orchestration doit inclure dans l’idéal, de la logique permettant d’extraire le type de message de notification reçu, puis effectuez toutes les opérations suivantes.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-104">In business scenarios, the orchestration must ideally include the logic to extract the kind of notification message received and then perform any subsequent operations.</span></span> <span data-ttu-id="b2fc7-105">En d’autres termes, l’orchestration décrite dans cette rubrique doit être générée sur l’orchestration décrite dans [traiter les messages de notification pour effectuer des tâches spécifiques dans SQL à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-105">In other words, the orchestration described in this topic must be built on top of the orchestration described in [Process notification messages to complete specific tasks in SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/process-notification-messages-to-complete-specific-tasks-in-sql-using-biztalk.md).</span></span>  
  
 <span data-ttu-id="b2fc7-106">Cette rubrique montre comment configurer le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] pour recevoir des messages de notification de requête incrémentielle à partir d’une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-106">This topic demonstrates how to configure the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive incremental query notification messages from a SQL Server database.</span></span> <span data-ttu-id="b2fc7-107">Pour illustrer les notifications incrémentielles, considérez une table Employee, avec une colonne « État ».</span><span class="sxs-lookup"><span data-stu-id="b2fc7-107">To demonstrate incremental notifications, consider a table, Employee, with a “Status” column.</span></span> <span data-ttu-id="b2fc7-108">Lorsqu’un nouvel enregistrement est inséré à cette table, la valeur de la colonne d’état est définie sur 0.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-108">When a new record is inserted to this table, the value of the Status column is set to 0.</span></span> <span data-ttu-id="b2fc7-109">Vous pouvez configurer l’adaptateur pour recevoir des notifications incrémentielles en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-109">You can configure the adapter to receive incremental notifications by doing the following:</span></span>  
  
-   <span data-ttu-id="b2fc7-110">S’inscrire pour les notifications à l’aide d’une instruction SQL qui Récupère tous les enregistrements dont la colonne d’état en tant que 0.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-110">Register for notifications using a SQL statement that retrieves all records that have Status column as 0.</span></span> <span data-ttu-id="b2fc7-111">Vous pouvez le faire en spécifiant l’instruction SQL pour le **NotificationStatement** propriété de liaison.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-111">You can do so by specifying the SQL statement for the **NotificationStatement** binding property.</span></span>  
  
-   <span data-ttu-id="b2fc7-112">Pour les lignes pour la notification des messages ont été reçus, vous devez mettre à jour la colonne d’état à 1.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-112">For rows for which notification messages have been received, update the Status column to 1.</span></span>  
  
 <span data-ttu-id="b2fc7-113">Cette rubrique montre comment créer une orchestration BizTalk et de configurer une application BizTalk pour y parvenir.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-113">This topic demonstrates how to create a BizTalk orchestration and configure a BizTalk application to achieve this.</span></span>  
  
## <a name="configuring-notifications-with-the-sql-adapter-binding-properties"></a><span data-ttu-id="b2fc7-114">Configuration des Notifications à l’adaptateur SQL propriétés de liaison</span><span class="sxs-lookup"><span data-stu-id="b2fc7-114">Configuring Notifications with the SQL Adapter Binding Properties</span></span>  
 <span data-ttu-id="b2fc7-115">Le tableau suivant récapitule les [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] propriétés de liaison qui vous permet de configurer la réception des notifications à partir de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-115">The following table summarizes the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] binding properties that you use to configure receiving notifications from SQL Server.</span></span> <span data-ttu-id="b2fc7-116">Vous devez spécifier ces propriétés de liaison lors de la configuration du port de réception dans le [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] console d’Administration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-116">You must specify these binding properties while configuring the receive port in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b2fc7-117">Vous pouvez choisir de spécifier ces propriétés de liaison lors de la génération du schéma pour le **Notification** opération, même si elle n’est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-117">You may choose to specify these binding properties when generating the schema for the **Notification** operation, even though it is not mandatory.</span></span> <span data-ttu-id="b2fc7-118">Si vous procédez ainsi, la liaison du port de fichiers qui le [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] génère comme partie de la génération de métadonnées contient également les valeurs spécifiées pour les propriétés de liaison.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-118">If you do so, the port binding file that the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] generates as part of the metadata generation also contains the values you specify for the binding properties.</span></span> <span data-ttu-id="b2fc7-119">Vous pouvez importer ultérieurement ce fichier de liaison dans le [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] port de réception de la console Administration pour créer le WCF-custom ou WCF-SQL avec la liaison de propriétés déjà définies.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-119">You can later import this binding file in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to create the WCF-custom or WCF-SQL receive port with the binding properties already set.</span></span> <span data-ttu-id="b2fc7-120">Pour plus d’informations sur la création d’un port à l’aide du fichier de liaison, consultez [configurer une liaison de port physique à l’aide d’un fichier de liaison de port à utiliser l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-120">For more information about creating a port using the binding file, see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
|<span data-ttu-id="b2fc7-121">Propriété de liaison</span><span class="sxs-lookup"><span data-stu-id="b2fc7-121">Binding Property</span></span>|<span data-ttu-id="b2fc7-122"> Description</span><span class="sxs-lookup"><span data-stu-id="b2fc7-122">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="b2fc7-123">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-123">**InboundOperationType**</span></span>|<span data-ttu-id="b2fc7-124">Spécifie l’opération entrante que vous souhaitez effectuer.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-124">Specifies the inbound operation that you want to perform.</span></span> <span data-ttu-id="b2fc7-125">Pour recevoir des messages de notification, affectez la valeur **Notification**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-125">To receive notification messages, set this to **Notification**.</span></span>|  
|<span data-ttu-id="b2fc7-126">**NotificationStatement**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-126">**NotificationStatement**</span></span>|<span data-ttu-id="b2fc7-127">Spécifie l’instruction SQL (SELECT ou EXEC \<procédure stockée >) permet de s’inscrire aux notifications de requête.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-127">Specifies the SQL statement (SELECT or EXEC \<stored procedure>) used to register for query notifications.</span></span> <span data-ttu-id="b2fc7-128">L’adaptateur reçoit un message de notification de SQL Server que lorsque le jeu de résultats pour que les modifications d’instruction SQL spécifiées.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-128">The adapter gets a notification message from SQL Server only when the result set for the specified SQL statement changes.</span></span>|  
|<span data-ttu-id="b2fc7-129">**NotifyOnListenerStart**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-129">**NotifyOnListenerStart**</span></span>|<span data-ttu-id="b2fc7-130">Spécifie si l’adaptateur envoie une notification pour les clients de la carte au démarrage de l’écouteur.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-130">Specifies whether the adapter sends a notification to the adapter clients when the listener is started.</span></span>|  
  
 <span data-ttu-id="b2fc7-131">Pour obtenir une description plus complète de ces propriétés, consultez [en savoir plus sur l’adaptateur BizTalk pour les propriétés de liaison de l’adaptateur SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-131">For a more complete description of these properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <span data-ttu-id="b2fc7-132">Pour obtenir une description complète de l’utilisation de la [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] pour recevoir des notifications à partir de SQL Server, poursuivre la lecture.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-132">For a complete description of how to use the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive notifications from SQL Server, read further.</span></span>  
  
## <a name="how-this-topic-demonstrates-receiving-notification-messages"></a><span data-ttu-id="b2fc7-133">Comment cette rubrique illustre la réception de Messages de Notification</span><span class="sxs-lookup"><span data-stu-id="b2fc7-133">How This Topic Demonstrates Receiving Notification Messages</span></span>  
 <span data-ttu-id="b2fc7-134">Pour illustrer comment le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] prend en charge la réception de messages de notification à partir de SQL Server, cette rubrique va vous montrer comment configurer l’adaptateur pour recevoir des notifications de modifications apportées à une table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-134">To demonstrate how the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving notification messages from SQL Server, this topic will demonstrate how to configure the adapter to receive notifications for changes to an Employee table.</span></span> <span data-ttu-id="b2fc7-135">Supposons que la table Employee possède des colonnes Employee_ID, nom et l’état.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-135">Assume that the Employee table has columns Employee_ID, Name, and Status.</span></span> <span data-ttu-id="b2fc7-136">Chaque fois qu’un nouvel employé est ajouté, la valeur de la colonne d’état est définie sur 0.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-136">Whenever a new employee is added, the value of the Status column is set to 0.</span></span>  
  
 <span data-ttu-id="b2fc7-137">Pour illustrer la réception des notifications, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-137">To demonstrate receiving notifications, do the following:</span></span>  
  
-   <span data-ttu-id="b2fc7-138">Génération du schéma pour le **Notification** (opération entrante), et **sélectionnez** (opération sortante) sur la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-138">Generate schema for the **Notification** (inbound operation), and **Select** (outbound operation) on the Employee table.</span></span>  
  
-   <span data-ttu-id="b2fc7-139">Créer une orchestration qui a les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-139">Create an orchestration that has the following:</span></span>  
  
    -   <span data-ttu-id="b2fc7-140">Un emplacement de réception pour recevoir les messages de notification.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-140">A receive location to receive notification messages.</span></span> <span data-ttu-id="b2fc7-141">Vous pouvez configurer pour la notification en spécifiant l’instruction SELECT en tant que :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-141">You can configure for notification by specifying the SELECT statement as:</span></span>  
  
        ```  
        SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0  
        ```  
  
        > [!NOTE]
        >  <span data-ttu-id="b2fc7-142">Vous devez spécifiquement spécifier les noms de colonnes dans l’instruction comme indiqué dans cette instruction de sélection.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-142">You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="b2fc7-143">En outre, vous devez toujours spécifier le nom de table, ainsi que le nom du schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-143">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="b2fc7-144">Par exemple, `dbo.Employee`.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-144">For example, `dbo.Employee`.</span></span>  
  
    -   <span data-ttu-id="b2fc7-145">Un port d’envoi pour mettre à jour les lignes pour lesquelles des notifications a déjà été envoyée.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-145">A send port to update the rows for which notification has already been sent.</span></span> <span data-ttu-id="b2fc7-146">Pour faire en définissant la valeur dans la colonne État 1.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-146">You do so by setting the value in the Status column to 1.</span></span> <span data-ttu-id="b2fc7-147">Vous pouvez cela dans le cadre de l’opération de sélection en envoyant le message suivant à l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-147">You can do this as part of the Select operation by sending the following message to the adapter.</span></span>  
  
        ```  
        <Select xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
          <Columns>Employee_ID,Name,Status</Columns>  
          <Query>where Status=0;UPDATE Employee SET Status=1 WHERE Status=0</Query>  
        </Select>  
        ```  
  
         <span data-ttu-id="b2fc7-148">Dans ce message, dans le cadre de la `<Query>` élément, vous spécifiez l’instruction de mise à jour pour mettre à jour la colonne d’état.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-148">In this message, as part of the `<Query>` element, you specify the UPDATE statement to update the Status column.</span></span> <span data-ttu-id="b2fc7-149">Notez que cette opération doit être exécutée après que réception de la notification des messages afin que les lignes traitées sont mis à jour.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-149">Note that this operation must be executed after receiving the notification messages so that the processed rows are updated.</span></span> <span data-ttu-id="b2fc7-150">Pour effectuer immédiatement avec la surcharge de la réponse de notification en attente et puis la supprimer manuellement un message de demande pour mettre à jour les lignes, vous allez générer le message de demande de mise à jour les lignes dans l’orchestration lui-même.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-150">To do away with the overhead of waiting to get the notification response and then manually dropping a request message to update the rows, you will generate the request message for updating the rows within the orchestration itself.</span></span> <span data-ttu-id="b2fc7-151">Vous pouvez le faire à l’aide de la **construire un Message** forme dans une orchestration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-151">You can do so by using the **Construct Message** shape within an orchestration.</span></span>  
  
## <a name="how-to-receive-notification-messages-from-the-sql-server-database"></a><span data-ttu-id="b2fc7-152">La réception des Messages de Notification à partir de la base de données SQL Server</span><span class="sxs-lookup"><span data-stu-id="b2fc7-152">How to Receive Notification Messages from the SQL Server Database</span></span>  
 <span data-ttu-id="b2fc7-153">Une opération sur la base de données SQL Server à l’aide [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] avec [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] implique les tâches de procédures décrites dans [blocs de construction pour développer des applications BizTalk à l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-153">Performing an operation on the SQL Server database using [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves the procedural tasks described in [Building blocks to develop BizTalk applications with the SQL adapter](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md).</span></span> <span data-ttu-id="b2fc7-154">Pour configurer l’adaptateur pour recevoir des messages de notification, ces tâches sont :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-154">To configure the adapter to receive notification messages, these tasks are:</span></span>  
  
1.  <span data-ttu-id="b2fc7-155">Créez un projet BizTalk, puis générer le schéma pour le **Notification** (opération entrante) et **sélectionnez** (opération sortante) sur la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-155">Create a BizTalk project, and then generate schema for the **Notification** (inbound operation) and **Select** (outbound operation) on the Employee table.</span></span> <span data-ttu-id="b2fc7-156">Si vous le souhaitez, vous pouvez spécifier des valeurs pour le **InboundOperationType** et **NotificationStatement** propriétés de liaison.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-156">Optionally, you can specify values for the **InboundOperationType** and **NotificationStatement** binding properties.</span></span>  
  
2.  <span data-ttu-id="b2fc7-157">Créez un message dans le projet BizTalk pour la réception des notifications de la base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-157">Create a message in the BizTalk project for receiving notification from the SQL Server database.</span></span>  
  
3.  <span data-ttu-id="b2fc7-158">Créer des messages dans le projet BizTalk pour effectuer les sélection d’informations sur la base de données SQL Server et de recevoir des messages de réponse.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-158">Create messages in the BizTalk project for performing the Select information on the SQL Server database and receiving response messages.</span></span>  
  
4.  <span data-ttu-id="b2fc7-159">Créer une orchestration qui effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-159">Create an orchestration that does the following:</span></span>  
  
    -   <span data-ttu-id="b2fc7-160">Reçoit le message de notification à partir de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-160">Receives notification message from SQL Server.</span></span>  
  
    -   <span data-ttu-id="b2fc7-161">Crée un message pour sélectionner et mettre à jour les lignes pour lesquelles la notification est reçue.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-161">Creates a message to select and update the rows for which notification is received.</span></span>  
  
    -   <span data-ttu-id="b2fc7-162">Envoie ce message à SQL Server pour mettre à jour les lignes et reçoit une réponse.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-162">Sends this message to the SQL Server to update the rows and receives a response.</span></span>  
  
5.  <span data-ttu-id="b2fc7-163">Générez et déployez le projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-163">Build and deploy the BizTalk project.</span></span>  
  
6.  <span data-ttu-id="b2fc7-164">Configurer l’application en créant physique d’envoi et ports de réception BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-164">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b2fc7-165">Pour les opérations entrantes, tels que la réception des messages de notification, vous devez configurer uniquement un WCF-Custom unidirectionnel ou port de réception WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-165">For inbound operations, like receiving notification messages, you must only configure a one-way WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="b2fc7-166">Ports de réception bidirectionnel WCF-Custom ou WCF-SQL ne sont pas pris en charge pour les opérations entrantes.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-166">Two-way WCF-Custom or WCF-SQL receive ports are not supported for inbound operations.</span></span>  
  
7.  <span data-ttu-id="b2fc7-167">Démarrez l’application BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-167">Start the BizTalk application.</span></span>  
  
 <span data-ttu-id="b2fc7-168">Cette rubrique fournit des instructions pour effectuer ces tâches.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-168">This topic provides instructions to perform these tasks.</span></span>  
  
## <a name="sample-based-on-this-topic"></a><span data-ttu-id="b2fc7-169">Exemple basé sur cette rubrique</span><span class="sxs-lookup"><span data-stu-id="b2fc7-169">Sample Based on This Topic</span></span>  
 <span data-ttu-id="b2fc7-170">Un exemple IncrementalNotification, en fonction de cette rubrique est fourni avec le [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2fc7-170">A sample, IncrementalNotification, based on this topic is provided with the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="b2fc7-171">Pour plus d’informations, consultez [exemples de l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-171">For more information, see [Samples for the SQL adapter](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md).</span></span>  
  
## <a name="generating-schema"></a><span data-ttu-id="b2fc7-172">Génération du schéma</span><span class="sxs-lookup"><span data-stu-id="b2fc7-172">Generating Schema</span></span>  
 <span data-ttu-id="b2fc7-173">Vous devez générer le schéma pour le **Notification** opération et **sélectionnez** opération sur la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-173">You must generate the schema for the **Notification** operation and **Select** operation on Employee table.</span></span> <span data-ttu-id="b2fc7-174">Consultez [obtenir les métadonnées pour les opérations de SQL Server dans Visual Studio à l’aide de l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md) pour plus d’informations sur la façon de générer le schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-174">See [Get metadata for SQL Server operations in Visual Studio using the SQL adapter](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md) for more information about how to generate the schema.</span></span> <span data-ttu-id="b2fc7-175">Effectuer les tâches suivantes lors de la génération du schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-175">Perform the following tasks when generating the schema.</span></span> <span data-ttu-id="b2fc7-176">Ignorer la première étape si vous ne souhaitez pas spécifier les propriétés de liaison au moment du design.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-176">Skip the first step if you do not want to specify the binding properties at design time.</span></span>  
  
1.  <span data-ttu-id="b2fc7-177">Spécifiez une valeur pour **InboundOperationType** et **NotificationStatement** propriétés de liaison lors de la génération du schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-177">Specify a value for **InboundOperationType** and **NotificationStatement** binding properties while generating the schema.</span></span> <span data-ttu-id="b2fc7-178">Pour plus d’informations sur cette propriété de liaison, consultez [en savoir plus sur l’adaptateur BizTalk pour les propriétés de liaison de l’adaptateur SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-178">For more information about this binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <span data-ttu-id="b2fc7-179">Pour obtenir des instructions sur la façon de spécifier les propriétés de liaison, consultez [configurer les propriétés de liaison de l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-179">For instructions on how to specify binding properties, see [Configure the binding properties for the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span></span>  
  
2.  <span data-ttu-id="b2fc7-180">Sélectionnez le type de contrat **Service (opérations entrantes)**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-180">Select the contract type as **Service (Inbound operations)**.</span></span>  
  
3.  <span data-ttu-id="b2fc7-181">Génération du schéma pour le **Notification** opération.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-181">Generate schema for the **Notification** operation.</span></span>  
  
4.  <span data-ttu-id="b2fc7-182">Sélectionnez le type de contrat **Client (Outbound operations)**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-182">Select the contract type as **Client (Outbound operations)**.</span></span>  
  
5.  <span data-ttu-id="b2fc7-183">Génération du schéma pour le **sélectionnez** opération sur **employé** table.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-183">Generate schema for the **Select** operation on **Employee** table.</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="b2fc7-184">Définition des Messages et les Types de messages</span><span class="sxs-lookup"><span data-stu-id="b2fc7-184">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="b2fc7-185">Le schéma que vous avez généré précédemment décrit les « types » requis pour les messages dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-185">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="b2fc7-186">Un message est généralement une variable, le type est défini par le schéma correspondant.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-186">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="b2fc7-187">Une fois que le schéma est généré, vous devez le lier aux messages à partir de la vue de l’Orchestration du projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-187">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  
  
 <span data-ttu-id="b2fc7-188">Cette rubrique, vous devez créer trois messages : un pour recevoir des notifications à partir de la base de données SQL Server, un pour effectuer l’opération de sélection et un pour recevoir la réponse pour l’opération de sélection.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-188">For this topic, you must create three messages—one to receive notifications from the SQL Server database, one to perform the Select operation, and one to receive the response for Select operation.</span></span>  
  
 <span data-ttu-id="b2fc7-189">Procédez comme suit pour créer des messages et les lier au schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-189">Perform the following steps to create messages and link them to schema.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="b2fc7-190">Pour créer des messages et le lier au schéma</span><span class="sxs-lookup"><span data-stu-id="b2fc7-190">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="b2fc7-191">Ajouter une orchestration au projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-191">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="b2fc7-192">À partir de l’Explorateur de solutions, cliquez sur le nom du projet BizTalk, pointez sur **ajouter**, puis cliquez sur **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-192">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="b2fc7-193">Tapez un nom pour l’orchestration BizTalk, puis **ajouter**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-193">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="b2fc7-194">Ouvrez la fenêtre Vue orchestration du projet BizTalk, s’il n’est pas déjà ouvert.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-194">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="b2fc7-195">Cliquez sur **vue**, pointez sur **autres fenêtres**, puis cliquez sur **Vue Orchestration**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-195">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="b2fc7-196">Dans le **Vue Orchestration**, avec le bouton droit **Messages**, puis cliquez sur **nouveau Message**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-196">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="b2fc7-197">Cliquez sur le message qui vient d’être créé, puis sélectionnez **fenêtre Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-197">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="b2fc7-198">Dans le **propriétés** volet pour **Message_1**, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-198">In the **Properties** pane for **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="b2fc7-199">Utiliser</span><span class="sxs-lookup"><span data-stu-id="b2fc7-199">Use this</span></span>|<span data-ttu-id="b2fc7-200">Pour effectuer cette opération</span><span class="sxs-lookup"><span data-stu-id="b2fc7-200">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="b2fc7-201">Identificateur</span><span class="sxs-lookup"><span data-stu-id="b2fc7-201">Identifier</span></span>|<span data-ttu-id="b2fc7-202">Tapez `NotifyReceive`.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-202">Type `NotifyReceive`.</span></span>|  
    |<span data-ttu-id="b2fc7-203">Type de message</span><span class="sxs-lookup"><span data-stu-id="b2fc7-203">Message Type</span></span>|<span data-ttu-id="b2fc7-204">Dans la liste déroulante, développez **schémas**, puis sélectionnez *SQLNotify.Notification*, où *SQLNotify* est le nom de votre projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-204">From the drop-down list, expand **Schemas**, and select *SQLNotify.Notification*, where *SQLNotify* is the name of your BizTalk project.</span></span> <span data-ttu-id="b2fc7-205">*Notification* est le schéma généré pour le **Notification** opération.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-205">*Notification* is the schema generated for the **Notification** operation.</span></span>|  
  
6.  <span data-ttu-id="b2fc7-206">Répétez l’étape 3 pour créer deux nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-206">Repeat step 3 to create two new messages.</span></span> <span data-ttu-id="b2fc7-207">Dans le **propriétés** volet pour le nouveau message, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-207">In the **Properties** pane for the new message, do the following:</span></span>  
  
    |<span data-ttu-id="b2fc7-208">Identificateur de la valeur</span><span class="sxs-lookup"><span data-stu-id="b2fc7-208">Set Identifier to</span></span>|<span data-ttu-id="b2fc7-209">Définissez le Type de Message</span><span class="sxs-lookup"><span data-stu-id="b2fc7-209">Set Message Type to</span></span>|  
    |-----------------------|-------------------------|  
    |<span data-ttu-id="b2fc7-210">Select</span><span class="sxs-lookup"><span data-stu-id="b2fc7-210">Select</span></span>|<span data-ttu-id="b2fc7-211">*SQLNotify.TableOperation_dbo_Employee.Select*, où *TableOperation_dbo_Employee* est le schéma généré pour le **sélectionnez** opération</span><span class="sxs-lookup"><span data-stu-id="b2fc7-211">*SQLNotify.TableOperation_dbo_Employee.Select*, where  *TableOperation_dbo_Employee* is the schema generated for the **Select** operation</span></span>|  
    |<span data-ttu-id="b2fc7-212">SelectResponse</span><span class="sxs-lookup"><span data-stu-id="b2fc7-212">SelectResponse</span></span>|<span data-ttu-id="b2fc7-213">*SQLNotify.TableOperation_dbo_Employee.SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-213">*SQLNotify.TableOperation_dbo_Employee.SelectResponse*</span></span>|  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="b2fc7-214">Configuration de l’Orchestration</span><span class="sxs-lookup"><span data-stu-id="b2fc7-214">Setting up the Orchestration</span></span>  
 <span data-ttu-id="b2fc7-215">Vous devez créer une orchestration BizTalk à utiliser [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] pour recevoir des messages de notification à partir de la base de données SQL Server et mise à jour des lignes pour lesquelles la notification a été reçue.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-215">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving notification messages from the SQL Server database and then updating the rows for which notification was received.</span></span> <span data-ttu-id="b2fc7-216">Dans cette orchestration, l’adaptateur reçoit le message de notification en fonction de l’instruction SELECT spécifiée pour le **NotificationStatement** propriété de liaison.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-216">In this orchestration, the adapter receives the notification message based on the SELECT statement specified for the **NotificationStatement** binding property.</span></span> <span data-ttu-id="b2fc7-217">Le message de notification est reçu au niveau d’un emplacement de fichier.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-217">The notification message is received at a FILE location.</span></span> <span data-ttu-id="b2fc7-218">Une fois que la réponse est reçue, l’orchestration génère un message qui sera utilisé pour mettre à jour les lignes pour lesquelles la notification est reçue.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-218">Once the response is received, the orchestration constructs a message that will be used to update the rows for which notification is received.</span></span> <span data-ttu-id="b2fc7-219">La réponse de ce message est reçue également au même emplacement de fichier.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-219">The response for this message is also received at the same FILE location.</span></span>  
  
 <span data-ttu-id="b2fc7-220">Par conséquent, l’orchestration doit contenir les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-220">So, your orchestration must contain the following:</span></span>  
  
-   <span data-ttu-id="b2fc7-221">Port pour recevoir des messages de notification de réception unidirectionnel.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-221">A one-way receive port to receive notification messages.</span></span>  
  
-   <span data-ttu-id="b2fc7-222">Pour envoyer des messages pour mettre à jour des lignes et de recevoir de réponse pour le même port d’envoi bidirectionnel.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-222">A two-way send port to send messages to update rows and receive response for the same.</span></span>  
  
-   <span data-ttu-id="b2fc7-223">A **construire un Message** forme pour construire des messages, pour exécuter l’opération de mise à jour, dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-223">A **Construct Message** shape to construct messages, to execute the Update operation, within the orchestration.</span></span>  
  
-   <span data-ttu-id="b2fc7-224">Un fichier de port d’envoi pour enregistrer la réponse pour l’opération de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-224">A FILE send port to save the response for the Update operation.</span></span>  
  
-   <span data-ttu-id="b2fc7-225">Formes réception et envoi.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-225">Receive and send shapes.</span></span>  
  
 <span data-ttu-id="b2fc7-226">Un exemple d’orchestration semblable au suivant.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-226">A sample orchestration resembles the following.</span></span>  
  
 <span data-ttu-id="b2fc7-227">![Orchestration pour recevoir des notifications de SQL Server](../../adapters-and-accelerators/adapter-sql/media/f13ad3b8-8161-42e5-a521-424bbf549ad5.gif "f13ad3b8-8161-42e5-a521-424bbf549ad5")</span><span class="sxs-lookup"><span data-stu-id="b2fc7-227">![Orchestration to receive SQL Server notifications](../../adapters-and-accelerators/adapter-sql/media/f13ad3b8-8161-42e5-a521-424bbf549ad5.gif "f13ad3b8-8161-42e5-a521-424bbf549ad5")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="b2fc7-228">Ajouter des formes de Message</span><span class="sxs-lookup"><span data-stu-id="b2fc7-228">Adding Message Shapes</span></span>  
 <span data-ttu-id="b2fc7-229">Assurez-vous que vous spécifiez les propriétés suivantes pour chacune des formes de message.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-229">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="b2fc7-230">Les noms répertoriés dans la colonne de forme sont les noms des formes de message tel qu’affiché dans l’orchestration juste-mentionné.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-230">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="b2fc7-231">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="b2fc7-231">Shape</span></span>|<span data-ttu-id="b2fc7-232">Type de forme</span><span class="sxs-lookup"><span data-stu-id="b2fc7-232">Shape Type</span></span>|<span data-ttu-id="b2fc7-233">Propriétés</span><span class="sxs-lookup"><span data-stu-id="b2fc7-233">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="b2fc7-234">ReceiveNotification</span><span class="sxs-lookup"><span data-stu-id="b2fc7-234">ReceiveNotification</span></span>|<span data-ttu-id="b2fc7-235">Recevoir</span><span class="sxs-lookup"><span data-stu-id="b2fc7-235">Receive</span></span>|<span data-ttu-id="b2fc7-236">-Définissez **nom** à *ReceiveNotification*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-236">- Set **Name** to *ReceiveNotification*</span></span><br /><br /> <span data-ttu-id="b2fc7-237">-Définissez **activer** à *True*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-237">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="b2fc7-238">SaveNotification</span><span class="sxs-lookup"><span data-stu-id="b2fc7-238">SaveNotification</span></span>|<span data-ttu-id="b2fc7-239">Send</span><span class="sxs-lookup"><span data-stu-id="b2fc7-239">Send</span></span>|<span data-ttu-id="b2fc7-240">-Définissez **nom** à *SaveNotification*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-240">- Set **Name** to *SaveNotification*</span></span>|  
|<span data-ttu-id="b2fc7-241">SendSelectMessage</span><span class="sxs-lookup"><span data-stu-id="b2fc7-241">SendSelectMessage</span></span>|<span data-ttu-id="b2fc7-242">Send</span><span class="sxs-lookup"><span data-stu-id="b2fc7-242">Send</span></span>|<span data-ttu-id="b2fc7-243">-Définissez **nom** à *SendSelectMessage*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-243">- Set **Name** to *SendSelectMessage*</span></span>|  
|<span data-ttu-id="b2fc7-244">ReceiveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="b2fc7-244">ReceiveSelectResponse</span></span>|<span data-ttu-id="b2fc7-245">Recevoir</span><span class="sxs-lookup"><span data-stu-id="b2fc7-245">Receive</span></span>|<span data-ttu-id="b2fc7-246">-Définissez **nom** à *ReceiveSelectResponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-246">- Set **Name** to *ReceiveSelectResponse*</span></span>|  
|<span data-ttu-id="b2fc7-247">SaveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="b2fc7-247">SaveSelectResponse</span></span>|<span data-ttu-id="b2fc7-248">Send</span><span class="sxs-lookup"><span data-stu-id="b2fc7-248">Send</span></span>|<span data-ttu-id="b2fc7-249">-Définissez **nom** à *SaveSelectResponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-249">- Set **Name** to *SaveSelectResponse*</span></span>|  
  
### <a name="adding-construct-message-shape"></a><span data-ttu-id="b2fc7-250">Ajout de forme construire un Message</span><span class="sxs-lookup"><span data-stu-id="b2fc7-250">Adding Construct Message Shape</span></span>  
 <span data-ttu-id="b2fc7-251">Vous pouvez utiliser la **construire un Message** forme pour générer un message de demande au sein de l’opération à effectuer l’opération de sélection.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-251">You can use the **Construct Message** shape to generate a request message within the operation to perform the Select operation.</span></span> <span data-ttu-id="b2fc7-252">Pour ce faire, vous devez ajouter un **construire un Message** forme dans laquelle un **assignation du Message** forme à votre orchestration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-252">To do so, you must add a **Construct Message** shape and within that a **Message Assignment** shape to your orchestration.</span></span> <span data-ttu-id="b2fc7-253">Pour cet exemple, le **assignation du Message** forme appelle le code qui génère un message est envoyé à SQL Server pour effectuer l’opération de sélection.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-253">For this example, the **Message Assignment** shape invokes code that generates a message that is sent to SQL Server to perform the Select operation.</span></span> <span data-ttu-id="b2fc7-254">Le **assignation du Message** forme définit également l’action pour le message à envoyer à SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-254">The **Message Assignment** shape also sets the action for the message to be sent to SQL Server.</span></span>  
  
 <span data-ttu-id="b2fc7-255">Pour la forme construire un message, définissez la **Message construit** propriété **sélectionnez**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-255">For the construct message shape, set the **Message Constructed** property to **Select**.</span></span>  
  
 <span data-ttu-id="b2fc7-256">Le code pour générer la réponse peut faire partie de la même solution Visual Studio en tant que votre projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-256">The code to generate the response could be part of the same Visual Studio solution as your BizTalk project.</span></span> <span data-ttu-id="b2fc7-257">Un exemple de code pour générer un message de réponse ressemble à ceci.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-257">A sample code for generating a response message looks like this.</span></span>  
  
```  
namespace SampleMessageCreator  
{  
    public class SampleMessageCreator  
    {  
        private static XmlDocument Message;  
        private static string XmlFileLocation;  
        private static string ResponseDoc;  
        public static XmlDocument XMLMessageCreator()  
        {  
            XmlFileLocation = "C:\\TestLocation\\CreateMessage";  
            try  
            {  
                ResponseDoc = (Directory.GetFiles(XmlFileLocation, "*.xml", SearchOption.TopDirectoryOnly))[0];  
            }  
            catch (Exception ex)  
            {  
                Console.WriteLine("Trying to get XML from: " + XmlFileLocation);  
                Console.WriteLine("EXCEPTION: " + ex.ToString());  
                throw ex;  
            }  
            //Create Message From XML  
            Message = new XmlDocument();  
            Message.PreserveWhitespace = true;  
            Message.Load(ResponseDoc);  
            return Message;  
        }   
    }  
}  
```  
  
 <span data-ttu-id="b2fc7-258">Pour l’extrait de code précédent être en mesure de générer un message de demande, vous devez disposer d’un message de demande XML (pour l’opération Select sur la table Employee) dans l’emplacement spécifié pour le `XmlFileLocation` variable.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-258">For the preceding code excerpt to be able to generate a request message, you must have an XML request message (for the Select operation on the Employee table) in the location specified for the `XmlFileLocation` variable.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b2fc7-259">Une fois que vous générez le projet, SampleMessageCreator.dll sera créé dans le répertoire du projet.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-259">After you build the project, SampleMessageCreator.dll will be created in the project directory.</span></span> <span data-ttu-id="b2fc7-260">Vous devez ajouter cette DLL dans le global assembly cache (GAC).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-260">You must add this DLL to the global assembly cache (GAC).</span></span> <span data-ttu-id="b2fc7-261">En outre, vous devez ajouter le SampleMessageCreator.dll en tant que référence dans le projet BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-261">Also, you must add the SampleMessageCreator.dll as a reference in the BizTalk project.</span></span>  
  
 <span data-ttu-id="b2fc7-262">Ajoutez l’expression suivante pour appeler ce code à partir de la **assignation du Message** forme et à définir l’action de message.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-262">Add the following expression to invoke this code from the **Message Assignment** shape and to set the action for message.</span></span> <span data-ttu-id="b2fc7-263">Pour ajouter une expression, double-cliquez sur le **assignation du Message** forme pour ouvrir l’éditeur d’Expression.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-263">To add an expression, double-click the **Message Assignment** shape to open the Expression Editor.</span></span>  
  
```  
Select = SampleMessageCreator.SampleMessageCreator.XMLMessageCreator();  
Select(WCF.Action) = "TableOp/Select/dbo/Employee";  
```  
  
### <a name="adding-ports"></a><span data-ttu-id="b2fc7-264">Ajout de Ports</span><span class="sxs-lookup"><span data-stu-id="b2fc7-264">Adding Ports</span></span>  
 <span data-ttu-id="b2fc7-265">Assurez-vous que vous spécifiez les propriétés suivantes pour chacun des ports logiques.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-265">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="b2fc7-266">Les noms répertoriés dans la colonne de Port sont les noms des ports tel qu’affiché dans l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-266">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="b2fc7-267">Port</span><span class="sxs-lookup"><span data-stu-id="b2fc7-267">Port</span></span>|<span data-ttu-id="b2fc7-268">Propriétés</span><span class="sxs-lookup"><span data-stu-id="b2fc7-268">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="b2fc7-269">SQLNotifyPort</span><span class="sxs-lookup"><span data-stu-id="b2fc7-269">SQLNotifyPort</span></span>|<span data-ttu-id="b2fc7-270">-Définissez **identificateur** à *SQLNotifyPort*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-270">- Set **Identifier** to *SQLNotifyPort*</span></span><br /><br /> <span data-ttu-id="b2fc7-271">-Définissez **Type** à *SQLNotifyPortType*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-271">- Set **Type** to *SQLNotifyPortType*</span></span><br /><br /> <span data-ttu-id="b2fc7-272">-Définissez **modèle de Communication** à *à sens unique*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-272">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="b2fc7-273">-Définissez **Direction de Communication** à *de réception*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-273">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="b2fc7-274">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="b2fc7-274">SaveMessagePort</span></span>|<span data-ttu-id="b2fc7-275">-Définissez **identificateur** à *SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-275">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="b2fc7-276">-Définissez **Type** à *SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-276">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="b2fc7-277">-Définissez **modèle de Communication** à *à sens unique*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-277">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="b2fc7-278">-Définissez **Direction de Communication** à *envoyer*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-278">- Set **Communication Direction** to *Send*</span></span><br /><br /> <span data-ttu-id="b2fc7-279">-Créer une opération *notifier*.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-279">- Create an operation *Notify*.</span></span> <span data-ttu-id="b2fc7-280">Cette opération est utilisée pour les messages de notification.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-280">This operation is used for notification messages.</span></span><br /><br /> <span data-ttu-id="b2fc7-281">-Créer une opération *sélectionnez*.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-281">- Create an operation *Select*.</span></span> <span data-ttu-id="b2fc7-282">Cette opération est utilisée pour les messages de réponse select.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-282">This operation is used for select response messages.</span></span>|  
|<span data-ttu-id="b2fc7-283">SQLOutboundPort</span><span class="sxs-lookup"><span data-stu-id="b2fc7-283">SQLOutboundPort</span></span>|<span data-ttu-id="b2fc7-284">-Définissez **identificateur** à *SQLOutboundPort*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-284">- Set **Identifier** to *SQLOutboundPort*</span></span><br /><br /> <span data-ttu-id="b2fc7-285">-Définissez **Type** à *SQLOutboundPortType*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-285">- Set **Type** to *SQLOutboundPortType*</span></span><br /><br /> <span data-ttu-id="b2fc7-286">-Définissez **modèle de Communication** à *demande-réponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-286">- Set **Communication Pattern** to *Request-Response*</span></span><br /><br /> <span data-ttu-id="b2fc7-287">-Définissez **Direction de Communication** à *envoi / réception*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-287">- Set **Communication Direction** to *Send-Receive*</span></span>|  
  
### <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="b2fc7-288">Spécifier des Messages pour les formes d’Action et de se connecter à des Ports</span><span class="sxs-lookup"><span data-stu-id="b2fc7-288">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="b2fc7-289">Le tableau suivant indique les propriétés et leurs valeurs, vous devez définir pour spécifier les messages de formes d’action et lier les messages aux ports.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-289">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="b2fc7-290">Les noms répertoriés dans la colonne de forme sont les noms des formes de message tel qu’affiché dans l’orchestration mentionnée précédemment.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-290">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="b2fc7-291">Graphique à base de formes</span><span class="sxs-lookup"><span data-stu-id="b2fc7-291">Shape</span></span>|<span data-ttu-id="b2fc7-292">Propriétés</span><span class="sxs-lookup"><span data-stu-id="b2fc7-292">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="b2fc7-293">ReceiveNotification</span><span class="sxs-lookup"><span data-stu-id="b2fc7-293">ReceiveNotification</span></span>|<span data-ttu-id="b2fc7-294">-Définissez **Message** à *NotifyReceive*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-294">- Set **Message** to *NotifyReceive*</span></span><br /><br /> <span data-ttu-id="b2fc7-295">-Définissez **opération** à *SQLNotifyPort.Notify.Request*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-295">- Set **Operation** to *SQLNotifyPort.Notify.Request*</span></span>|  
|<span data-ttu-id="b2fc7-296">SaveNotification</span><span class="sxs-lookup"><span data-stu-id="b2fc7-296">SaveNotification</span></span>|<span data-ttu-id="b2fc7-297">-Définissez **Message** à *NotifyReceive*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-297">- Set **Message** to *NotifyReceive*</span></span><br /><br /> <span data-ttu-id="b2fc7-298">-Définissez **opération** à *SaveMessagePort.Notify.Request*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-298">- Set **Operation** to *SaveMessagePort.Notify.Request*</span></span>|  
|<span data-ttu-id="b2fc7-299">SendSelectMessage</span><span class="sxs-lookup"><span data-stu-id="b2fc7-299">SendSelectMessage</span></span>|<span data-ttu-id="b2fc7-300">-Définissez **Message** à *sélectionner*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-300">- Set **Message** to *Select*</span></span><br /><br /> <span data-ttu-id="b2fc7-301">-Définissez **opération** à *SQLOutboundPort.Select.Request*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-301">- Set **Operation** to *SQLOutboundPort.Select.Request*</span></span>|  
|<span data-ttu-id="b2fc7-302">ReceiveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="b2fc7-302">ReceiveSelectResponse</span></span>|<span data-ttu-id="b2fc7-303">-Définissez **Message** à *SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-303">- Set **Message** to *SelectResponse*</span></span><br /><br /> <span data-ttu-id="b2fc7-304">-Définissez **opération** à *SQLOutboundPort.Select.Response*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-304">- Set **Operation** to *SQLOutboundPort.Select.Response*</span></span>|  
|<span data-ttu-id="b2fc7-305">SaveSelectResponse</span><span class="sxs-lookup"><span data-stu-id="b2fc7-305">SaveSelectResponse</span></span>|<span data-ttu-id="b2fc7-306">-Définissez **Message** à *SelectResponse*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-306">- Set **Message** to *SelectResponse*</span></span><br /><br /> <span data-ttu-id="b2fc7-307">-Définissez **opération** à *SaveMessagePort.Select.Request*</span><span class="sxs-lookup"><span data-stu-id="b2fc7-307">- Set **Operation** to *SaveMessagePort.Select.Request*</span></span>|  
  
 <span data-ttu-id="b2fc7-308">Une fois que vous avez défini ces propriétés, les formes de message et les ports sont connectés et l’orchestration est terminée.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-308">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
 <span data-ttu-id="b2fc7-309">Vous devez maintenant générer la solution BizTalk et déployez-le dans un [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2fc7-309">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="b2fc7-310">Pour plus d’informations, consultez [génération et exécution des Orchestrations](../../core/building-and-running-orchestrations.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-310">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="b2fc7-311">Configuration de l’Application BizTalk</span><span class="sxs-lookup"><span data-stu-id="b2fc7-311">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="b2fc7-312">Après avoir déployé le projet BizTalk, l’orchestration que vous avez créé précédemment est répertoriée sous le **Orchestrations** volet de la console Administration de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-312">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="b2fc7-313">Vous devez utiliser la console Administration de BizTalk Server pour configurer l’application.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-313">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="b2fc7-314">Pour une procédure pas à pas, consultez [procédure pas à pas : déploiement d’une Application BizTalk base](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-314">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="b2fc7-315">Configuration d’une application implique :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-315">Configuring an application involves:</span></span>  
  
-   <span data-ttu-id="b2fc7-316">Sélection d’un hôte de l’application.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-316">Selecting a host for the application.</span></span>  
  
-   <span data-ttu-id="b2fc7-317">Mappage de ports que vous avez créé dans l’orchestration aux ports physiques dans la console Administration de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-317">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="b2fc7-318">Pour cette orchestration, vous devez :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-318">For this orchestration you must:</span></span>  
  
    -   <span data-ttu-id="b2fc7-319">Définir un WCF-Custom physique ou le port de réception unidirectionnel WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-319">Define a physical WCF-Custom or WCF-SQL one-way receive port.</span></span> <span data-ttu-id="b2fc7-320">Ce port d’écoute pour les notifications provenant de la base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-320">This port listens for notifications coming from the SQL Server database.</span></span> <span data-ttu-id="b2fc7-321">Pour plus d’informations sur la création de ports, consultez [configurer manuellement une liaison de port physique à l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-321">For information about how to create ports, see [Manually configure a physical port binding to the SQL adapter](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span></span> <span data-ttu-id="b2fc7-322">Assurez-vous que vous spécifiez les propriétés suivantes de la liaison pour le port de réception.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-322">Make sure you specify the following binding properties for the receive port.</span></span>  
  
        > [!IMPORTANT]
        >  <span data-ttu-id="b2fc7-323">Vous n’avez pas besoin d’effectuer cette étape si vous avez spécifié les propriétés de liaison au moment du design.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-323">You do not need to perform this step if you specified the binding properties at design time.</span></span> <span data-ttu-id="b2fc7-324">Dans ce cas, vous pouvez créer un WCF-custom ou WCF-SQL port de réception, avec le jeu de propriétés de liaison requis, en important le fichier de liaison créé par le [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2fc7-324">In such a case, you can create a WCF-custom or WCF-SQL receive port, with the required binding properties set, by importing the binding file created by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="b2fc7-325">Pour plus d’informations, consultez [configurer une liaison de port physique à l’aide d’un fichier de liaison de port à utiliser l’adaptateur SQL](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-325">For more information see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
        |<span data-ttu-id="b2fc7-326">Propriété de liaison</span><span class="sxs-lookup"><span data-stu-id="b2fc7-326">Binding Property</span></span>|<span data-ttu-id="b2fc7-327">Valeur</span><span class="sxs-lookup"><span data-stu-id="b2fc7-327">Value</span></span>|  
        |----------------------|-----------|  
        |<span data-ttu-id="b2fc7-328">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-328">**InboundOperationType**</span></span>|<span data-ttu-id="b2fc7-329">Affectez la valeur **Notification**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-329">Set this to **Notification**.</span></span>|  
        |<span data-ttu-id="b2fc7-330">**NotificationStatement**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-330">**NotificationStatement**</span></span>|<span data-ttu-id="b2fc7-331">Affectez la valeur :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-331">Set this to:</span></span><br /><br /> `SELECT Employee_ID, Name FROM dbo.Employee WHERE Status=0`<br /><br /> <span data-ttu-id="b2fc7-332">**Remarque :** vous devez spécifier plus précisément les noms de colonnes dans l’instruction comme indiqué dans l’instruction SELECT suivante.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-332">**Note:** You must specifically specify the column names in the statement as shown in this SELECT statement.</span></span> <span data-ttu-id="b2fc7-333">En outre, vous devez toujours spécifier le nom de table, ainsi que le nom du schéma.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-333">Also, you must always specify the table name along with the schema name.</span></span> <span data-ttu-id="b2fc7-334">Par exemple, `dbo.Employee`.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-334">For example, `dbo.Employee`.</span></span>|  
        |<span data-ttu-id="b2fc7-335">**NotifyOnListenerStart**</span><span class="sxs-lookup"><span data-stu-id="b2fc7-335">**NotifyOnListenerStart**</span></span>|<span data-ttu-id="b2fc7-336">Affectez la valeur **True**.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-336">Set this to **True**.</span></span>|  
  
         <span data-ttu-id="b2fc7-337">Pour plus d’informations sur les propriétés de liaison différente, consultez [en savoir plus sur l’adaptateur BizTalk pour les propriétés de liaison de l’adaptateur SQL Server](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-337">For more information about the different binding properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="b2fc7-338">Nous vous recommandons de configurer le niveau d’isolation de transaction et le délai d’attente de transaction lors de l’exécution d’opérations entrantes à l’aide de la [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b2fc7-338">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="b2fc7-339">Vous pouvez effectuer afin d’en ajoutant le service de port de réception comportement lors de la configuration WCF-Custom ou WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-339">You can do so by adding the service behavior while configuring the WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="b2fc7-340">Pour obtenir des instructions sur la façon d’ajouter le comportement de service, consultez [configurer Transaction Isolation Level et délai de Transaction SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-340">For instruction on how to add the service behavior, see [Configure Transaction Isolation Level and Transaction Timeout with SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span></span>  
  
    -   <span data-ttu-id="b2fc7-341">Définir un port d’envoi WCF-Custom ou WCF-SQL physique pour envoyer des messages à la base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-341">Define a physical WCF-Custom or WCF-SQL send port to send messages to the SQL Server database.</span></span> <span data-ttu-id="b2fc7-342">Vous devez également spécifier l’action dans le port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-342">You must also specify the action in the send port.</span></span>  
  
    -   <span data-ttu-id="b2fc7-343">Définir un emplacement sur le disque dur et un port de fichier correspondant dans lequel l’orchestration BizTalk supprimera les messages à partir de la base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-343">Define a location on the hard disk and a corresponding file port where the BizTalk orchestration will drop the messages from the SQL Server database.</span></span> <span data-ttu-id="b2fc7-344">Ils vous seront les messages de notification reçues de SQL Server et les messages pour la sélectionner et port d’envoi opération de mise à jour que vous effectuez par le biais WCF-Custom ou WCF-SQL.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-344">These will be the notification messages received from SQL Server and messages for the Select and Update operation you perform through the WCF-Custom or WCF-SQL send port.</span></span>  
  
## <a name="starting-the-application"></a><span data-ttu-id="b2fc7-345">Démarrage de l’Application</span><span class="sxs-lookup"><span data-stu-id="b2fc7-345">Starting the Application</span></span>  
 <span data-ttu-id="b2fc7-346">Vous devez démarrer l’application BizTalk pour la réception des messages de notification à partir de la base de données SQL Server et pour effectuer les opérations Select et de mise à jour ultérieures.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-346">You must start the BizTalk application for receiving notification messages from the SQL Server database and for performing the subsequent Select and Update operations.</span></span> <span data-ttu-id="b2fc7-347">Pour obtenir des instructions sur le démarrage d’une application BizTalk, consultez [comment démarrer une Orchestration](../../core/how-to-start-an-orchestration.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-347">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>
  
 <span data-ttu-id="b2fc7-348">À ce stade, vérifiez que :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-348">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="b2fc7-349">Le WCF-Custom ou WCF-SQL unidirectionnel port de réception, qui reçoit les messages de notification à partir de la base de données est en cours d’exécution de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-349">The WCF-Custom or WCF-SQL one-way receive port, which receives the notification messages from the SQL Server database is running.</span></span>  
  
-   <span data-ttu-id="b2fc7-350">Le port d’envoi WCF-Custom ou WCF-SQL pour effectuer sélectionnez et les opérations de mise à jour sur la table Employee est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-350">The WCF-Custom or WCF-SQL send port to perform Select and Update operations on the Employee table is running.</span></span>  
  
-   <span data-ttu-id="b2fc7-351">Le port d’envoi de fichier qui reçoit des messages à partir de SQL Server, est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-351">The FILE send port, which receives messages from SQL Server, is running.</span></span>  
  
-   <span data-ttu-id="b2fc7-352">L’orchestration BizTalk pour l’opération est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-352">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="b2fc7-353">L’exécution de l’opération</span><span class="sxs-lookup"><span data-stu-id="b2fc7-353">Executing the Operation</span></span>  
 <span data-ttu-id="b2fc7-354">Pour exécuter cette opération, vous devez insérer un enregistrement dans la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-354">To execute this operation, you must insert a record into the Employee table.</span></span> <span data-ttu-id="b2fc7-355">Supposons que vous insérez un enregistrement avec les détails suivants :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-355">Let us assume you insert a record with following details:</span></span>  
  
```  
Name = John Smith  
Designation = Manager  
Salary = 100000  
```  
  
 <span data-ttu-id="b2fc7-356">En outre, assurez-vous que le message XML pour exécuter la sélection et les opérations de mise à jour est disponible à l’adresse C:\TestLocation\MessageIn.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-356">Also, make sure the XML message to perform Select and Update operations is available at C:\TestLocation\MessageIn.</span></span> <span data-ttu-id="b2fc7-357">Le fichier XML doit ressembler au suivant :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-357">The XML file should resemble the following:</span></span>  
  
```  
<Select xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
  <Columns>Employee_ID,Name,Status</Columns>  
  <Query>where Status=0;UPDATE Employee SET Status=1 WHERE Status=0</Query>  
</Select>  
```  
  
 <span data-ttu-id="b2fc7-358">Une fois que l’enregistrement est inséré, l’ensemble d’actions suivantes ont lieu, dans l’ordre :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-358">Once the record is inserted, the following set of actions take place, in the same sequence:</span></span>  
  
-   <span data-ttu-id="b2fc7-359">L’adaptateur reçoit un message de notification qui ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-359">The adapter receives a notification message that resembles the following:</span></span>  
  
    ```  
    \<?xml version="1.0" encoding="utf-8" ?>   
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Insert</Info>   
      <Source>Data</Source>   
      <Type>Change</Type>   
    </Notification>  
    ```  
  
     <span data-ttu-id="b2fc7-360">Ce message indique qu’un enregistrement a été inséré dans la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-360">This message notifies that a record was inserted in the Employee table.</span></span> <span data-ttu-id="b2fc7-361">Notez que la valeur de la `<Info>` élément est « Insert ».</span><span class="sxs-lookup"><span data-stu-id="b2fc7-361">Note that the value for the `<Info>` element is “Insert”.</span></span>  
  
-   <span data-ttu-id="b2fc7-362">L’adaptateur exécute l’opération de sélection.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-362">The adapter executes the Select operation.</span></span> <span data-ttu-id="b2fc7-363">Étant donné que l’opération Select XML inclut également une instruction Update, l’instruction de mise à jour est également exécutée.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-363">Because the Select operation XML also includes an Update statement, the Update statement is also executed.</span></span> <span data-ttu-id="b2fc7-364">La réponse suivante à partir de SQL Server est de l’instruction Select.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-364">The next response from SQL Server is for the Select statement.</span></span>  
  
    ```  
    \<?xml version="1.0" encoding="utf-8" ?>   
    <SelectResponse xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
      <SelectResult>  
        <Employee xmlns="http://schemas.microsoft.com/Sql/2008/05/Types/Tables/dbo">  
          <Employee_ID>10006</Employee_ID>   
          <Name>John</Name>   
          <Status>0</Status>  
        </Employee>  
      </SelectResult>  
    </SelectResponse>  
    ```  
  
     <span data-ttu-id="b2fc7-365">Cette réponse indique qu’un enregistrement a été inséré dans la table Employee et l’état de cet enregistrement est 0.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-365">This response shows that a record was inserted into the Employee table and the Status for that record is 0.</span></span>  
  
-   <span data-ttu-id="b2fc7-366">Dans le cadre de l’instruction Select, l’instruction de mise à jour est également exécutée et la colonne d’état pour le nouvel enregistrement est remplacée par 1.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-366">As part of the Select statement, the Update statement is also executed and the Status column for the new record is changed to 1.</span></span> <span data-ttu-id="b2fc7-367">Cette option force à nouveau une autre notification à partir de SQL Server et l’adaptateur reçoit un message de notification correspondant, qui ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="b2fc7-367">This again triggers another notification from SQL Server and the adapter receives a corresponding notification message, that resembles the following:</span></span>  
  
    ```  
    \<?xml version="1.0" encoding="utf-8" ?>   
    <Notification xmlns="http://schemas.microsoft.com/Sql/2008/05/Notification/">  
      <Info>Update</Info>   
      <Source>Data</Source>   
      <Type>Change</Type>   
    </Notification>  
    ```  
  
     <span data-ttu-id="b2fc7-368">Ce message avertit que l’utilisation d’un enregistrement a été mis à jour dans la table Employee.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-368">This message notifies that a record was updated in the Employee table.</span></span> <span data-ttu-id="b2fc7-369">Notez que la valeur de la `<Info>` élément est « Update ».</span><span class="sxs-lookup"><span data-stu-id="b2fc7-369">Note that the value for the `<Info>` element is “Update”.</span></span>  
  
-   <span data-ttu-id="b2fc7-370">Après la deuxième notification, l’adaptateur exécute l’instruction Select.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-370">After the second notification, the adapter executes the Select statement.</span></span> <span data-ttu-id="b2fc7-371">Toutefois, comme il n’existe aucun enregistrement qui ont l’état en tant que 0, l’adaptateur reçoit une réponse vide qui ressemble à la suivante.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-371">However, because there are no records now that have Status as 0, the adapter gets an empty response resembling the following.</span></span>  
  
    ```  
    \<?xml version="1.0" encoding="utf-8" ?>   
    <SelectResponse xmlns="http://schemas.microsoft.com/Sql/2008/05/TableOp/dbo/Employee">  
      <SelectResult />   
    </SelectResponse>  
    ```  
  
## <a name="best-practices"></a><span data-ttu-id="b2fc7-372">Bonnes pratiques</span><span class="sxs-lookup"><span data-stu-id="b2fc7-372">Best Practices</span></span>  
 <span data-ttu-id="b2fc7-373">Après avoir déployé et configuré le projet BizTalk, vous pouvez exporter les paramètres de configuration dans un fichier XML appelé le fichier de liaison.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-373">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the binding file.</span></span> <span data-ttu-id="b2fc7-374">Une fois que vous générez un fichier de liaison, vous pouvez importer les paramètres de configuration à partir du fichier, afin que vous n’avez pas besoin de créer les ports d’envoi et de réception pour l’orchestration même.</span><span class="sxs-lookup"><span data-stu-id="b2fc7-374">Once you generate a binding file, you can import the configuration settings from the file, so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="b2fc7-375">Pour plus d’informations sur les fichiers de liaison, consultez [liaisons de l’adaptateur SQL de réutiliser](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="b2fc7-375">For more information about binding files, see [Reuse SQL adapter bindings](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b2fc7-376">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b2fc7-376">See Also</span></span>  
 [<span data-ttu-id="b2fc7-377">Recevoir des Notifications de requête SQL à l’aide de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="b2fc7-377">Receive SQL Query Notifications using BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)