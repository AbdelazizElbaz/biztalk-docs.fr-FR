---
title: "Exécuter des procédures stockées dans SQL Server à l’aide de l’adaptateur SQL | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 245626a7-f546-4aca-90df-c0579139a872
caps.latest.revision: "16"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 65a475d8de1fc30df2e06923ad14bcba0897159e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="execute-stored-procedures-in-sql-server-using-the-sql-adapter"></a><span data-ttu-id="36c55-102">Exécuter des procédures stockées dans SQL Server à l’aide de l’adaptateur SQL</span><span class="sxs-lookup"><span data-stu-id="36c55-102">Execute Stored Procedures in SQL Server using the SQL adapter</span></span>
<span data-ttu-id="36c55-103">Les procédures stockées CLR dans SQL Server Transact-SQL sont signalées en tant qu’opérations dans [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)] sous le **procédures** nœud lors de l’utilisation la [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] ou [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36c55-103">The Transact-SQL and CLR stored procedures in SQL Server are surfaced as operations in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)] under the **Procedures** node while using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] or [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span></span> <span data-ttu-id="36c55-104">Les noms des opérations exposées par le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] sont les mêmes que le nom de la procédure stockée dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="36c55-104">The operation names exposed by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] are the same as the name of the stored procedure in SQL Server.</span></span> <span data-ttu-id="36c55-105">Tous les paramètres dans la procédure stockée sont exposés dans l’opération correspondante.</span><span class="sxs-lookup"><span data-stu-id="36c55-105">All the parameters in the stored procedure are exposed in the corresponding operation.</span></span> <span data-ttu-id="36c55-106">Le paramètre de sortie contient la valeur de retour de la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="36c55-106">The OUT parameter contains the return value of the stored procedure.</span></span> <span data-ttu-id="36c55-107">Le jeu de résultats de la procédure stockée est un tableau du jeu de données.</span><span class="sxs-lookup"><span data-stu-id="36c55-107">The result set of the stored procedure is an array of DataSet.</span></span> <span data-ttu-id="36c55-108">Pour plus d’informations sur le jeu de données, consultez [http://go.microsoft.com/fwlink/?LinkId=196853](http://go.microsoft.com/fwlink/?LinkId=196853).</span><span class="sxs-lookup"><span data-stu-id="36c55-108">For more information about DataSet, see [http://go.microsoft.com/fwlink/?LinkId=196853](http://go.microsoft.com/fwlink/?LinkId=196853).</span></span> <span data-ttu-id="36c55-109">Les informations de schéma de l’objet cible sont obtenues en tant que partie du message de réponse en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="36c55-109">The schema information of the target object is obtained as part of the response message at run time.</span></span>  
  
 <span data-ttu-id="36c55-110">Toutefois, si vous souhaitez obtenir les informations de schéma de l’objet cible au moment du design, vous devez générer les schémas pour les procédures sous le **fortement typée procédures** nœud dans le [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] ou [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36c55-110">However, if you want to obtain the schema information of the target object at design time, you must generate schemas for the procedures under the **Strongly-Typed Procedures** node in the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] or [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)].</span></span> <span data-ttu-id="36c55-111">Notez que les mêmes procédures stockées sont signalées sous le **procédures** et **fortement typée procédures** nœud.</span><span class="sxs-lookup"><span data-stu-id="36c55-111">Note that the same stored procedures are surfaced under the **Procedures** and the **Strongly-Typed Procedures** node.</span></span> <span data-ttu-id="36c55-112">La valeur de retour de la procédure stockée est fortement typé et pas seulement un tableau du jeu de données.</span><span class="sxs-lookup"><span data-stu-id="36c55-112">The return value of the stored procedure is strongly typed, and not just an array of DataSet.</span></span> <span data-ttu-id="36c55-113">Comme les informations de schéma sont disponibles au moment du design, vous pouvez l’utiliser pour mapper le schéma de la procédure stockée à un autre schéma pour une autre opération.</span><span class="sxs-lookup"><span data-stu-id="36c55-113">As the schema information is available at the design time, you can use it to map the schema of the stored procedure to another schema for a different operation.</span></span> <span data-ttu-id="36c55-114">Par exemple, vous pouvez mapper le schéma généré pour une procédure fortement typé pour le schéma généré pour l’opération d’insertion sur une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="36c55-114">For example, you can map the schema generated for a strongly-typed procedure to the schema generated for the Insert operation on a database table.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="36c55-115">Vous ne serez pas en mesure d’afficher les informations de schéma au moment du design pour une procédure stockée fortement typé si :</span><span class="sxs-lookup"><span data-stu-id="36c55-115">You will not be able to view the schema information at design time for a strongly-typed stored procedure if:</span></span>  
>   
>  -   <span data-ttu-id="36c55-116">Vous utilisez un curseur, ce qui correspond à une valeur de retour d’une autre procédure stockée, le paramètre d’entrée pour la procédure stockée fortement typée.</span><span class="sxs-lookup"><span data-stu-id="36c55-116">You are using a cursor, which is a return value of another stored procedure, as the input parameter for the strongly-typed stored procedure.</span></span>  
> -   <span data-ttu-id="36c55-117">Il s’agit d’une procédure stockée CLR qui effectue certaines opérations sur une table.</span><span class="sxs-lookup"><span data-stu-id="36c55-117">It is a CLR stored procedure that performs some operations on a table.</span></span>  
  
## <a name="support-for-stored-procedures-with-for-xml-clause"></a><span data-ttu-id="36c55-118">Prise en charge des procédures stockées avec la Clause FOR XML</span><span class="sxs-lookup"><span data-stu-id="36c55-118">Support for Stored Procedures with FOR XML Clause</span></span>  
 <span data-ttu-id="36c55-119">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] vous permet également d’exécuter des procédures stockées qui ont une instruction SELECT avec une clause FOR XML.</span><span class="sxs-lookup"><span data-stu-id="36c55-119">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] also enables you to execute stored procedures that have a SELECT statement with a FOR XML clause.</span></span> <span data-ttu-id="36c55-120">Une clause FOR XML est utilisée dans une instruction SELECT pour retourner les résultats au format XML au lieu d’un ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="36c55-120">A FOR XML clause is used in a SELECT statement to return the results as XML instead of a rowset.</span></span> <span data-ttu-id="36c55-121">Pour plus d’informations sur la clause FOR XML, consultez [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span><span class="sxs-lookup"><span data-stu-id="36c55-121">For more information about the FOR XML clause, see [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="36c55-122">Le « native » [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] disponible avec [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] prend en charge uniquement les procédures stockées qui renvoient des données XML, autrement dit, comportent la clause FOR XML dans l’instruction SELECT.</span><span class="sxs-lookup"><span data-stu-id="36c55-122">The “native” [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] available with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] supports only those stored procedures that return XML, that is, have the FOR XML clause in the SELECT statement.</span></span> <span data-ttu-id="36c55-123">Avec la prise en charge pour les procédures stockées avec la clause FOR XML, vous pouvez exécuter ces procédures stockées à l’aide de la station de travail WCF [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] sans apporter de modifications à la définition de procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="36c55-123">With the support for stored procedures with FOR XML clause, you can execute these stored procedures using the WCF-based [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] without making any changes to the stored procedure definition.</span></span>  
  
## <a name="support-for-stored-procedures-with-temporary-tables"></a><span data-ttu-id="36c55-124">Prise en charge des procédures stockées avec les Tables temporaires</span><span class="sxs-lookup"><span data-stu-id="36c55-124">Support for Stored Procedures with Temporary Tables</span></span>  
 <span data-ttu-id="36c55-125">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] vous permet de générer des métadonnées pour les procédures stockées qui contiennent des tables temporaires dans leurs définitions.</span><span class="sxs-lookup"><span data-stu-id="36c55-125">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] enables you to generate metadata for stored procedures that contain temporary tables in their definitions.</span></span> <span data-ttu-id="36c55-126">Toutefois, pour ces procédures stockées vous devez générer des métadonnées en sélectionnant les procédures stockées uniquement à partir de la **procédures** nœud, tout en utilisant le [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] ou [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="36c55-126">However, for such stored procedures you must generate metadata by selecting the stored procedures only from the **Procedures** node, while using the [!INCLUDE[addadapterservrefshort](../../includes/addadapterservrefshort-md.md)] or [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="36c55-127">L’adaptateur ne prend pas en charge les générer des métadonnées pour ces procédures stockées sous la **fortement typée procédures** nœud.</span><span class="sxs-lookup"><span data-stu-id="36c55-127">The adapter does not support generating metadata for such stored procedures from under the **Strongly-Typed Procedures** node.</span></span>  
  
## <a name="support-for-result-sets-containing-columns-without-names-or-with-same-names"></a><span data-ttu-id="36c55-128">Prise en charge des jeux de résultats contenant des colonnes sans nom ou avec le même nom</span><span class="sxs-lookup"><span data-stu-id="36c55-128">Support for Result Sets Containing Columns Without Names or With Same Names</span></span>  
 <span data-ttu-id="36c55-129">Le tableau suivant répertorie comment les [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] gère les colonnes sans les noms et même dans les jeux de résultats des procédures stockées et des procédures stockées fortement typée.</span><span class="sxs-lookup"><span data-stu-id="36c55-129">The following table lists how the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] handles columns without names and same names in the result sets for stored procedures and strongly-typed stored procedures.</span></span>  
  
|<span data-ttu-id="36c55-130">Jeu de résultats contient...</span><span class="sxs-lookup"><span data-stu-id="36c55-130">Result set contains…</span></span>|<span data-ttu-id="36c55-131">Procédure stockée</span><span class="sxs-lookup"><span data-stu-id="36c55-131">Stored Procedure</span></span>|<span data-ttu-id="36c55-132">Fortement typée de procédure stockée</span><span class="sxs-lookup"><span data-stu-id="36c55-132">Strongly-Typed Stored Procedure</span></span>|  
|--------------------------|----------------------|--------------------------------------|  
|<span data-ttu-id="36c55-133">**Colonnes sans nom**</span><span class="sxs-lookup"><span data-stu-id="36c55-133">**Columns without names**</span></span>|<span data-ttu-id="36c55-134">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] génère un nom pour la colonne de la façon suivante : un ID unique (GUID) est généré pour la colonne sans «- » (tiret), et ensuite la chaîne GUID préfixée par « C », car le GUID généré peut commencer par un chiffre, mais un nom de balise XML ne peut pas.</span><span class="sxs-lookup"><span data-stu-id="36c55-134">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] generates a name for the column in the following way: a unique ID (GUID) is generated for the column without "-" (hyphen), and then the GUID string is prefixed by "C" because the generated GUID might start with a digit but an XML tag name cannot.</span></span>|<span data-ttu-id="36c55-135">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] génère le nom suivant pour la colonne : « UnNamedColumn [column_index] », où column_index commence à partir de '0'.</span><span class="sxs-lookup"><span data-stu-id="36c55-135">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] generates the following name for the column: “UnNamedColumn[column_index]”,  where column_index starts from ‘0’.</span></span>|  
|<span data-ttu-id="36c55-136">**Colonnes avec les mêmes noms**</span><span class="sxs-lookup"><span data-stu-id="36c55-136">**Columns with same names**</span></span>|<span data-ttu-id="36c55-137">Les noms des colonnes que la première sont complétés par « _ » (trait de soulignement) suivi d’un GUID aléatoire sans «- » (tiret).</span><span class="sxs-lookup"><span data-stu-id="36c55-137">The names of the columns other than the first one are appended with “_” (underscore) followed by a random GUID without "-" (hyphen).</span></span> <span data-ttu-id="36c55-138">Par exemple : «\_[GUID] ».</span><span class="sxs-lookup"><span data-stu-id="36c55-138">For example: “\_[GUID]”.</span></span>|<span data-ttu-id="36c55-139">Le [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] ne prend pas en charge les colonnes avec les mêmes noms dans les jeux de résultats et lève une exception.</span><span class="sxs-lookup"><span data-stu-id="36c55-139">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] does not support columns with same names in the result sets, and throws an exception.</span></span> <span data-ttu-id="36c55-140">**Important :** vous devez vous assurer que les noms de colonnes dans un jeu de résultats ont des noms uniques.</span><span class="sxs-lookup"><span data-stu-id="36c55-140">**Important:**  You must ensure that the column names in a result set have unique names.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="36c55-141">En général, il est recommandé que toutes les colonnes dans un résultat défini pour les procédures stockées et fortement typée de procédures stockées doivent être nommés et ont des noms uniques.</span><span class="sxs-lookup"><span data-stu-id="36c55-141">In general, it is recommended that all the columns in a result set for stored procedures and strongly-typed stored procedures must be named, and have unique names.</span></span>  
  
 <span data-ttu-id="36c55-142">Pour plus d’informations sur :</span><span class="sxs-lookup"><span data-stu-id="36c55-142">For more information about:</span></span>  
  
-   <span data-ttu-id="36c55-143">Comment exécuter des procédures stockées, consultez [exécuter des procédures stockées dans SQL Server à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-in-sql-server-using-biztalk-server.md).</span><span class="sxs-lookup"><span data-stu-id="36c55-143">How to execute stored procedures, see [Execute stored procedures in SQL Server using BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-in-sql-server-using-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="36c55-144">Comment exécuter des procédures stockées ayant une clause FOR XML, consultez [exécuter des procédures stockées ayant une clause FOR XML dans SQL Server à l’aide de BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-having-a-for-xml-clause-in-sql-server-using-biztalk.md).</span><span class="sxs-lookup"><span data-stu-id="36c55-144">How to execute stored procedures having a FOR XML clause, see [Execute stored procedures having a FOR XML clause in SQL Server using BizTalk Server](../../adapters-and-accelerators/adapter-sql/execute-stored-procedures-having-a-for-xml-clause-in-sql-server-using-biztalk.md).</span></span>  
  
-   <span data-ttu-id="36c55-145">Pour les procédures stockées, les schémas de message, consultez [des schémas de Message pour les procédures et fonctions](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md).</span><span class="sxs-lookup"><span data-stu-id="36c55-145">Message schemas for the stored procedures, see [Message Schemas for Procedures and Functions](../../adapters-and-accelerators/adapter-sql/message-schemas-for-procedures-and-functions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="36c55-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="36c55-146">See Also</span></span>  
 [<span data-ttu-id="36c55-147">Se connecter à un système SAP à l’aide de l’adaptateur</span><span class="sxs-lookup"><span data-stu-id="36c55-147">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)