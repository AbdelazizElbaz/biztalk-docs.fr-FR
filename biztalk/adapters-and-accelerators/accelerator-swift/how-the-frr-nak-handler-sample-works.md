---
title: "Fonctionne de l’exemple de gestionnaire FRR NAK | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 9f11bd20-3a0e-4d96-8e0a-32fecc7eed7e
caps.latest.revision: "3"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 009cb0c3dffce5f88c72207866f6778e3deb7b28
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-the-frr-nak-handler-sample-works"></a><span data-ttu-id="53459-102">Fonctionne de l’exemple de gestionnaire FRR NAK</span><span class="sxs-lookup"><span data-stu-id="53459-102">How the FRR NAK Handler Sample Works</span></span>
<span data-ttu-id="53459-103">L’exemple de gestionnaire personnalisé de FRR NAK sert d’intermédiaire entre l’orchestration de rapprochement de réponse de FIN (FRR) et l’orchestration de réparation de message.</span><span class="sxs-lookup"><span data-stu-id="53459-103">The sample FRR NAK custom handler serves as an intermediary between the FIN Response Reconciliation (FRR) orchestration and the message-repair orchestration.</span></span> <span data-ttu-id="53459-104">L’orchestration FRR identifie l’erreur qui s’est produite lorsque le réseau SWIFT a tenté de recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="53459-104">The FRR orchestration identifies the error that occurred when the SWIFT network attempted to receive the message.</span></span> <span data-ttu-id="53459-105">La sortie de l’orchestration FRR est un message d’une partie avec un objet d’erreur.</span><span class="sxs-lookup"><span data-stu-id="53459-105">The output of the FRR orchestration is a one-part message with an error object.</span></span> <span data-ttu-id="53459-106">Le gestionnaire personnalisé FRR NAK transforme ce message dans un message en deux parties, avec une partie de l’erreur qui indique l’erreur qui s’est produite, l’activation de message à être récupéré par l’orchestration de réparation de message.</span><span class="sxs-lookup"><span data-stu-id="53459-106">The FRR NAK custom handler transforms that message into a two-part message, with an error part that indicates the error that occurred, enabling the message to be picked up by the message-repair orchestration.</span></span> <span data-ttu-id="53459-107">L’orchestration de réparation de message ouvre le message dans une [!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)] formulaire qui vous permet de savoir quel était l’erreur, réparez le message en conséquence et soumettre à nouveau afin que [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] peut renvoyer à SAA.</span><span class="sxs-lookup"><span data-stu-id="53459-107">The message-repair orchestration opens the message in an [!INCLUDE[btsInpathNoVersion](../../includes/btsinpathnoversion-md.md)] form that enables you to find out what the error was, repair the message accordingly, and resubmit it so that [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] can resend it to SAA.</span></span>  
  
 <span data-ttu-id="53459-108">Les étapes suivantes se produisent lorsque le gestionnaire personnalisé FRR NAK traite un message réseau rapide n’a pas été correctement reçu :</span><span class="sxs-lookup"><span data-stu-id="53459-108">The following steps occur when the FRR NAK custom handler processes a message that the SWIFT network could not successfully receive:</span></span>  
  
1.  <span data-ttu-id="53459-109">Une fois que l’orchestration FRR a mis en corrélation le message ayant échoué pour le message MTS21_FIN_ACKNAK NAK, l’orchestration RepairSWIFTRejectedMessage (le gestionnaire personnalisé) récupère le message d’origine à partir de la MessageBox.</span><span class="sxs-lookup"><span data-stu-id="53459-109">After the FRR orchestration has correlated the failed message to the MTS21_FIN_ACKNAK NAK message, the RepairSWIFTRejectedMessage orchestration (the custom handler) picks up the original message from the MessageBox.</span></span> <span data-ttu-id="53459-110">Il donc en filtrant sur A4SWIFT_FRRFailed == True et A4SWIFT_SendingServiceType = « A4SWIFT_FrrService ».</span><span class="sxs-lookup"><span data-stu-id="53459-110">It does so because it filters on A4SWIFT_FRRFailed==True and A4SWIFT_SendingServiceType="A4SWIFT_FrrService".</span></span>  
  
2.  <span data-ttu-id="53459-111">Le gestionnaire personnalisé ne prennent pas en charge le message de MTS21_FIN_ACKNAK NAK FRR mis en corrélation avec le message d’origine.</span><span class="sxs-lookup"><span data-stu-id="53459-111">The custom handler does not pick up the MTS21_FIN_ACKNAK NAK message that FRR correlated to the original message.</span></span> <span data-ttu-id="53459-112">Au lieu de cela, il crée un objet de collection d’erreurs, il remplit avec une erreur de validation BRE qui indique que la propriété A4SWIFT_FRRFailedReason a été et l’ajoute au message d’origine.</span><span class="sxs-lookup"><span data-stu-id="53459-112">Instead, it creates an error collection object, populates it with a BRE validation error that indicates what the A4SWIFT_FRRFailedReason property was, and adds it to the original message.</span></span> <span data-ttu-id="53459-113">L’orchestration de réparation de message peut traiter ce message en deux parties.</span><span class="sxs-lookup"><span data-stu-id="53459-113">The message-repair orchestration can process this two-part message.</span></span>  
  
3.  <span data-ttu-id="53459-114">Le gestionnaire personnalisé promeut les propriétés suivantes pour provoquer le message à être récupéré par l’orchestration de réparation de message : A4SWIFT_Failed == True, A4SWIFT_SwiftBound == True et BizTalk Server. Opération = « A4SWIFT_DASMMarkedAsFailed ».</span><span class="sxs-lookup"><span data-stu-id="53459-114">The custom handler promotes the following properties to cause the message to be picked up by the message-repair orchestration: A4SWIFT_Failed==True, A4SWIFT_SwiftBound==True, and BTS.Operation="A4SWIFT_DASMMarkedAsFailed".</span></span> <span data-ttu-id="53459-115">Il définit le nombre de parties propriété à 2 et définit les propriétés de l’erreur appropriée.</span><span class="sxs-lookup"><span data-stu-id="53459-115">It sets the number of parts property to 2, and sets the appropriate error properties.</span></span>  
  
4.  <span data-ttu-id="53459-116">À la suite les propriétés promues, l’orchestration de réparation de messages récupère le message, et l’orchestration RepairSWIFTRejectedMessage s’arrête.</span><span class="sxs-lookup"><span data-stu-id="53459-116">As a result of the promoted properties, the message-repair orchestration picks up the message, and the RepairSWIFTRejectedMessage orchestration terminates.</span></span>