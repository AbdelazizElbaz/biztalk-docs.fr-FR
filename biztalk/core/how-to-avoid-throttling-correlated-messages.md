---
title: "Comment éviter la limitation des Messages corrélés | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bfe47747-01e7-4e2f-bbd5-d5055cea001a
caps.latest.revision: "7"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 10cfcf0009cac5a72d71190c1b974ca6d01a2e1e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-avoid-throttling-correlated-messages"></a><span data-ttu-id="68ddb-102">Élimination des risques de limitation des messages corrélés</span><span class="sxs-lookup"><span data-stu-id="68ddb-102">How to Avoid Throttling Correlated Messages</span></span>
<span data-ttu-id="68ddb-103">Les messages mis en file d'attente dans un serveur BizTalk Server, par exemple via un emplacement de réception ou par des orchestrations, peuvent être traités de l'une des manières suivantes :</span><span class="sxs-lookup"><span data-stu-id="68ddb-103">Messages that are en-queued into BizTalk Server, for example through a receive location or by orchestrations, can be processed in one of the following ways:</span></span>  
  
-   <span data-ttu-id="68ddb-104">Ils peuvent activer de nouvelles instances d'abonnés (c'est-à-dire des orchestrations ou des ports d'envoi).</span><span class="sxs-lookup"><span data-stu-id="68ddb-104">They can activate new instances of subscribers (that is, orchestrations or send ports)</span></span>  
  
-   <span data-ttu-id="68ddb-105">Ils peuvent être acheminés vers une instance d'abonné existante via la corrélation.</span><span class="sxs-lookup"><span data-stu-id="68ddb-105">They can be routed to an existing subscriber instance via correlation.</span></span> <span data-ttu-id="68ddb-106">Pour plus d’informations sur la corrélation, consultez [à l’aide de corrélations dans les Orchestrations](../core/using-correlations-in-orchestrations.md).</span><span class="sxs-lookup"><span data-stu-id="68ddb-106">For more information about correlation, see [Using Correlations in Orchestrations](../core/using-correlations-in-orchestrations.md).</span></span>  
  
 <span data-ttu-id="68ddb-107">Les développeurs sont nombreux à voir les emplacements de réception comme une solution pour recevoir des messages d'activation et corrélés via un même port.</span><span class="sxs-lookup"><span data-stu-id="68ddb-107">A lot of developers think about the receive locations for a solution as receiving both activation and correlated messages for the solution through the same port.</span></span> <span data-ttu-id="68ddb-108">Rien d'étonnant à cela puisque le nombre d'adresses dont les expéditeurs des messages doivent garder la trace est ainsi réduit.</span><span class="sxs-lookup"><span data-stu-id="68ddb-108">This is natural as it minimizes the number of addresses that message senders need to keep track of.</span></span> <span data-ttu-id="68ddb-109">Mais avec la limitation dans [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], il peut y avoir des avantages à distinguer le flux des messages d'activation et le flux des messages corrélés.</span><span class="sxs-lookup"><span data-stu-id="68ddb-109">However, with throttling in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], there can be advantages to thinking about the stream of activation messages and the stream of correlated messages separately when it comes to throttling.</span></span>  
  
 <span data-ttu-id="68ddb-110">Lorsque les messages d'activation et les messages de corrélation arrivent via le même emplacement de réception, ils sont soumis au même état de limitation car la limitation est appliquée au niveau de l'hôte.</span><span class="sxs-lookup"><span data-stu-id="68ddb-110">When both activation and correlation messages arrive through the same receive location, they are subject to the same throttling state because throttling is applied at the host level.</span></span> <span data-ttu-id="68ddb-111">Il en résulte que tous les messages arrivant aux emplacements de réception dans l'hôte sont limités sous la forme d'une unité.</span><span class="sxs-lookup"><span data-stu-id="68ddb-111">As a result, all messages arriving at receive locations in the host will be throttled as a unit.</span></span> <span data-ttu-id="68ddb-112">Cela ne pose pas de problème dans la plupart des cas mais il peut arriver que la limitation de corrélations avec des activations puisse entraîner des blocages du système.</span><span class="sxs-lookup"><span data-stu-id="68ddb-112">This is not an issue for many scenarios, but there are cases where throttling correlations with activations can result in a type of system deadlock.</span></span>  
  
## <a name="example"></a><span data-ttu-id="68ddb-113">Exemple</span><span class="sxs-lookup"><span data-stu-id="68ddb-113">Example</span></span>  
 <span data-ttu-id="68ddb-114">Supposons par exemple que vous ayez une orchestration qui reçoive une activation, qui l'utilise pour initialiser un ensemble de corrélations, puis qui reçoive un convoi de dix messages supplémentaires à la suite de l'ensemble de corrélations.</span><span class="sxs-lookup"><span data-stu-id="68ddb-114">For example, let's assume you have a scenario containing an orchestration that receives one activation, uses it to initialize a correlation set, then receives a convoy of 10 additional messages that follow the correlation set.</span></span> <span data-ttu-id="68ddb-115">Supposons de plus qu'en conditions de charge, une accumulation se produise au niveau du spooleur lors de l'arrivée du mélange de messages d'activation et de corrélation, et que cette accumulation entraîne une limitation de la quantité des messages pouvant être reçus.</span><span class="sxs-lookup"><span data-stu-id="68ddb-115">In addition, assume that, under load, a backlog builds up in the spool as the mix of activation and correlation messages arrive that results in throttling the amount of messages that can be received.</span></span> <span data-ttu-id="68ddb-116">Malheureusement, les messages de corrélation étant limités avec les activations, cela ralentit l'exécution des orchestrations et entraîne ainsi une nouvelle accumulation et une limitation supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="68ddb-116">Unfortunately, the correlation messages are throttled along with the activations, which slows down the completion of orchestrations, causing further backlog and additional throttling.</span></span> <span data-ttu-id="68ddb-117">Si ce scénario se poursuivait, on assisterait à la limitation du système jusqu'à un débit proche de zéro.</span><span class="sxs-lookup"><span data-stu-id="68ddb-117">Allowed to continue, this would result in throttling the system down to near zero throughput.</span></span>  
  
 <span data-ttu-id="68ddb-118">En divisant l'emplacement de réception unique en deux, un emplacement pour les activations et un emplacement pour les corrélations, et en configurant les emplacements dans des hôtes distincts, le seuil de limitation de la taille de la base de données correspondant aux activations peut être maintenu à un niveau plus bas que celui correspondant aux corrélations, ce qui permet de réduire le nombre global des blocages et de maintenir la transmission des messages.</span><span class="sxs-lookup"><span data-stu-id="68ddb-118">By splitting the single receive location into two -- one for activations and one for correlations -- and configuring the locations in separate hosts, the database size throttling threshold for the activations can be kept lower than that for correlations, which will result in reduced backlog overall, and keep the messages flowing.</span></span>  
  
 <span data-ttu-id="68ddb-119">Par conséquent, vous vous demandez peut-être : « Pourquoi ne puis-je pas simplement relever le seuil de taille de base de données de mon seul emplacement de réception à résoudre le problème ? »</span><span class="sxs-lookup"><span data-stu-id="68ddb-119">So, you might be asking: "why can’t I just raise the database size threshold for my single receive location to fix the problem?"</span></span> <span data-ttu-id="68ddb-120">Ce serait possible mais vous n'obtiendriez pas toujours le comportement souhaité.</span><span class="sxs-lookup"><span data-stu-id="68ddb-120">The answer is, you can, but it won’t always result in the desired behavior.</span></span> <span data-ttu-id="68ddb-121">La limitation sert surtout à protéger le système contre les surcharges.</span><span class="sxs-lookup"><span data-stu-id="68ddb-121">Throttling is there primarily to protect the system from becoming overloaded.</span></span> <span data-ttu-id="68ddb-122">Si vous élevez suffisamment les seuils ou si vous les désactivez complètement, vous ôterez cette protection.</span><span class="sxs-lookup"><span data-stu-id="68ddb-122">If you raise the thresholds high enough, or turn them off altogether, you will eliminate this protection.</span></span>  
  
## <a name="recommendation"></a><span data-ttu-id="68ddb-123">Recommandation</span><span class="sxs-lookup"><span data-stu-id="68ddb-123">Recommendation</span></span>  
 <span data-ttu-id="68ddb-124">La meilleure chose à faire dans les scénarios similaires à celui décrit ci-dessus est de répartir les emplacements de réception dans des hôtes distincts pouvant être limités de façon indépendante.</span><span class="sxs-lookup"><span data-stu-id="68ddb-124">The best practice for scenarios such as the one described above that are sensitive to throttling correlation messages, is to separate the receive locations into separate hosts which can be throttled independently.</span></span>  
  
 <span data-ttu-id="68ddb-125">Lorsque des hôtes distincts sont configurés pour des emplacements de réception, définissez le seuil de limitation de la taille de base de données correspondant à l'hôte utilisé par les emplacements de réception sur une valeur inférieure à celle du seuil correspondant aux hôtes utilisés par les orchestrations ou les corrélations.</span><span class="sxs-lookup"><span data-stu-id="68ddb-125">When separate hosts are configured for receive locations, set the database size throttling threshold for the host used by the receive locations to a lower value than the database size throttling threshold for hosts used by orchestrations or correlations.</span></span>  
  
 <span data-ttu-id="68ddb-126">Si vous savez que votre charge ne dépassera jamais le débit maximal acceptable du système, ou que les pics de débit sont récupérables entre les événements de pic, élever les seuils de limitation pourra aussi être une solution mais ne permettra sans doute pas un débit aussi élevé que si vous utilisiez des hôtes distincts pour les activations et les corrélations.</span><span class="sxs-lookup"><span data-stu-id="68ddb-126">If you know that your load will never be higher than the maximum sustainable throughput (MST) for the system, or that throughput peaks are recoverable between peak events, then raising the throttling thresholds will also work, but may not sustain as high a throughput as using separate hosts for activations and correlations.</span></span>