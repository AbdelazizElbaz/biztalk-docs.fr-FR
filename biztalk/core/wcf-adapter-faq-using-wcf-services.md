---
title: 'FAQ sur les adaptateurs WCF : Utilisation des Services WCF | Documents Microsoft'
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: befa2268-8a65-465f-8086-70a66808845e
caps.latest.revision: ''
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 41d02fe0b7be1f53edaac4c18cfd7717a25c3a71
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/23/2018
---
# <a name="wcf-adapter-faq-using-wcf-services"></a><span data-ttu-id="ac2a6-102">FAQ sur les adaptateurs WCF : utilisation des services WCF</span><span class="sxs-lookup"><span data-stu-id="ac2a6-102">WCF Adapter FAQ: Using WCF Services</span></span>
## <a name="how-does-biztalk-server-use-its-wcf-adapters-to-access-wcf-services"></a><span data-ttu-id="ac2a6-103">Comment BizTalk Server utilise-t-il les adaptateurs WCF pour accéder aux services WCF ?</span><span class="sxs-lookup"><span data-stu-id="ac2a6-103">How does BizTalk Server use its WCF adapters to access WCF services?</span></span>  
 <span data-ttu-id="ac2a6-104">Les adaptateurs WCF BizTalk sont configurés dans BizTalk Server via un emplacement de réception ou un port d'envoi WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-104">BizTalk WCF adapters are configured in BizTalk Server through either a WCF receive location or a send port.</span></span> <span data-ttu-id="ac2a6-105">Lorsqu'un emplacement de réception utilisant un adaptateur WCF est activé, une instance ServiceHost unique est instanciée et initialisée pour chaque emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-105">When a receive location using a WCF adapter is enabled, a single ServiceHost instance is instantiated and initialized for each receive location.</span></span> <span data-ttu-id="ac2a6-106">L'instance ServiceHost exécute un service générique qui accepte des messages WCF entrants, puis les convertit en messages BizTalk avant de les publier dans la base de données MessageBox BizTalk.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-106">The ServiceHost runs a generic service that accepts incoming WCF messages, and converts them to BizTalk messages before publishing them to the BizTalk MessageBox database.</span></span> <span data-ttu-id="ac2a6-107">Le service ServiceHost générique est interne à l'implémentation de l'adaptateur de réception WCF BizTalk et expose un contrat sans type.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-107">The generic ServiceHost service is internal to the WCF BizTalk receive adapter implementation and exposes a typeless contract.</span></span> <span data-ttu-id="ac2a6-108">Dans WCF, un contrat sans type se compose de signatures d'opération qui prennent un paramètre de type WCF System.ServiceModel.Channel.Message.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-108">In WCF, a typeless contract consists of operation signatures that take a single parameter of type WCF System.ServiceModel.Channel.Message.</span></span>  
  
 <span data-ttu-id="ac2a6-109">L'opération d'un service WCF doit être marquée comme IsOneWay=false si elle doit être accessible par un port d'envoi BizTalk même s'il n'y aucune donnée à renvoyer.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-109">The operation  of a WCF service should be marked as IsOneWay=false if they are to be accessed by a BizTalk send port even if there is no data to return.</span></span> <span data-ttu-id="ac2a6-110">Les opérations sur le contrat côté client doivent être annotées IsOneWay=false et ReplyAction=”\*”.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-110">The operations on the client-side contract should be annotated with IsOneWay=false and ReplyAction=”\*”.</span></span>  <span data-ttu-id="ac2a6-111">En outre, tous les appels provenant du client doivent être marqués comme IsOneWay=”false”.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-111">Additionally all calls from the client should be marked at IsOneWay=”false”.</span></span> <span data-ttu-id="ac2a6-112">Une opération de service bidirectionnelle peut renvoyer une valeur de type Message.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-112">A two-way service operation may return a value of type Message.</span></span> <span data-ttu-id="ac2a6-113">Une exception à cela consiste à utiliser l'adaptateur WCF-NetMsmq puisqu'il exécute une opération unidirectionnelle qui publie un message dans une file d'attente MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-113">The exception to this is using the WCF-NetMsmq adapter since it executes a one-way operation that posts a message into an MSMQ queue.</span></span> <span data-ttu-id="ac2a6-114">Dans ce cas, le port d'envoi peut être unidirectionnel et chaque opération de service est marquée comme IsOneWay=true.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-114">In this case the send port can be one-way and any service operation marked as IsOneWay=true.</span></span>  
  
 <span data-ttu-id="ac2a6-115">Dans WCF, il est également possible de définir un élément OperationContract isOneWay=false sur une méthode renvoyant void.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-115">It may be a little confusing that it is also possible in WCF to define an isOneWay=false OperationContract on a method that actually returns void.</span></span> <span data-ttu-id="ac2a6-116">Dans une telle situation, un message est renvoyé sur le câble créé pour vous au moment de l'exécution de WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-116">In such a situation there is actually a message returned on the wire created by the WCF runtime for you.</span></span>  
  
 <span data-ttu-id="ac2a6-117">Les adaptateurs WCF BizTalk utilisent cette fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-117">The BizTalk WCF adapters make use of this feature.</span></span> <span data-ttu-id="ac2a6-118">Lorsque vous spécifiez un port BizTalk unidirectionnel, vous obtenez une méthode void avec isOneWay=false dans l'implémentation de l'adaptateur WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-118">When you specify a one-way BizTalk port you actually get a void method with isOneWay=false within the implementation of the WCF adapter.</span></span> <span data-ttu-id="ac2a6-119">Notez qu'un port unidirectionnel BizTalk utilisant un canal direct comme HTTP ou net.tcp correspond en fait à un élément OperationContract isOneWay=false.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-119">The point is that a BizTalk one-way port, when using a direct channel such as HTTP or net.tcp, will actually correspond to an isOneWay=false OperationContract.</span></span> <span data-ttu-id="ac2a6-120">Les canaux mis en file d'attente comme net.msmq sont différents, car il arrive qu'un port BizTalk unidirectionnel communique avec un OperationContract isOneWay=true.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-120">Queued channels such as net.msmq are different in that a one-way BizTalk port does happen to talk to an isOneWay=true OperationContract.</span></span> <span data-ttu-id="ac2a6-121">La situation est différente, car le distributeur WCF utilise une transaction sur le canal.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-121">The situation is different because the WCF dispatcher is using a transaction against the channel.</span></span>  
  
## <a name="how-do-you-create-and-use-a-custom-binding-with-a-wcf-custom-adapter"></a><span data-ttu-id="ac2a6-122">Création et utilisation d'une liaison personnalisée avec un adaptateur WCF personnalisé</span><span class="sxs-lookup"><span data-stu-id="ac2a6-122">How do you create and use a custom binding with a WCF custom adapter?</span></span>  
 <span data-ttu-id="ac2a6-123">Une liaison CustomBinding WCF est composée d'un regroupement d'éléments BindingElements.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-123">A WCF CustomBinding consists of a collection of BindingElements.</span></span> <span data-ttu-id="ac2a6-124">Elle peut être créée soit en extrayant divers éléments BindingElements préexistants (par exemple, en combinant un transport préexistant avec l'encodeur préexistant d'une autre source),</span><span class="sxs-lookup"><span data-stu-id="ac2a6-124">A CustomBinding can be created by pulling together pre-existing BindingElements (for example, combining a pre-existing Transport with a pre-existing Encoder from another source).</span></span> <span data-ttu-id="ac2a6-125">soit en combinant un élément BindingElement préexistant avec un élément BindingElement personnalisé récemment écrit.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-125">Or it can be created by combining a pre-existing BindingElement with a newly written custom BindingElement.</span></span> <span data-ttu-id="ac2a6-126">Un élément CustomBinding peut être généré dans le code à partir de ces composants BindingElements en les ajoutant par programme.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-126">In code a CustomBinding can be built from these component BindingElements by adding them programmatically.</span></span> <span data-ttu-id="ac2a6-127">WCF permet également cette construction via la configuration .NET (fichiers de configuration).</span><span class="sxs-lookup"><span data-stu-id="ac2a6-127">WCF also allows this construction through .NET Configuration (config files).</span></span> <span data-ttu-id="ac2a6-128">À l'aide de BizTalk Server, cet élément CustomBinding peut être créé via l'adaptateur WCF BizTalk personnalisé.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-128">By using BizTalk Server this CustomBinding can be created through the BizTalk WCF Custom adapter.</span></span>  
  
 <span data-ttu-id="ac2a6-129">L'adaptateur WCF BizTalk personnalisé permet de déployer une nouvelle liaison à partir des éléments BindingElements, ainsi que de configurer directement une nouvelle liaison.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-129">The BizTalk WCF Custom adapter not only allows you to build a new binding from BindingElements but also lets you configure a new binding directly.</span></span> <span data-ttu-id="ac2a6-130">Il permet également de configurer les comportements sur les liaisons standard.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-130">It also allows you to configure behaviors on standard bindings.</span></span> <span data-ttu-id="ac2a6-131">Ceci est particulièrement utile car l'écriture de comportements personnalisés est bien plus facile que l'écriture de nouveaux objets BindingElements.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-131">This is particularly useful because writing custom behaviors is much easier than writing new BindingElements objects.</span></span>  
  
 <span data-ttu-id="ac2a6-132">Création d’un élément BindingElement est un exercice de développement impliquées et la meilleure source d’informations de référence pour qu’il est exemples WCF sur le lien hypertexte «http://go.microsoft.com/fwlink/?LinkId=142449"\t « _blank » http://go.microsoft.com/fwlink/?LinkId=142449.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-132">Building a BindingElement is an involved development exercise and the best source of reference for it is the WCF samples at  HYPERLINK "http://go.microsoft.com/fwlink/?LinkId=142449" \t "_blank" http://go.microsoft.com/fwlink/?LinkId=142449.</span></span> <span data-ttu-id="ac2a6-133">Pour créer un élément BindingElement personnalisé, vous créez une classe dérivant de BindingElement.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-133">To create a custom BindingElement you create a class that derives from BindingElement.</span></span> <span data-ttu-id="ac2a6-134">Un nouvel élément BindingElement doit se trouver dans un nouvel assembly.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-134">A new BindingElement will have to be in a new assembly.</span></span> <span data-ttu-id="ac2a6-135">Celui-ci doit être installé dans le GAC de l'ordinateur d'administration dans lequel sont configurés l'hôte, le port d'envoi et l'emplacement de réception BizTalk.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-135">This assembly must be installed into the Global Assembly Cache (GAC) of the administration computer where the BizTalk Host, send port, and receive location are configured.</span></span> <span data-ttu-id="ac2a6-136">Pour associer une liaison personnalisée avec un port d’envoi ou emplacement de réception, vous devez d’abord ajouter à la \<bindingElementExtensions\> section du fichier machine.config sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-136">To associate a custom binding with a specific send port or receive location, you first need to add it to the \<bindingElementExtensions\> section of the machine.config file on the same computer.</span></span>  
  
 <span data-ttu-id="ac2a6-137">Après avoir apporté cette modification, vous pouvez afficher le **Configuration des propriétés de Transport** boîte de dialogue pour configurer la liaison.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-137">After making that change you can then bring up the **Transport Properties Configuration** dialog box to configure the binding.</span></span>  
  
1.  <span data-ttu-id="ac2a6-138">Sur le **liaison** onglet, le type de liaison, sélectionnez **customBinding**.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-138">On the **Binding** tab, for Binding type, select **customBinding**.</span></span>  
  
2.  <span data-ttu-id="ac2a6-139">Dans le **liaison** volet, avec le bouton droit **CustomBindingElement**, puis sélectionnez **Ajout d’une Extension**.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-139">In the **Binding** pane, right-click **CustomBindingElement**, and select **Add Extension**.</span></span>  
  
3.  <span data-ttu-id="ac2a6-140">Sélectionnez l'élément de liaison que vous avez spécifié dans le fichier machine.config, puis configurez la liaison selon vos besoins.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-140">Select the binding element you specified in the machine.config file and configure the binding as required.</span></span> <span data-ttu-id="ac2a6-141">La liaison peut à présent utiliser la transmission ou la réception de messages.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-141">It is now ready to use for message transmission or receipt.</span></span>  
  
 <span data-ttu-id="ac2a6-142">BizTalk utilise une validation très limitée pour une liaison personnalisée lorsque celle-ci a été ajoutée de cette manière.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-142">BizTalk does very limited validation for a custom binding when it has been added in this manner.</span></span> <span data-ttu-id="ac2a6-143">Toutefois, il est important de vérifier que les éléments de liaison sont répertoriés dans le bon ordre.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-143">Therefore, it is important to ensure the binding elements are listed in the correct order.</span></span> <span data-ttu-id="ac2a6-144">L'élément de liaison qui doit être invoqué en premier au moment de l'exécution doit être en bas de l'arborescence des liaisons CustomBindingElement dans la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-144">The binding element you want invoked first at runtime must be on the bottom of the CustomBindingElement binding tree in the dialog box.</span></span> <span data-ttu-id="ac2a6-145">La liste des éléments BindingElements doit contenir un transport, qui doit être en bas de la liste.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-145">The list of BindingElements must contain a Transport and that Transport must be at the bottom of the list.</span></span> <span data-ttu-id="ac2a6-146">L'ensemble d'éléments BindingElements doit également contenir un encodeur.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-146">The set of BindingElements may also contain an Encoder.</span></span> <span data-ttu-id="ac2a6-147">Pour plus d’informations, consultez la documentation WCF sur la liaison d’éléments à [ http://go.microsoft.com/fwlink/?LinkId=142449 ](http://go.microsoft.com/fwlink/?LinkId=142449).</span><span class="sxs-lookup"><span data-stu-id="ac2a6-147">For more information, see the WCF documentation on binding elements at [http://go.microsoft.com/fwlink/?LinkId=142449](http://go.microsoft.com/fwlink/?LinkId=142449).</span></span>  
  
## <a name="what-is-a-wcf-custom-behavior-and-how-do-i-use-one-with-biztalk-server"></a><span data-ttu-id="ac2a6-148">Définition d'un comportement WCF personnalisé et utilisation de celui-ci avec BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="ac2a6-148">What is a WCF custom behavior and how do I use one with BizTalk Server?</span></span>  
 <span data-ttu-id="ac2a6-149">L'un des avantages d'utiliser WCF en tant que mécanisme de communication par message est la possibilité d'étendre les fonctionnalités de ses services à l'aide d'un code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-149">One of the advantages of using WCF as a message communication mechanism is the opportunity to extend the functionality of its services by using custom code.</span></span> <span data-ttu-id="ac2a6-150">Les extensions de comportement personnalisé sont l'une des fonctionnalités qui différencie WCF des autres technologies de services Web sur le marché.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-150">Custom behavior extensions are one of the features that differentiate WCF from other Web services technologies in the market.</span></span>  
  
 <span data-ttu-id="ac2a6-151">Différents points du flux d'un message WCF interceptent et exécutent un traitement personnalisé avant que le message n'atteigne sa destination finale.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-151">There are different points within the flow of a WCF message to intercept and execute custom processing before a message reaches its final destination.</span></span> <span data-ttu-id="ac2a6-152">Les extensions de comportement personnalisé WCF sont l'un de ces mécanismes d'interception. Elles peuvent permettre d'étendre le service WCF ou la fonctionnalité client à différents niveaux de granularité.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-152">WCF custom behavior extensions are one such type of interception mechanism and can be used to extend WCF service or client functionality at different levels of granularity.</span></span> <span data-ttu-id="ac2a6-153">Elles peuvent exister aux niveaux du service et du client WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-153">Custom behavior extensions can exist at both the WCF service and client levels.</span></span> <span data-ttu-id="ac2a6-154">La configuration d'un comportement sur la pile d'appels vers un service WCF n'a aucune incidence sur la liaison de communication utilisée pour l'appel.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-154">Configuring a behavior on the call stack to a WCF service has no influence on the communication binding used to make the call.</span></span> <span data-ttu-id="ac2a6-155">En fait, les comportements sont généralement invisibles au client car ils ne sont pas affichés dans les métadonnées qu'un service publie.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-155">In fact, behaviors are typically invisible to the client because they are not displayed in the metadata a service publishes.</span></span> <span data-ttu-id="ac2a6-156">Le client ne se rend habituellement pas compte que des comportements sont exécutés lors d'un appel vers une opération WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-156">The client typically has no idea that the behaviors are executing during a call to a WCF operation.</span></span>  
  
 <span data-ttu-id="ac2a6-157">La capacité à implémenter facilement un traitement personnalisé dans un appel vers un service WCF est l'une des raisons pour lesquelles WCF est un paradigme de programmation riche, en comparaison avec d'autres méthodes de communication entre les applications Web.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-157">The ability to easily implement custom processing in a call to a WCF service is one of the main reasons why WCF is such a rich programming paradigm compared to other ways of communication between Web applications.</span></span> <span data-ttu-id="ac2a6-158">Le traitement personnalisé peut prendre la plupart des formes, selon les besoins d'extensibilité de l'application Web.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-158">This custom processing can take almost any form as dictated by extensibility requirements within a Web application.</span></span> <span data-ttu-id="ac2a6-159">Les développeurs peuvent créer des extensions personnalisées qui inspectent et valident la configuration du service, ou modifient le comportement à l'exécution dans les applications de client et de service WCF.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-159">Developers can create custom extensions that inspect and validate service configuration or modify runtime behavior in WCF client and service applications.</span></span> <span data-ttu-id="ac2a6-160">Comportements peuvent compléter le traitement normal des messages, modifiez le message au cours du traitement, vérifier certains critères de configuration et prenez les mesures appropriées, valider les identités de l’appelant et passer le message si elle est réussie, etc. Car il s’agit réellement personnalisé mécanisme vous implémentez toutes les extensions de traitement votre application a besoin.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-160">Behaviors can supplement normal message processing, modify the message during processing, scrutinize certain configuration criteria and take appropriate action, validate identities of the caller and pass the message on if it is successful, etc. Because it is truly a custom processing mechanism you implement whatever extensibility your application needs.</span></span>  
  
 <span data-ttu-id="ac2a6-161">Pour utiliser un comportement personnalisé WCF dans BizTalk Server vous allez le configurer à l’aide de la **comportement** onglet de l’adaptateur WCF-Custom ou WCF-CustomIsolated pour un emplacement de réception ou un port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="ac2a6-161">To use a WCF custom behavior in BizTalk Server you will configure it by using the **Behavior** tab for the WCF-Custom or WCF-CustomIsolated adapter for a receive location or a send port.</span></span>