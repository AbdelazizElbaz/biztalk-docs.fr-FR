---
title: "Comment tester et déboguer un adaptateur | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: cf6563ea-b4ea-4617-b3da-d31250d002ab
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 508f0b5a5ee7b29ed6e2fbde9a94b352d645e550
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-test-and-debug-an-adapter"></a><span data-ttu-id="3134f-102">Test et débogage d'un adaptateur</span><span class="sxs-lookup"><span data-stu-id="3134f-102">How to Test and Debug an Adapter</span></span>
<span data-ttu-id="3134f-103">Le débogage des problèmes d'exécution doit souvent être abordé sous plusieurs angles.</span><span class="sxs-lookup"><span data-stu-id="3134f-103">Debugging run-time problems often requires a multifaceted approach.</span></span> <span data-ttu-id="3134f-104">Pour déterminer la cause des problèmes ou des bogues logiciels, il est nécessaire de rassembler des données de plusieurs sources telles que le suivi logiciel, les compteurs de performance, les entrées de journal d'événements, les événements WMI (Windows Management Instrumentation) et le code source de débogage.</span><span class="sxs-lookup"><span data-stu-id="3134f-104">Data must be gathered from multiple sources such as software tracing, performance counters, event log entries, Windows Management Instrumentation (WMI) events, and debugging source code to determine the cause of problems or software bugs.</span></span>  
  
 <span data-ttu-id="3134f-105">Les adaptateurs de réception et d'envoi étant exécutés dans l'espace d'adressage du service BizTalk, le débogueur doit être associé au processus BtsNtSvc.exe pour pouvoir déboguer un adaptateur.</span><span class="sxs-lookup"><span data-stu-id="3134f-105">Because receive and send adapters run in the address space of the BizTalk service the debugger needs to be attached to the BtsNtSvc.exe process to debug an adapter.</span></span> <span data-ttu-id="3134f-106">Par contre, pour les adaptateurs de réception isolés, le débogueur doit être associé au processus qui les héberge.</span><span class="sxs-lookup"><span data-stu-id="3134f-106">However for isolated receive adapters, the debugger needs to be attached to the process that hosts the adapter.</span></span>  
  
 <span data-ttu-id="3134f-107">Le code d'exécution de l'adaptateur doit idéalement être instrumenté avec un code de suivi pour pouvoir capturer des diagnostics d'exécution en vue du dépannage.</span><span class="sxs-lookup"><span data-stu-id="3134f-107">The adapter run-time code should be instrumented with tracing code to capture run-time diagnostics for troubleshooting.</span></span> <span data-ttu-id="3134f-108">Vous pouvez réaliser cette instrumentation à l'aide de Microsoft Enterprise Instrumentation Framework (EIF).</span><span class="sxs-lookup"><span data-stu-id="3134f-108">You can do this by using the Microsoft Enterprise Instrumentation Framework (EIF).</span></span> <span data-ttu-id="3134f-109">Il est généralement utile d'ajouter des instructions de suivi à chaque niveau de gravité. Par exemple, suivi pour les conditions d'erreur uniquement, suivi pour les erreurs et les avertissements ou suivi pour les erreurs, les avertissements et les instructions d'information.</span><span class="sxs-lookup"><span data-stu-id="3134f-109">Typically it is useful to add trace statements for different levels of severity, for example, tracing for error conditions only, tracing for errors and warnings, and finally tracing for errors, warnings, and informational statements.</span></span> <span data-ttu-id="3134f-110">Par ailleurs, les adaptateurs plus complexes comportent parfois des sous-systèmes séparés dont le suivi doit être effectué de manière isolée.</span><span class="sxs-lookup"><span data-stu-id="3134f-110">Further, more complex adapters may have separate subsystems that need to be traced in isolation from each other.</span></span> <span data-ttu-id="3134f-111">Un adaptateur peut en effet avoir un sous-sous-système de réseau et un sous-système principal. L'activation du suivi pour tous les sous-systèmes est susceptible de générer une quantité excessive de « bruit » dans certains cas de figure.</span><span class="sxs-lookup"><span data-stu-id="3134f-111">For example, an adapter may have a network subsubsystem and a core subsystem; enabling tracing for all subsystems may generate an excessive amount of "noise" in some scenarios.</span></span>  
  
 <span data-ttu-id="3134f-112">Des compteurs de performance doivent être ajoutés pour capturer les taux et valeurs au moment de l'exécution et donner davantage d'informations au sujet du comportement de l'adaptateur durant l'exécution.</span><span class="sxs-lookup"><span data-stu-id="3134f-112">Performance counters should be added to capture rates and values at run time to give more information about the run-time behavior of the adapter.</span></span> <span data-ttu-id="3134f-113">Par exemple, un adaptateur pourra publier des compteurs de performance pour les nombres bruts des messages envoyés terminaison par terminaison ainsi que pour le nombre de messages envoyés par seconde.</span><span class="sxs-lookup"><span data-stu-id="3134f-113">For example, an adapter might publish performance counters for the raw numbers of messages sent on a per-endpoint basis as well as the rate of messages sent per second.</span></span>  
  
 <span data-ttu-id="3134f-114">Les événements WMI peuvent aussi s'avérer utiles pour certains scénarios d'erreurs critiques.</span><span class="sxs-lookup"><span data-stu-id="3134f-114">WMI events may also be useful for some critical error scenarios.</span></span>  <span data-ttu-id="3134f-115">Par exemple, si un adaptateur rencontre une erreur critique qui l'amène à fermer un emplacement de réception, le déclenchement d'un événement WMI permet à un administrateur d'écouter cet événement et de prendre les mesures nécessaires.</span><span class="sxs-lookup"><span data-stu-id="3134f-115">For instance if an adapter hits a critical error that causes it to shut down a receive location, firing a WMI event allows an administrator to listen on that event and take appropriate action.</span></span>  
  
## <a name="adapter-testing"></a><span data-ttu-id="3134f-116">Test des adaptateurs</span><span class="sxs-lookup"><span data-stu-id="3134f-116">Adapter Testing</span></span>  
 <span data-ttu-id="3134f-117">Lorsque vous développez un adaptateur personnalisé pour BizTalk Server, rappelez-vous qu'il doit avoir la qualité logicielle de l'entreprise.</span><span class="sxs-lookup"><span data-stu-id="3134f-117">When you develop a custom adapter for BizTalk Server, remember that it should be developed to enterprise software quality.</span></span> <span data-ttu-id="3134f-118">Cela signifie que vous devez le tester de manière approfondie avant de le livrer.</span><span class="sxs-lookup"><span data-stu-id="3134f-118">This means that you need to test the adapter thoroughly before shipping it.</span></span> <span data-ttu-id="3134f-119">Cette section donne une bonne idée de ce qu'il faut faire pour tester des adaptateurs, sans entrer dans tous les détails.</span><span class="sxs-lookup"><span data-stu-id="3134f-119">While it does not completely detail how adapters should be tested, this section gives an idea of what needs to be done.</span></span> <span data-ttu-id="3134f-120">En règle générale le test de code d’exécution tels que des cartes doit couvrir les trois grandes catégories : test fonctionnel, test de stress et test des performances.</span><span class="sxs-lookup"><span data-stu-id="3134f-120">In general the testing of run-time code such as adapters should cover three broad categories: functional testing, stress testing, and performance testing.</span></span>  
  
### <a name="function-testing"></a><span data-ttu-id="3134f-121">Test fonctionnel</span><span class="sxs-lookup"><span data-stu-id="3134f-121">Function Testing</span></span>  
 <span data-ttu-id="3134f-122">L'adaptateur doit être testé pour toutes les permutations de sa fonctionnalité et doit être soumis à des tests aussi bien positifs que négatifs.</span><span class="sxs-lookup"><span data-stu-id="3134f-122">The adapter should be tested for all permutations of its functionality, including both positive tests and negative tests.</span></span> <span data-ttu-id="3134f-123">Les tests positifs devront porter entre autres sur les cas de figure suivants :</span><span class="sxs-lookup"><span data-stu-id="3134f-123">Positive tests should include but not be limited to the following scenarios:</span></span>  
  
-   <span data-ttu-id="3134f-124">recevoir un ou des messages ;</span><span class="sxs-lookup"><span data-stu-id="3134f-124">Receive a message(s)</span></span>  
  
-   <span data-ttu-id="3134f-125">transmettre un ou des messages ;</span><span class="sxs-lookup"><span data-stu-id="3134f-125">Transmit a message(s)</span></span>  
  
-   <span data-ttu-id="3134f-126">transmettre un message à l'aide d'un port dynamique ;</span><span class="sxs-lookup"><span data-stu-id="3134f-126">Transmit a message using a dynamic port</span></span>  
  
-   <span data-ttu-id="3134f-127">désactiver des emplacements de réception ;</span><span class="sxs-lookup"><span data-stu-id="3134f-127">Disable receive locations</span></span>  
  
-   <span data-ttu-id="3134f-128">mettre à jour la configuration ;</span><span class="sxs-lookup"><span data-stu-id="3134f-128">Update configuration</span></span>  
  
-   <span data-ttu-id="3134f-129">garantir que les fenêtre du service fonctionnent pour les adaptateurs de réception et d'envoi ;</span><span class="sxs-lookup"><span data-stu-id="3134f-129">Ensure service windows are working for both receive and send adapters</span></span>  
  
-   <span data-ttu-id="3134f-130">garantir l'intégrité transactionnelle des adaptateurs traités.</span><span class="sxs-lookup"><span data-stu-id="3134f-130">Ensure transactional integrity for transacted adapters</span></span>  
  
 <span data-ttu-id="3134f-131">Les tests négatifs devront porter entre autres sur les cas de figure suivants :</span><span class="sxs-lookup"><span data-stu-id="3134f-131">Negative tests should include but not be limited to:</span></span>  
  
-   <span data-ttu-id="3134f-132">recevoir un ou des messages incorrects ;</span><span class="sxs-lookup"><span data-stu-id="3134f-132">Receive a bad message(s)</span></span>  
  
-   <span data-ttu-id="3134f-133">recevoir un lot mixte de messages corrects et incorrects ;</span><span class="sxs-lookup"><span data-stu-id="3134f-133">Receive a mixed batch of messages, some good and some bad</span></span>  
  
-   <span data-ttu-id="3134f-134">transmettre une erreur ;</span><span class="sxs-lookup"><span data-stu-id="3134f-134">Transmit failure</span></span>  
  
-   <span data-ttu-id="3134f-135">faire une nouvelle tentative en cas de réussite ;</span><span class="sxs-lookup"><span data-stu-id="3134f-135">Retry successful</span></span>  
  
-   <span data-ttu-id="3134f-136">faire une nouvelle tentative en cas d'échec, passer au prochain transport réussi ;</span><span class="sxs-lookup"><span data-stu-id="3134f-136">Retry fails, move to next transport successful</span></span>  
  
-   <span data-ttu-id="3134f-137">passer au prochain échec de transport, interrompre le message ;</span><span class="sxs-lookup"><span data-stu-id="3134f-137">Move to next transport fails, suspend message</span></span>  
  
-   <span data-ttu-id="3134f-138">transmettre un lot mixte de messages ;</span><span class="sxs-lookup"><span data-stu-id="3134f-138">Transmit a mixed batch of messages</span></span>  
  
-   <span data-ttu-id="3134f-139">basculement de base de données.</span><span class="sxs-lookup"><span data-stu-id="3134f-139">Database failover</span></span>  
  
### <a name="stress-testing"></a><span data-ttu-id="3134f-140">Test de stress</span><span class="sxs-lookup"><span data-stu-id="3134f-140">Stress Testing</span></span>  
 <span data-ttu-id="3134f-141">En tant que composants d'exécution, les adaptateurs doivent satisfaire aux exigences rigoureuses des logiciels d'exécution.</span><span class="sxs-lookup"><span data-stu-id="3134f-141">Adapters are run-time components and as such should meet the stringent requirements for run-time software.</span></span> <span data-ttu-id="3134f-142">Généralement, le test de stress consiste à mettre en œuvre des scénarios en condition de charge sur une certaine durée.</span><span class="sxs-lookup"><span data-stu-id="3134f-142">Typically stress testing is carried out by running scenarios under load for a period of time.</span></span> <span data-ttu-id="3134f-143">Entre les tests d'échec, des intervalles de stress élevé et de faible stress devront par ailleurs être testés pendant que l'adaptateur sera exécuté en condition de charge sur une durée déterminée.</span><span class="sxs-lookup"><span data-stu-id="3134f-143">Further high-stress and low-stress mean time between failure tests should be performed, whereby the adapter is run under load for a measured time period.</span></span>  
  
 <span data-ttu-id="3134f-144">Pour conduire ces tests, il sera notamment judicieux d'exécuter l'adaptateur sous un stress élevé pendant environ 72 heures, quand le nombre des messages qui transitent par l'adaptateur entraîne une utilisation de l'UC de 80 à 90 pour cent.</span><span class="sxs-lookup"><span data-stu-id="3134f-144">Some rough guidelines for these tests might be running the adapter at high stress for around 72 hours, where the number of messages through the adapter causes the CPU utilization to be around of 80 to 90 percent.</span></span> <span data-ttu-id="3134f-145">Sous faible stress, l'utilisation de l'UC devrait être de 30 à 40 pour cent pendant 120 heures.</span><span class="sxs-lookup"><span data-stu-id="3134f-145">For low stress, the CPU utilization would be around 30 to 40 percent for around 120 hours.</span></span>  
  
### <a name="performance-testing"></a><span data-ttu-id="3134f-146">Test de performances</span><span class="sxs-lookup"><span data-stu-id="3134f-146">Performance Testing</span></span>  
 <span data-ttu-id="3134f-147">Les performances sont un aspect incontournable du développement des adaptateurs.</span><span class="sxs-lookup"><span data-stu-id="3134f-147">Adapters should be developed with performance in mind.</span></span> <span data-ttu-id="3134f-148">Avant de sortir un adaptateur, veillez donc à valider ses performances.</span><span class="sxs-lookup"><span data-stu-id="3134f-148">Before releasing an adapter you should validate its performance.</span></span> <span data-ttu-id="3134f-149">Il est primordial qu'elles évoluent verticalement et horizontalement. Autrement dit, l'ajout d'UC a pour conséquence une augmentation des performances, au même titre que l'ajout d'ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="3134f-149">It is important to ensure that its performance scales up and scales out; that is, adding more CPUs leads to a performance increase as does adding more computers.</span></span> <span data-ttu-id="3134f-150">Profiler le code peut faciliter l'élimination des goulots d'étranglement liés aux performances.</span><span class="sxs-lookup"><span data-stu-id="3134f-150">Profiling the code can help to eliminate performance bottlenecks.</span></span>