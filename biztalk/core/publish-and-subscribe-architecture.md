---
title: "Publier et s’abonner Architecture | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- publish/subscribe architecture, publishers
- architecture, publish/subscribe
- publishing, publish/subscribe architecture
- publish/subscribe architecture, about publish/subscribe architecture
- creating, subscriptions
- publish/subscribe architecture, Messaging Engine
- routing, publishing
- Messaging Engine, publishing
- publish/subscribe architecture, subscribers
- publish/subscribe architecture
- subscriptions, publish/subscribe architecture
- publish/subscribe architecture, creating subscriptions
- subscriptions, creating
- Messaging Engine, subscribing
- publishing, routing
- Messaging Engine, publish/subscribe architecture
- publish/subscribe architecture, events
ms.assetid: 5ed36c1f-077d-468f-a99e-60f97377cef6
caps.latest.revision: "11"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b11ed175fc047eee59761547d8d13ab798ac860c
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="publish-and-subscribe-architecture"></a><span data-ttu-id="0b225-102">Architecture « publication-abonnement »</span><span class="sxs-lookup"><span data-stu-id="0b225-102">Publish and Subscribe Architecture</span></span>
<span data-ttu-id="0b225-103">Dans une conception publication/abonnement, trois composants entrent en jeu :</span><span class="sxs-lookup"><span data-stu-id="0b225-103">In a publish/subscribe design, you have three components:</span></span>  
  
-   <span data-ttu-id="0b225-104">Serveurs de publication</span><span class="sxs-lookup"><span data-stu-id="0b225-104">Publishers</span></span>  
  
-   <span data-ttu-id="0b225-105">Abonnés</span><span class="sxs-lookup"><span data-stu-id="0b225-105">Subscribers</span></span>  
  
-   <span data-ttu-id="0b225-106">Événements</span><span class="sxs-lookup"><span data-stu-id="0b225-106">Events</span></span>  
  
 <span data-ttu-id="0b225-107">Parmi les serveurs de publication, on peut citer les ports de réception qui publient les messages qui arrivent à leur emplacement de destination, les orchestrations qui publient les messages lorsqu'elles envoient des messages ou lorsqu'elles démarrent une autre orchestration de manière asynchrone et répondent à (ou sollicitent) des ports d'envoi qui publient les messages lorsqu'ils reçoivent une réponse de l'application cible ou du transport.</span><span class="sxs-lookup"><span data-stu-id="0b225-107">Publishers include receive ports that publish messages that arrive in their receive locations, orchestrations that publish messages when sending messages or starting another orchestration asynchronously, and solicit/response send ports that publish messages when they receive a response from the target application or transport.</span></span>  
  
 <span data-ttu-id="0b225-108">Dans BizTalk Server, il existe deux principaux types d’abonnements : l’activation et l’instance.</span><span class="sxs-lookup"><span data-stu-id="0b225-108">In BizTalk Server, there are two main types of subscriptions: activation and instance.</span></span> <span data-ttu-id="0b225-109">Un *abonnement d’activation* Spécifie qu’un message qui correspond à l’abonnement doit activer, ou créez, une nouvelle instance de l’abonné lorsqu’elle est reçue.</span><span class="sxs-lookup"><span data-stu-id="0b225-109">An *activation subscription* is one specifying that a message that fulfills the subscription should activate, or create, a new instance of the subscriber when it is received.</span></span> <span data-ttu-id="0b225-110">Les ports d'envoi dotés de filtres ou ceux liés à des orchestrations et les orchestrations qui reçoivent des formes dont la propriété Activer est définie sur True sont des exemples d'éléments qui créent des abonnements d'activation.</span><span class="sxs-lookup"><span data-stu-id="0b225-110">Examples of things that create activation subscriptions include send ports with filters or send ports that are bound to orchestrations, and orchestration receive shapes that have their Activate property set to true.</span></span> <span data-ttu-id="0b225-111">Un *abonnement d’instance* indique que les messages qui correspondent à l’abonnement doivent être routés vers une instance en cours d’exécution de l’abonné.</span><span class="sxs-lookup"><span data-stu-id="0b225-111">An *instance subscription* indicates that messages that fulfill the subscription should be routed to an already-running instance of the subscriber.</span></span> <span data-ttu-id="0b225-112">Les orchestrations dotées de ports de réception corrélés et de style requête/réponse en attente d'une réponse de BizTalk Server sont des exemples d'éléments qui créent des abonnements d'instance.</span><span class="sxs-lookup"><span data-stu-id="0b225-112">Examples of things that create instance subscriptions are orchestrations with correlated receives and request/response-style receive ports waiting for a response from BizTalk Server.</span></span>  
  
 <span data-ttu-id="0b225-113">Au niveau de l'information, la différence entre ces deux types d'abonnements réside dans le fait qu'un abonnement d'instance inclut l'ID d'instance unique, stocké dans la table des abonnements de la base de données principale MessageBox.</span><span class="sxs-lookup"><span data-stu-id="0b225-113">The difference between the two types of subscription at the information level is that an instance subscription includes the unique instance ID, stored in the subscription table in the master MessageBox database.</span></span> <span data-ttu-id="0b225-114">Lorsqu'une instance d'orchestration ou un port de réception termine le traitement, les abonnements d'instance sont supprimés de la base de données MessageBox alors que les abonnements d'activation restent actifs tant que l'orchestration ou le port d'envoi est inscrit.</span><span class="sxs-lookup"><span data-stu-id="0b225-114">When an orchestration instance or receive port completes processing, instance subscriptions are removed from the MessageBox while activation subscriptions remain active as long as the orchestration or send port is enlisted.</span></span>  
  
## <a name="creating-subscriptions"></a><span data-ttu-id="0b225-115">Création d'abonnements</span><span class="sxs-lookup"><span data-stu-id="0b225-115">Creating Subscriptions</span></span>  
 <span data-ttu-id="0b225-116">Les abonnements sont créés par des classes de service dans BizTalk Server répertoriées dans la table adm_ServiceClass de la base de données de gestion BizTalk.</span><span class="sxs-lookup"><span data-stu-id="0b225-116">Subscriptions are created by service classes in BizTalk Server, which are listed in the adm_ServiceClass table in the BizTalk Server Management database.</span></span> <span data-ttu-id="0b225-117">Ces services incluent le service de mise en cache des messages In-process et isolés qui est hébergé par le Gestionnaire des points de terminaison et les orchestrations/XLANG hébergées par le sous-service XLANG.</span><span class="sxs-lookup"><span data-stu-id="0b225-117">These services include the caching service; in-process and isolated messaging, hosted by the Endpoint Manager; and orchestrations/XLANG hosted by the XLANG subservice.</span></span> <span data-ttu-id="0b225-118">Chacune de ces classes de service peut créer des abonnements et recevoir des messages publiés.</span><span class="sxs-lookup"><span data-stu-id="0b225-118">Each of these service classes can create subscriptions and receive published messages.</span></span>  
  
 <span data-ttu-id="0b225-119">Un abonnement est une collection d'instructions de comparaison, ou prédicats, qui impliquent des propriétés de contexte de message et les valeurs spécifiques à l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="0b225-119">A subscription is a collection of comparison statements, known as predicates, involving message context properties and the values specific to the subscription.</span></span> <span data-ttu-id="0b225-120">Par exemple, Type de message est une propriété de contexte de messages et de nombreux abonnements la spécifient.</span><span class="sxs-lookup"><span data-stu-id="0b225-120">For example, Message Type is a context property of messages and many subscriptions specify the message type in their subscription.</span></span> <span data-ttu-id="0b225-121">Des informations générales sur l'abonnement sont insérées dans la table d'abonnements par l'agent des messages alors que les prédicats spécifiques sont insérés dans les tables suivantes, en fonction du type d'opération spécifié pour l'abonnement :</span><span class="sxs-lookup"><span data-stu-id="0b225-121">General information about the subscription is inserted into the subscriptions table by the Message Agent while the specific predicates go into one of the following predicate tables, depending on the type of operation specified for the subscription:</span></span>  
  
-   <span data-ttu-id="0b225-122">BitwiseANDPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-122">BitwiseANDPredicates</span></span>  
  
-   <span data-ttu-id="0b225-123">EqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-123">EqualsPredicates</span></span>  
  
-   <span data-ttu-id="0b225-124">EqualsPredicates2ndPass</span><span class="sxs-lookup"><span data-stu-id="0b225-124">EqualsPredicates2ndPass</span></span>  
  
-   <span data-ttu-id="0b225-125">ExistsPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-125">ExistsPredicates</span></span>  
  
-   <span data-ttu-id="0b225-126">FirstPassPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-126">FirstPassPredicates</span></span>  
  
-   <span data-ttu-id="0b225-127">GreaterThanOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-127">GreaterThanOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="0b225-128">GreaterThanPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-128">GreaterThanPredicates</span></span>  
  
-   <span data-ttu-id="0b225-129">LessThenOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-129">LessThenOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="0b225-130">LessThenPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-130">LessThenPredicates</span></span>  
  
-   <span data-ttu-id="0b225-131">NotEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="0b225-131">NotEqualsPredicates</span></span>  
  
 <span data-ttu-id="0b225-132">Tout ceci s’effectue en appelant le Bts_CreateSubscription_\<nom de l’application\> et Bts_InsertPredicate_\<nom de l’application\> des procédures stockées dans la MessageBox où la base de données \< nom de l’application\> est le nom de l’hôte BizTalk qui crée l’abonnement.</span><span class="sxs-lookup"><span data-stu-id="0b225-132">All of this is accomplished by calling the Bts_CreateSubscription_\<application name\> and Bts_InsertPredicate_\<application name\> stored procedures in the MessageBox database where \<application name\> is the name of the BizTalk host that is creating the subscription.</span></span>  
  
 <span data-ttu-id="0b225-133">Quand un port d'envoi est inscrit, le port crée au minimum un abonnement pour tout message avec l'ID de transport de ce port d'envoi dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="0b225-133">When a send port is enlisted, the port creates, at a minimum, a subscription for any message with that send port's transport ID in the context.</span></span> <span data-ttu-id="0b225-134">Cela permet au port d'envoi de toujours recevoir des messages qui lui sont spécifiquement destinés.</span><span class="sxs-lookup"><span data-stu-id="0b225-134">This allows the send port to always receive messages intended specifically for it.</span></span> <span data-ttu-id="0b225-135">Lorsqu'un port d'orchestration est lié à un port d'envoi particulier, les informations relatives à cette liaison sont stockées dans la base de données de gestion BizTalk.</span><span class="sxs-lookup"><span data-stu-id="0b225-135">When an orchestration port is bound to a particular send port, the information about that binding is stored in the BizTalk Management database.</span></span> <span data-ttu-id="0b225-136">Lorsque des messages sont envoyés de l'orchestration via le port lié au port d'envoi physique, l'ID de transport est inclus dans le contexte de sorte que le message soit acheminé vers ce port d'envoi.</span><span class="sxs-lookup"><span data-stu-id="0b225-136">When messages are sent from the orchestration through the port bound to the physical send port, the Transport ID is included in the context so that the message gets routed to that send port.</span></span> <span data-ttu-id="0b225-137">Il est cependant important de noter que ce port d'envoi n'est pas le seul port susceptible de recevoir des messages envoyés depuis l'orchestration.</span><span class="sxs-lookup"><span data-stu-id="0b225-137">However, it is important to note that this send port is not the only send port that can receive messages sent from the orchestration.</span></span> <span data-ttu-id="0b225-138">Lorsqu'une orchestration envoie un message, le message est publié dans la base de données MessageBox avec toutes les propriétés promues appropriées.</span><span class="sxs-lookup"><span data-stu-id="0b225-138">When an orchestration sends a message, that message is published to the MessageBox with all of the relevant promoted properties.</span></span> <span data-ttu-id="0b225-139">Le port d'envoi lié est assuré de recevoir une copie du message, car l'ID de transport figure dans le contexte. Cependant, tout autre port d'envoi, ou orchestration, peut être associé à un abonnement qui correspond également aux propriétés du message.</span><span class="sxs-lookup"><span data-stu-id="0b225-139">The bound send port is guaranteed to receive a copy of the message because the transport ID is in the context, but any other send port, or orchestration, can have a subscription that also matches the message properties.</span></span> <span data-ttu-id="0b225-140">Il est très important de comprendre que chaque fois qu'un message est publié directement dans la base de données MessageBox, tous les abonnés dont les abonnements correspondent recevront une copie du message.</span><span class="sxs-lookup"><span data-stu-id="0b225-140">It is very important to understand that any time a message is published directly to the MessageBox, all subscribers with matching subscriptions will receive a copy of the message.</span></span>  
  
## <a name="publishing-and-routing"></a><span data-ttu-id="0b225-141">Publication et routage</span><span class="sxs-lookup"><span data-stu-id="0b225-141">Publishing and Routing</span></span>  
 <span data-ttu-id="0b225-142">Une fois qu'un abonnement est créé et activé, il est nécessaire qu'un message soit publié avant que le traitement ne puisse avoir lieu.</span><span class="sxs-lookup"><span data-stu-id="0b225-142">After a subscription is created and enabled, a message must be published before any processing takes place.</span></span> <span data-ttu-id="0b225-143">Les messages sont publiés lorsqu'ils sont reçus dans BizTalk Server d'un des services précédemment mentionnés.</span><span class="sxs-lookup"><span data-stu-id="0b225-143">Messages are published when they are received into BizTalk Server from one of the services mentioned previously.</span></span> <span data-ttu-id="0b225-144">Dans le cadre de cette présentation de l'acheminement, nous allons nous concentrer sur les messages reçus dans BizTalk Server via un adaptateur.</span><span class="sxs-lookup"><span data-stu-id="0b225-144">For this discussion of routing, we will focus on messages received into BizTalk Server through an adapter.</span></span>  
  
 <span data-ttu-id="0b225-145">Lorsque les messages transitent par le pipeline de réception, des propriétés sont promues dans le contexte du message.</span><span class="sxs-lookup"><span data-stu-id="0b225-145">When messages go through the receive pipeline processing, properties are promoted into the message context.</span></span> <span data-ttu-id="0b225-146">Une fois qu'un message est prêt à être publié dans la base de données MessageBox après avoir été traité par l'adaptateur de réception et le pipeline, la première chose qui se produit est que l'agent des messages insère les valeurs des propriétés promues et les valeurs de prédicat à partir du contexte du message dans la base de données MessageBox SQL Server principale.</span><span class="sxs-lookup"><span data-stu-id="0b225-146">After a message is ready to be published into the MessageBox after being processed by the receive adapter and pipeline, the first thing that happens is the Message Agent inserts the property values for the promoted properties and predicate values from the message context into the master MessageBox SQL Server database.</span></span> <span data-ttu-id="0b225-147">La présence de ces valeurs dans la base de données permet à l'agent des messages de prendre des décisions relatives au routage.</span><span class="sxs-lookup"><span data-stu-id="0b225-147">Having these values in the database enables the Message Agent to make routing decisions.</span></span>  
  
 <span data-ttu-id="0b225-148">Au cours de l'étape suivante, l'agent des messages demande à la base de données MessageBox principale de rechercher les abonnements correspondant au lot actuel de messages publiés.</span><span class="sxs-lookup"><span data-stu-id="0b225-148">The next step is for the Message Agent to ask the master MessageBox database to find subscriptions for the current batch of messages being published.</span></span> <span data-ttu-id="0b225-149">N'oubliez pas qu'à ce stade, seules les propriétés ont été écrites dans la base de données, ce qui n'est pas le cas des messages.</span><span class="sxs-lookup"><span data-stu-id="0b225-149">Keep in mind that the messages have not yet been written to the database, only the properties from the context.</span></span> <span data-ttu-id="0b225-150">La procédure bts_FindSubscriptions stockée dans la base de données MessageBox interroge les tables d'abonnement et de prédicats et les lie aux propriétés du message stockées pour le lot actuel de messages.</span><span class="sxs-lookup"><span data-stu-id="0b225-150">The bts_FindSubscriptions stored procedure in the MessageBox queries the subscription and predicate tables identified above, linking them to the message properties stored for the current batch of messages.</span></span>  
  
 <span data-ttu-id="0b225-151">Muni de ces informations, l'agent des messages insère le message une fois dans chaque base de données MessageBox possédant un abonnement en appelant la procédure stockée bts_InsertMessage.</span><span class="sxs-lookup"><span data-stu-id="0b225-151">With this information, the Message Agent inserts the message once into each MessageBox database that has a subscription by calling the bts_InsertMessage stored procedure.</span></span> <span data-ttu-id="0b225-152">La procédure stockée bts_InsertMessage est d’abord appelée avec un ID d’abonnement.</span><span class="sxs-lookup"><span data-stu-id="0b225-152">The bts_InsertMessage stored procedure is first called with a subscription ID.</span></span> <span data-ttu-id="0b225-153">Ce premier passage, les appels de procédure stockée l’int_EvaluateSubscriptions procédure stockée qui est responsable de la recherche les informations de détail d’abonnement, vérifier que le message répond aux exigences de sécurité pour l’application en vérifiant que le prédicat correspond aux propriétés de l’application pour l’ordinateur hôte et l’insertion d’une référence au message dans la file d’attente spécifique des applications ou d’une application spécifique file d’attente suspendue selon l’état de message.</span><span class="sxs-lookup"><span data-stu-id="0b225-153">On this first pass, the stored procedure calls the int_EvaluateSubscriptions stored procedure which is responsible for looking up the subscription detail information, verifying that the message meets security requirements for the application by checking that message predicates match application properties for the host, and inserting a reference to the message in the application specific queue or application specific suspended queue depending on the state.</span></span> <span data-ttu-id="0b225-154">Les ID de message, d'abonnement et de service ainsi que les informations sur l'abonnement sont insérés dans la table de files d'attente propre à l'application pour chaque abonnement trouvé pour cette application.</span><span class="sxs-lookup"><span data-stu-id="0b225-154">The message ID, subscription ID, service ID, and other subscription information are inserted into the application specific queue table for each subscription that was found for this application.</span></span> <span data-ttu-id="0b225-155">Une fois que les messages sont insérés, les valeurs relatives au lot sont effacées des tables de propriétés et de prédicats du message.</span><span class="sxs-lookup"><span data-stu-id="0b225-155">After the messages are inserted, the message properties and message predicates tables are cleared of the batch related values.</span></span>  
  
 <span data-ttu-id="0b225-156">La procédure stockée bts_InsertMessage est ensuite appelée pour chaque partie composant le message.</span><span class="sxs-lookup"><span data-stu-id="0b225-156">The bts_InsertMessage stored procedure is called subsequently for each part in the message.</span></span> <span data-ttu-id="0b225-157">Sur le premier appel, le contexte du message est passé et est ensuite inséré dans la table du SPOULEUR en même temps que les métadonnées relatives au message, telles que le nombre de parties, le nom du corps et l’ID</span><span class="sxs-lookup"><span data-stu-id="0b225-157">On the first call, the message context is passed and is then inserted into the SPOOL table along with metadata about the message such as the number of parts, the body part name and ID.</span></span> <span data-ttu-id="0b225-158">En outre, le corps du message est inséré dans la table des parties à l’aide de la procédure stockée int_insertpart en vue.</span><span class="sxs-lookup"><span data-stu-id="0b225-158">In addition the message body part is inserted into the PARTS table using the int_InsertPart stored procedure.</span></span> <span data-ttu-id="0b225-159">La procédure stockée bts_InsertMessage est ensuite appelée pour chaque partie restante du message. Ces parties sont simplement transmises à la procédure stockée int_InsertPart en vue d'être enregistrées dans la table des parties.</span><span class="sxs-lookup"><span data-stu-id="0b225-159">The bts_InsertMessage stored procedure is then called for each of the remaining message parts where they are simply passed to the int_InsertPart stored procedure to be persisted in the PARTS table.</span></span>  
  
 <span data-ttu-id="0b225-160">Lorsque les messages sont acheminés, des références sont ajoutées pour chaque service qui reçoit l'instance spécifique du message et ses parties en insérant des enregistrements dans les tables suivantes :</span><span class="sxs-lookup"><span data-stu-id="0b225-160">When messages are routed, references are added for each service that receives the specific instance of the message and its parts by inserting records into the following tables:</span></span>  
  
-   <span data-ttu-id="0b225-161">MessageRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="0b225-161">MessageRefCountLog1</span></span>  
  
-   <span data-ttu-id="0b225-162">MessageRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="0b225-162">MessageRefCountLog2</span></span>  
  
-   <span data-ttu-id="0b225-163">PartRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="0b225-163">PartRefCountLog1</span></span>  
  
-   <span data-ttu-id="0b225-164">PartRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="0b225-164">PartRefCountLog2</span></span>  
  
 <span data-ttu-id="0b225-165">Ces références empêchent que les messages et les parties ne soient supprimés par des tâches de nettoyage qui s'exécutent régulièrement pour supprimer de la base de données MessageBox les messages qui n'existent plus dans le système.</span><span class="sxs-lookup"><span data-stu-id="0b225-165">These references keep the messages and parts from being deleted by cleanup jobs that run periodically to keep the MessageBox from getting full with message data for messages that are no longer in the system.</span></span> <span data-ttu-id="0b225-166">Deux tables sont utilisées pour limiter les problèmes de conflit et de verrouillage.</span><span class="sxs-lookup"><span data-stu-id="0b225-166">Two tables are used to reduce contention and locking issues.</span></span>  
  
 <span data-ttu-id="0b225-167">Le message étant désormais acheminé vers la file d'attente appropriée, stocké dans les tables de files d'attente et des parties, puis référencé dans les files d'attente propres à l'application, il doit être retiré des files d'attente par les instances de l'application.</span><span class="sxs-lookup"><span data-stu-id="0b225-167">Now that the message has been routed to the right queue, stored in the Spool and Parts tables, and referenced in the application specific queues, the messages must be pulled off the queues by the application instances.</span></span> <span data-ttu-id="0b225-168">Chaque instance d'hôte possède des threads chargés de retirer les messages de la file d'attente. Ces threads interrogent en permanence la base de données à des intervalles configurés dans la table adm_ServiceClass de la base de données de gestion BizTalk.</span><span class="sxs-lookup"><span data-stu-id="0b225-168">Each host instance has a number of dequeuing threads that continuously poll the database on an interval that is configured in the adm_ServiceClass table in the BizTalk Management database.</span></span> <span data-ttu-id="0b225-169">Cette même table comporte une colonne qui indique le nombre de threads chargés du retrait des messages.</span><span class="sxs-lookup"><span data-stu-id="0b225-169">This same table has a column to indicate the number of dequeuing threads to be used.</span></span> <span data-ttu-id="0b225-170">Chaque thread appelle dans la base de données MessageBox et appelle le bts_DequeueMessages_\<nom de l’application\> procédure appropriée pour l’application hôte est stockée.</span><span class="sxs-lookup"><span data-stu-id="0b225-170">Each thread calls into the MessageBox database and calls the bts_DequeueMessages_\<application name\> stored procedure appropriate for the host application it is running in.</span></span> <span data-ttu-id="0b225-171">Cette procédure stockée utilise la sémantique de verrouillage pour vous assurer que seule une instance et un thread de retrait sont en mesure de fonctionner sur un message dans la file d’attente à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="0b225-171">This stored procedure uses locking semantics to make sure that only one instance and one dequeuing thread are able to operate on a message in the queue at a given time.</span></span> <span data-ttu-id="0b225-172">L'instance de l'hôte qui obtient le verrou obtient le message. Il est ensuite chargé de la remise du message au sous-service auquel le message est destiné.</span><span class="sxs-lookup"><span data-stu-id="0b225-172">The host instance that gets the lock gets the message, and is then responsible for handing the message to the subservice for which it is intended.</span></span>  
  
 <span data-ttu-id="0b225-173">Si le service qui reçoit le message est le gestionnaire des points de terminaison, le port d'envoi est alors appelé (ou la partie de réponse d'un port de réception requête-réponse). S'il s'agit du sous-service XLANG/s, une orchestration est créée ou recherchée en vue de traiter l'abonnement, selon qu'un ID d'instance figure ou non dans l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="0b225-173">If the service receiving the message is the Endpoint Manager, then the send port is invoked (or the response portion of a request/response receive port) and if it is the XLANG/s subservice, an orchestration is either created, or located to service the subscription depending on whether there is an instance ID in the subscription.</span></span> <span data-ttu-id="0b225-174">Le service libère la référence au message et à sa partie de sorte que si aucun autre service ne comporte des références, les données du message peuvent être supprimées.</span><span class="sxs-lookup"><span data-stu-id="0b225-174">The service then releases the reference to the message and its part so that if no other services have references, the message data can be deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0b225-175">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0b225-175">See Also</span></span>  
 [<span data-ttu-id="0b225-176">Le moteur de messagerie</span><span class="sxs-lookup"><span data-stu-id="0b225-176">The Messaging Engine </span></span>](../core/the-messaging-engine.md)