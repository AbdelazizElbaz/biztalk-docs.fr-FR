---
title: "Résolution de schéma dans les composants de Pipeline | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- pipelines, schema resolution
- pipeline components, schema resolution
- schemas, pipeline components
ms.assetid: 35a79a6f-788b-4ca1-8483-36dcba5ae580
caps.latest.revision: "14"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 897c25ecb64a3038a6992b9c4caf927ba3e2d805
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="schema-resolution-in-pipeline-components"></a><span data-ttu-id="e6b0d-102">Résolution de schéma dans les composants de Pipeline</span><span class="sxs-lookup"><span data-stu-id="e6b0d-102">Schema Resolution in Pipeline Components</span></span>
<span data-ttu-id="e6b0d-103">Les composants de pipeline Désassembleur et Assembleur utilisent des schémas XSD pour traiter les messages.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-103">Pipeline disassembler and assembler components use XSD schemas to process messages.</span></span> <span data-ttu-id="e6b0d-104">Les schémas contiennent des informations telles que la liste des propriétés promues, des champs distinctifs, des annotations pour les messages de fichier plat et des annotations pour les enveloppes XML.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-104">The schemas contain information such as the list of promoted properties, distinguished fields, annotations for flat file messages, and annotations for XML envelopes.</span></span>  
  
 <span data-ttu-id="e6b0d-105">Les composants Désassembleur et Assembleur standard prennent en charge la récupération des schémas déployés en utilisant le nom du type de schéma et le type de message.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-105">Standard disassembler and assembler components support retrieval of deployed schemas by using the schema type name and message type.</span></span> <span data-ttu-id="e6b0d-106">Certains composants procèdent à la récupération en utilisant à la fois le nom du type de schéma et le type de message, tandis que d'autres (par exemple, le Désassembleur de fichier plat) n’utilisent que le type de schéma.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-106">Some components retrieve by using both the schema type name and the message type, while others (for example, the Flat File Disassembler) retrieve only by the schema type.</span></span>  
  
 <span data-ttu-id="e6b0d-107">Les composants de pipeline qui reçoivent des messages XML déterminent le type de message en examinant l'élément racine du message et l'espace de noms.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-107">Pipeline components that receive XML messages determine the message type by examining the message root element and namespace.</span></span> <span data-ttu-id="e6b0d-108">Par exemple, le type du message XML suivant est « http://MyDocument.org#MyDocument ».</span><span class="sxs-lookup"><span data-stu-id="e6b0d-108">For example, the message type for the following XML is "http://MyDocument.org#MyDocument".</span></span>  
  
```  
<ns0:MyDocument xmlns:ns0="http://MyDocument.org">  
  
</ns0:MyDocument>  
```  
  
 <span data-ttu-id="e6b0d-109">Si un schéma n’a pas un espace de noms défini pour ce dernier, le type de message est «\<**rootNode**\>».</span><span class="sxs-lookup"><span data-stu-id="e6b0d-109">If a schema does not have a namespace defined for it, the message type is "\<**rootNode**\>".</span></span> <span data-ttu-id="e6b0d-110">Par exemple, si l’exemple XML précédent n’était associé à aucun espace de noms, le type de message serait « MyDocument ».</span><span class="sxs-lookup"><span data-stu-id="e6b0d-110">For example, if the preceding example XML had no namespace, the message type would be "MyDocument".</span></span>  
  
 <span data-ttu-id="e6b0d-111">Les composants de pipeline standard utilisent le type de message pour récupérer le schéma approprié de la base de données.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-111">Standard pipeline components use the message type to retrieve the appropriate schema from the database.</span></span> <span data-ttu-id="e6b0d-112">Les pipelines de réception et d'envoi XML par défaut déterminent toujours quels schémas charger à l'aide du type de message dynamiquement détecté au moment de l'exécution à partir du contenu XML du message (sauf si le composant de pipeline a été configuré de façon à accepter les messages non reconnus).</span><span class="sxs-lookup"><span data-stu-id="e6b0d-112">Default XML receive and send pipelines always determine which schema to load by using the message type dynamically discovered at runtime from the message XML content (unless the pipeline component is set to allow unrecognized messages).</span></span> <span data-ttu-id="e6b0d-113">Le désassembleur XML peut supprimer l’enveloppe du message en utilisant ce mécanisme ; toutefois, l'assembleur XML ne peut pas créer d’enveloppe pour un message sortant sans connaître le schéma d’enveloppe à utiliser.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-113">The XML Disassembler can remove the message envelope by using this mechanism; however, the XML Assembler cannot create an envelope for an outgoing message without knowing what envelope schema to use.</span></span>  
  
 <span data-ttu-id="e6b0d-114">Vous spécifiez le schéma d’enveloppe dans les propriétés de configuration de l’Assembleur XML au sein du Concepteur de pipeline.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-114">You specify the envelope schema in the configuration properties for the XML Assembler from within the pipeline designer.</span></span>  
  
## <a name="how-schemas-are-resolved"></a><span data-ttu-id="e6b0d-115">Résolution des schémas</span><span class="sxs-lookup"><span data-stu-id="e6b0d-115">How Schemas Are Resolved</span></span>  
 <span data-ttu-id="e6b0d-116">En supposant que vous ne spécifiez pas le schéma directement dans le Désassembleur XML, les schémas sont résolus de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="e6b0d-116">Assuming you are not specifying the schema directly in the XmlDisassembler, schemas will be resolved in the following manner:</span></span>  
  
1.  <span data-ttu-id="e6b0d-117">Une recherche non qualifiée est d'abord effectuée sur les schémas déployés à l'aide du nom du nœud racine et de l'espace de noms (par exemple, http://MonEspaceDeNoms#MaRacine).</span><span class="sxs-lookup"><span data-stu-id="e6b0d-117">First, an unqualified search on the deployed schemas is made using the root node name and namespace (for example, http://MyNamespace#MyRoot).</span></span> <span data-ttu-id="e6b0d-118">Si une correspondance unique est trouvée, le schéma est résolu.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-118">If a unique match is found the schema is resolved.</span></span> <span data-ttu-id="e6b0d-119">Si plusieurs correspondances sont trouvées et diffèrent uniquement par leur numéro de version et qu'une seule soit active, cette version est utilisée et le schéma est résolu.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-119">If multiple matches are found and differ only by version number and only one is active, that version is used and the schema is resolved.</span></span> <span data-ttu-id="e6b0d-120">Si le même schéma est actif dans plusieurs applications, plusieurs schémas actifs sont trouvés et la recherche continue à l'étape 2 ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-120">If the same schema is active in multiple applications, multiple active schemas will be found and the search will continue with step 2 below.</span></span>  
  
2.  <span data-ttu-id="e6b0d-121">S’il existe plusieurs correspondances qui l’étape 1 ne peut pas résoudre, la recherche est qualifiée par l’assembly que ne s’exécute dans le pipeline.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-121">If there are multiple matches that step 1 cannot resolve, the search is qualified by the assembly the pipeline is executing in.</span></span> <span data-ttu-id="e6b0d-122">Si un schéma unique est trouvé dans le même assembly ne s’exécute dans le pipeline, puis le schéma est résolu.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-122">If a unique schema is found within the same assembly the pipeline is executing in, then the schema is resolved.</span></span>  
  
3.  <span data-ttu-id="e6b0d-123">S'il n'y a toujours aucune correspondance, l'éditeur est utilisé pour résoudre le schéma.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-123">If there are still no matches, then the publisher is used to resolve the schema.</span></span> <span data-ttu-id="e6b0d-124">La recherche est affinée par l'utilisation du nœud racine, de l'espace de noms et du jeton de clé publique.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-124">The search is narrowed by using the root node, namespace, and public key token.</span></span> <span data-ttu-id="e6b0d-125">Si un schéma unique est trouvé à l'aide de cette recherche, le schéma est résolu.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-125">If a unique schema is found using this search, the schema is resolved.</span></span>  
  
4.  <span data-ttu-id="e6b0d-126">Le schéma ne peut être résolu.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-126">Schema cannot be resolved.</span></span> <span data-ttu-id="e6b0d-127">Un message d'erreur indiquant qu'aucun schéma unique n'a été trouvée est renvoyé.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-127">An error is returned noting that no unique schema can be found.</span></span>  
  
 <span data-ttu-id="e6b0d-128">Pour d’autres considérations, y compris l’effet du classement SQL Server et de respect de la casse sur la résolution de schéma, consultez [Namespace gestion](../core/namespace-management.md).</span><span class="sxs-lookup"><span data-stu-id="e6b0d-128">For other considerations including the effect of SQL Server collation and case-sensitivity on schema resolution, see [Namespace Management](../core/namespace-management.md).</span></span>  
  
 <span data-ttu-id="e6b0d-129">Pour créer une enveloppe dans l’Assembleur XML ou un en-tête et un code de fin dans l’Assembleur de fichier plat, vous pouvez effectuer l'une des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="e6b0d-129">To create an envelope in the XML Assembler or a header and trailer in the Flat File Assembler, you may do one of the following:</span></span>  
  
-   <span data-ttu-id="e6b0d-130">Créez un pipeline d'envoi personnalisé et spécifiez le schéma d’enveloppe dans les propriétés de configuration de l’Assembleur XML.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-130">Create a custom send pipeline and specify the schemas for the envelope in the configuration properties for the XML Assembler.</span></span> <span data-ttu-id="e6b0d-131">Ces opérations sont effectuées au sein même du Concepteur de pipeline.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-131">This is done from within the pipeline designer.</span></span>  
  
-   <span data-ttu-id="e6b0d-132">Dans la console Administration de BizTalk Server, spécifiez XMLTransmit comme propriété de pipeline d’envoi sur un port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-132">In the BizTalk Server Administration console specify XMLTransmit for the Send pipeline property on a send port.</span></span> <span data-ttu-id="e6b0d-133">Cliquez sur les points de suspension pour configurer les propriétés de pipeline et spécifiez le schéma pour l'enveloppe dans la propriété EnvelopeDocSpecNames.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-133">Click the ellipsis to configure the pipeline properties and specify the schema for the envelope in the EnvelopeDocSpecNames property.</span></span>  
  
 <span data-ttu-id="e6b0d-134">La résolution de schéma par type de message peut ne pas fonctionner si plusieurs versions d’un même schéma sont intentionnellement ou accidentellement déployées dans la base de données (par exemple dans un déploiement côte à côte ou si plusieurs scénarios n'ont pas de type de message unique).</span><span class="sxs-lookup"><span data-stu-id="e6b0d-134">Schema resolution by message type may not work if several versions of the same schema are intentionally or accidentally deployed in the database (for example, in a side-by-side deployment or if multiple scenarios do not have unique message types).</span></span> <span data-ttu-id="e6b0d-135">Si la résolution de schéma par type de message échoue, une erreur « d’ambiguïté de schéma » est ajoutée au journal des événements.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-135">If schema resolution by message type fails, a "schema ambiguity" error is added to the event log.</span></span> <span data-ttu-id="e6b0d-136">Pour garantir le succès d’une résolution de schéma par type de message, effectuez l'une des procédures suivantes :</span><span class="sxs-lookup"><span data-stu-id="e6b0d-136">To ensure that schema resolution by message type succeeds, do one of the following:</span></span>  
  
-   <span data-ttu-id="e6b0d-137">Définissez les schémas dans le même projet BizTalk que votre pipeline personnalisé.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-137">Define the schemas in the same BizTalk project as your custom pipeline.</span></span>  
  
-   <span data-ttu-id="e6b0d-138">Signez l’assembly avec des schémas possédant la même clé que l'assembly contenant les pipelines.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-138">Sign the assembly with the schemas with the same key as the assembly containing the pipelines.</span></span>  
  
-   <span data-ttu-id="e6b0d-139">Spécifiez explicitement les schémas dans les composants de pipeline (les noms de type de message doivent être uniques dans toute la base de données de gestion BizTalk).</span><span class="sxs-lookup"><span data-stu-id="e6b0d-139">Explicitly specify schemas in pipeline components (message type names should be unique across the BizTalk Management database).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="e6b0d-140">Lorsque les schémas d’un même assembly partagent un type de message, vous ne devez pas les inclure dans le même assembly de composant de pipeline en raison des limitations liées à la résolution des ambiguïtés ; créez plutôt une référence à ces schémas externes.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-140">When schemas in the same assembly share a message type, you must not include the schemas in the same pipeline component assembly due to the limitations of ambiguity resolution; instead, reference schemas that are external to the pipeline component assembly.</span></span> <span data-ttu-id="e6b0d-141">La résolution des ambiguïtés ne fonctionne pas lorsque les schémas et les composants de pipeline se trouvent dans le même assembly, même si les noms de type de schéma sont explicitement spécifiés dans les composants de pipeline dans les pipelines personnalisés.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-141">Ambiguity resolution does not work when schemas and pipeline components are in the same assembly, even if schema type names are explicitly specified in pipeline components in custom pipelines.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e6b0d-142">Composants de pipeline personnalisés qui utilisent **IPipelineContext** pour obtenir les schémas déployés doit-elle obtenir les schémas par type de schéma uniquement si le nom de type de schéma n’est pas spécifié pour le composant en cours d’exécution et obtenir des schémas par type de message uniquement Si les informations de type de schéma ne sont pas disponibles lorsque le composant est exécuté.</span><span class="sxs-lookup"><span data-stu-id="e6b0d-142">Custom pipeline components that use **IPipelineContext** to obtain deployed schemas should obtain schemas by schema type only if the schema type name is not specified for the component at run time, and obtain schemas by message type only if the schema type information is not available when the component is run.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e6b0d-143">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e6b0d-143">See Also</span></span>  
 [<span data-ttu-id="e6b0d-144">Composants de pipeline</span><span class="sxs-lookup"><span data-stu-id="e6b0d-144">Pipeline Components</span></span>](../core/pipeline-components.md)