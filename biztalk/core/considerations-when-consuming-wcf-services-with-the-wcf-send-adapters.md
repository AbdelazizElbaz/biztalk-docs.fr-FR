---
title: "Considérations relatives à l’utilisation des Services WCF avec WCF des adaptateurs d’envoi | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- consuming, WCF services
- best practices, WCF services
- WCF services, best practices
- consuming, best practices
- WCF services, consuming
ms.assetid: 8bbcfd99-3495-458d-bd7a-6d170a29dde2
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b2bb1e512b8a13c3d91b87bbfc410c3d21f334fb
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="considerations-when-consuming-wcf-services-with-the-wcf-send-adapters"></a><span data-ttu-id="33a8d-102">Considérations relatives à l'utilisation de services WCF à l'aide des adaptateurs d'envoi WCF</span><span class="sxs-lookup"><span data-stu-id="33a8d-102">Considerations When Consuming WCF Services with the WCF Send Adapters</span></span>
<span data-ttu-id="33a8d-103">Cette rubrique fournit des informations à prendre en compte lors de l'utilisation des services WCF à l'aide des adaptateurs WCF.</span><span class="sxs-lookup"><span data-stu-id="33a8d-103">This topic provides information that you should take into consideration when consuming WCF services with the WCF adapters.</span></span>  
  
## <a name="use-the-template----content-specified-by-template-option-when-sending-non-xml-content-as-solicit-messages"></a><span data-ttu-id="33a8d-104">Utilisation de l'option « Modèle -- contenu spécifié par le modèle » lors de l'envoi de contenu non-XML en tant que messages de sollicitation</span><span class="sxs-lookup"><span data-stu-id="33a8d-104">Use the "Template -- content specified by template" option when sending non-XML content as solicit messages</span></span>  
 <span data-ttu-id="33a8d-105">Les adaptateurs WCF avec **corps--corps du message de réponse BizTalk** (la valeur par défaut) option n’autorisent pas l’envoi de message non-XML tels que des images bitmap et des données de caractères.</span><span class="sxs-lookup"><span data-stu-id="33a8d-105">The WCF adapters with **Body -- BizTalk response message body** (the default value) option do not allow sending non-XML message such as character data and bitmap images.</span></span> <span data-ttu-id="33a8d-106">Vous pouvez utiliser la **modèle--contenu spécifié par le modèle** option pour les adaptateurs WCF envoyer des messages non XML.</span><span class="sxs-lookup"><span data-stu-id="33a8d-106">You can use the **Template -- content specified by template** option for the WCF adapters to send non-XML messages.</span></span> <span data-ttu-id="33a8d-107">Pour plus d’informations sur la façon d’utiliser le modèle, consultez [Considérations lors de la publication des Services WCF avec les adaptateurs de réception WCF](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md).</span><span class="sxs-lookup"><span data-stu-id="33a8d-107">For more information about how to use the template, see [Considerations When Publishing WCF Services with the WCF Receive Adapters](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md).</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-ports-always-ignore-the-proxy-if-the-service-address-begins-with-httplocalhost"></a><span data-ttu-id="33a8d-108">Les ports d'envoi WCF-BasicHttp et WCF-WSHttp ignorent toujours le proxy si l'adresse de service commence par http://localhost</span><span class="sxs-lookup"><span data-stu-id="33a8d-108">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost</span></span>  
 <span data-ttu-id="33a8d-109">Le WCF-BasicHttp et WCF-WSHttp ports d’envoi toujours ignorent le proxy si l’adresse de service commence par http://localhost si le proxy est configuré sur le **Proxy** onglet du port d’envoi ou le **Proxy** onglet du Gestionnaire d’envoi.</span><span class="sxs-lookup"><span data-stu-id="33a8d-109">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost whether the proxy is configured on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="33a8d-110">Si vous souhaitez que les clients utilisent un proxy dans le cadre de la communication avec des services sur le même ordinateur, vous devez utiliser le nom de l'hôte (au lieu de « localhost »).</span><span class="sxs-lookup"><span data-stu-id="33a8d-110">You should use the host name (rather than localhost) if you want clients to go through a proxy when talking to services on the same computer.</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-adapters-suspend-the-messages-if-the-proxy-setting-is-not-correctly-configured"></a><span data-ttu-id="33a8d-111">Les adaptateurs d'envoi WCF-BasicHttp et WCF-WSHttp suspendent les messages si le paramètre de proxy n'est pas correctement configuré</span><span class="sxs-lookup"><span data-stu-id="33a8d-111">The WCF-BasicHttp and WCF-WSHttp send adapters suspend the messages if the proxy setting is not correctly configured</span></span>  
 <span data-ttu-id="33a8d-112">Vous pouvez spécifier le paramètre de proxy pour le WCF-BasicHttp et WCF-WSHttp les adaptateurs d’envoi le **Proxy** onglet du port d’envoi ou le **Proxy** onglet du Gestionnaire d’envoi.</span><span class="sxs-lookup"><span data-stu-id="33a8d-112">You can specify the proxy setting for the WCF-BasicHttp and WCF-WSHttp send adapters on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="33a8d-113">Si ce paramètre de proxy n'est pas correctement configuré, les adaptateurs WCF suspendent les messages et le message d'erreur « Il n’existait pas de point de terminaison à l’écoute pouvant accepter le message » est affiché dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="33a8d-113">If this proxy setting is not correctly configured, the WCF adapters suspend the messages, and you receive the "There was no endpoint listening that could accept the message" error message in the event log.</span></span>  
  
## <a name="setting-up-the-permissions-for-a-wcf-send-port-with-the-wcf-netmsmq-adapter"></a><span data-ttu-id="33a8d-114">Configuration des autorisations pour un port d'envoi WCF à l'aide de l'adaptateur WCF-NetMsmq</span><span class="sxs-lookup"><span data-stu-id="33a8d-114">Setting up the permissions for a WCF send port with the WCF-NetMsmq adapter</span></span>  
 <span data-ttu-id="33a8d-115">Lorsqu'un port d'envoi WCF utilisant l'adaptateur WCF-NetMsmq envoie un message à un service WCF publié à l'aide de NetMsmqBinding, il adresse le message à la file d'attente cible, qui est la file d'attente gérée par le gestionnaire de files d'attente du service.</span><span class="sxs-lookup"><span data-stu-id="33a8d-115">When a WCF send port with the WCF-NetMsmq adapter sends a message to a WCF service published with the NetMsmqBinding, it addresses the message to the target queue, which is the queue managed by the service's queue manager.</span></span> <span data-ttu-id="33a8d-116">Le gestionnaire de files d'attente sur le client envoie le message à une file d'attente de transmission (ou sortante).</span><span class="sxs-lookup"><span data-stu-id="33a8d-116">The queue manager on the client sends the message to a transmission (or outgoing) queue.</span></span> <span data-ttu-id="33a8d-117">La file d'attente de transmission est une file d'attente, située sur le gestionnaire de files d'attente côté client, qui stocke des messages pour les transmettre à la file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="33a8d-117">The transmission queue is a queue on the client-side queue manager that stores messages for transmission to the target queue.</span></span>  
  
 <span data-ttu-id="33a8d-118">Le gestionnaire de files d'attente du service accepte des messages adressés aux files d'attente cibles qu'il possède et stocke les messages.</span><span class="sxs-lookup"><span data-stu-id="33a8d-118">The service's queue manager accepts messages addressed to the target queues it owns and stores the messages.</span></span> <span data-ttu-id="33a8d-119">Ensuite, le service lance des demandes de lecture à partir de la file d'attente cible. Le gestionnaire de files d'attente livre alors les messages au service.</span><span class="sxs-lookup"><span data-stu-id="33a8d-119">Then, the service makes requests to read from the target queue, and the queue manager delivers the messages to the service.</span></span> <span data-ttu-id="33a8d-120">C'est la raison pour laquelle le compte de service pour l'instance d'hôte BizTalk hébergeant le port d'envoi doit disposer des autorisations d'écriture à partir de la file d'attente de transmission.</span><span class="sxs-lookup"><span data-stu-id="33a8d-120">For this reason, the service account for the BizTalk host instance hosting the send port should have the permissions to write on the transmission queue.</span></span>  
  
## <a name="use-an-empty-xpath-expression-to-receive-a-soap-message-with-character-data-in-the-content-of-the-soap-body-element"></a><span data-ttu-id="33a8d-121">Utilisation d'une expression XPath vide pour recevoir un message SOAP contenant des données de type caractère dans l'élément SOAP Body</span><span class="sxs-lookup"><span data-stu-id="33a8d-121">Use an empty XPath expression to receive a SOAP message with character data in the content of the SOAP Body element</span></span>  
 <span data-ttu-id="33a8d-122">Le port d'envoi WCF de type sollicitation-réponse peut recevoir un message WCF en tant que message de réponse.</span><span class="sxs-lookup"><span data-stu-id="33a8d-122">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="33a8d-123">Pour créer un message BizTalk à partir d’un message de réponse entrante avec des données de caractères dans le contenu de SOAP **corps** élément, comme indiqué dans l’exemple suivant, vous devez laisser la **expression XPath** zone de texte vide sur le **Message** onglet dans la boîte de dialogue Propriétés du transport WCF adaptateur.</span><span class="sxs-lookup"><span data-stu-id="33a8d-123">To create a BizTalk message from an incoming response message with character data in the content of the SOAP **Body** element as shown in the following example, you should leave the **XPath expression** text box empty on the **Message** tab in the WCF adapter transport properties dialog box.</span></span>  
  
```  
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing">  
    <s:Header>  
      ...  
    </s:Header>  
    <s:Body>Contoso</s:Body>  
</s:Envelope>  
```  
  
 <span data-ttu-id="33a8d-124">Si vous sélectionnez le **enveloppe** ou **corps** option, l’adaptateur ne crée pas le message BizTalk à partir du message entrant.</span><span class="sxs-lookup"><span data-stu-id="33a8d-124">If you select the **Envelope** or **Body** option, the adapter does not create the BizTalk message from the incoming message.</span></span> <span data-ttu-id="33a8d-125">Le message n'est pas interrompu car les messages échouant au cours du traitement de marshaling SOAP entrant ne sont pas interrompus.</span><span class="sxs-lookup"><span data-stu-id="33a8d-125">The message is not suspended because messages that fail in the inbound SOAP marshaling processing are not suspended.</span></span> <span data-ttu-id="33a8d-126">Pour plus d’informations sur l’utilisation de l’expression XPath sur le **Message** , consultez la rubrique [spécifiant le corps du Message pour les adaptateurs WCF](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span><span class="sxs-lookup"><span data-stu-id="33a8d-126">For more information about how to use the XPath expression on the **Message** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="33a8d-127">Vous pouvez utiliser l'outil TraceViewer (SvcTraceViewer.exe) du Kit de développement Windows SDK en configurant le fichier BTSNTSvc.exe.config.</span><span class="sxs-lookup"><span data-stu-id="33a8d-127">You can use the TraceViewer tool (SvcTraceViewer.exe) in the Windows SDK by configuring the BTSNTSvc.exe.config.file.</span></span> <span data-ttu-id="33a8d-128">Pour plus d’informations sur le Kit de développement logiciel Windows, consultez « Nouveautés dans le Kit de développement logiciel Windows » à [http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219).</span><span class="sxs-lookup"><span data-stu-id="33a8d-128">For more information about the Windows SDK, see "What's New in the Windows SDK" at [http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219).</span></span> <span data-ttu-id="33a8d-129">Pour plus d’informations sur l’outil TraceViewer, consultez « TraceViewer Tool (SvcTraceViewer.exe) » à [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218).</span><span class="sxs-lookup"><span data-stu-id="33a8d-129">For more information about the TraceViewer tool, see "TraceViewer Tool (SvcTraceViewer.exe)" at [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218).</span></span>  
  
## <a name="biztalk-server-does-not-use-multi-part-message-types-and-root-elements-describing-custom-soap-headers"></a><span data-ttu-id="33a8d-130">BizTalk Server n'utilise pas les types de messages à parties multiples et les éléments racines décrivant les en-têtes SOAP personnalisés</span><span class="sxs-lookup"><span data-stu-id="33a8d-130">BizTalk Server does not use multi-part message types and root elements describing custom SOAP headers</span></span>  
 <span data-ttu-id="33a8d-131">Si vous exécutez l'Assistant Consommation de service WCF BizTalk avec les métadonnées d'après lesquelles les en-têtes SOAP sont définis, l'Assistant génère les éléments racines dans les schémas générés pour représenter les en-têtes SOAP personnalisés.</span><span class="sxs-lookup"><span data-stu-id="33a8d-131">If you run the BizTalk WCF service Consuming Wizard against metadata where custom SOAP headers are defined, the wizard generates root elements in the generated schemas to represent the custom SOAP headers.</span></span> <span data-ttu-id="33a8d-132">L'Assistant crée également des types de messages à parties multiples dans les orchestrations pour les en-têtes SOAP personnalisés.</span><span class="sxs-lookup"><span data-stu-id="33a8d-132">The wizard also creates multi-part message types in orchestrations for the custom SOAP headers.</span></span> <span data-ttu-id="33a8d-133">Serveur BizTalk Server :</span><span class="sxs-lookup"><span data-stu-id="33a8d-133">BizTalk Server.</span></span> <span data-ttu-id="33a8d-134">Toutefois, BizTalk Server n’utilise pas de types de message à parties multiples et les éléments racines pour gérer les en-têtes SOAP personnalisés.</span><span class="sxs-lookup"><span data-stu-id="33a8d-134">However, BizTalk Server does not use multi-part message types and root elements to handle the custom SOAP headers.</span></span>  
  
 <span data-ttu-id="33a8d-135">Pour accéder aux en-têtes SOAP personnalisés, vous devez utiliser le **InboundHeaders** propriété.</span><span class="sxs-lookup"><span data-stu-id="33a8d-135">To access custom SOAP headers, you should use the **InboundHeaders** property.</span></span> <span data-ttu-id="33a8d-136">Pour plus d’informations sur la réception des en-têtes SOAP personnalisés, consultez [les en-têtes SOAP avec les Services WCF publiés](../core/soap-headers-with-published-wcf-services.md).</span><span class="sxs-lookup"><span data-stu-id="33a8d-136">For more information about receiving custom SOAP headers, see [SOAP Headers with Published WCF Services](../core/soap-headers-with-published-wcf-services.md).</span></span> <span data-ttu-id="33a8d-137">Pour utiliser des en-têtes SOAP personnalisés, vous devez utiliser le **OutboundCustomHeaders** propriété.</span><span class="sxs-lookup"><span data-stu-id="33a8d-137">To use custom SOAP headers, you should use the **OutboundCustomHeaders** property.</span></span> <span data-ttu-id="33a8d-138">Pour plus d’informations sur l’envoi des en-têtes SOAP personnalisés, consultez [les en-têtes SOAP avec les Services WCF consommé](../core/soap-headers-with-consumed-wcf-services.md).</span><span class="sxs-lookup"><span data-stu-id="33a8d-138">For more information about sending custom SOAP headers, see [SOAP Headers with Consumed WCF Services](../core/soap-headers-with-consumed-wcf-services.md).</span></span>  
  
## <a name="create-separate-host-instances-for-send-ports-that-use-different-proxy-addresses-andor-proxy-credentials"></a><span data-ttu-id="33a8d-139">Création d'instances d'hôte distinctes pour les ports d'envoi utilisant différentes adresses proxy et/ou informations d'identification de proxy</span><span class="sxs-lookup"><span data-stu-id="33a8d-139">Create separate host instances for send ports that use different proxy addresses and/or proxy credentials</span></span>  
 <span data-ttu-id="33a8d-140">Pour que les adaptateurs d'envoi WCF obtiennent des performances optimales, il est recommandé de créer des instances d'hôte distinctes pour les ports d'envoi qui utilisent différentes adresses proxy et/ou informations d'identification de proxy.</span><span class="sxs-lookup"><span data-stu-id="33a8d-140">To achieve the best possible performance for WCF send adapters, we recommend that you create separate host instances for send ports that use different proxy addresses and/or proxy credentials.</span></span> <span data-ttu-id="33a8d-141">Ceci permet d'éviter les conflits au niveau des paramètres de proxy.</span><span class="sxs-lookup"><span data-stu-id="33a8d-141">This avoids contention on proxy settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="33a8d-142">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="33a8d-142">See Also</span></span>  
 [<span data-ttu-id="33a8d-143">Fichier BTSNTSvc.exe.config</span><span class="sxs-lookup"><span data-stu-id="33a8d-143">BTSNTSvc.exe.config File</span></span>](../core/btsntsvc-exe-config-file.md)