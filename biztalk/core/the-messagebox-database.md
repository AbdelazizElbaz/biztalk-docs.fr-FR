---
title: "La base de données MessageBox | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- messages, MessageBox database
- messages, suspended messages
- MessageBox database, messages
- MessageBox database, about MessageBox database
- MessageBox database, suspended messages
- suspended messages
- MessageBox database
- suspended messages, MessageBox database
ms.assetid: f89eb02c-1b83-4127-8a91-e78fb4a1f96e
caps.latest.revision: "15"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: edf1fb3a89d6e08f6a0183a3242c53c4be890e60
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="the-messagebox-database"></a><span data-ttu-id="80481-102">La base de données MessageBox</span><span class="sxs-lookup"><span data-stu-id="80481-102">The MessageBox Database</span></span>
<span data-ttu-id="80481-103">Le cœur du moteur de publication/d'abonnement de Microsoft BizTalk Server est la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-103">The heart of the publish/subscribe engine in Microsoft BizTalk Server is the MessageBox database.</span></span> <span data-ttu-id="80481-104">MessageBox est constitué de deux composants : un ou plusieurs bases de données Microsoft SQL Server et l’Agent de messagerie.</span><span class="sxs-lookup"><span data-stu-id="80481-104">The MessageBox is made up of two components: one or more Microsoft SQL Server databases and the Messaging Agent.</span></span> <span data-ttu-id="80481-105">La base de données SQL Server assure le stockage permanent de nombreuses choses comme les messages, les parties et propriétés des messages, les abonnements, l'état des orchestrations, les données de suivi, les files d'attente hôte pour le routage, etc.</span><span class="sxs-lookup"><span data-stu-id="80481-105">The SQL Server database provides the persistence store for many things including messages, message parts, message properties, subscriptions, orchestration state, tracking data, host queues for routing, and others.</span></span> <span data-ttu-id="80481-106">Le groupe BizTalk Server peut posséder une ou plusieurs bases de données MessageBox dans lesquelles il publie des messages et à partir desquelles les abonnés extraient ces messages.</span><span class="sxs-lookup"><span data-stu-id="80481-106">The BizTalk Server group may have one or more MessageBox databases into which it publishes messages and from which subscribers to those messages extract messages.</span></span>  
  
 <span data-ttu-id="80481-107">La base de données fournit une partie de la logique liée au routage des messages et aux réponses aux abonnements.</span><span class="sxs-lookup"><span data-stu-id="80481-107">The database provides some of the logic related to routing messages and fulfilling subscriptions.</span></span> <span data-ttu-id="80481-108">L'agent des messages est toutefois le composant qui encapsule et résume le composant de base de données. Il s'agit de l'interface utilisée par BizTalk Server pour interagir avec le MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-108">The Message Agent, however, is the component that encapsulates and abstracts the database component and is the interface used by BizTalk Server to interact with the MessageBox.</span></span> <span data-ttu-id="80481-109">L'agent des messages est un composant COM (Component Object Model) qui fournit des interfaces pour la publication des messages, l'inscription aux messages, la récupération des messages, etc.</span><span class="sxs-lookup"><span data-stu-id="80481-109">The Message Agent is a Component Object Model (COM) component that provides interfaces for publishing messages, subscribing to messages, retrieving messages, and so on.</span></span> <span data-ttu-id="80481-110">Cette interface est le seul mécanisme utilisé par les autres composants BizTalk Server, comme l'infrastructure d'adaptateurs et les orchestrations, pour interagir avec le MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-110">This interface is the only mechanism used by other BizTalk Server components, including the adapter framework and orchestrations, to interact with the MessageBox.</span></span>  
  
## <a name="the-messagebox-and-the-message"></a><span data-ttu-id="80481-111">MessageBox et message</span><span class="sxs-lookup"><span data-stu-id="80481-111">The MessageBox and the Message</span></span>  
 <span data-ttu-id="80481-112">Un abonnement à la base de données MessageBox est un ensemble d'informations établies et d'informations de service.</span><span class="sxs-lookup"><span data-stu-id="80481-112">A MessageBox database subscription is a set of established information and service information.</span></span> <span data-ttu-id="80481-113">Les informations établies (ou de prédicat) correspondent aux critères qu'un message doit remplir.</span><span class="sxs-lookup"><span data-stu-id="80481-113">The established (or predicate) information is the criteria that a message must meet.</span></span> <span data-ttu-id="80481-114">Les informations de service indiquent ce qu'il faut faire du message qui répond aux critères.</span><span class="sxs-lookup"><span data-stu-id="80481-114">The service information is what to do with the message that meets the criteria.</span></span> <span data-ttu-id="80481-115">Toutes ces informations sont stockées dans un ensemble de tables qui appellent le moteur de messagerie et d'orchestration.</span><span class="sxs-lookup"><span data-stu-id="80481-115">All of this information is stored in a set of tables that call the messaging and orchestration engine.</span></span>  
  
 <span data-ttu-id="80481-116">Lorsque BizTalk Server reçoit un message, il le traite dans un pipeline, puis le place dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-116">When BizTalk Server receives a message, it processes the message in a pipeline, and places the message in the MessageBox database.</span></span> <span data-ttu-id="80481-117">Le message entrant comporte un contexte.</span><span class="sxs-lookup"><span data-stu-id="80481-117">The incoming message has a context.</span></span> <span data-ttu-id="80481-118">Le contexte du message est un ensemble de propriétés associées au message.</span><span class="sxs-lookup"><span data-stu-id="80481-118">The message context is a set of properties associated with the message.</span></span> <span data-ttu-id="80481-119">Il existe trois types de propriétés de contexte de message :</span><span class="sxs-lookup"><span data-stu-id="80481-119">The three types of message context properties are:</span></span>  
  
-   <span data-ttu-id="80481-120">Propriétés écrites simples</span><span class="sxs-lookup"><span data-stu-id="80481-120">Simple written properties</span></span>  
  
-   <span data-ttu-id="80481-121">Propriétés promues</span><span class="sxs-lookup"><span data-stu-id="80481-121">Promoted properties</span></span>  
  
-   <span data-ttu-id="80481-122">Propriétés de prédicat</span><span class="sxs-lookup"><span data-stu-id="80481-122">Predicate properties</span></span>  
  
 <span data-ttu-id="80481-123">Les propriétés promues et de prédicat indiquent le processus d'entreprise qui s'abonne à ce message, et si ce processus dispose des autorisations nécessaires pour recevoir ce message.</span><span class="sxs-lookup"><span data-stu-id="80481-123">The promoted and predicate message properties indicate the business process that subscribes to this message, and whether the business process has the permissions necessary to receive the message.</span></span>  
  
 <span data-ttu-id="80481-124">Si un processus d'entreprise s'abonne au message, la base de données MessageBox envoie ce message au processus.</span><span class="sxs-lookup"><span data-stu-id="80481-124">If a business process subscribes to the message, the MessageBox database sends the message to the business process.</span></span> <span data-ttu-id="80481-125">Lorsque le processus d'entreprise reçoit le message, il le traite sur une instance de l'hôte disponible.</span><span class="sxs-lookup"><span data-stu-id="80481-125">When the business process receives the message, it processes the message on an available host instance.</span></span> <span data-ttu-id="80481-126">Une fois le message traité, si le processus d'entreprise s'abonne à un pipeline ou un port d'envoi, il envoie un message de retour à la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-126">After processing the message, if the business process subscribes to a pipeline or send port, the business process sends a return message to the MessageBox database.</span></span>  
  
 <span data-ttu-id="80481-127">Pour chaque hôte BizTalk, la base de données MessageBox associée comprend une file de travail et une file d'attente des messages interrompus.</span><span class="sxs-lookup"><span data-stu-id="80481-127">For each BizTalk Host, the associated MessageBox has one work queue and one suspended queue.</span></span> <span data-ttu-id="80481-128">En outre, chaque base de données MessageBox contient un ensemble de tables pour les états statiques, dynamiques et d'instance.</span><span class="sxs-lookup"><span data-stu-id="80481-128">Additionally, each MessageBox database contains a set of tables for static states, dynamic states, and instance state.</span></span> <span data-ttu-id="80481-129">Pour plus d’informations sur les hôtes BizTalk, consultez [entités](../core/entities.md).</span><span class="sxs-lookup"><span data-stu-id="80481-129">For information about BizTalk Hosts, see [Entities](../core/entities.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="80481-130">Si un hôte n'est plus disponible, par exemple lorsque la base de données MessageBox qui reçoit des messages de cet hôte devient indisponible, aucune autre base de données MessageBox n'est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="80481-130">If a host becomes unavailable --for example, the MessageBox database that receives messages from that host becomes unavailable, all other MessageBox databases become unavailable.</span></span>  
  
 <span data-ttu-id="80481-131">Vous créez la première base de données MessageBox lorsque vous exécutez l'Assistant Configuration.</span><span class="sxs-lookup"><span data-stu-id="80481-131">You create the first MessageBox database when you run the Configuration Wizard.</span></span> <span data-ttu-id="80481-132">La base de données MessageBox configurée devient la base de données principale MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-132">The MessageBox database that is configured becomes the master MessageBox database.</span></span> <span data-ttu-id="80481-133">Cette base de données évalue et achemine les abonnements vers toutes les autres bases de données MessageBox dans l'environnement BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="80481-133">The master MessageBox database evaluates and routes subscriptions to all other MessageBox databases in the BizTalk Server environment.</span></span> <span data-ttu-id="80481-134">Pour plus d’informations sur l’amélioration des performances pour la base de données principale, consultez [la gestion des bases de données MessageBox](../core/managing-messagebox-databases.md).</span><span class="sxs-lookup"><span data-stu-id="80481-134">For information about improving performance for the master MessageBox database, see [Managing MessageBox Databases](../core/managing-messagebox-databases.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="80481-135">Vous devez utiliser la mise en cluster de SQL Server pour assurer une protection par basculement pour les bases de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-135">You must use SQL Server clustering to provide failover protection for MessageBox databases.</span></span>  
  
## <a name="suspended-messages-in-the-messagebox-database"></a><span data-ttu-id="80481-136">Messages suspendus dans la base de données MessageBox</span><span class="sxs-lookup"><span data-stu-id="80481-136">Suspended Messages in the MessageBox Database</span></span>  
 <span data-ttu-id="80481-137">BizTalk Server stocke les messages associés aux pipelines suspendus dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="80481-137">BizTalk Server stores messages associated with suspended pipelines in the MessageBox database.</span></span> <span data-ttu-id="80481-138">En cas de problème dans le pipeline, BizTalk Server suspend l'instance d'un message.</span><span class="sxs-lookup"><span data-stu-id="80481-138">If a failure occurs in the pipeline, BizTalk Server suspends the instance of a message.</span></span> <span data-ttu-id="80481-139">Il existe deux types d'instances de service suspendues :</span><span class="sxs-lookup"><span data-stu-id="80481-139">There are two types of suspended service instances:</span></span>  
  
-   <span data-ttu-id="80481-140">les instances suspendues que vous pouvez reprendre ;</span><span class="sxs-lookup"><span data-stu-id="80481-140">Suspended instances that you can resume.</span></span>  
  
-   <span data-ttu-id="80481-141">les instances suspendues que vous ne pouvez pas reprendre.</span><span class="sxs-lookup"><span data-stu-id="80481-141">Suspended instances that you cannot resume.</span></span> <span data-ttu-id="80481-142">Il s'agit par exemple d'une instance endommagée.</span><span class="sxs-lookup"><span data-stu-id="80481-142">For example, if an instance is corrupt.</span></span>  
  
 <span data-ttu-id="80481-143">Selon la cause de la suspension, vous pouvez reprendre les services suspendus par BizTalk Server. Il en est ainsi par exemple si une orchestration atteint une forme Interrompre ou si un transport n'a pas réussi à livrer un message. BizTalk Server ne supprime pas automatiquement de la base de données MessageBox les instances suspendues impossibles à reprendre.</span><span class="sxs-lookup"><span data-stu-id="80481-143">Depending on the cause of the suspension, you may be able to resume services that BizTalk Server suspends -- for example, if an orchestration hits a Suspend shape, or if a transport was unable to deliver a message, BizTalk Server does not automatically remove suspended instances that you cannot resume from the MessageBox database.</span></span> <span data-ttu-id="80481-144">Vous pouvez choisir d'enregistrer une instance de service sur disque avant de la supprimer de la file d'attente des messages interrompus.</span><span class="sxs-lookup"><span data-stu-id="80481-144">You can choose to save a service instance to disk before removing it from the suspended queue.</span></span>  
  
 <span data-ttu-id="80481-145">Pour plus d’informations sur la sauvegarde des bases de données MessageBox, consultez [sauvegarde et restauration de bases de données BizTalk Server](../core/backing-up-and-restoring-biztalk-server.md).</span><span class="sxs-lookup"><span data-stu-id="80481-145">For information about backing up MessageBox databases, see [Backing Up and Restoring BizTalk Server Databases](../core/backing-up-and-restoring-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="80481-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="80481-146">See Also</span></span>  
 [<span data-ttu-id="80481-147">Le moteur de messagerie</span><span class="sxs-lookup"><span data-stu-id="80481-147">The Messaging Engine</span></span>](../core/the-messaging-engine.md)