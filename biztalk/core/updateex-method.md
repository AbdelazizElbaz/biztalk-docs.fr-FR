---
title: Méthode UpdateEx | Documents Microsoft
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7a6a64c6709eb9806612518c551372ba45d1a454
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="updateex-method"></a><span data-ttu-id="1cc57-102">Méthode UpdateEx</span><span class="sxs-lookup"><span data-stu-id="1cc57-102">UpdateEx Method</span></span>
<span data-ttu-id="1cc57-103">Utilisé pour mettre à jour les propriétés basées sur les paramètres de clé d’entrée (key1, key2...</span><span class="sxs-lookup"><span data-stu-id="1cc57-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="1cc57-104">keyn).</span><span class="sxs-lookup"><span data-stu-id="1cc57-104">keyn).</span></span> <span data-ttu-id="1cc57-105">Lors de l'utilisation d'`UpdateEx`, vous ne pouvez pas supprimer d'éléments d'une collection.</span><span class="sxs-lookup"><span data-stu-id="1cc57-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="1cc57-106">Une méthode distincte facilite la suppression.</span><span class="sxs-lookup"><span data-stu-id="1cc57-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="1cc57-107">Pour plus d’informations, consultez [méthode DeleteOnly](../core/deleteonly-method.md).</span><span class="sxs-lookup"><span data-stu-id="1cc57-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="1cc57-108">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="1cc57-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="1cc57-109">Paramètres</span><span class="sxs-lookup"><span data-stu-id="1cc57-109">Parameters</span></span>  
  
|<span data-ttu-id="1cc57-110">Paramètre</span><span class="sxs-lookup"><span data-stu-id="1cc57-110">Parameter</span></span>|<span data-ttu-id="1cc57-111"> Description</span><span class="sxs-lookup"><span data-stu-id="1cc57-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="1cc57-112">Un ensemble de paramètres qui doit exister dans la base de données du serveur ou une erreur se produit.</span><span class="sxs-lookup"><span data-stu-id="1cc57-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="1cc57-113">Ces clés correspondent au jeu de clés Get défini pour l'interface de composant spécifique.</span><span class="sxs-lookup"><span data-stu-id="1cc57-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="1cc57-114">Indicateur booléen.</span><span class="sxs-lookup"><span data-stu-id="1cc57-114">A Boolean flag.</span></span> <span data-ttu-id="1cc57-115">Lorsqu'il est défini sur true, il permet d'apporter des modifications aux interfaces de composant avec des éléments ayant une date d'effet, soit en mettant à jour les valeurs de champ soit en insérant de nouveaux éléments dans une collection.</span><span class="sxs-lookup"><span data-stu-id="1cc57-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="1cc57-116">Plus précisément, il permet de modifier les éléments dont l'EFFDT est antérieure à la date d'effet actuelle.</span><span class="sxs-lookup"><span data-stu-id="1cc57-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="1cc57-117">Sans cet indicateur défini sur TRUE, toute modification apportée à ces éléments génère une erreur renvoyée par le serveur PeopleSoft.</span><span class="sxs-lookup"><span data-stu-id="1cc57-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="1cc57-118">L'argument `correctionMode` est uniquement exposé pour ces interfaces de composant qui contiennent des éléments ayant une date d'effet.</span><span class="sxs-lookup"><span data-stu-id="1cc57-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="1cc57-119">Dans le cas contraire, il n'apparaît pas dans le cadre de l'argument.</span><span class="sxs-lookup"><span data-stu-id="1cc57-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="1cc57-120">Vous devez éviter de définir `correctionMode` sur True dans un environnement de production.</span><span class="sxs-lookup"><span data-stu-id="1cc57-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="1cc57-121">(Il s'agit également de la recommandation de PeopleSoft.) Les événements qui se sont déjà produits, tels que déterminés par la clé EFFDT passée, ne doivent pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="1cc57-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="1cc57-122">Cela permet la création d'une piste d'audit.</span><span class="sxs-lookup"><span data-stu-id="1cc57-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="1cc57-123">L'indicateur `correctionMode` dans `UpdateEx` permet le contournement de ce mécanisme de sécurité.</span><span class="sxs-lookup"><span data-stu-id="1cc57-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="1cc57-124">Pour les événements passés, la pratique recommandée consiste à les désactiver en définissant un champ dans l'élément et en ajoutant l'élément mis à jour (au lieu de le supprimer).</span><span class="sxs-lookup"><span data-stu-id="1cc57-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="1cc57-125">Indicateur utilisé pour la gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="1cc57-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="1cc57-126">Lors de l’accès aux propriétés dans une interface de composant, l’adaptateur BizTalk pour PeopleSoft Enterprise utilise les API fournies par PeopleSoft qui lisent et écrivent des champs individuels dans l’interface de composant ; Toutefois, ces modifications ne sont pas propagées au serveur PeopleSoft une à la fois.</span><span class="sxs-lookup"><span data-stu-id="1cc57-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="1cc57-127">Au contraire, psjoa.jar (avec lequel l'adaptateur BizTalk pour PeopleSoft Enterprise interagit) regroupe toutes les modifications et les envoie au serveur dans un seul package.</span><span class="sxs-lookup"><span data-stu-id="1cc57-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="1cc57-128">En cas d'échec d'une des mises à jour individuelles, une erreur générique est renvoyée, sans identifier l'erreur réelle.</span><span class="sxs-lookup"><span data-stu-id="1cc57-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="1cc57-129">Si le mode interactif est défini sur TRUE, chaque mise à jour de champ est envoyée au serveur individuellement.</span><span class="sxs-lookup"><span data-stu-id="1cc57-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="1cc57-130">Cela a un impact considérable sur les performances mais des informations spécifiques sur l'erreur sont fournies en cas d'échec de la mise à jour (par exemple, si une valeur non valide est utilisée pour la définition d'un champ).</span><span class="sxs-lookup"><span data-stu-id="1cc57-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="1cc57-131">`interactiveMode` offre des performances optimales et fournit des rapports d'erreurs au niveau de la mise à jour du champ.</span><span class="sxs-lookup"><span data-stu-id="1cc57-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="1cc57-132">Pour utiliser correctement cette fonctionnalité, il est recommandé d'effectuer des appels normaux avec `interactiveMode` défini sur FALSE.</span><span class="sxs-lookup"><span data-stu-id="1cc57-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="1cc57-133">Cela ne doit avoir aucun impact sur les performances.</span><span class="sxs-lookup"><span data-stu-id="1cc57-133">There should be no impact on performance.</span></span> <span data-ttu-id="1cc57-134">Si une erreur est renvoyée, le même appel peut faire l'objet d'une nouvelle tentative avec l'indicateur `interactiveMode` défini sur True.</span><span class="sxs-lookup"><span data-stu-id="1cc57-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="1cc57-135">Lorsque l'appel échoue, le serveur renvoie un message d'erreur plus précis.</span><span class="sxs-lookup"><span data-stu-id="1cc57-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="1cc57-136">Notes</span><span class="sxs-lookup"><span data-stu-id="1cc57-136">Remarks</span></span>  
 <span data-ttu-id="1cc57-137">Lorsque vous appelez cette fonction, les propriétés de l'enregistrement correspondant aux clés sont remplacées par les propriétés du paramètre d'entrée.</span><span class="sxs-lookup"><span data-stu-id="1cc57-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="1cc57-138">Toutes les collections comprenant les enregistrements originaux sont supprimées et remplacées par celles du paramètre d'entrée.</span><span class="sxs-lookup"><span data-stu-id="1cc57-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="1cc57-139">Les tailles de ces collections ne doivent pas correspondre car la procédure dans `UpdateEx` consiste à supprimer tous les éléments de collection existants et de les insérer dans les collections données.</span><span class="sxs-lookup"><span data-stu-id="1cc57-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="1cc57-140">Si les propriétés de l'interface de composant contiennent des éléments ayant une date d'effet, le paramètre des propriétés doit contenir tous les éléments ayant une date d'effet future car la liste d'origine est remplacée.</span><span class="sxs-lookup"><span data-stu-id="1cc57-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="1cc57-141">Cela fournit le mécanisme d'ajout et de suppression des éléments ayant une date d'effet future. Cependant, si les propriétés contiennent aussi des éléments ayant une date d'effet passée, une erreur est renvoyée car de tels éléments ne peuvent pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="1cc57-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="1cc57-142">Si l'élément ayant une date d'effet actuelle est également inclus, il est ignoré.</span><span class="sxs-lookup"><span data-stu-id="1cc57-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="1cc57-143">Cela permet au client d’appeler `Get()` avec la `getHistoryItems` paramètre la valeur False et modifier les éléments à date d’effet futures ou ajouter de nouveaux éléments à date d’effet futures et transmettre la structure en tant que paramètre pour le `UpdateEx()` (fonction).</span><span class="sxs-lookup"><span data-stu-id="1cc57-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="1cc57-144">Si l’interface de composant n’a pas de clé, comme dans le cas où une seule instance peut exister, le `UpdateEx()` méthode présente sous la forme :</span><span class="sxs-lookup"><span data-stu-id="1cc57-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="1cc57-145">La méthode de l'adaptateur BizTalk pour PeopleSoft Enterprise `UpdateEx()` est fournie si les fonctions `Get` et `Save` de PeopleSoft sont activées dans l'interface de composant.</span><span class="sxs-lookup"><span data-stu-id="1cc57-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1cc57-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1cc57-146">See Also</span></span>  
 [<span data-ttu-id="1cc57-147">Annexe a : méthodes d’Interface de composant</span><span class="sxs-lookup"><span data-stu-id="1cc57-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)