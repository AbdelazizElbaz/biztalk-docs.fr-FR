---
title: "Expressions de l’adaptateur de Windows SharePoint Services | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: "22"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bf777931837f036f7228c4a359eef77faa9e97e7
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="bab73-102">Expressions de l'adaptateur Windows SharePoint Services</span><span class="sxs-lookup"><span data-stu-id="bab73-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="bab73-103">Cette rubrique décrit le format et la signification des chaînes qui peuvent être spécifiées en tant que valeurs pour le **fichier NameProperty Source** propriétés de l’adaptateur Windows SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="bab73-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="bab73-104">Elle décrit également les propriétés de contexte associées **WSS. Nom de fichier** et **WSS. ConfigPropertiesXml**.</span><span class="sxs-lookup"><span data-stu-id="bab73-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="bab73-105">Ces expressions permettent de définir aisément la valeur de nom de fichier ou la valeur de colonne Windows SharePoint Service personnalisée, à l'aide de littéraux et de valeurs extraites du message ou du système BizTalk.</span><span class="sxs-lookup"><span data-stu-id="bab73-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="bab73-106">Les expressions peuvent contenir des littéraux et des macros.</span><span class="sxs-lookup"><span data-stu-id="bab73-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="bab73-107">Les littéraux apparaissent dans le nom de fichier tels que vous les avez tapés.</span><span class="sxs-lookup"><span data-stu-id="bab73-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="bab73-108">Les macros doivent être placées entre des caractères « % ».</span><span class="sxs-lookup"><span data-stu-id="bab73-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="bab73-109">Par exemple, la macro `%MessageID%` est remplacée par le GUID du message au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="bab73-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bab73-110">Lorsque le caractère « % » est utilisé comme un littéral ou dans une expression XPATH, celui-ci doit être échappé ainsi \\%.</span><span class="sxs-lookup"><span data-stu-id="bab73-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="bab73-111">Un seul % sera considéré comme un délimiteur de macro, où un \\% sera remplacé par un seul % lors de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="bab73-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="bab73-112">Le \ caractère doit être échappé ainsi \\ \\.</span><span class="sxs-lookup"><span data-stu-id="bab73-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="bab73-113">Exemples d'expression</span><span class="sxs-lookup"><span data-stu-id="bab73-113">Expression examples</span></span>  
  
|<span data-ttu-id="bab73-114">Valeur au moment de la conception</span><span class="sxs-lookup"><span data-stu-id="bab73-114">Design time value</span></span>|<span data-ttu-id="bab73-115">Valeur au moment de l'exécution</span><span class="sxs-lookup"><span data-stu-id="bab73-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="bab73-116">XYZ</span><span class="sxs-lookup"><span data-stu-id="bab73-116">XYZ</span></span>|<span data-ttu-id="bab73-117">XYZ</span><span class="sxs-lookup"><span data-stu-id="bab73-117">XYZ</span></span>|  
|<span data-ttu-id="bab73-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="bab73-118">PurchaseOrder</span></span>|<span data-ttu-id="bab73-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="bab73-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="bab73-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="bab73-120">%MessageID%</span></span>|<span data-ttu-id="bab73-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="bab73-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="bab73-122">PurchaseOrder - %MessageID%</span><span class="sxs-lookup"><span data-stu-id="bab73-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="bab73-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="bab73-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="bab73-124">Remise \\% 10.</span><span class="sxs-lookup"><span data-stu-id="bab73-124">Discount \\%10</span></span>|<span data-ttu-id="bab73-125">Discount %10</span><span class="sxs-lookup"><span data-stu-id="bab73-125">Discount %10</span></span>|  
|<span data-ttu-id="bab73-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="bab73-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="bab73-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="bab73-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="bab73-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="bab73-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="bab73-129">PurchaseOrder – Contoso-10001</span><span class="sxs-lookup"><span data-stu-id="bab73-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="bab73-130">Macros prises en charge</span><span class="sxs-lookup"><span data-stu-id="bab73-130">Supported macros</span></span>  
  
|<span data-ttu-id="bab73-131">Valeur au moment de la conception</span><span class="sxs-lookup"><span data-stu-id="bab73-131">Design time value</span></span>|<span data-ttu-id="bab73-132">Valeur au moment de l'exécution</span><span class="sxs-lookup"><span data-stu-id="bab73-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="bab73-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="bab73-133">%MessageID%</span></span>|<span data-ttu-id="bab73-134">ID de message BizTalk qui est un GUID unique.</span><span class="sxs-lookup"><span data-stu-id="bab73-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="bab73-135">%SendingOrchestrationID%</span><span class="sxs-lookup"><span data-stu-id="bab73-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="bab73-136">ID BizTalk de l'instance d'orchestration dont provient le message.</span><span class="sxs-lookup"><span data-stu-id="bab73-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="bab73-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="bab73-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="bab73-138">Nom de type de l'orchestration dont provient le message.</span><span class="sxs-lookup"><span data-stu-id="bab73-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="bab73-139">% XPATH =\<xpath > %</span><span class="sxs-lookup"><span data-stu-id="bab73-139">%XPATH=\<xpath>%</span></span>|<span data-ttu-id="bab73-140">Permet de spécifier une syntaxe XPATH à utiliser pour extraire la valeur du message.</span><span class="sxs-lookup"><span data-stu-id="bab73-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="bab73-141">«\<xpath > » doit être remplacé par une expression XPATH valide.</span><span class="sxs-lookup"><span data-stu-id="bab73-141">“\<xpath>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="bab73-142">**Remarque :** l’alias d’espace de noms doit être défini en dehors de l’expression dans le 'Alias Namespace' ou WSS. Champ de ConfigNamespaceAliases.</span><span class="sxs-lookup"><span data-stu-id="bab73-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="bab73-143">%Filename%</span><span class="sxs-lookup"><span data-stu-id="bab73-143">%Filename%</span></span>|<span data-ttu-id="bab73-144">Remplacé par la valeur de nom de fichier extraite de la propriété de contexte de message WSS.Filename.</span><span class="sxs-lookup"><span data-stu-id="bab73-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="bab73-145">La valeur de la propriété de contexte WSS.Filename des messages reçus de SharePoint est définie sur le nom du fichier SharePoint.</span><span class="sxs-lookup"><span data-stu-id="bab73-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="bab73-146">La valeur renvoyée est prétraitée à l'aide de la méthode Path.GetFilenameWithoutExtension.</span><span class="sxs-lookup"><span data-stu-id="bab73-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="bab73-147">**Remarque :** cette macro ne peut pas être utilisée dans WSS. Configuration * Propriétés de contexte (à partir d’orchestration).</span><span class="sxs-lookup"><span data-stu-id="bab73-147">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="bab73-148">%Extension%</span><span class="sxs-lookup"><span data-stu-id="bab73-148">%Extension%</span></span>|<span data-ttu-id="bab73-149">Remplacé par la valeur d'extension de fichier extraite de la propriété de contexte de message WSS.Filename.</span><span class="sxs-lookup"><span data-stu-id="bab73-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="bab73-150">La valeur de la propriété de contexte WSS.Filename des messages reçus de SharePoint est définie sur le nom du fichier SharePoint.</span><span class="sxs-lookup"><span data-stu-id="bab73-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="bab73-151">La valeur renvoyée est prétraitée à l'aide de la méthode Path.GetExtension.</span><span class="sxs-lookup"><span data-stu-id="bab73-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="bab73-152">La valeur renvoyée ne contient pas le caractère « . ».</span><span class="sxs-lookup"><span data-stu-id="bab73-152">The returned value will not contain ".".</span></span> <span data-ttu-id="bab73-153">**Remarque :** cette macro ne peut pas être utilisée dans WSS. Configuration * Propriétés de contexte (à partir d’orchestration).</span><span class="sxs-lookup"><span data-stu-id="bab73-153">**Note:**  This macro cannot be used in WSS.Config* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="bab73-154">Les expressions valides prises en charge par la promotion de propriétés constituent des noms de fichier valides au moment de la conception.</span><span class="sxs-lookup"><span data-stu-id="bab73-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="bab73-155">Les noms de fichier au moment de la conception sont développés lors de l'exécution en noms de fichier Windows SharePoint Services.</span><span class="sxs-lookup"><span data-stu-id="bab73-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="bab73-156">Les limites applicables aux noms de fichier Windows SharePoint Services sont décrites ci-après.</span><span class="sxs-lookup"><span data-stu-id="bab73-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="bab73-157">Un nom de fichier Windows valide peut contenir des caractères Unicode, à l'exception des caractères suivants : /  \  :  *  ?</span><span class="sxs-lookup"><span data-stu-id="bab73-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  *  ?</span></span>  <span data-ttu-id="bab73-158">\<> &#124;  « # {} % & ~ ou caractères de tabulation et points multiples.</span><span class="sxs-lookup"><span data-stu-id="bab73-158">\<  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="bab73-159">Un nom de fichier peut inclure jusqu'à 256 caractères, de même que l'URL entière.</span><span class="sxs-lookup"><span data-stu-id="bab73-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="bab73-160">Si le nom de fichier Windows SharePoint Services complet contient des caractères non valides, ou si le nom de fichier complet et/ou l'URL sont trop longs, une erreur est consignée dans le journal des événements de l'application et le message est suspendu.</span><span class="sxs-lookup"><span data-stu-id="bab73-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="bab73-161">L'erreur et l'état du message sont également visibles dans la page Hub du groupe via le suivi des messages et des instances de service.</span><span class="sxs-lookup"><span data-stu-id="bab73-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bab73-162">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bab73-162">See Also</span></span>  
 <span data-ttu-id="bab73-163">[Pour configurer Windows SharePoint Services emplacement de réception](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="bab73-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="bab73-164">[Comment configurer un gestionnaire d’envoi Windows SharePoint Services](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="bab73-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="bab73-165">[Comment configurer un Port d’envoi Windows SharePoint Services](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="bab73-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="bab73-166">[Référence des propriétés de l’adaptateur Windows SharePoint Services](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="bab73-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="bab73-167">Prise en charge des Types de colonnes Windows SharePoint Services</span><span class="sxs-lookup"><span data-stu-id="bab73-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)