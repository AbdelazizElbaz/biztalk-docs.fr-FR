---
title: "Assembler un échange EDI par lot | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 18f64595-935e-4d52-9ec2-5edf7c2b9e83
caps.latest.revision: "45"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8c4274362e5ec8441e203d0b2b97f27e95235fd9
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="assembling-a-batched-edi-interchange"></a><span data-ttu-id="b7c57-102">Assemblage d'un échange EDI par lot</span><span class="sxs-lookup"><span data-stu-id="b7c57-102">Assembling a Batched EDI Interchange</span></span>
<span data-ttu-id="b7c57-103">Pour assembler des éléments de lot de document informatisé au sein d'un échange EDI, les fonctionnalités EDI et AS2 de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] effectuent les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7c57-103">To assemble individual transaction-set batch elements into an EDI interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI and AS2 does the following:</span></span>  
  
-   <span data-ttu-id="b7c57-104">identifier les éléments de lot pour le traitement par lot ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-104">Identifies batch elements for batching</span></span>  
  
-   <span data-ttu-id="b7c57-105">valider et mettre les éléments de lot individuels en mémoire tampon une fois ceux-ci reçus ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-105">Validates and buffers individual batch elements upon receipt</span></span>  
  
-   <span data-ttu-id="b7c57-106">récupérer des éléments de lot spécifiques et assembler un échange traité par lot lorsque les critères de déclenchement sont satisfaits.</span><span class="sxs-lookup"><span data-stu-id="b7c57-106">Retrieves specific batch elements and assembles a batched interchange when the release criteria is met</span></span>  
  
 <span data-ttu-id="b7c57-107">L'heure de début de la collecte des messages individuels à insérer dans un lot est déterminée par les critères d'activation du lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-107">The start time for collection of individual messages to go into a batch is determined by the batch activation criteria.</span></span> <span data-ttu-id="b7c57-108">L'heure de déclenchement du lot est déterminée par les critères de déclenchement du lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-108">The time at which the batch is released is determined by the batch release criteria.</span></span> <span data-ttu-id="b7c57-109">Pour plus d’informations sur ces deux ensembles de critères, consultez [configuration d’un lot sortant](../core/configuring-an-outgoing-batch.md).</span><span class="sxs-lookup"><span data-stu-id="b7c57-109">For more information about these two sets of criteria, see [Configuring an Outgoing Batch](../core/configuring-an-outgoing-batch.md).</span></span>  
  
## <a name="message-flow-for-outgoing-batched-messages"></a><span data-ttu-id="b7c57-110">Flux des messages traités par lot sortants</span><span class="sxs-lookup"><span data-stu-id="b7c57-110">Message Flow for Outgoing Batched Messages</span></span>  
 <span data-ttu-id="b7c57-111">Lorsque [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] est configuré pour traiter un message sortant par lot, les composants de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] effectuent les tâches suivantes pour préparer le message traité par lot pour envoi.</span><span class="sxs-lookup"><span data-stu-id="b7c57-111">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is configured to batch an outgoing message, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] components will perform the following series of steps to prepare the batched message for sending.</span></span> <span data-ttu-id="b7c57-112">Ces opérations décrivent le cas dans lequel le pipeline EDIReceive associé au composant de pipeline BatchMarker traite les échanges reçus qui contiennent des documents informatisés à traiter par lot pour envoi.</span><span class="sxs-lookup"><span data-stu-id="b7c57-112">This series of steps describes the case in which the EDIReceive pipeline with the BatchMarker pipeline component processes the received interchanges that contain transaction sets to be batched for sending.</span></span>  
  
1.  <span data-ttu-id="b7c57-113">Le composant BatchMarker dans le pipeline EDIReceive identifie les messages à traiter par lot en fonction des paramètres de filtre par lot EDI dans les propriétés du tiers.</span><span class="sxs-lookup"><span data-stu-id="b7c57-113">The BatchMarker pipeline component in the EDIReceive pipeline determines which messages need to be batched from the EDI batch filter settings in the party properties.</span></span> <span data-ttu-id="b7c57-114">(Il s'agit du seul composant de traitement par lot qui examine les paramètres de filtre par lot et agit sur eux.)</span><span class="sxs-lookup"><span data-stu-id="b7c57-114">(This is the only batching component that looks at the batch filter settings and acts upon them.)</span></span>  
  
2.  <span data-ttu-id="b7c57-115">Si les paramètres de filtre d'une seule configuration de lot s'abonnent à un message, le composant BatchMarker promeut la propriété `EDI.ToBeBatched = True`.</span><span class="sxs-lookup"><span data-stu-id="b7c57-115">If the filter settings of only one batch configuration subscribes to a message, the BatchMarker component will promote the property `EDI.ToBeBatched = True`.</span></span> <span data-ttu-id="b7c57-116">Cela garantit que l’orchestration prennent en charge le message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-116">This ensures that the batching orchestration will pick up the message.</span></span>  
  
3.  <span data-ttu-id="b7c57-117">Si les paramètres de filtre de plusieurs configurations de lot correspondent au contexte d'un message, le composant BatchMarker promeut les propriétés `EDI.ToBeRouted = True` et définit la propriété `EDI.BatchIds` sur une liste délimitée par des espaces contenant les ID de lot correspondants.</span><span class="sxs-lookup"><span data-stu-id="b7c57-117">If the filter settings of more than one batch configuration match the context of a message, the BatchMarker component promotes the properties `EDI.ToBeRouted = True` and sets the `EDI.BatchIds` property to a space delimited list containing the matching batch IDs.</span></span>  <span data-ttu-id="b7c57-118">Cela permet à l'orchestration de routage de s'abonner au message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-118">This ensures that the routing orchestration will subscribe to the message.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-119">Vous pouvez promouvoir les propriétés de contexte appropriées dans un pipeline de réception personnalisé ou une orchestration personnalisée.</span><span class="sxs-lookup"><span data-stu-id="b7c57-119">You can promote the appropriate context properties in a custom receive pipeline or a custom orchestration.</span></span> <span data-ttu-id="b7c57-120">Le pipeline de réception personnalisé peut utiliser le composant de pipeline BatchMarker ou promouvoir les propriétés sans recourir à ce même composant.</span><span class="sxs-lookup"><span data-stu-id="b7c57-120">The custom receive pipeline can use the BatchMarker pipeline component, or can promote the properties without using the BatchMarker pipeline component.</span></span>  
  
4.  <span data-ttu-id="b7c57-121">L'orchestration de routage récupère un document informatisé quelconque pour lequel `EDI.ToBeRouted = True` et la propriété `EDI.BatchIds` est promue, puis en crée des copies, de telle sorte qu'une copie de chaque ID de lot contenu dans la propriété `EDI.BatchIds` est disponible.</span><span class="sxs-lookup"><span data-stu-id="b7c57-121">The routing orchestration picks up any transaction set for which `EDI.ToBeRouted = True` and `EDI.BatchIds` is promoted, and then creates copies of the transaction set, ensuring that there is a copy for each batch ID contained in `EDI.BatchIds`.</span></span> <span data-ttu-id="b7c57-122">L'orchestration de routage définit `EDI.ToBeBatched = True` et la propriété `EDI.BatchId` est définie sur l'ID de lot de la configuration de lot correspondante pour chaque copie du document informatisé.</span><span class="sxs-lookup"><span data-stu-id="b7c57-122">The routing orchestration sets `EDI.ToBeBatched = True` and `EDI.BatchId` is set to the batch ID of the matching batch configuration for each copy of the transaction set.</span></span> <span data-ttu-id="b7c57-123">Cela permet à l'orchestration de traitement par lot de récupérer les documents informatisés pour leur appliquer un traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-123">This ensures that the transaction sets will be picked up by the batching orchestration for batching.</span></span>  
  
5.  <span data-ttu-id="b7c57-124">L'orchestration de traitement par lot récupère tous les messages pour lesquels les propriétés suivantes ont été promues :</span><span class="sxs-lookup"><span data-stu-id="b7c57-124">The batching orchestration picks up all messages for which the following properties have been promoted:</span></span>  
  
    -   <span data-ttu-id="b7c57-125">`EDI.ToBeBatched = True` et EDI.BatchId = ID du lot associé à cette instance de l'orchestration de traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-125">`EDI.ToBeBatched = True` and EDI.BatchId = the batch id of the batch associated with this instance of the batching orchestration.</span></span>  
  
    -   <span data-ttu-id="b7c57-126">`EDI.ToBeBatched = True`, EDI.BatchName = nom du lot configuré et EDI.DestinationPartyName = nom du tiers contentant la configuration de lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-126">`EDI.ToBeBatched = True` and EDI.BatchName = the name of the configured batch and EDI.DestinationPartyName = the party name that contains the batch configuration.</span></span>  
  
     <span data-ttu-id="b7c57-127">Lors du traitement des messages entrants par le pipeline EDIReceive (à l'aide du composant de pipeline BatchMarker), l'orchestration de traitement par lot ne traite que les documents informatisés X12 et EDIFACT.</span><span class="sxs-lookup"><span data-stu-id="b7c57-127">When the incoming messages are processed by the EDIReceive pipeline (with the BatchMarker pipeline component), the batching orchestration will batch only X12- or EDIFACT-encoded transaction sets.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-128">Il n'y a qu'une instance de l'orchestration de traitement par lot pour chaque configuration de lot active, chacune s'abonnant à un ID de lot spécifique.</span><span class="sxs-lookup"><span data-stu-id="b7c57-128">There will be one instance of the batching orchestration for each active batch configuration, each subscribing to a specific batch ID.</span></span> <span data-ttu-id="b7c57-129">La valeur d’ID de lot est définie automatiquement lors de la création d’une nouvelle configuration de lot dans le **Identification** section de la **le traitement par lot de Configuration** page de l’onglet d’accord unidirectionnel de la  **Propriétés de l’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-129">The batch ID value is set automatically when creating a new batch configuration in the **Identification** section of the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
6.  <span data-ttu-id="b7c57-130">L'orchestration de traitement par lot valide chaque document informatisé auquel un traitement par lot est appliqué.</span><span class="sxs-lookup"><span data-stu-id="b7c57-130">The batching orchestration validates each transaction set to be batched.</span></span> <span data-ttu-id="b7c57-131">Si le processus de validation échoue, elle définit la propriété de contexte `EDI.BatchItemValidationFailure` sur la valeur True.</span><span class="sxs-lookup"><span data-stu-id="b7c57-131">If the transaction set fails validation, it sets the `EDI.BatchItemValidationFailure` context property to "True".</span></span> <span data-ttu-id="b7c57-132">Le **BatchSuspend** orchestration récupère le message en fonction de cette propriété de contexte, publie des informations sur l’erreur, puis est interrompue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-132">The **BatchSuspend** orchestration picks up the message based upon that context property, posts error information, and then is suspended.</span></span>  
  
7.  <span data-ttu-id="b7c57-133">Une fois les critères de déclenchement du lot satisfaits, l'orchestration de traitement par lot assemble les éléments de lot au sein d'un lot et crée une enveloppe.</span><span class="sxs-lookup"><span data-stu-id="b7c57-133">When the batch release criteria has been met, the batching orchestration assembles the batch elements into a batch and creates an envelope.</span></span>  
  
8.  <span data-ttu-id="b7c57-134">Une fois que l'orchestration de traitement par lot a terminé le traitement par lot d'un échange, elle promeut les propriétés suivantes sur cet échange : EDI.DestinationPartyName = %Nom_tiers%, EDI.BatchEncodingType = X12 ou EDIFACT et EDI.ToBeBatched = False.</span><span class="sxs-lookup"><span data-stu-id="b7c57-134">After the batching orchestration completes batching an interchange, it promotes the following properties on that interchange: EDI.DestinationPartyName = %PartyName%, EDI.BatchEncodingType = X12 or EDIFACT, and EDI.ToBeBatched = False.</span></span>  
  
9. <span data-ttu-id="b7c57-135">Un port d’envoi récupère les documents informatisés traités par lot en fonction de l’EDI. DestinationPartyName = \<Nom_tiers\>, EDI. BatchEncodingType = EDIFACT ou X12 et EDI. ToBeBatched = False.</span><span class="sxs-lookup"><span data-stu-id="b7c57-135">A send port picks up the batched transaction sets based on EDI.DestinationPartyName = \<PartyName\>, EDI.BatchEncodingType = EDIFACT or X12, and EDI.ToBeBatched = False.</span></span>  
  
## <a name="batching-orchestration-control-messages"></a><span data-ttu-id="b7c57-136">Messages de contrôle de l'orchestration de traitement par lot</span><span class="sxs-lookup"><span data-stu-id="b7c57-136">Batching Orchestration Control Messages</span></span>  
 <span data-ttu-id="b7c57-137">L'orchestration de traitement par lot est activée, arrêtée ou remplacée par les messages de contrôle suivants :</span><span class="sxs-lookup"><span data-stu-id="b7c57-137">The batching orchestration is activated, terminated, or overridden by the following control messages:</span></span>  
  
-   <span data-ttu-id="b7c57-138">**BatchActivation**: lorsque l’orchestration reçoit ce message, une instance de l’orchestration de traitement par lot est créée et l’orchestration est activée pour recevoir les éléments de lot (si elle satisfait les critères d’activation du lot).</span><span class="sxs-lookup"><span data-stu-id="b7c57-138">**BatchActivation**: When the orchestration receives this message, an instance of the batching orchestration is created and the orchestration is active to receive batch elements (if it meets the batch activation criteria).</span></span> <span data-ttu-id="b7c57-139">Ce message de contrôle est envoyé en cliquant sur le **Démarrer** bouton d’une configuration de lot sur la **Configuration de traitement par lot** page de l’onglet d’accord unidirectionnel de la **Propriétésdel’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-139">This control message is sent by clicking the **Start** button of a batch configuration on the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
-   <span data-ttu-id="b7c57-140">**BatchTermination**: lorsque l’orchestration reçoit ce message, il crée un lot à partir d’éléments de lot existants, publie le message vers la MessageBox et s’arrête.</span><span class="sxs-lookup"><span data-stu-id="b7c57-140">**BatchTermination**: When the orchestration receives this message, it creates a batch from existing batch elements, publishes the message to the MessageBox, and terminates.</span></span> <span data-ttu-id="b7c57-141">Ce message de contrôle est envoyé en cliquant sur le **arrêter** bouton d’une configuration de lot sur la **Configuration de traitement par lot** page de l’onglet d’accord unidirectionnel de la **Propriétésdel’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-141">This control message is sent by clicking the **Stop** button of a batch configuration on the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-142">L’orchestration est également arrêtée si elle atteint la durée spécifiée pour le **fin par** propriété dans le **arrêt** section de la **Configuration de traitement par lot** page de la onglet d’accord unidirectionnel de la **propriétés de l’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-142">The orchestration is also terminated if it reaches the time specified for the **End-by** property in the **Termination** section of the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
-   <span data-ttu-id="b7c57-143">**BatchOverride**: lorsque l’orchestration reçoit ce message, il crée un lot à partir d’éléments existants, publie le message vers la MessageBox et attend les messages pour le lot suivant.</span><span class="sxs-lookup"><span data-stu-id="b7c57-143">**BatchOverride**: When the orchestration receives this message, it creates a batch from existing elements, publishes the message to the MessageBox, and then waits for messages for the next batch.</span></span> <span data-ttu-id="b7c57-144">Envoyer ce message de contrôle en cliquant sur le **remplacer** bouton d’une configuration de lot sur la **le traitement par lot de Configuration** page de l’onglet d’accord unidirectionnel de la **Propriétésdel’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-144">This control message is sent by clicking the **Override** button of a batch configuration on the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="b7c57-145">L'orchestration de traitement par lot reçoit les messages de contrôle via l'emplacement de réception BatchControlMessageRecvLoc.</span><span class="sxs-lookup"><span data-stu-id="b7c57-145">The batching orchestration receives the control messages via the BatchControlMessageRecvLoc receive location.</span></span> <span data-ttu-id="b7c57-146">L’intervalle d’interrogation pour cet emplacement de réception SQL a la valeur par défaut de 30 secondes, mais peut être modifié dans le **propriétés du Transport SQL** boîte de dialogue de l’emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="b7c57-146">The polling interval for this SQL receive location is set by default to 30 seconds, but can be changed in the **SQL Transport Properties** dialog box for the receive location.</span></span> <span data-ttu-id="b7c57-147">La diminution de la fréquence d'interrogation garantit que l'emplacement de réception BatchControlMessageRecvLoc reçoit un message de contrôle peu après l'exécution de l'action à l'origine de l'envoi du message de contrôle (par exemple, lors du démarrage de l'orchestration de traitement par lot).</span><span class="sxs-lookup"><span data-stu-id="b7c57-147">Decreasing the polling interval will ensure that the BatchControlMessageRecvLoc receive location will receive a control message soon after you perform the action that sent the control message (such as when you start the batching orchestration).</span></span>  
  
 <span data-ttu-id="b7c57-148">Les opérations suivantes surviennent au démarrage d'une orchestration de traitement par lot :</span><span class="sxs-lookup"><span data-stu-id="b7c57-148">The following steps occur when you start a batch orchestration:</span></span>  
  
1.  <span data-ttu-id="b7c57-149">Lorsque vous cliquez sur le **Démarrer** bouton, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] crée un enregistrement dans une table qui indique l’id de tiers et de traitement par lots vous activez l’orchestration de traitement par lots pour.</span><span class="sxs-lookup"><span data-stu-id="b7c57-149">When you click the **Start** button, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] creates a record in a table indicating which party and batch id you are activating the batch orchestration for.</span></span>  
  
2.  <span data-ttu-id="b7c57-150">L'adaptateur SQL associé à l'emplacement de réception BatchControlMessageRecvLoc lance une interrogation pour vérifier l'existence de l'enregistrement dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="b7c57-150">The SQL adapter associated with the BatchControlMessageRecvLoc receive location polls to see if the record exists in the database.</span></span>  
  
3.  <span data-ttu-id="b7c57-151">Si l'enregistrement existe, l'adaptateur SQL génère un message de contrôle, en utilisant les informations de l'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="b7c57-151">If the record exists, the SQL adapter builds a control message, using information in the record.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-152">La génération du message de contrôle de cette façon garantit que l'orchestration ne peut pas être démarrée par un message de contrôle non valide.</span><span class="sxs-lookup"><span data-stu-id="b7c57-152">Building the control message in this way ensures that the orchestration cannot be started by an invalid control message.</span></span>  
  
4.  <span data-ttu-id="b7c57-153">L'emplacement de réception BatchControlMessageRecvLoc reçoit le message de contrôle et [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] active une instance de l'orchestration de traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-153">The BatchControlMessageRecvLoc receive location receives the control message, and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] activates a batching orchestration instance.</span></span>  
  
## <a name="batch-components"></a><span data-ttu-id="b7c57-154">Composants d'un traitement par lot</span><span class="sxs-lookup"><span data-stu-id="b7c57-154">Batch Components</span></span>  
 <span data-ttu-id="b7c57-155">La fonctionnalité EDI de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] applique un traitement par lot aux documents informatisés XML sous la forme d'échanges EDI à l'aide des composants suivants :</span><span class="sxs-lookup"><span data-stu-id="b7c57-155">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI batches XML transaction sets into EDI interchanges using the following components:</span></span>  
  
-   <span data-ttu-id="b7c57-156">BatchMarkerReceivePipelineComponent dans le pipeline de réception EDI ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-156">BatchMarkerReceivePipelineComponent in the EDI receive pipeline</span></span>  
  
-   <span data-ttu-id="b7c57-157">Orchestration de routage</span><span class="sxs-lookup"><span data-stu-id="b7c57-157">Routing Orchestration</span></span>  
  
-   <span data-ttu-id="b7c57-158">Orchestration de traitement par lot</span><span class="sxs-lookup"><span data-stu-id="b7c57-158">Batching Orchestration</span></span>  
  
-   <span data-ttu-id="b7c57-159">orchestration UpgradeBatching ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-159">Upgrade Batching Orchestration</span></span>  
  
-   <span data-ttu-id="b7c57-160">Orchestration BatchSuspend</span><span class="sxs-lookup"><span data-stu-id="b7c57-160">BatchSuspend Orchestration</span></span>  
  
-   <span data-ttu-id="b7c57-161">Pipeline d'envoi EDI</span><span class="sxs-lookup"><span data-stu-id="b7c57-161">EDI Send Pipeline</span></span>  
  
 <span data-ttu-id="b7c57-162">Ces composants sont installés sous forme de DLL lors de l'installation et de la configuration des fonctionnalités EDI et AS2 de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b7c57-162">These components are installed as DLLs when you install and configure [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI and AS2.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b7c57-163">Les composants de traitement par lot dans les fonctionnalités EDI et AS2 de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ne garantissent pas le classement des documents informatisés dans un lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-163">The batching components in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI and AS2 do not guarantee the ordering of the transaction sets in a batch.</span></span>  
  
### <a name="batchmarkerreceivepipelinecomponent"></a><span data-ttu-id="b7c57-164">BatchMarkerReceivePipelineComponent</span><span class="sxs-lookup"><span data-stu-id="b7c57-164">BatchMarkerReceivePipelineComponent</span></span>  
 <span data-ttu-id="b7c57-165">Le composant BatchMarkerReceivePipelineComponent dans le pipeline de réception EDI permet à l'orchestration de traitement par lot de récupérer les messages auxquels appliquer un traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-165">BatchMarkerReceivePipelineComponent in the EDI receive pipeline enables the batching orchestration to pick up messages to be batched.</span></span> <span data-ttu-id="b7c57-166">Ce composant de pipeline est appliqué après le désassembleur dans le pipeline de réception EDI.</span><span class="sxs-lookup"><span data-stu-id="b7c57-166">This pipeline component is applied after the Disassembler in the EDI Receive Pipeline.</span></span> <span data-ttu-id="b7c57-167">Le composant évalue les critères de filtre définis dans le **filtre** section de la **le traitement par lot de Configuration** page de l’onglet d’accord unidirectionnel de la **propriétés de l’accord** boîte de dialogue et marque les ensembles de transactions avec les propriétés de contexte suivantes pour le traitement par le routage et le traitement par lot des orchestrations</span><span class="sxs-lookup"><span data-stu-id="b7c57-167">The component evaluates the filter criteria set in the **Filter** section of the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box, and marks the transaction sets with the following context properties for processing by the routing and batching orchestrations</span></span>  
  
-   <span data-ttu-id="b7c57-168">Si un seul tiers s'abonne à un message auquel appliquer un traitement par lot, il promeut `ToBeBatched = True` et la propriété BatchId est définie sur la valeur de l'ID de lot de la configuration de lot correspondante.</span><span class="sxs-lookup"><span data-stu-id="b7c57-168">If a single party subscribes to a message to be batched, it promotes `ToBeBatched = True` and BatchId is set to the value of the batch ID of the matching batch configuration.</span></span> <span data-ttu-id="b7c57-169">Cela permet à l'orchestration de traitement par lot de récupérer le message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-169">This enables pickup by the batching orchestration.</span></span>  
  
-   <span data-ttu-id="b7c57-170">Si plusieurs lots s'abonnent à un message auquel appliquer un traitement par lot, il promeut `ToBeRouted = True` et définit la propriété `EDI.BatchIds` sur une liste d'ID de lot délimitée par des espaces.</span><span class="sxs-lookup"><span data-stu-id="b7c57-170">If multiple batches subscribe to a message to be batched, it promotes `ToBeRouted = True`, and sets the `EDI.BatchIds` property set to a space-delimited list of batch IDs.</span></span> <span data-ttu-id="b7c57-171">Cela permet à l'orchestration de routage de récupérer le message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-171">This enables pickup by the routing orchestration.</span></span>  
  
-   <span data-ttu-id="b7c57-172">Si aucun abonnement n'existe, il ne promeut aucune propriété de contexte.</span><span class="sxs-lookup"><span data-stu-id="b7c57-172">If no subscriptions exist, it does not promote a context property.</span></span> <span data-ttu-id="b7c57-173">Cela indique que le document informatisé ne doit pas être traité par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-173">This indicates that the transaction set is not to be batched.</span></span>  
  
 <span data-ttu-id="b7c57-174">Le composant de pipeline ignore les messages dans un format autre que XML et les messages associés à la propriété `ReuseEnvelope` (lots conservés).</span><span class="sxs-lookup"><span data-stu-id="b7c57-174">The pipeline component ignores messages other than XML and messages with the `ReuseEnvelope` property (preserved batches).</span></span> <span data-ttu-id="b7c57-175">Si les accusés de réception ne doivent pas être traités par lot, le composant de pipeline ignore les types de messages ACK (CONTRL, TA1 et 997).</span><span class="sxs-lookup"><span data-stu-id="b7c57-175">If acknowledgments are not to be batched, the pipeline component will ignore the ACK message types (CONTRL, TA1, and 997).</span></span> <span data-ttu-id="b7c57-176">Pour optimiser le traitement des orchestrations de routage et de traitement par lot, le composant BatchMarkerPipelineComponent transmet le message à la base de données MessageBox si la propriété de contexte `MessageDestination` du message est définie sur la valeur « SuspendedQueue » par le désassembleur.</span><span class="sxs-lookup"><span data-stu-id="b7c57-176">To optimize processing of the routing and batching orchestrations, the BatchMarkerPipelineComponent passes the message through to the MessageBox if the message context property `MessageDestination` is set to "SuspendedQueue" by the disassembler.</span></span>  
  
 <span data-ttu-id="b7c57-177">Si vous utilisez un pipeline personnalisé à la place du pipeline EDIReceive, vous pouvez utiliser le composant BatchMarker dans votre pipeline personnalisé.</span><span class="sxs-lookup"><span data-stu-id="b7c57-177">If you are using a custom pipeline, rather than the EDIReceive pipeline, you can use the BatchMarker component in your custom pipeline.</span></span> <span data-ttu-id="b7c57-178">Si vous n'utilisez pas le pipeline EDIReceive et publiez des messages à partir d'une orchestration, vous devez promouvoir `ToBeBatched = True` et définir la propriété `BatchID` sur l'ID d'un lot actif dans l'un de vos composants.</span><span class="sxs-lookup"><span data-stu-id="b7c57-178">If you are not using the EDIReceive pipeline, and are publishing messages from an orchestration, you will have to promote `ToBeBatched = True` and `BatchID` to the ID of an active batch in one of your components.</span></span>  
  
### <a name="routing-orchestration"></a><span data-ttu-id="b7c57-179">Orchestration de routage</span><span class="sxs-lookup"><span data-stu-id="b7c57-179">Routing Orchestration</span></span>  
 <span data-ttu-id="b7c57-180">L'orchestration de routage s'abonne aux messages avec la propriété de contexte `ToBeRouted = True` et la propriété de contexte `EDI.BatchIds` définie sur une liste d'ID de lot délimitée par des espaces.</span><span class="sxs-lookup"><span data-stu-id="b7c57-180">The routing orchestration subscribes to any message with the context property `ToBeRouted = True` and the context property `EDI.BatchIds` set to a space-delimited list of batch IDs.</span></span> <span data-ttu-id="b7c57-181">Cela se produit lorsque plusieurs filtres de lot s'abonnent à un message auquel appliquer un traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-181">This occurs when multiple batch filters subscribe to a message to be batched.</span></span> <span data-ttu-id="b7c57-182">L'orchestration de routage effectue une copie du message pour chaque ID de lot contenu dans la propriété `EDI.BatchIds`.</span><span class="sxs-lookup"><span data-stu-id="b7c57-182">The routing orchestration will make a copy of the message for each batch ID contained in `EDI.BatchIds`.</span></span> <span data-ttu-id="b7c57-183">Elle applique deux nouvelles propriétés de contexte à chaque copie :</span><span class="sxs-lookup"><span data-stu-id="b7c57-183">It stamps each copy with two new context properties:</span></span>  
  
-   <span data-ttu-id="b7c57-184">`EDI.BatchID`, définie sur l'ID du lot auquel ce message est destiné.</span><span class="sxs-lookup"><span data-stu-id="b7c57-184">`EDI.BatchID`, which is set to the ID of the batch that this message is intended for.</span></span>  
  
-   <span data-ttu-id="b7c57-185">`EDI.ToBeBatched`, définie sur la valeur True.</span><span class="sxs-lookup"><span data-stu-id="b7c57-185">`EDI.ToBeBatched`, which is set to True.</span></span>  
  
 <span data-ttu-id="b7c57-186">Elle achemine ensuite les copies à la base de données MessageBox afin que celles-ci soient récupérées par l'orchestration de traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-186">It then routes the copies to the MessageBox to be picked up by the batching orchestration.</span></span> <span data-ttu-id="b7c57-187">Chaque ID de lot de destination utilise une instance singleton de la même orchestration, avec un filtre sur l'ID de lot spécifique.</span><span class="sxs-lookup"><span data-stu-id="b7c57-187">Each destination batch ID use a singleton instance of the same orchestration, with a filter on the specific batch ID.</span></span>  
  
### <a name="batching-orchestration"></a><span data-ttu-id="b7c57-188">Orchestration de traitement par lot</span><span class="sxs-lookup"><span data-stu-id="b7c57-188">Batching Orchestration</span></span>  
 <span data-ttu-id="b7c57-189">L'orchestration de traitement par lot est un service avec état qui met en mémoire tampon des éléments de lot (documents informatisés) au cours d'une période, les assemble au sein d'un échange, puis transmet l'échange au pipeline d'envoi en fonction des critères de déclenchement.</span><span class="sxs-lookup"><span data-stu-id="b7c57-189">The batching orchestration is a stateful service that buffers batch elements (transaction sets) over a period of time, assembles them into an interchange, and then releases the interchange to the send pipeline based upon the release criteria.</span></span>  
  
 <span data-ttu-id="b7c57-190">Une fois activée, une instance de l’orchestration de traitement par lot peut démarrer le traitement par lot des messages d’un type de codage particulier à un tiers donné (si le **Démarrer** datetime a passé).</span><span class="sxs-lookup"><span data-stu-id="b7c57-190">After being activated, an instance of the batching orchestration can start batching messages of a particular encoding type to a given party (if the **Start** datetime has passed).</span></span> <span data-ttu-id="b7c57-191">À tout moment, il peut y avoir plusieurs instances de l'orchestration de traitement par lot pour chaque tiers (une instance par configuration de lot active).</span><span class="sxs-lookup"><span data-stu-id="b7c57-191">At any one time there can be many instances of the batching orchestration for each party, one per active batch configuration.</span></span> <span data-ttu-id="b7c57-192">Une instance unique de l'orchestration de traitement par lot peut transmettre plusieurs lots pour une seule configuration de lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-192">A single instance of the batching orchestration can release multiple batches for a single  batch configuration.</span></span> <span data-ttu-id="b7c57-193">Une fois les critères de fin satisfaits, l'instance de l'orchestration de traitement par lot est arrêtée.</span><span class="sxs-lookup"><span data-stu-id="b7c57-193">After the end criteria is met, the batching orchestration instance will terminate.</span></span> <span data-ttu-id="b7c57-194">Une nouvelle instance de l’orchestration de traitement par lot doit être créé manuellement à partir de la gestion de partenaires commerciaux (GPC) à l’aide de la **Démarrer** bouton.</span><span class="sxs-lookup"><span data-stu-id="b7c57-194">A new instance of the batching orchestration will need to be created manually from the Trading Partner Management (TPM) using the **Start** button.</span></span>  
  
 <span data-ttu-id="b7c57-195">Si l’orchestration de traitement par lots commence avant le début de période date indiquée dans le **Activation** section sur la de la **le traitement par lot de Configuration** page de l’onglet d’accord unidirectionnel de la **accord Propriétés** boîte de dialogue, elle reçoit uniquement les messages qui sont spécifiés dans la plage d’activation.</span><span class="sxs-lookup"><span data-stu-id="b7c57-195">If the batch orchestration starts before the start date time shown in the **Activation** section on the of the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box, it will only receive messages that are specified in the activation range.</span></span> <span data-ttu-id="b7c57-196">pas ceux envoyés avant les date et heure de début.</span><span class="sxs-lookup"><span data-stu-id="b7c57-196">It will not receive messages sent before the start date time.</span></span>  
  
 <span data-ttu-id="b7c57-197">L'orchestration de traitement par lot effectue les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7c57-197">The batching orchestration does the following:</span></span>  
  
-   <span data-ttu-id="b7c57-198">Elle s'abonne aux éléments de lot XML avec les propriétés de contexte `EDI.ToBeBatched = True` et `EDI.BatchId` = ID de la configuration de lot, ou `EDI.ToBeBatched = True`, EDI.BatchName = nom du lot configuré et EDI.DestinationPartyName = nom du tiers contenant la configuration de lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-198">Subscribes to XML batch elements with the context properties `EDI.ToBeBatched = True` and `EDI.BatchId` the ID of the batch configuration, or `EDI.ToBeBatched = True` and EDI.BatchName = the name of the configured batch and EDI.DestinationPartyName = the party name that contains the batch configuration.</span></span> <span data-ttu-id="b7c57-199">Il reçoit les éléments de lot à l’aide un **réception** opération d’action dans une boucle.</span><span class="sxs-lookup"><span data-stu-id="b7c57-199">It receives batch elements using a **Receive** action operation in a loop.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-200">L’orchestration ne pas traiter par lot des documents informatisés en fonction de critères de filtre définis dans la section filtre de le **le traitement par lot de Configuration** page de l’onglet d’accord unidirectionnel de la **Propriétésdel’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-200">The batching orchestration does not batch transaction sets based upon the filter criteria set in the Filter section of the **Batching Configuration** page of the one-way agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="b7c57-201">Elle s'abonne aux documents informatisés pour lesquels les propriétés de contexte ci-dessus sont définies.</span><span class="sxs-lookup"><span data-stu-id="b7c57-201">It subscribes to transaction sets that have the above context properties set on them.</span></span> <span data-ttu-id="b7c57-202">Le composant de pipeline BatchMarker définit et promeut ces propriétés de contexte en fonction des paramètres de filtre définis dans les propriétés du tiers.</span><span class="sxs-lookup"><span data-stu-id="b7c57-202">The BatchMarker pipeline component sets and promotes those context properties based upon the filter settings in the party properties.</span></span>  
  
-   <span data-ttu-id="b7c57-203">Elle récupère les paramètres de configuration de lot pour le tiers identifié dans la propriété de contexte `BatchId`.</span><span class="sxs-lookup"><span data-stu-id="b7c57-203">Retrieves the batch configuration settings for the party identified in the `BatchId` context property.</span></span>  
  
-   <span data-ttu-id="b7c57-204">Elle valide l'élément de lot (document informatisé) en fonction des paramètres du tiers.</span><span class="sxs-lookup"><span data-stu-id="b7c57-204">Validates the batch element (transaction set) based on party settings.</span></span>  
  
-   <span data-ttu-id="b7c57-205">Si un élément de lot comporte une erreur, l'orchestration de traitement par lot promeut la propriété suivante sur ce document informatisé : `EDI.BatchItemValidationFailure = True`.</span><span class="sxs-lookup"><span data-stu-id="b7c57-205">If there is an error in a batch element, the batching orchestration will promoted the following property on that transaction set: `EDI.BatchItemValidationFailure = True`.</span></span> <span data-ttu-id="b7c57-206">Le **BatchElementSuspend** orchestration s’abonne à n’importe quel document informatisé pour lesquels cette propriété est promue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-206">The **BatchElementSuspend** orchestration subscribes to any transaction set for which this property has been promoted.</span></span> <span data-ttu-id="b7c57-207">Elle fournit des informations détaillées sur la première erreur rencontrée lors du traitement par lot de l'échange.</span><span class="sxs-lookup"><span data-stu-id="b7c57-207">This orchestration will provide detailed error information for the first error encountered in batching the interchange.</span></span>  
  
-   <span data-ttu-id="b7c57-208">Si un élément de lot ne comporte aucune erreur, elle conserve une référence à cet élément de lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-208">If there is no error in a batch element, holds a reference to that batch element.</span></span>  
  
-   <span data-ttu-id="b7c57-209">Lorsque le message de contrôle approprié est reçu ou les critères de déclenchement du traitement par lot est remplie, elle interrompt la **réception** boucle d’action, récupère tous les éléments de lot à partir de la MessageBox et assemble l’échange.</span><span class="sxs-lookup"><span data-stu-id="b7c57-209">When the appropriate control message is received or the batching release criteria is met, breaks out of the **Receive** action loop, retrieves all batch elements from the MessageBox, and assembles the interchange.</span></span>  
  
-   <span data-ttu-id="b7c57-210">Elle définit la propriété de contexte `ToBeBatched = False` pour l'échange et la propriété de contexte DestinationPartyName = %Nom_tiers% où %Nom_tiers% est le nom du tiers auquel le message est destiné.</span><span class="sxs-lookup"><span data-stu-id="b7c57-210">Sets the context property `ToBeBatched = False` for the interchange and the context property DestinationPartyName = %PartyName% where %PartyName% is the name of the party for which the message is intended.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-211">Si un port d'envoi s'abonne à la propriété `EDI.ToBeBatched = False` et/ou à la propriété EDI.DestinationPartyName = %Nom_tiers%, il peut récupérer l'échange traité par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-211">If a send port subscribes to either or both of the properties `EDI.ToBeBatched = False` and EDI.DestinationPartyName = %PartyName%, that send port can pick up the batched interchange.</span></span> <span data-ttu-id="b7c57-212">Vérifiez que les filtres d'un port d'envoi sont configurés de telle sorte que celui-ci récupère uniquement les échanges traités par lot appropriés.</span><span class="sxs-lookup"><span data-stu-id="b7c57-212">Make sure that a send port's filters are configured such that the send port picks up only those batched interchanges that it is intended to pick up.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="b7c57-213">Seules les propriétés `EDI.ToBeBatched = False`, EDI.DestinationPartyName = %Nom_tiers% et EDI.BatchEncodingType = "X12" ou "EDIFACT" des échanges déposés par l'orchestration de traitement par lot dans la base de données MessageBox sont promues dans le contexte.</span><span class="sxs-lookup"><span data-stu-id="b7c57-213">Interchanges dropped by the batching orchestration into the MessageBox have only the properties `EDI.ToBeBatched = False`, EDI.DestinationPartyName = %PartyName%, and EDI.BatchEncodingType = "X12" or "EDIFACT" promoted to the context.</span></span> <span data-ttu-id="b7c57-214">Toutes les propriétés de contexte des documents informatisés d'origine sont perdues.</span><span class="sxs-lookup"><span data-stu-id="b7c57-214">All context properties from the original transaction sets are lost.</span></span>  
  
-   <span data-ttu-id="b7c57-215">Pour un échange X12, elle applique les propriétés suivantes à l'enveloppe :</span><span class="sxs-lookup"><span data-stu-id="b7c57-215">For an X12-encoded interchange, applies the following properties to the envelope:</span></span>  
  
    -   <span data-ttu-id="b7c57-216">ISA6 : ID de l'expéditeur de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-216">ISA6: Interchange Sender ID</span></span>  
  
    -   <span data-ttu-id="b7c57-217">ISA8 : ID du destinataire de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-217">ISA8: Interchange Receiver ID</span></span>  
  
    -   <span data-ttu-id="b7c57-218">ISA15 : indicateur d'utilisation ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-218">ISA15: Usage indicator</span></span>  
  
    -   <span data-ttu-id="b7c57-219">ISA_Blob (écrite dans le contexte).</span><span class="sxs-lookup"><span data-stu-id="b7c57-219">ISA_Blob (written to context)</span></span>  
  
-   <span data-ttu-id="b7c57-220">Pour un échange EDIFACT, elle applique les propriétés suivantes à l'enveloppe :</span><span class="sxs-lookup"><span data-stu-id="b7c57-220">For an EDIFACT-encoded interchange, applies the following properties to the envelope:</span></span>  
  
    -   <span data-ttu-id="b7c57-221">UNB2.1 : ID de l'expéditeur de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-221">UNB2.1: Interchange Sender ID</span></span>  
  
    -   <span data-ttu-id="b7c57-222">UNB3.1 : ID du destinataire de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-222">UNB3.1: Interchange Recipient ID</span></span>  
  
    -   <span data-ttu-id="b7c57-223">UNB2.3 : adresse de routage inverse ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-223">UNB2.3: Address for Reverse Routing</span></span>  
  
    -   <span data-ttu-id="b7c57-224">UNB11 : indicateur d'utilisation ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-224">UNB11: Usage indicator</span></span>  
  
    -   <span data-ttu-id="b7c57-225">UNA_Blob (écrite dans le contexte) ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-225">UNA_Blob (written to context)</span></span>  
  
    -   <span data-ttu-id="b7c57-226">UNB_Blob (écrite dans le contexte).</span><span class="sxs-lookup"><span data-stu-id="b7c57-226">UNB_Blob (written to context)</span></span>  
  
-   <span data-ttu-id="b7c57-227">Elle remet l'échange traité par lot à la base de données MessageBox pour que le pipeline d'envoi EDI puisse le récupérer.</span><span class="sxs-lookup"><span data-stu-id="b7c57-227">Delivers the batched interchange to the MessageBox for pickup by the EDI send pipeline.</span></span>  
  
### <a name="upgradebatching-orchestration"></a><span data-ttu-id="b7c57-228">Orchestration UpgradeBatching</span><span class="sxs-lookup"><span data-stu-id="b7c57-228">UpgradeBatching Orchestration</span></span>  
 <span data-ttu-id="b7c57-229">L'orchestration UpgradeBatching traite les messages pour lesquels la propriété `EDI.ToBeBatched` est définie sur la valeur True mais la propriété `EDI.BatchID` n'est pas définie.</span><span class="sxs-lookup"><span data-stu-id="b7c57-229">The UpgradeBatching orchestration handles messages that are have the `EDI.ToBeBatched` property set to true, but do not have the `EDI.BatchID` property set.</span></span>  
  
 <span data-ttu-id="b7c57-230">Dans les versions précédentes de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], chaque tiers ne pouvait avoir qu'une seule configuration de lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-230">In previous versions of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], each party could have only one batch configuration.</span></span>  <span data-ttu-id="b7c57-231">Dans le cadre du traitement des messages pour lesquels la propriété `EDI.ToBeBatched` est définie sur la valeur True, la propriété `EDI.DestinationPartyId` était utilisée pour identifier le tiers, puis la configuration de lot était lue à partir des propriétés de l'accord.</span><span class="sxs-lookup"><span data-stu-id="b7c57-231">When processing messages that had `EDI.ToBeBatched` set to true, the `EDI.DestinationPartyId` was used to determine the party and then the batch configuration was read from the agreement properties.</span></span>  
  
 <span data-ttu-id="b7c57-232">Dans [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], plusieurs configurations de lot peuvent être associées à chaque tiers, de sorte que la propriété `EDI.DestinationPartyId` ne fournit pas suffisamment d'informations pour déterminer la configuration de lot devant être utilisée.</span><span class="sxs-lookup"><span data-stu-id="b7c57-232">In [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], each party can have multiple batch configurations associated with it, so the `EDI.DestinationPartyId` does not provide enough information to determine which batch configuration should be used.</span></span>  <span data-ttu-id="b7c57-233">Lorsque [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] reçoit des messages, la propriété `EDI.BatchId` est utilisée pour identifier la configuration de lot spécifique à utiliser pour le traitement d'un message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-233">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives messages, the `EDI.BatchId` property is used to identify which specific batch configuration should be used when processing a message.</span></span>  
  
 <span data-ttu-id="b7c57-234">Après la mise à niveau vers [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], il se peut que des pipelines personnalisés utilisent toujours la propriété `EDI.DestinationPartyId` pour spécifier la configuration du tiers.</span><span class="sxs-lookup"><span data-stu-id="b7c57-234">After upgrading to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], you may still have custom pipelines that use the `EDI.DestinationPartyId` property to specify the party configuration.</span></span> <span data-ttu-id="b7c57-235">Si la propriété `EDI.ToBeBatched` d'un message reçu est définie sur la valeur True, et la propriété `EDI.DestinationPartyID` est définie au lieu de la propriété EDI.BatchID, l'orchestration UpgradeBatching tente de déterminer la configuration de lot devant être utilisée.</span><span class="sxs-lookup"><span data-stu-id="b7c57-235">When a message is received that has `EDI.ToBeBatched` set to true, and has `EDI.DestinationPartyID` set instead of EDI.BatchID, the UpgradeBatching orchestration attempts to determine which batch configuration should be used.</span></span>  
  
 <span data-ttu-id="b7c57-236">L'orchestration UpgradeBatching utilise les filtres suivants pour s'abonner aux documents marqués pour le traitement par lot, mais ne spécifie pas d'ID de lot :</span><span class="sxs-lookup"><span data-stu-id="b7c57-236">The UpgradeBatching orchestration uses the following subscription filters to subscribe to documents that are marked for batching, but do not specify a batch ID:</span></span>  
  
-   `EDI.ToBeBatched=True`  
  
-   <span data-ttu-id="b7c57-237">`EDI.EncodingType` existe ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-237">`EDI.EncodingType` exists</span></span>  
  
-   <span data-ttu-id="b7c57-238">`EDI.DestinationPartyId` existe ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-238">`EDI.DestinationPartyId` exists</span></span>  
  
 <span data-ttu-id="b7c57-239">Lorsque l'orchestration reçoit un message, elle recherche une configuration de lot correspondante pour le message à l'aide du nom du tiers et du type de codage.</span><span class="sxs-lookup"><span data-stu-id="b7c57-239">When the orchestration receives a message, it will try to find a matching batch configuration for the message by using the party name and encoding type.</span></span>  <span data-ttu-id="b7c57-240">Le `EDI.DestinationPartyID` propriété est utilisée pour déterminer le nom du tiers, et l’orchestration recherche ensuite un nom qui correspond à \<Nom_tiers\>+\<Type_codage\>+ par défaut.</span><span class="sxs-lookup"><span data-stu-id="b7c57-240">The `EDI.DestinationPartyID` property is used to determine the party name, and then the orchestration looks for a batch name that matches \<PartyName\>+\<EncodingType\>+Default.</span></span>  <span data-ttu-id="b7c57-241">Par exemple, si le nom du tiers est Contoso et la valeur de la propriété `EDI.EncodingType` est X12, l'orchestration recherche le lot ContosoX12Default.</span><span class="sxs-lookup"><span data-stu-id="b7c57-241">For example if the party name is Contoso, and the value of `EDI.EncodingType` is X12, then the orchestration will look for a batch named ContosoX12Default.</span></span>  
  
 <span data-ttu-id="b7c57-242">Si une configuration de lot correspondante est trouvée, le message est replacé dans la base de données MessageBox avec les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7c57-242">If a matching batch configuration is found, the message is placed back in the message box with the following properties:</span></span>  
  
-   `EDI.ToBeBatched = True`  
  
-   `EDI.ToBeRouted = False`  
  
-   <span data-ttu-id="b7c57-243">EDI.BatchId = ID du lot correspondant</span><span class="sxs-lookup"><span data-stu-id="b7c57-243">EDI.BatchId = the batch ID for the matching batch</span></span>  
  
 <span data-ttu-id="b7c57-244">L'orchestration de traitement par lot traite ensuite le message.</span><span class="sxs-lookup"><span data-stu-id="b7c57-244">The batching orchestration will then process the message</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b7c57-245">Si aucun lot correspondant n'est trouvé, les événements suivants surviennent :</span><span class="sxs-lookup"><span data-stu-id="b7c57-245">If no matching batch is found, then the following will happen:</span></span>  
>   
>  -   <span data-ttu-id="b7c57-246">Le message n'est pas envoyé à l'orchestration BatchSuspend.</span><span class="sxs-lookup"><span data-stu-id="b7c57-246">The message will not be sent to the BatchSuspend orchestration.</span></span>  
> -   <span data-ttu-id="b7c57-247">L'instance d'orchestration UpgradeBatching et le message sont suspendus.</span><span class="sxs-lookup"><span data-stu-id="b7c57-247">The UpgradeBatching orchestration instance and message will be suspended.</span></span>  
> -   <span data-ttu-id="b7c57-248">Une erreur indiquant qu'aucun lot n'a été trouvé est consignée dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="b7c57-248">An error will be logged to the event log stating that a batch was not found.</span></span>  
  
### <a name="batchsuspend-orchestration"></a><span data-ttu-id="b7c57-249">Orchestration BatchSuspend</span><span class="sxs-lookup"><span data-stu-id="b7c57-249">BatchSuspend Orchestration</span></span>  
 <span data-ttu-id="b7c57-250">L'orchestration BatchSuspend gère les messages non valides reçus par l'orchestration de traitement par lot.</span><span class="sxs-lookup"><span data-stu-id="b7c57-250">The BatchSuspend orchestration handles invalid messages received by the batching orchestration.</span></span> <span data-ttu-id="b7c57-251">Elle est requise car il n'y a aucun moyen direct de suspendre un message à partir d'une orchestration (en l'occurrence, l'orchestration de traitement par lot) sans interrompre l'exécution de l'instance de l'orchestration.</span><span class="sxs-lookup"><span data-stu-id="b7c57-251">The BatchSuspend orchestration is needed because there is no direct way to suspend a message from an orchestration (in this case, the batching orchestration) without stopping the execution of the instance of the orchestration.</span></span>  
  
 <span data-ttu-id="b7c57-252">Lorsqu'une instance de l'orchestration de traitement par lot reçoit un message, elle tente de le valider.</span><span class="sxs-lookup"><span data-stu-id="b7c57-252">When an instance of the batching orchestration receives a message, it attempts to validate it.</span></span> <span data-ttu-id="b7c57-253">Si cette opération échoue, l'orchestration de traitement par lot crée une instance de l'orchestration BatchSuspend et définit la propriété de contexte `EDI.BatchItemValidationFailure` sur la valeur True.</span><span class="sxs-lookup"><span data-stu-id="b7c57-253">If the message fails validation, the batching orchestration creates an instance of the BatchSuspend orchestration, and sets the `EDI.BatchItemValidationFailure` context property to True.</span></span> <span data-ttu-id="b7c57-254">L'orchestration BatchSuspend s'abonne à tous les messages pour lesquels cette propriété de contexte est définie sur la valeur True.</span><span class="sxs-lookup"><span data-stu-id="b7c57-254">The BatchSuspend orchestration subscribes to all messages with that context property set to True.</span></span> <span data-ttu-id="b7c57-255">Une fois le document informatisé acheminé à l'orchestration BatchSuspend, l'instance de l'orchestration BatchSuspend est suspendue.</span><span class="sxs-lookup"><span data-stu-id="b7c57-255">After the invalid transaction set is routed to the BatchSuspend orchestration, the BatchSuspend orchestration instance is suspended.</span></span>  
  
 <span data-ttu-id="b7c57-256">L'orchestration BatchSuspend fournit des informations détaillées sur la première erreur rencontrée.</span><span class="sxs-lookup"><span data-stu-id="b7c57-256">Detailed error information for the first error encountered is provided by the BatchSuspend orchestration.</span></span>  
  
 <span data-ttu-id="b7c57-257">Vous pouvez créer une orchestration personnalisée pour gérer les documents informatisés dont la validation par l'orchestration de traitement par lot échoue, en utilisant la propriété `EDI.BatchElementValidationFailure` dans un filtre.</span><span class="sxs-lookup"><span data-stu-id="b7c57-257">You can create a custom orchestration to handle transaction sets that fail validation by the batching orchestration, by using the `EDI.BatchElementValidationFailure` property in a filter.</span></span>  
  
### <a name="edi-send-pipeline"></a><span data-ttu-id="b7c57-258">Pipeline d'envoi EDI</span><span class="sxs-lookup"><span data-stu-id="b7c57-258">EDI Send Pipeline</span></span>  
 <span data-ttu-id="b7c57-259">Après avoir reçu un échange traité par lot de l'orchestration de traitement par lot, le pipeline d'envoi EDI effectue les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7c57-259">After receiving a batched interchange from the batching orchestration, the EDI send pipeline does the following:</span></span>  
  
-   <span data-ttu-id="b7c57-260">Pour un échange X12, il applique les propriétés suivantes à l'enveloppe :</span><span class="sxs-lookup"><span data-stu-id="b7c57-260">For an X12-encoded interchange, the send pipeline applies the following properties to the envelope:</span></span>  
  
    -   <span data-ttu-id="b7c57-261">ISA2 : informations d'autorisation ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-261">ISA2: Authorization Information</span></span>  
  
    -   <span data-ttu-id="b7c57-262">ISA4 : informations de sécurité ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-262">ISA4: Security Information</span></span>  
  
    -   <span data-ttu-id="b7c57-263">ISA9 : date de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-263">ISA9: Interchange Date</span></span>  
  
    -   <span data-ttu-id="b7c57-264">ISA10 : heure de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-264">ISA10: Interchange Time</span></span>  
  
    -   <span data-ttu-id="b7c57-265">ISA13 : numéro de contrôle de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-265">ISA13: Interchange Control Number</span></span>  
  
    -   <span data-ttu-id="b7c57-266">GS4 : date ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-266">GS4: Date</span></span>  
  
    -   <span data-ttu-id="b7c57-267">GS5 : heure ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-267">GS5: Time</span></span>  
  
    -   <span data-ttu-id="b7c57-268">GS6 : numéro de contrôle du groupe ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-268">GS6: Group Control Number</span></span>  
  
    -   <span data-ttu-id="b7c57-269">ST2 : numéro de contrôle du document informatisé.</span><span class="sxs-lookup"><span data-stu-id="b7c57-269">ST2: Transaction Set Control Number</span></span>  
  
-   <span data-ttu-id="b7c57-270">Pour un échange EDIFACT, il applique les propriétés suivantes à l'enveloppe :</span><span class="sxs-lookup"><span data-stu-id="b7c57-270">For an EDIFACT-encoded interchange, the send pipeline applies the following properties to the envelope:</span></span>  
  
    -   <span data-ttu-id="b7c57-271">UNB4.1 : date :</span><span class="sxs-lookup"><span data-stu-id="b7c57-271">UNB4.1: Date</span></span>  
  
    -   <span data-ttu-id="b7c57-272">UNB4.2 : heure ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-272">UNB4.2: Time</span></span>  
  
    -   <span data-ttu-id="b7c57-273">UNB5 : référence de contrôle de l'échange ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-273">UNB5: Interchange Control Reference</span></span>  
  
    -   <span data-ttu-id="b7c57-274">UNB6.1 : mot de passe du destinataire ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-274">UNB6.1: Recipient Reference Password</span></span>  
  
    -   <span data-ttu-id="b7c57-275">UNG4.1 : date ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-275">UNG4.1: Date</span></span>  
  
    -   <span data-ttu-id="b7c57-276">UNG4.2 : heure ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-276">UNG4.2: Time</span></span>  
  
    -   <span data-ttu-id="b7c57-277">UNG5 : référence de groupe fonctionnel ;</span><span class="sxs-lookup"><span data-stu-id="b7c57-277">UNG5: Functional Group Reference</span></span>  
  
    -   <span data-ttu-id="b7c57-278">UNG8 : mot de passe de l'application.</span><span class="sxs-lookup"><span data-stu-id="b7c57-278">UNG8: Application Password</span></span>  
  
-   <span data-ttu-id="b7c57-279">Il remet le message via l'adaptateur associé.</span><span class="sxs-lookup"><span data-stu-id="b7c57-279">Delivers the message via the associated adapter</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b7c57-280">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b7c57-280">See Also</span></span>  
 [<span data-ttu-id="b7c57-281">Traitement par lot des messages EDI sortants</span><span class="sxs-lookup"><span data-stu-id="b7c57-281">Batching Outgoing EDI Messages</span></span>](../core/batching-outgoing-edi-messages.md)