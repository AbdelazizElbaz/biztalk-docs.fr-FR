---
title: "Parties multiples de traitement des Messages avec l’adaptateur POP3 | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 56ad041f-f155-4c1c-ab87-1405c80d9b68
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 26aff4569414103ad8c4f37a9e4699a85874e481
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="processing-multi-part-messages-with-the-pop3-adapter"></a><span data-ttu-id="120fa-102">Traitement des messages à parties multiples avec l'adaptateur POP3</span><span class="sxs-lookup"><span data-stu-id="120fa-102">Processing Multi Part Messages with the POP3 Adapter</span></span>
<span data-ttu-id="120fa-103">L’adaptateur POP3 peut traiter des messages au format MIME qui sont conformes aux normes IETF expliquées dans [RFC 2045](http://go.microsoft.com/fwlink/?LinkId=58810), [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=58811), et [RFC 2047](http://go.microsoft.com/fwlink/?LinkId=58812).</span><span class="sxs-lookup"><span data-stu-id="120fa-103">The POP3 Adapter can process MIME-encoded messages that conform to the IETF standards documented in [RFC 2045](http://go.microsoft.com/fwlink/?LinkId=58810), [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=58811), and [RFC 2047](http://go.microsoft.com/fwlink/?LinkId=58812).</span></span> <span data-ttu-id="120fa-104">Les messages MIME peuvent être constitués d'une ou de plusieurs parties, avec différents types de contenus.</span><span class="sxs-lookup"><span data-stu-id="120fa-104">MIME encoded messages can have from one to many parts with different content types.</span></span> <span data-ttu-id="120fa-105">Cette rubrique décrit la manière dont l'adaptateur POP3 traite les messages MIME à parties multiples.</span><span class="sxs-lookup"><span data-stu-id="120fa-105">This topic discusses the how the POP3 adapter processes multi part MIME encoded messages.</span></span>  
  
## <a name="receiving-multi-part-messages-with-the-pop3-adapter"></a><span data-ttu-id="120fa-106">Réception de messages à parties multiples avec l'adaptateur POP3</span><span class="sxs-lookup"><span data-stu-id="120fa-106">Receiving Multi part Messages with the POP3 Adapter</span></span>  
 <span data-ttu-id="120fa-107">Si un emplacement de réception qui utilise l’adaptateur POP3 a le **appliquer le décodage MIME** option définie sur **True** ensuite l’adaptateur POP3 effectue les actions suivantes lors de la réception d’un message codé au format MIME :</span><span class="sxs-lookup"><span data-stu-id="120fa-107">If a receive location that uses the POP3 adapter has the **Apply MIME Decoding** option set to **True** then the POP3 adapter performs the following actions when receiving a MIME-encoded message:</span></span>  
  
1.  <span data-ttu-id="120fa-108">Crée un message BizTalk à parties multiples à partir des parties du message MIME reçu.</span><span class="sxs-lookup"><span data-stu-id="120fa-108">Creates a multi part BizTalk message from the parts of the MIME encoded message that it receives.</span></span> <span data-ttu-id="120fa-109">Le message à parties multiples peut contenir d'une à plusieurs parties et contient le même nombre de parties que le message MIME reçu.</span><span class="sxs-lookup"><span data-stu-id="120fa-109">This multi part message can contain from 1 to many parts and will contain the same number of parts as the MIME encoded message that is received.</span></span>  
  
2.  <span data-ttu-id="120fa-110">Analyse les en-têtes du message MIME.</span><span class="sxs-lookup"><span data-stu-id="120fa-110">Scans the headers of the MIME encoded message.</span></span> <span data-ttu-id="120fa-111">Si des en-têtes correspondent à la liste des propriétés décrites dans la rubrique [propriétés et schéma de propriété de l’adaptateur POP3](../core/pop3-adapter-property-schema-and-properties.md) ensuite ces en-têtes sont promues pour le message à parties multiples BizTalk en tant que propriétés de contexte.</span><span class="sxs-lookup"><span data-stu-id="120fa-111">If any headers match the list of properties documented in the topic [POP3 Adapter Property Schema and Properties](../core/pop3-adapter-property-schema-and-properties.md) then these headers are promoted to the multi part BizTalk message as context properties.</span></span>  
  
3.  <span data-ttu-id="120fa-112">Utilise un algorithme configurable pour désigner l'une des parties du message MIME en tant que corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-112">Uses a configurable algorithm to designate one of the parts of the MIME encoded message as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-113">L’algorithme utilisé pour déterminer la partie du message qui sera le corps du message BizTalk est décrit ci-dessous dans la section **corps partie sélection algorithme utilisé par l’adaptateur POP3**.</span><span class="sxs-lookup"><span data-stu-id="120fa-113">The algorithm used to determine which message part will be the BizTalk message body part is described below in the section **Body Part Selection Algorithm Used by the POP3 Adapter**.</span></span>  
  
4.  <span data-ttu-id="120fa-114">Publie le message BizTalk à parties multiples dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="120fa-114">Publishes the multi part BizTalk message to the MessageBox.</span></span>  
  
## <a name="body-part-selection-algorithm-used-by-the-pop3-adapter"></a><span data-ttu-id="120fa-115">Algorithme de sélection du corps utilisé par l'adaptateur POP3</span><span class="sxs-lookup"><span data-stu-id="120fa-115">Body Part Selection Algorithm Used by the POP3 Adapter</span></span>  
 <span data-ttu-id="120fa-116">Lorsque l'adaptateur POP3 crée un message BizTalk à parties multiples à partir des parties du message MIME reçu, il sélectionne l'une des parties du message comme corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-116">When the POP3 adapter creates a multipart BizTalk message from the parts of the MIME-encoded message that it receives, it selects one of the message parts as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-117">Le corps du message BizTalk est utilisé par BizTalk Server notamment pour la validation du message, le mappage, la promotion de propriétés, l'assembly de fichier plat et d'autres opérations.</span><span class="sxs-lookup"><span data-stu-id="120fa-117">The BizTalk message body part is used by BizTalk Server for things such as message validation, mapping, property promotion, flat file assembly and other operations.</span></span> <span data-ttu-id="120fa-118">Les abonnés à un message BizTalk à parties multiples reçoivent toutes les parties du message mais n'utilisent que le corps désigné du message BizTalk, sauf utilisation d'une orchestration, d'un pipeline personnalisé ou d'un adaptateur qui peut comprendre les messages à parties multiples.</span><span class="sxs-lookup"><span data-stu-id="120fa-118">Subscribers to a multi part BizTalk message receive all of the message parts but will only consume the designated BizTalk message body part unless using an orchestration, a custom pipeline, or an adapter that can understand multi part messages.</span></span> <span data-ttu-id="120fa-119">Par exemple, vous pouvez configurer une orchestration pour lire toutes les parties d'un message à parties multiples. L'adaptateur SMTP peut lire toutes les parties d'un message à parties multiples et un pipeline personnalisé peut être configuré pour utiliser le composant de pipeline Encodeur MIME/SMIME.</span><span class="sxs-lookup"><span data-stu-id="120fa-119">For example, you can configure an orchestration to read all parts of multi part message; the SMTP adapter can read all of the parts of a multi part message, and a custom pipeline can be configured to use the MIME/SMIME encoder pipeline component.</span></span> <span data-ttu-id="120fa-120">Pour plus d’informations sur l’utilisation d’une orchestration pour consommer un message à parties multiples, consultez la section ci-dessous, **traitement des Messages à parties multiples dans les Orchestrations**.</span><span class="sxs-lookup"><span data-stu-id="120fa-120">For more information about using an orchestration to consume a multi part message see the section below, **Processing Multi Part Messages in Orchestrations**.</span></span>  
  
 <span data-ttu-id="120fa-121">L’adaptateur POP3 sélectionne le corps du message BizTalk à partir des parties de corps disponibles en fonction des valeurs fournies pour le **Index du corps** et **Type de contenu du corps**.</span><span class="sxs-lookup"><span data-stu-id="120fa-121">The POP3 adapter selects the BizTalk message body part from the available body parts based upon the values supplied for the **Body Part Index** and the **Body Part Content Type**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="120fa-122">L’adaptateur POP3 est conçu pour reconnaître les Types de contenu de partie de corps qui sont définies dans [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=119569).</span><span class="sxs-lookup"><span data-stu-id="120fa-122">The POP3 adapter is designed to recognize the Body Part Content Types that are defined in [RFC 2046](http://go.microsoft.com/fwlink/?LinkId=119569).</span></span>  
  
 <span data-ttu-id="120fa-123">L'algorithme utilisé pour sélectionner le corps du message BizTalk d'un courrier électronique est décrit ci-après :</span><span class="sxs-lookup"><span data-stu-id="120fa-123">The algorithm that is used to select the BizTalk message body part of an e-mail is described below:</span></span>  
  
1.  <span data-ttu-id="120fa-124">Si le **Index du corps** est définie sur 0 et **Type de contenu du corps** est vierge, l’algorithme suivant est utilisé pour sélectionner le corps du message BizTalk :</span><span class="sxs-lookup"><span data-stu-id="120fa-124">If the **Body Part Index** is set to 0 and the **Body Part Content Type** is blank then the following algorithm is used to select the BizTalk message body part:</span></span>  
  
    -   <span data-ttu-id="120fa-125">Utilisez la première partie MIME avec l'en-tête Content-Description défini sur « body ».</span><span class="sxs-lookup"><span data-stu-id="120fa-125">Use the first MIME part with the Content-Description header set to "body".</span></span>  
  
    -   <span data-ttu-id="120fa-126">Sinon, utilisez la première partie MIME avec l'en-tête Content-Type défini sur « text/xml ».</span><span class="sxs-lookup"><span data-stu-id="120fa-126">Otherwise use the first MIME part with the Content-Type header set to "text/xml".</span></span>  
  
    -   <span data-ttu-id="120fa-127">Sinon, utilisez la première partie MIME avec l'en-tête Content-Type défini sur « text/plain ».</span><span class="sxs-lookup"><span data-stu-id="120fa-127">Otherwise use the first MIME part with the Content-Type header set to "text/plain".</span></span>  
  
    -   <span data-ttu-id="120fa-128">Sinon, utilisez la première partie MIME avec l'en-tête Content-Type défini sur « text/ ».</span><span class="sxs-lookup"><span data-stu-id="120fa-128">Otherwise use the first MIME part with the Content-Type header set to "text/".</span></span>  
  
    -   <span data-ttu-id="120fa-129">Sinon, utilisez la première partie MIME.</span><span class="sxs-lookup"><span data-stu-id="120fa-129">Otherwise use the first MIME part.</span></span>  
  
2.  <span data-ttu-id="120fa-130">Sinon si le **Index du corps** est définie sur 0 et **Type de contenu du corps** est défini, alors que la première partie du corps du message entrant qui correspond à l’élément spécifié **Type du corps contenu** est sélectionné comme corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-130">Otherwise if the **Body Part Index** is set to 0 and the **Body Part Content Type** is set, then the first body part of the incoming message that matches the specified **Body Part Content Type** is selected as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-131">Si aucune partie ne correspond au type de contenu, le message est interrompu.</span><span class="sxs-lookup"><span data-stu-id="120fa-131">If there are no parts with a matching content type then the message is suspended.</span></span>  
  
3.  <span data-ttu-id="120fa-132">Sinon si le **Index du corps** est défini sur une valeur supérieure à 0 et la **Type de contenu du corps** est vide, puis dans le corps avec l’index spécifié est sélectionné comme corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-132">Otherwise if the **Body Part Index** is set to a value greater than 0 and the **Body Part Content Type** is blank, then the body part with the specified index is selected as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-133">Si l'index spécifié est supérieur au nombre de corps, le message est interrompu.</span><span class="sxs-lookup"><span data-stu-id="120fa-133">If the specified index is greater than the number of body parts then the message is suspended.</span></span>  
  
4.  <span data-ttu-id="120fa-134">Sinon si le **Index du corps** est défini sur une valeur supérieure à 0 et la **Type de contenu du corps** est défini, le **Index du corps** ne s’applique qu’aux corps des composants qui correspondent à la chaîne **Type de contenu du corps** et le corps correspondant est sélectionné comme corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-134">Otherwise if the **Body Part Index** is set to a value greater than 0 and the **Body Part Content Type** is set, then the **Body Part Index** is only applied to those body parts that match the specified **Body Part Content Type** and the corresponding body part is selected as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-135">Si l'index spécifié est supérieur au nombre de corps avec un type de contenu correspondant, le message est interrompu.</span><span class="sxs-lookup"><span data-stu-id="120fa-135">If the specified index is greater than the number of parts with a matching content type then the message is suspended.</span></span> <span data-ttu-id="120fa-136">Si aucune partie ne correspond au type de contenu, le message est interrompu.</span><span class="sxs-lookup"><span data-stu-id="120fa-136">If there are no parts with a matching content type then the message is suspended.</span></span>  
  
5.  <span data-ttu-id="120fa-137">La partie sélectionnée comme corps du message BizTalk devient la première partie du message BizTalk à parties multiples publié dans la base de données MessageBox, tandis que les parties restantes du message gardent l'ordre qu'ils avaient dans le message MIME d'origine.</span><span class="sxs-lookup"><span data-stu-id="120fa-137">The part that is selected as the BizTalk message body part becomes the first part of the multi part BizTalk message that is published to the MessageBox, the remaining parts of the message maintain the order that they had in the original MIME encoded message.</span></span>  
  
## <a name="processing-multi-part-messages-in-orchestrations"></a><span data-ttu-id="120fa-138">Traitement de messages à parties multiples dans des orchestrations</span><span class="sxs-lookup"><span data-stu-id="120fa-138">Processing Multi Part Messages in Orchestrations</span></span>  
 <span data-ttu-id="120fa-139">Lorsque l'adaptateur POP3 crée un message BizTalk à parties multiples à partir d'un message MIME reçu, toutes les parties sont publiées dans la base de données MessageBox même si une seule partie est désignée comme corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="120fa-139">When the POP3 adapter creates a multi part BizTalk message from a MIME encoded message that it receives, all of the parts are published to the MessageBox database even though only one of the parts is designated as the BizTalk message body part.</span></span> <span data-ttu-id="120fa-140">Ces parties peuvent être ensuite utilisées par une orchestration abonnée au message à parties multiples.</span><span class="sxs-lookup"><span data-stu-id="120fa-140">These parts can be subsequently consumed by an orchestration that subscribes to the multi part message.</span></span> <span data-ttu-id="120fa-141">Cette section décrit certaines considérations lors du traitement de messages à parties multiples dans une orchestration.</span><span class="sxs-lookup"><span data-stu-id="120fa-141">This section documents some considerations when processing multi part messages in an orchestration.</span></span>  
  
### <a name="processing-multi-part-messages-with-a-known-number-of-parts-and-known-part-types"></a><span data-ttu-id="120fa-142">Traitement de messages à parties multiples avec un nombre connu de parties et des types de parties connus</span><span class="sxs-lookup"><span data-stu-id="120fa-142">Processing multi part messages with a known number of parts and known part types</span></span>  
 <span data-ttu-id="120fa-143">Si votre orchestration reçoit un message à parties multiples avec un nombre connu de parties et des types de parties connus, vous pouvez déclarer un message à parties multiples dans l'orchestration et définir le nombre de parties et les types de parties au moment de la conception.</span><span class="sxs-lookup"><span data-stu-id="120fa-143">If your orchestration is receiving a multi part message with a known number of parts and known part types then you can declare a multi part message in the orchestration and set the number of parts and part types at design time.</span></span>  
  
### <a name="processing-multi-part-messages-with-unknown-part-types"></a><span data-ttu-id="120fa-144">Traitement de messages à parties multiples avec des types de parties inconnus</span><span class="sxs-lookup"><span data-stu-id="120fa-144">Processing multi part messages with unknown part types</span></span>  
 <span data-ttu-id="120fa-145">Si votre orchestration reçoit un message à parties multiples avec des types de parties inconnus, vous pouvez déclarer un message à parties multiples dans l’orchestration et utiliser le **XmlDocument** type pour chacune des parties pour laquelle le type est inconnu.</span><span class="sxs-lookup"><span data-stu-id="120fa-145">If your orchestration is receiving a multi part message with unknown part types then you can declare a multi part message in the orchestration and use the **XmlDocument** type for each of the parts for which the type is unknown.</span></span>  
  
### <a name="processing-multi-part-messages-with-an-unknown-number-of-parts-and-all-of-the-part-types-are-unknown"></a><span data-ttu-id="120fa-146">Traitement de messages à parties multiples avec un nombre inconnu de parties et tous les types de parties inconnus</span><span class="sxs-lookup"><span data-stu-id="120fa-146">Processing multi part messages with an unknown number of parts and all of the part types are unknown</span></span>  
 <span data-ttu-id="120fa-147">Si votre orchestration reçoit un message à parties multiples avec un nombre inconnu de parties, que vous pouvez déclarer un message à parties multiples avec une seule partie de la **XmlDocument** type dans l’orchestration pour recevoir le message.</span><span class="sxs-lookup"><span data-stu-id="120fa-147">If your orchestration is receiving a multi part message with an unknown number of parts then you can declare a multi part message with a single part of the **XmlDocument** type in the orchestration to receive the message.</span></span> <span data-ttu-id="120fa-148">Si un message à parties multiples contenant supérieur au nombre de parties déclarés est reçu, les lectures du moteur d’orchestration combien dénombre les parties contenues dans le message, construit ensuite les types de parties propres pour les parties qui correspondant au nombre de parties du message déclaré type et constructions **XmlDocument** parties pour les parties restantes.</span><span class="sxs-lookup"><span data-stu-id="120fa-148">If a multi part message that contains greater than the number of declared parts is received, the orchestration engine reads how many parts there are in the message, then constructs the proper part types for the parts that match the number of parts in the declared message type and then constructs **XmlDocument** parts for the remaining parts.</span></span>