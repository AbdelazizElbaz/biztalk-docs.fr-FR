---
title: "Problèmes connus avec la sécurité AS2 | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b291e000-630d-49a1-8e19-f76c4dfee294
caps.latest.revision: "10"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1bb633e092ed568bb3817df7be788364934be446
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="known-issues-with-as2-security"></a><span data-ttu-id="0cf58-102">Problèmes connus avec la sécurité AS2</span><span class="sxs-lookup"><span data-stu-id="0cf58-102">Known Issues with AS2 Security</span></span>
<span data-ttu-id="0cf58-103">Cette rubrique décrit les problèmes connus de sécurité en relation avec les solutions de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] AS2.</span><span class="sxs-lookup"><span data-stu-id="0cf58-103">This topic describes known issues with the security of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] AS2 solutions.</span></span>  
  
## <a name="the-as2-decoder-will-not-validate-that-a-certificate-is-configured-on-the-host-or-for-the-destination-party"></a><span data-ttu-id="0cf58-104">Le décodeur AS2 ne valide pas le fait qu'un certificat soit configuré sur l'hôte ou pour le tiers de destination</span><span class="sxs-lookup"><span data-stu-id="0cf58-104">The AS2 Decoder Will Not Validate that a Certificate Is Configured on the Host or for the Destination Party</span></span>  
 <span data-ttu-id="0cf58-105">Le décodeur AS2 déchiffre un message à condition que le certificat privé relatif à ce dernier soit configuré dans le magasin de certificats.</span><span class="sxs-lookup"><span data-stu-id="0cf58-105">The AS2 decoder will decrypt a message as long as the private certificate for that message is configured in the certificate store.</span></span> <span data-ttu-id="0cf58-106">En revanche, le décodeur AS2 ne valide pas le fait que le certificat de déchiffrement soit identique au certificat configuré sur l'hôte.</span><span class="sxs-lookup"><span data-stu-id="0cf58-106">However, the AS2 decoder will not validate that the decryption certificate is the same as the certificate configured on the host.</span></span> <span data-ttu-id="0cf58-107">Le message reçu peut être chiffré avec plusieurs certificats.</span><span class="sxs-lookup"><span data-stu-id="0cf58-107">The received message can be encrypted with more than one certificate.</span></span>  
  
## <a name="storing-as2-messages-in-wire-format-can-lead-to-a-security-issue"></a><span data-ttu-id="0cf58-108">Le stockage des messages AS2 au format câble peut provoquer un problème de sécurité</span><span class="sxs-lookup"><span data-stu-id="0cf58-108">Storing AS2 Messages in Wire Format Can Lead to a Security Issue</span></span>  
 <span data-ttu-id="0cf58-109">Dans les cas où les certificats ne sont pas utilisés, il n'est pas recommandé de stocker les messages AS2 au format câble dans la base de données de réception de non-répudiation (NRR),</span><span class="sxs-lookup"><span data-stu-id="0cf58-109">When certificates are not used, storing AS2 messages in wire format in the non-repudiation receipt (NRR) database is not recommended.</span></span> <span data-ttu-id="0cf58-110">sous peine d'affecter la sécurité.</span><span class="sxs-lookup"><span data-stu-id="0cf58-110">Doing so could lead to a security issue.</span></span>  
  
## <a name="messages-or-mdns-to-be-stored-in-the-nrr-database-should-be-signed"></a><span data-ttu-id="0cf58-111">Les messages ou MDN à stocker dans la base de données de réception de non-répudiation (NRR) doivent être signés</span><span class="sxs-lookup"><span data-stu-id="0cf58-111">Messages or MDNs To Be Stored in the NRR Database Should Be Signed</span></span>  
 <span data-ttu-id="0cf58-112">Pour garantir la non-répudiation de réception, vous devez établir l'authentification et l'intégrité des messages.</span><span class="sxs-lookup"><span data-stu-id="0cf58-112">To guarantee non-repudiation of receipt, you must establish the authentication and integrity of the applicable message.</span></span> <span data-ttu-id="0cf58-113">La méthode recommandée pour cela consiste à utiliser une signature numérique sur le message.</span><span class="sxs-lookup"><span data-stu-id="0cf58-113">The recommended way of doing so is by using a digital signature on the message.</span></span> <span data-ttu-id="0cf58-114">Par conséquent, si vous configurez les propriétés de tiers AS2 pour stocker des messages ou des MDN dans la base de données de non-répudiation, vous devez configurer les propriétés AS2 de façon à signer les messages ou MDN que vous comptez stocker.</span><span class="sxs-lookup"><span data-stu-id="0cf58-114">As a result, if you configure AS2 party properties to store messages or MDNs in the non-repudiation database, you should configure the AS2 properties to sign the messages or MDNs that you are going to store.</span></span>  
  
## <a name="biztalk-server-will-be-unable-to-decrypt-a-message-saved-in-wire-format-if-the-certificate-is-not-valid"></a><span data-ttu-id="0cf58-115">BizTalk Server ne peut pas déchiffrer un message enregistré au format câble si le certificat n'est pas valide</span><span class="sxs-lookup"><span data-stu-id="0cf58-115">BizTalk Server Will Be Unable to Decrypt a Message Saved in Wire Format If the Certificate Is Not Valid</span></span>  
 <span data-ttu-id="0cf58-116">**Symptôme**</span><span class="sxs-lookup"><span data-stu-id="0cf58-116">**Symptom**</span></span>  
  
 <span data-ttu-id="0cf58-117">BizTalk Server ne peut pas déchiffrer un message AS2 entrant enregistré au format câble dans la base de données de non-répudiation.</span><span class="sxs-lookup"><span data-stu-id="0cf58-117">BizTalk Server is unable to decrypt an inbound AS2 message that was saved in wire format in the non-repudiation database.</span></span>  
  
 <span data-ttu-id="0cf58-118">**Cause possible**</span><span class="sxs-lookup"><span data-stu-id="0cf58-118">**Possible Cause**</span></span>  
  
 <span data-ttu-id="0cf58-119">Le certificat requis pour déchiffrer le message a expiré ou été révoqué.</span><span class="sxs-lookup"><span data-stu-id="0cf58-119">The certificate required to decrypt the message has expired or been revoked.</span></span> <span data-ttu-id="0cf58-120">La probabilité que cela se produise est supérieure si une certaine période s'est écoulée depuis l'enregistrement du message AS2 dans la base de données de non-répudiation.</span><span class="sxs-lookup"><span data-stu-id="0cf58-120">This is more likely to occur if a certain period of time has elapsed since the AS2 message was saved in the non-repudiation database.</span></span> <span data-ttu-id="0cf58-121">Si cela ce produit, il se peut que vous n'ayez pas d'accès immédiat à un certificat valide pour le message.</span><span class="sxs-lookup"><span data-stu-id="0cf58-121">If this occurs, you may not have immediate access to a valid certificate for the message.</span></span>  
  
 <span data-ttu-id="0cf58-122">**Résolution**</span><span class="sxs-lookup"><span data-stu-id="0cf58-122">**Resolution**</span></span>  
  
 <span data-ttu-id="0cf58-123">Acquérir un certificat valide pour le déchiffrement du message.</span><span class="sxs-lookup"><span data-stu-id="0cf58-123">Acquire a valid certificate for decrypting the message.</span></span>  
  
## <a name="the-inner-envelope-of-a-signed-as2-message-must-not-be-changed-after-the-signature-has-been-calculated"></a><span data-ttu-id="0cf58-124">L'enveloppe interne d'un message AS2 signé ne doit pas être modifiée une fois la signature calculée</span><span class="sxs-lookup"><span data-stu-id="0cf58-124">The inner envelope of a signed AS2 message must not be changed after the signature has been calculated</span></span>  
 <span data-ttu-id="0cf58-125">Une fois un message AS2 signé, la signature est calculée sur la base des en-têtes et de la charge de l'enveloppe interne.</span><span class="sxs-lookup"><span data-stu-id="0cf58-125">When an AS2 message is signed, the signature is calculated based on the inner envelope headers and payload.</span></span> <span data-ttu-id="0cf58-126">En cas de modification de l'enveloppe interne après le calcul de la signature, la signature est endommagée.</span><span class="sxs-lookup"><span data-stu-id="0cf58-126">If the inner envelope is changed after the signature is calculated, the signature will be corrupted.</span></span> <span data-ttu-id="0cf58-127">Vous pouvez modifier les en-têtes de limite ou tout ce qui est situé à l'extérieur de ces derniers, mais pas leur contenu.</span><span class="sxs-lookup"><span data-stu-id="0cf58-127">The boundary headers, or anything outside the boundary headers, can be changed, but anything within the boundary headers must not be changed.</span></span>  
  
## <a name="use-the-same-logon-for-the-in-process-host-instance-and-the-isolated-host-instance-to-ensure-that-personal-store-is-recognized"></a><span data-ttu-id="0cf58-128">Utilisez le même nom de connexion pour l'instance de l'hôte In-process et l'instance de l'hôte isolé pour vous assurer que le magasin Personnel est reconnu</span><span class="sxs-lookup"><span data-stu-id="0cf58-128">Use the same logon for the in-process host instance and the isolated host instance to ensure that Personal store is recognized</span></span>  
 <span data-ttu-id="0cf58-129">Le magasin de certificats Personnels sera disponible pour le traitement des messages uniquement si le profil utilisateur est chargé pour l'utilisateur dont les informations d'identification sont associées à l'instance hôte.</span><span class="sxs-lookup"><span data-stu-id="0cf58-129">The Personal certificate store will be available for message processing only if the user profile is loaded for the user whose logon credentials are associated with the host instance.</span></span> <span data-ttu-id="0cf58-130">Le magasin Personnel est utilisé pour les certificats de signature et de déchiffrement (la clé propre privée de l'utilisateur).</span><span class="sxs-lookup"><span data-stu-id="0cf58-130">The Personal store is used for signing and decryption certificates (the user's own private key).</span></span> <span data-ttu-id="0cf58-131">Le profil utilisateur est chargé par défaut pour l'instance hôte In-process ; toutefois, il n'est pas chargé par défaut pour l'instance hôte isolé.</span><span class="sxs-lookup"><span data-stu-id="0cf58-131">The user profile is loaded by default for the in-process host instance; however, the user profile is not loaded by default for the isolated host instance.</span></span> <span data-ttu-id="0cf58-132">Vous pouvez faire en sorte qu'une application charge le profil utilisateur pour l'hôte isolé. </span><span class="sxs-lookup"><span data-stu-id="0cf58-132">You can have an application load the user profile for the isolated host.</span></span> <span data-ttu-id="0cf58-133">Vous pouvez également contourner ce problème en utilisant le même nom de connexion pour l'instance hôte In-process et l'instance hôte isolé.</span><span class="sxs-lookup"><span data-stu-id="0cf58-133">Alternatively, you can work around this issue by using the same logon for the in-process host instance and the isolated host instance.</span></span>  
  
 <span data-ttu-id="0cf58-134">Plutôt que de faire charger le profil utilisateur par une application, vous pouvez créer un service vide pour charger le profil.</span><span class="sxs-lookup"><span data-stu-id="0cf58-134">Instead of having an application load the user profile, you can create an empty service to load the profile.</span></span> <span data-ttu-id="0cf58-135">Pour plus d’informations sur la création d’un service vide, consultez [Comment : créer des Services Windows](http://go.microsoft.com/fwlink/?LinkId=196492).</span><span class="sxs-lookup"><span data-stu-id="0cf58-135">For information about creating an empty service, see [How to: Create Windows Services](http://go.microsoft.com/fwlink/?LinkId=196492).</span></span> <span data-ttu-id="0cf58-136">Après avoir créé le service, ouvrez la boîte de dialogue Gestion de l’ordinateur, ouvrez la boîte de dialogue Propriétés pour le service, cliquez sur le **session** onglet, sélectionnez **ce compte**, entrez le nom d’ouverture de session utilisé pour le isolé d’instance d’hôte, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="0cf58-136">After you have created the service, open the Computer Management dialog box, open the Properties dialog box for the service, click the **Log On** tab, select **This Account**, enter the logon name used for the isolated host instance, and then click **OK**.</span></span> <span data-ttu-id="0cf58-137">Vous pouvez démarrer manuellement le serveur pour charger le profil utilisateur de cet utilisateur de connexion.</span><span class="sxs-lookup"><span data-stu-id="0cf58-137">You can then manually start the service to load the user profile for that logon user.</span></span>  
  
## <a name="the-key-usage-attribute-of-a-certificate-must-match-the-certificates-use"></a><span data-ttu-id="0cf58-138">L'attribut Utilisation de la clé d'un certificat doit correspondre à l'utilisation du certificat</span><span class="sxs-lookup"><span data-stu-id="0cf58-138">The Key Usage attribute of a certificate must match the certificate's use</span></span>  
 <span data-ttu-id="0cf58-139">Les certificats utilisés pour le transport AS2 doivent avoir les attributs requis pour l'utilisation prévue.</span><span class="sxs-lookup"><span data-stu-id="0cf58-139">Certificates used for AS2 transport must have the attributes required for their intended use.</span></span> <span data-ttu-id="0cf58-140">Pour la signature et la vérification de signature, l'attribut Utilisation de la clé du certificat doit être défini sur Signature numérique.</span><span class="sxs-lookup"><span data-stu-id="0cf58-140">For signing and signature verification, the Key Usage attribute of the certificate must be Digital Signature.</span></span> <span data-ttu-id="0cf58-141">Pour le chiffrement et le déchiffrement, l'attribut Utilisation de la clé du certificat doit être défini sur Chiffrement des données ou Chiffrement de clés.</span><span class="sxs-lookup"><span data-stu-id="0cf58-141">For encryption and decryption, the Key Usage attribute of the certificate must be Data Encipherment or Key Encipherment.</span></span> <span data-ttu-id="0cf58-142">Vous pouvez vérifier l'attribut Utilisation de la clé en double-cliquant sur le certificat, puis en cliquant sur l'onglet Détails de la boîte de dialogue Certificat et en vérifiant le champ Utilisation de la clé.</span><span class="sxs-lookup"><span data-stu-id="0cf58-142">You can verify the Key Usage attribute by double-clicking the certificate, clicking the Details tab in the Certificate dialog box, and checking the Key Usage field.</span></span>  
  
## <a name="the-certificate-resolution-list-will-be-verified-for-an-outgoing-mdn-if-the-as2-to-property-is-not-set-for-the-party"></a><span data-ttu-id="0cf58-143">La liste de résolution des certificats est vérifiée pour un MDN sortant si la propriété AS2-To n'est pas définie pour le tiers</span><span class="sxs-lookup"><span data-stu-id="0cf58-143">The certificate resolution list will be verified for an outgoing MDN if the AS2-To property is not set for the party</span></span>  
 <span data-ttu-id="0cf58-144">Dans l'accord par défaut pour un MDN sortant, la vérification de la liste de résolution des certificats est effectuée.</span><span class="sxs-lookup"><span data-stu-id="0cf58-144">In the default agreement for an outgoing MDN, the certificate resolution list verification is performed.</span></span> <span data-ttu-id="0cf58-145">Si vous ne voulez pas que cette vérification ait lieu, vérifiez que la propriété AS2-To correcte est définie, de façon à ce que le tiers qui reçoit puisse être résolu et les propriétés du tiers déterminées.</span><span class="sxs-lookup"><span data-stu-id="0cf58-145">If you do not want this verification to be performed, verify that the correct AS2-To party property is set, so the receiving party can be resolved and the party properties can be determined.</span></span> <span data-ttu-id="0cf58-146">Si c'est le cas, l'accord par défaut qui invite à vérifier la liste de résolution des certificats n'est pas utilisé.</span><span class="sxs-lookup"><span data-stu-id="0cf58-146">If so, the default agreement that prompts verification of the certificate resolution list will not be used.</span></span> <span data-ttu-id="0cf58-147">Vous devez également désactiver la propriété Vérifier la liste de révocation des certificats de la page Général des propriétés de tiers AS2.</span><span class="sxs-lookup"><span data-stu-id="0cf58-147">You will also need to disable the Check Certification Revocation List property on the General page of the AS2 party properties.</span></span>