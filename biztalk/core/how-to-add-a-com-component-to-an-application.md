---
title: "Comment ajouter un composant COM à une Application | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- managing [applications], COM components
- managing [resources], COM components
- applications, COM components
- COM components, applications
ms.assetid: fdda1a9d-96af-41fe-9d94-ee1fbd80a7c9
caps.latest.revision: "13"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cc2fe522d024059ce672124d48e458c869de9406
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/01/2017
---
# <a name="how-to-add-a-com-component-to-an-application"></a><span data-ttu-id="46661-102">Ajout d'un composant COM à une application</span><span class="sxs-lookup"><span data-stu-id="46661-102">How to Add a COM Component to an Application</span></span>
<span data-ttu-id="46661-103">Cette rubrique décrit comment ajouter un composant COM à une application BizTalk à l'aide de la console Administration de BizTalk Server ou de l'invite de commandes :</span><span class="sxs-lookup"><span data-stu-id="46661-103">This topic describes how to use the BizTalk Server Administration console or the command line to add a COM component to a BizTalk application:</span></span>  
  
 <span data-ttu-id="46661-104">Lorsque vous ajoutez un composant COM à une application, gardez les points importants suivants à l'esprit :</span><span class="sxs-lookup"><span data-stu-id="46661-104">When adding a COM component to an application, bear in mind the following important points:</span></span>  
  
-   <span data-ttu-id="46661-105">Si vous souhaitez remplacer un composant COM existant déjà dans l'application, précisez l'option de remplacement.</span><span class="sxs-lookup"><span data-stu-id="46661-105">If you want to overwrite a COM component that already exists in the application, specify the Overwrite option.</span></span> <span data-ttu-id="46661-106">L’option permettant d'écraser n’est nécessaire que lorsque les deux artefacts sont dotés du même identificateur local unique (LUID).</span><span class="sxs-lookup"><span data-stu-id="46661-106">The overwrite option is required only when both artifacts have the same locally unique identifier (LUID).</span></span> <span data-ttu-id="46661-107">Si cette option n'est pas spécifiée, et qu'un composant COM ayant le même LUID que celui en cours d'ajout existe déjà dans l'application, l'opération d'ajout échoue.</span><span class="sxs-lookup"><span data-stu-id="46661-107">If not specified, and a COM component already exists in the application with the same LUID as the one being added, the add operation will fail.</span></span> <span data-ttu-id="46661-108">Vous pouvez afficher la liste des LUID pour les artefacts dans une application à l’aide de la [commande ListApp](../core/listapp-command.md).</span><span class="sxs-lookup"><span data-stu-id="46661-108">You can view the LUIDs for the artifacts in an application by using the [ListApp Command](../core/listapp-command.md).</span></span>  
  
-   <span data-ttu-id="46661-109">BizTalk Server ne vérifie pas la présence des dépendances des composants COM, c’est pourquoi vous devez vérifiez que tous les artefacts dont dépend le composant sont présents.</span><span class="sxs-lookup"><span data-stu-id="46661-109">BizTalk Server does not check the dependencies for COM components to verify that they are present, so you should verify that any artifacts on which the component depends are present.</span></span>  
  
-   <span data-ttu-id="46661-110">Si vous ajoutez un composant COM ou COM+ non managé pour ordinateur 64 bits et essayez d'installer l'application comprenant ledit composant sur un ordinateur 32 bits, vous n'y parviendrez pas.</span><span class="sxs-lookup"><span data-stu-id="46661-110">If you add a 64-bit unmanaged COM or COM+ component, and you attempt to install the application that includes the COM or COM+ component on a 32-bit computer, the component will not be installed.</span></span> <span data-ttu-id="46661-111">Un tel composant ne peut être installé que sur un ordinateur 64 bits.</span><span class="sxs-lookup"><span data-stu-id="46661-111">It will install only on a 64-bit computer.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="46661-112">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="46661-112">Prerequisites</span></span>  
 <span data-ttu-id="46661-113">Pour effectuer les procédures décrites dans cette rubrique, vous devez être connecté avec un compte qui est membre du groupe Administrateurs de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="46661-113">To perform the procedures in this topic, you must be logged on with an account that is a member of the BizTalk Server Administrators group.</span></span> <span data-ttu-id="46661-114">Pour plus d’informations sur les autorisations, consultez [autorisations requises pour déployer et gérer une Application BizTalk](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="46661-114">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
## <a name="to-add-a-com-component-to-an-application"></a><span data-ttu-id="46661-115">Pour ajouter un composant COM à une application</span><span class="sxs-lookup"><span data-stu-id="46661-115">To add a COM component to an application</span></span>  
  
#### <a name="using-the-biztalk-server-administration-console"></a><span data-ttu-id="46661-116">Utilisation de la console Administration de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="46661-116">Using the BizTalk Server Administration console</span></span>  
  
1.  <span data-ttu-id="46661-117">Cliquez sur **Démarrer**, cliquez sur **programmes**, cliquez sur [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], puis cliquez sur **Administration de BizTalk Server**.</span><span class="sxs-lookup"><span data-stu-id="46661-117">Click **Start**, click **Programs**, click [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2.  <span data-ttu-id="46661-118">Dans l’arborescence de la console, développez Administration de BizTalk Server, développez le groupe BizTalk, développez Applications, puis développez l’application à laquelle vous souhaitez ajouter un composant COM.</span><span class="sxs-lookup"><span data-stu-id="46661-118">In the console tree, expand BizTalk Server Administration, expand the BizTalk group, expand Applications, and then expand the application to which you want to add a COM component.</span></span>  
  
3.  <span data-ttu-id="46661-119">Cliquez sur le **ressources** dossier, pointez sur **ajouter**, puis cliquez sur **ressources**.</span><span class="sxs-lookup"><span data-stu-id="46661-119">Right-click the **Resources** folder, point to **Add**, and then click **Resources**.</span></span>  
  
4.  <span data-ttu-id="46661-120">Cliquez sur **ajouter**, sélectionnez le composant COM, puis cliquez sur **ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="46661-120">Click **Add**, select the COM component, and then click **Open**.</span></span>  
  
5.  <span data-ttu-id="46661-121">Dans le **type de fichier** la liste déroulante, cliquez sur **System.BizTalk : com**.</span><span class="sxs-lookup"><span data-stu-id="46661-121">In the **File type** drop-down list, click **System.BizTalk:Com**.</span></span>  
  
6.  <span data-ttu-id="46661-122">Dans **Options**, activez ou désactivez le **enregistrer le fichier de destination (regsvr32)** selon si vous souhaitez que le composant à ajouter au Registre Windows lorsque l’application est installé.</span><span class="sxs-lookup"><span data-stu-id="46661-122">In **Options**, select or clear the **Register the file at destination (regsvr32)** check box according to whether or not you want the component to be added to the Windows Registry when the application is installed.</span></span>  
  
7.  <span data-ttu-id="46661-123">Dans **Destination**, tapez le chemin d’accès complet de l’emplacement où le composant COM doit être copié lorsque l’application est installée à partir du fichier .msi, y compris le nom de fichier.</span><span class="sxs-lookup"><span data-stu-id="46661-123">In **Destination**, type the full path of the location where the COM component is to be copied when the application is installed from the .msi file, including the file name.</span></span> <span data-ttu-id="46661-124">Si ce chemin d'accès n'est pas fourni, le fichier n'est pas copié dans le système de fichiers local lors de l'installation.</span><span class="sxs-lookup"><span data-stu-id="46661-124">If this path is not provided, the file is not copied to the local file system during installation.</span></span> <span data-ttu-id="46661-125">Ce chemin d’accès est requis si vous avez sélectionné le **enregistrer le fichier de destination (regsvr32)** case à cocher à l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="46661-125">This path is required if you selected the **Register the file at destination (regsvr32)** check box in the previous step.</span></span>  
  
     <span data-ttu-id="46661-126">Exemple : **%BTAD_InstallDir%\MyComponent.dll**</span><span class="sxs-lookup"><span data-stu-id="46661-126">Example: **%BTAD_InstallDir%\MyComponent.dll**</span></span>  
  
8.  <span data-ttu-id="46661-127">Lorsque vous avez terminé, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="46661-127">When finished, click **OK**.</span></span>  
  
#### <a name="using-the-command-line"></a><span data-ttu-id="46661-128">À l’aide de la ligne de commande</span><span class="sxs-lookup"><span data-stu-id="46661-128">Using the command line</span></span>  
  
1.  <span data-ttu-id="46661-129">Ouvrez une invite de commandes comme suit : cliquez sur **Démarrer**, cliquez sur **exécuter**, type `cmd`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="46661-129">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="46661-130">Tapez la commande suivante en utilisant les valeurs appropriées, comme décrit dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="46661-130">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
     <span data-ttu-id="46661-131">**BTSTask AddResource** [**« ApplicationName » :***valeur*] **/Type:System.BizTalk:Com** [**/overwrite**] **/Source :***valeur* [**facultatif /Destination :***valeur*] [**/Options:Regsvr32OnInstall** ] [**/Server :***valeur*] [**/Database :***valeur*]</span><span class="sxs-lookup"><span data-stu-id="46661-131">**BTSTask AddResource** [**/ApplicationName:***value*] **/Type:System.BizTalk:Com** [**/Overwrite**] **/Source:***value* [**/Destination:***value*] [**/Options:Regsvr32OnInstall**] [**/Server:***value*] [**/Database:***value*]</span></span>  
  
     <span data-ttu-id="46661-132">Exemple :</span><span class="sxs-lookup"><span data-stu-id="46661-132">Example:</span></span>  
  
     <span data-ttu-id="46661-133">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:Com /overwrite/source : facultatif de « C:\Source Components\COM.dll » /Destination : /Server:MyDatabaseServer/Database /Options:Regsvr32OnInstall de « C:\New Components\COM.dll » : BizTalkMgmtDb**</span><span class="sxs-lookup"><span data-stu-id="46661-133">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:Com /Overwrite /Source:"C:\Source Components\COM.dll" /Destination:"C:\New Components\COM.dll" /Options:Regsvr32OnInstall /Server:MyDatabaseServer /Database:BizTalkMgmtDb**</span></span>  
  
    |<span data-ttu-id="46661-134">Paramètre</span><span class="sxs-lookup"><span data-stu-id="46661-134">Parameter</span></span>|<span data-ttu-id="46661-135">Valeur</span><span class="sxs-lookup"><span data-stu-id="46661-135">Value</span></span>|  
    |---------------|-----------|  
    |<span data-ttu-id="46661-136">**/ ApplicationName**</span><span class="sxs-lookup"><span data-stu-id="46661-136">**/ApplicationName**</span></span>|<span data-ttu-id="46661-137">Nom de l'application BizTalk à laquelle ajouter le composant COM.</span><span class="sxs-lookup"><span data-stu-id="46661-137">Name of the BizTalk application to which to add the COM component.</span></span> <span data-ttu-id="46661-138">Si le nom de l'application n'est pas spécifié, l'application utilisée est l'application BizTalk définie par défaut pour le groupe.</span><span class="sxs-lookup"><span data-stu-id="46661-138">If the application name is not specified, the default BizTalk application for the group is used.</span></span> <span data-ttu-id="46661-139">Si le nom comprend des espaces, vous devez le placer entre guillemets doubles («).</span><span class="sxs-lookup"><span data-stu-id="46661-139">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="46661-140">**Type**</span><span class="sxs-lookup"><span data-stu-id="46661-140">**/Type**</span></span>|<span data-ttu-id="46661-141">**System.BizTalk : com** (cette valeur ne respecte pas la casse).</span><span class="sxs-lookup"><span data-stu-id="46661-141">**System.BizTalk:Com** (This value is not case-sensitive.)</span></span>|  
    |<span data-ttu-id="46661-142">**/ Remplacer**</span><span class="sxs-lookup"><span data-stu-id="46661-142">**/Overwrite**</span></span>|<span data-ttu-id="46661-143">Option permettant de mettre à jour un composant COM existant.</span><span class="sxs-lookup"><span data-stu-id="46661-143">Option to update an existing COM component.</span></span> <span data-ttu-id="46661-144">Si cette option n'est pas spécifiée et qu'un composant COM, dont l’identificateur unique local LUID est le même que celui du composant COM à ajouter, existe déjà dans l'application, l'opération AddResource échoue.</span><span class="sxs-lookup"><span data-stu-id="46661-144">If not specified, and a COM component already exists in the application that has the same LUID as the COM component being added, the AddResource operation fails.</span></span> <span data-ttu-id="46661-145">Vous pouvez afficher la liste des LUID pour les artefacts dans une application à l’aide de la [commande ListApp](../core/listapp-command.md).</span><span class="sxs-lookup"><span data-stu-id="46661-145">You can view the LUIDs for the artifacts in an application by using the [ListApp Command](../core/listapp-command.md).</span></span>|  
    |<span data-ttu-id="46661-146">**/ Source**</span><span class="sxs-lookup"><span data-stu-id="46661-146">**/Source**</span></span>|<span data-ttu-id="46661-147">Chemin d'accès complet du fichier de composant COM, nom du fichier inclus.</span><span class="sxs-lookup"><span data-stu-id="46661-147">Full path of the COM component .dll file, including the file name.</span></span> <span data-ttu-id="46661-148">Si le chemin d'accès comprend des espaces, vous devez le placer entre guillemets doubles (").</span><span class="sxs-lookup"><span data-stu-id="46661-148">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="46661-149">**Et de destination**</span><span class="sxs-lookup"><span data-stu-id="46661-149">**/Destination**</span></span>|<span data-ttu-id="46661-150">Chemin d'accès complet de l'emplacement où le fichier .dll du composant COM doit être copié lorsque l'application est installée à partir du fichier .msi.</span><span class="sxs-lookup"><span data-stu-id="46661-150">Full path of the location where the COM component .dll file is to be copied when the application is installed from the .msi file.</span></span> <span data-ttu-id="46661-151">Si ce paramètre n'est pas défini, le fichier n'est pas copié dans le système de fichiers local lors de l'installation. Par conséquent, le composant ne peut pas être ajouté au Registre Windows au cours de cette installation.</span><span class="sxs-lookup"><span data-stu-id="46661-151">If not provided, the file is not copied to the local file system during installation; therefore, the component cannot be added to the Windows registry during installation.</span></span> <span data-ttu-id="46661-152">Si le chemin d'accès comprend des espaces, vous devez le placer entre guillemets doubles (").</span><span class="sxs-lookup"><span data-stu-id="46661-152">If the path includes spaces, you must enclose it in double quotation marks (").</span></span> <span data-ttu-id="46661-153">Si vous définissez le paramètre Regsvr32OnInstallOption, vous devez également définir le paramètre Destination.</span><span class="sxs-lookup"><span data-stu-id="46661-153">If you specify the Regsvr32OnInstallOption, you must also specify Destination.</span></span>|  
    |<span data-ttu-id="46661-154">**/ Options**</span><span class="sxs-lookup"><span data-stu-id="46661-154">**/Options**</span></span>|<span data-ttu-id="46661-155">**Regsvr32OnInstall.**</span><span class="sxs-lookup"><span data-stu-id="46661-155">**Regsvr32OnInstall.**</span></span> <span data-ttu-id="46661-156">Permet d'ajouter le composant COM au Registre Windows lorsque l'application est installée à partir du fichier .msi.</span><span class="sxs-lookup"><span data-stu-id="46661-156">Specify to add the COM component to the Windows registry when the application is installed from the .msi file.</span></span> <span data-ttu-id="46661-157">Si vous définissez cette option, vous devez également définir le paramètre Destination.</span><span class="sxs-lookup"><span data-stu-id="46661-157">If you specify this option, you must also specify Destination.</span></span>|  
    |<span data-ttu-id="46661-158">**/ Serveur**</span><span class="sxs-lookup"><span data-stu-id="46661-158">**/Server**</span></span>|<span data-ttu-id="46661-159">Nom de l'instance SQL Server hébergeant la base de données de gestion BizTalk et indiqué sous la forme NomServeur\NomInstance,Port.</span><span class="sxs-lookup"><span data-stu-id="46661-159">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="46661-160">Le nom de l'instance est uniquement requis lorsqu'il est différent du nom du serveur.</span><span class="sxs-lookup"><span data-stu-id="46661-160">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="46661-161">Le port est uniquement requis lorsque le serveur SQL Server utilise un numéro de port autre que celui par défaut (1433).</span><span class="sxs-lookup"><span data-stu-id="46661-161">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="46661-162">Exemples :</span><span class="sxs-lookup"><span data-stu-id="46661-162">Examples:</span></span><br /><br /> <span data-ttu-id="46661-163">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="46661-163">Server=MyServer</span></span><br /><br /> <span data-ttu-id="46661-164">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="46661-164">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="46661-165">Si vous n'indiquez pas de nom pour l'instance SQL Server, le nom d'instance utilisé est celui de l'instance SQL Server exécutée sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="46661-165">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
    |<span data-ttu-id="46661-166">**/ Base de données**</span><span class="sxs-lookup"><span data-stu-id="46661-166">**/Database**</span></span>|<span data-ttu-id="46661-167">Nom de la base de données de gestion BizTalk.</span><span class="sxs-lookup"><span data-stu-id="46661-167">Name of the BizTalk Management database.</span></span> <span data-ttu-id="46661-168">Si vous ne l'indiquez pas, la base de données utilisée est la base de données de gestion BizTalk s'exécutant au sein de l'instance locale de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="46661-168">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="46661-169">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="46661-169">See Also</span></span>  
 <span data-ttu-id="46661-170">[La gestion des assemblys .NET, certificats et autres ressources](../core/managing-net-assemblies-certificates-and-other-resources.md) </span><span class="sxs-lookup"><span data-stu-id="46661-170">[Managing .NET Assemblies, Certificates, and Other Resources](../core/managing-net-assemblies-certificates-and-other-resources.md) </span></span>  
 <span data-ttu-id="46661-171">[Commande AddResource : Un composant COM](../core/addresource-command-com-component.md) </span><span class="sxs-lookup"><span data-stu-id="46661-171">[AddResource Command: COM Component](../core/addresource-command-com-component.md) </span></span>  
 [<span data-ttu-id="46661-172">Création et modification des applications BizTalk</span><span class="sxs-lookup"><span data-stu-id="46661-172">Creating and Modifying BizTalk Applications</span></span>](../core/creating-and-modifying-biztalk-applications.md)