---
title: "L’examen des goulots d’étranglement | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 7ca22d07-d5fe-4dfb-8b52-3be3a95b0d6f
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a6a3cf4630bf3269516537439ed58b464589cf26
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-investigate-bottlenecks"></a><span data-ttu-id="3334c-102">Examen des goulots d'étranglement</span><span class="sxs-lookup"><span data-stu-id="3334c-102">How to Investigate Bottlenecks</span></span>
<span data-ttu-id="3334c-103">Cette rubrique décrit la procédure recommandée pour l'examen des goulots d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="3334c-103">This topic describes a recommended process for how to investigate bottlenecks.</span></span>  
  
## <a name="what-is-the-source-of-the-problem"></a><span data-ttu-id="3334c-104">Quelle est la source du problème ?</span><span class="sxs-lookup"><span data-stu-id="3334c-104">What is the Source of the Problem?</span></span>  
 <span data-ttu-id="3334c-105">La source du problème peut provenir du matériel ou du logiciel.</span><span class="sxs-lookup"><span data-stu-id="3334c-105">The source of the problem could be hardware or software related.</span></span> <span data-ttu-id="3334c-106">Si les ressources sont sous-utilisées, cela signifie généralement qu'il existe un goulot d'étranglement à un emplacement quelconque du système.</span><span class="sxs-lookup"><span data-stu-id="3334c-106">When resources are underutilized it is usually an indication of a bottleneck somewhere in the system.</span></span> <span data-ttu-id="3334c-107">Les goulots d'étranglement peuvent être imputables à des limites matérielles ou à des configurations logicielles inefficaces ou les deux.</span><span class="sxs-lookup"><span data-stu-id="3334c-107">Bottlenecks can be caused either due to hardware limitations or due to inefficient software configurations or both.</span></span>  
  
 <span data-ttu-id="3334c-108">L'identification des goulots d'étranglement est un processus incrémentiel, où l'élimination d'un goulot d'étranglement peut conduire à la découverte du goulot suivant.</span><span class="sxs-lookup"><span data-stu-id="3334c-108">Identifying bottlenecks is an incremental process whereby alleviating one bottleneck can lead to the discovery of the next one.</span></span> <span data-ttu-id="3334c-109">L'objectif de cette rubrique est de présenter la méthode qui permet d'identifier et d'éliminer ces goulots d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="3334c-109">The science of identifying and alleviating these bottlenecks is the objective of this topic.</span></span> <span data-ttu-id="3334c-110">Il est possible pour un système de fonctionner avec des pics d'activité sur de courtes périodes.</span><span class="sxs-lookup"><span data-stu-id="3334c-110">It is possible for a system to perform at peaks for short periods of time.</span></span> <span data-ttu-id="3334c-111">Toutefois, pour un débit acceptable constant, le système ne peut pas fonctionner plus vite que le plus lent de ses composants.</span><span class="sxs-lookup"><span data-stu-id="3334c-111">However, for sustainable throughput a system can only process as fast as its slowest performing component.</span></span>  
  
## <a name="using-a-serial-approach"></a><span data-ttu-id="3334c-112">Approche en série</span><span class="sxs-lookup"><span data-stu-id="3334c-112">Using a Serial Approach</span></span>  
 <span data-ttu-id="3334c-113">Des goulots d'étranglement peuvent survenir aux points de terminaison (entrée/sortie) du système ou au niveau de points intermédiaires (orchestration/base de données).</span><span class="sxs-lookup"><span data-stu-id="3334c-113">Bottlenecks can occur at the endpoints (entry/exit) of the system or somewhere in the middle (orchestration/database).</span></span> <span data-ttu-id="3334c-114">Une fois que l'emplacement d'un goulot d'étranglement a été isolé, il est possible de mettre en œuvre une approche structurée afin d'en identifier la source.</span><span class="sxs-lookup"><span data-stu-id="3334c-114">After the location of the bottleneck has been isolated a structured approach can be undertaken to identify the source.</span></span> <span data-ttu-id="3334c-115">Dès que les goulots d'étranglement ont été éliminés, il est essentiel de mesurer à nouveau les performances afin de s'assurer qu'un nouveau goulot d'étranglement n'a pas été créé à un autre endroit en aval du système.</span><span class="sxs-lookup"><span data-stu-id="3334c-115">After the bottlenecks have been alleviated it is essential to measure performance again to ensure that a new bottleneck has not been introduced elsewhere in the system further down the line.</span></span>  
  
 <span data-ttu-id="3334c-116">La procédure d'identification et de correction des goulots d'étranglement doit être effectuée de manière systématique, en faisant varier un seul paramètre à la fois et en mesurant alors l'impact de cette modification unique.</span><span class="sxs-lookup"><span data-stu-id="3334c-116">The process of identifying and fixing bottlenecks should be done in a serial manner whereby only one parameter at a time should be varied and then performance measured to verify the impact of that single change.</span></span> <span data-ttu-id="3334c-117">Faire varier plusieurs paramètres simultanément pourrait avoir pour effet de masquer l'impact d'une modification.</span><span class="sxs-lookup"><span data-stu-id="3334c-117">Varying more than one parameter at a time could conceal the effect of the change.</span></span>  
  
 <span data-ttu-id="3334c-118">Par exemple, la modification du paramètre 1 pourrait améliorer les performances ; paradoxalement, modifier le paramètre 2 en même temps que le paramètre 1 pourrait avoir un effet négatif qui annulerait alors les bénéfices de la modification du paramètre 1, pour un résultat net égal à zéro. .</span><span class="sxs-lookup"><span data-stu-id="3334c-118">For example, changing parameter 1 could improve performance however, changing parameter 2 in conjunction with changing parameter 1 could have a detrimental effect negating the benefits of changing parameter 1 thus leading to a net zero effect.</span></span> <span data-ttu-id="3334c-119">En fait, ce résultat donnerait à tort une fausse impression négative quant à la modification du paramètre 1 et une fausse impression positive quant à la modification du paramètre 2.</span><span class="sxs-lookup"><span data-stu-id="3334c-119">However, this results in a false negative on the effect of varying parameter 1 and a false positive on the effect of varying parameter 2.</span></span>  
  
## <a name="testing-consistency"></a><span data-ttu-id="3334c-120">Test de la cohérence</span><span class="sxs-lookup"><span data-stu-id="3334c-120">Testing Consistency</span></span>  
 <span data-ttu-id="3334c-121">Il est impératif de mesurer les caractéristiques de performances après une modification des paramètres afin de pouvoir quantifier les effets de la modification.</span><span class="sxs-lookup"><span data-stu-id="3334c-121">Measuring performance characteristics after changing settings is imperative to validate the effect of the change.</span></span>  
  
-   <span data-ttu-id="3334c-122">Matériel : Il est important d’utiliser un matériel cohérent car le changement de matériel peut afficher un comportement incohérent des résultats déroutants de production ; par exemple, n’utilisez pas un ordinateur portable.</span><span class="sxs-lookup"><span data-stu-id="3334c-122">Hardware: It is important to use consistent hardware as varying the hardware can display inconsistent behavior producing misleading results e.g. do not use a laptop.</span></span>  
  
-   <span data-ttu-id="3334c-123">Durée d’exécution de test : Il est également important de mesurer les performances sur une durée minimale fixe pour vous assurer que les résultats sont durables et pas simplement de pics soudains.</span><span class="sxs-lookup"><span data-stu-id="3334c-123">Test Run Duration: It is also important to measure performance for a fixed minimum period to ensure that the results are indeed sustainable and not simply peaks.</span></span> <span data-ttu-id="3334c-124">Une autre raison qui justifie le test sur des périodes plus longues, c'est qu'il convient de s'assurer que le système a terminé la phase initiale de préchauffage où toutes les mémoires cache sont remplies, que les tables de la base de données ont atteint les tailles attendues et que les procédures de limitation ont eu le temps de se mettre en place et de réguler le débit une fois que les seuils prédéfinis ont été atteints.</span><span class="sxs-lookup"><span data-stu-id="3334c-124">Another reason to run tests for longer periods is to ensure that the system has gone through the initial warm/ramp up period where all caches are populated, database tables have reached expected counts and throttling is given sufficient time to kick in and regulate throughput once predefined thresholds are hit.</span></span> <span data-ttu-id="3334c-125">Cette approche facilite la recherche du débit durable optimal.</span><span class="sxs-lookup"><span data-stu-id="3334c-125">This approach will help discover optimal sustainable throughput.</span></span>  
  
-   <span data-ttu-id="3334c-126">Paramètres de test : Il est également impératif ne varie ne pas à partir de la série de tests pour tester les paramètres de série de tests.</span><span class="sxs-lookup"><span data-stu-id="3334c-126">Test Parameters: It is also imperative to not vary test parameters from test run to test run.</span></span> <span data-ttu-id="3334c-127">Par exemple, changer la complexité d'un mappage et/ou les tailles de document peut entraîner des débits et des temps de latence différents.</span><span class="sxs-lookup"><span data-stu-id="3334c-127">For example, varying map complexity and/or document sizes can produce different throughput and latency results.</span></span>  
  
-   <span data-ttu-id="3334c-128">État propre : Une fois qu’un test est terminé il est important de nettoyage de l’exécution de tous les États avant d’exécuter le test suivant.</span><span class="sxs-lookup"><span data-stu-id="3334c-128">Clean State: Once a test is complete it is important to cleanup all state before running the next test run.</span></span> <span data-ttu-id="3334c-129">Par exemple, les données historiques pourraient s'accumuler dans la base de données et avoir une influence sur le débit d'exécution.</span><span class="sxs-lookup"><span data-stu-id="3334c-129">For example, historical data can buildup in the database impacting runtime throughput.</span></span> <span data-ttu-id="3334c-130">Recycler les instances de service facilite la libération des ressources en mémoire cache comme la mémoire, les connexions de base de données et les threads.</span><span class="sxs-lookup"><span data-stu-id="3334c-130">Recycling the service instances help to release cached resources like memory, database connections and threads.</span></span>  
  
## <a name="expectations-throughput-versus-latency"></a><span data-ttu-id="3334c-131">Attentes : Débit par rapport à latence</span><span class="sxs-lookup"><span data-stu-id="3334c-131">Expectations: Throughput versus Latency</span></span>  
 <span data-ttu-id="3334c-132">Il est raisonnable d'attendre un certain débit et une certaine latence à partir du système déployé.</span><span class="sxs-lookup"><span data-stu-id="3334c-132">It is reasonable to expect a certain amount of throughput and/or latency from the deployed system.</span></span> <span data-ttu-id="3334c-133">Essayer d'obtenir à la fois un débit élevé et une latence faible revient à tirer dans deux directions opposées.</span><span class="sxs-lookup"><span data-stu-id="3334c-133">Attempting to have both high throughput & low latency is like pulling in two different directions.</span></span> <span data-ttu-id="3334c-134">Toutefois, on peut espérer atteindre un juste équilibre entre un débit optimal et une latence raisonnable.</span><span class="sxs-lookup"><span data-stu-id="3334c-134">However it is realistic to expect optimal throughput with reasonable latency.</span></span> <span data-ttu-id="3334c-135">À mesure que le débit augmente, le système subit une pression accrue (consommation d'UC plus élevée, conflits d'E/S sur les disques plus nombreux, surcharge de la mémoire, conflits de verrouillage plus fréquents) qui peut avoir un impact négatif sur le délai de latence.</span><span class="sxs-lookup"><span data-stu-id="3334c-135">As throughput improves increased stress (higher CPU consumption, higher disk-IO contention, memory pressure, greater lock contention) is placed on the system which can have a negative impact on latency.</span></span> <span data-ttu-id="3334c-136">Pour trouver la capacité optimale d'un système, il est impératif d'identifier et d'éliminer tous les goulots d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="3334c-136">To discover optimal capacity of a system it is imperative to identify and alleviate any and all bottlenecks.</span></span>  
  
 <span data-ttu-id="3334c-137">Les goulots d'étranglement peuvent provenir de données héritées (instances terminées) qui résident dans la base de données et n'ont pas été nettoyées. Lorsque cela se produit, on assiste à une dégradation des performances.</span><span class="sxs-lookup"><span data-stu-id="3334c-137">Bottlenecks can be caused by legacy data (completed instances) residing in the database not cleaned out. When this occurs performance can degrade.</span></span> <span data-ttu-id="3334c-138">Offrir au système le temps nécessaire pour se purger peut aider à résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="3334c-138">Giving the system sufficient time to drain can help alleviate the problem.</span></span> <span data-ttu-id="3334c-139">Cependant, découvrir la cause de l'accumulation des travaux en retard et aider à y remédier est important.</span><span class="sxs-lookup"><span data-stu-id="3334c-139">However, discovering the cause of the backlog buildup and helping alleviate the issue is important.</span></span>  
  
 <span data-ttu-id="3334c-140">Pour découvrir la cause de l'accumulation des travaux en retard, il est important d'analyser les données historiques et de surveiller les compteurs de l'Analyseur de performances (pour identifier les modèles d'utilisation et diagnostiquer la source de l'accumulation).</span><span class="sxs-lookup"><span data-stu-id="3334c-140">To discover the cause of the backlog, it is important to analyze historical data, monitor Performance Monitor counters (to discover usage patterns, and diagnose the source of the backlog).</span></span> <span data-ttu-id="3334c-141">Cette situation est fréquente lorsque des volumes importants de données sont traités par lots, la nuit.</span><span class="sxs-lookup"><span data-stu-id="3334c-141">This is a common situation where large volumes of data are processed in a batched manner on a nightly basis.</span></span> <span data-ttu-id="3334c-142">Découvrir la capacité du système et son aptitude à récupérer suite à une accumulation peut être utile pour estimer les besoins matériels pour la gestion des scénarios de surcharge, ainsi que la quantité d'espace tampon à prévoir dans un système pour assumer les pics imprévus de débit.</span><span class="sxs-lookup"><span data-stu-id="3334c-142">Discovering the capacity of the system and its ability to recover from a backlog can be useful in estimating hardware requirements for handling overdrive scenarios and the amount of buffer room to accommodate within a system to handle unforeseen spikes in throughput.</span></span>  
  
 <span data-ttu-id="3334c-143">Affiner le système en vue d'obtenir un débit durable optimal nécessite une connaissance approfondie de l'application à déployer, des forces et faiblesses du système et des modèles d'utilisation du scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="3334c-143">Tuning the system for optimal sustainable throughput requires an in depth understanding of the application being deployed, the strengths and weaknesses of the system and usage patterns of the specific scenario.</span></span> <span data-ttu-id="3334c-144">La seule manière de découvrir les goulots d'étranglement et de prévoir avec certitude le débit durable optimal consiste à effectuer un test rigoureux d'une topologie se rapprochant le plus de celle qui sera utilisée en production.</span><span class="sxs-lookup"><span data-stu-id="3334c-144">The only way to discover bottlenecks and predict optimal sustainable throughput with certainty is through thorough testing on a topology that closely matches what will be used in production.</span></span>  
  
 <span data-ttu-id="3334c-145">D'autres rubriques de cette section vous guident pour la définition de cette topologie et fournissent des conseils sur la manière d'éliminer les goulots d'étranglement existants et, si possible, d'éviter qu'ils ne se créent dès l'origine.</span><span class="sxs-lookup"><span data-stu-id="3334c-145">Other topics in this section guides you through the process of defining that topology, and provides guidance on how to alleviate bottlenecks and hopefully help to avoid bottlenecks in the first place.</span></span>  
  
## <a name="scaling"></a><span data-ttu-id="3334c-146">mise à l’échelle</span><span class="sxs-lookup"><span data-stu-id="3334c-146">Scaling</span></span>  
 <span data-ttu-id="3334c-147">Des goulots d'étranglement peuvent se produire à différents niveaux de la topologie déployée.</span><span class="sxs-lookup"><span data-stu-id="3334c-147">Bottlenecks can occur at various stages of the deployed topology.</span></span> <span data-ttu-id="3334c-148">Certains d'entre eux peuvent être résolus par une mise à niveau du matériel.</span><span class="sxs-lookup"><span data-stu-id="3334c-148">Some bottlenecks can be addressed by upgrading hardware.</span></span> <span data-ttu-id="3334c-149">Le matériel peut faire l'objet soit d'une évolution verticale (augmentation du nombre d'UC, de la capacité de la mémoire ou du cache) soit d'une évolution horizontale (serveurs supplémentaires).</span><span class="sxs-lookup"><span data-stu-id="3334c-149">Hardware can be upgraded either by scaling-up (more CPU’s, memory or cache) or by scaling-out (additional servers).</span></span> <span data-ttu-id="3334c-150">Le choix entre une évolution verticale ou horizontale dépend du type de goulot d'étranglement rencontré et de l'application en cours de configuration.</span><span class="sxs-lookup"><span data-stu-id="3334c-150">The decision to scale up/out depends on the type of bottleneck encountered and the application being configured.</span></span> <span data-ttu-id="3334c-151">Les informations suivantes fournissent des conseils quant à la manière de modifier les topologies de déploiement matérielles en fonction des goulots d'étranglement rencontrés.</span><span class="sxs-lookup"><span data-stu-id="3334c-151">The following will help with guidance on how to change hardware deployment topologies based on bottlenecks encountered.</span></span> <span data-ttu-id="3334c-152">Une application doit être élaborée en partant de zéro pour pouvoir tirer parti d'une évolution verticale ou horizontale. Exemple :</span><span class="sxs-lookup"><span data-stu-id="3334c-152">An application needs to be built from the ground up to be capable of taking advantage of scaling up/out. For example:</span></span>  
  
-   <span data-ttu-id="3334c-153">Faire évoluer verticalement un serveur en lui ajoutant des UC supplémentaires ou de la mémoire n'éliminera pas forcément le problème si l'application est sérialisée et dépendante d'un seul thread d'exécution.</span><span class="sxs-lookup"><span data-stu-id="3334c-153">Scaling up a server with additional CPU’s and/or memory may not help alleviate the problem if the application is serialized and dependent on a single thread of execution.</span></span>  
  
-   <span data-ttu-id="3334c-154">Faire évoluer horizontalement un système en ajoutant des serveurs ne sera d'aucune utilité si les serveurs supplémentaires se contentent de créer de nouveaux conflits pour l'utilisation d'une ressource commune qui ne peut évoluer.</span><span class="sxs-lookup"><span data-stu-id="3334c-154">Scaling out a system with additional servers may not help if the additional servers simply add contention on a common resource that cannot be scaled.</span></span> <span data-ttu-id="3334c-155">Toutefois, l'évolution horizontale offre d'autres atouts.</span><span class="sxs-lookup"><span data-stu-id="3334c-155">However, scaling-out provides additional benefits.</span></span> <span data-ttu-id="3334c-156">Un déploiement sur deux serveurs à processeurs doubles au lieu d'un serveur à processeur quadruple permet d'obtenir un serveur redondant qui a une double fonction : répondre aux besoins d'évolution en gérant un débit supplémentaire et offrir une topologie haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="3334c-156">Deploying two dual-proc servers instead of one quad-proc server helps provide a redundant server that serves the dual purpose of scaling to handle additional throughput and provides a highly available topology.</span></span>