---
title: "Montée en puissance parallèle du niveau SQL Server | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- scaling, MessageBox database
- scaling, scaling out
- SQL Server, scaling
- MessageBox database, scaling
- scaling, strategies
ms.assetid: d5b2ebba-401e-4fde-8818-407fa626043a
caps.latest.revision: "7"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 702c253a0135c1dc4af4cea15a9b47c77792586f
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="scaling-out-the-sql-server-tier"></a><span data-ttu-id="88134-102">Évolution horizontale du niveau SQL Server</span><span class="sxs-lookup"><span data-stu-id="88134-102">Scaling Out the SQL Server Tier</span></span>
<span data-ttu-id="88134-103">Pour chaque groupe BizTalk, vous ajoutez une base de données principale MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-103">For each BizTalk group, you add one Master MessageBox database.</span></span> <span data-ttu-id="88134-104">Toutes les bases de données MessageBox suivantes que vous ajoutez sont des bases de données secondaires.</span><span class="sxs-lookup"><span data-stu-id="88134-104">All the subsequent MessageBox databases that you add are called secondary MessageBoxes.</span></span> <span data-ttu-id="88134-105">La base de données principale MessageBox gère tous les abonnements et le routage des messages.</span><span class="sxs-lookup"><span data-stu-id="88134-105">The Master MessageBox handles all subscriptions and message routing.</span></span> <span data-ttu-id="88134-106">Elle permet également la publication de messages.</span><span class="sxs-lookup"><span data-stu-id="88134-106">It can also publish messages.</span></span> <span data-ttu-id="88134-107">Les bases de données secondaires MessageBox publient des messages uniquement lorsqu'elles sont configurées pour ce faire.</span><span class="sxs-lookup"><span data-stu-id="88134-107">Secondary MessageBox databases will only publish messages when specifically configured to do so.</span></span>  
  
## <a name="how-to-add-a-secondary-messagebox-database"></a><span data-ttu-id="88134-108">Ajout d'une base de données secondaire MessageBox</span><span class="sxs-lookup"><span data-stu-id="88134-108">How to Add a Secondary MessageBox Database</span></span>  
 <span data-ttu-id="88134-109">Il existe deux façons d'ajouter des bases de données secondaires MessageBox :</span><span class="sxs-lookup"><span data-stu-id="88134-109">There are two ways to add secondary MessageBox databases:</span></span>  
  
-   <span data-ttu-id="88134-110">Ajoutez la base de données secondaire MessageBox sur le même serveur physique.</span><span class="sxs-lookup"><span data-stu-id="88134-110">Add the secondary MessageBox database on the same physical server.</span></span>  
  
     <span data-ttu-id="88134-111">Procédez de la sorte si le serveur physique MessageBox existant dispose de suffisamment de ressources UC et E/S et s'il est engorgé uniquement par un conflit de verrouillage.</span><span class="sxs-lookup"><span data-stu-id="88134-111">Do this if the existing MessageBox physical server has enough CPU and I/O resources and is only bottlenecked by lock contention.</span></span> <span data-ttu-id="88134-112">Créez la base de données secondaire MessageBox sur des lecteurs d'E/S distincts.</span><span class="sxs-lookup"><span data-stu-id="88134-112">Create the secondary MessageBox database on separate IO drives.</span></span>  
  
     <span data-ttu-id="88134-113">Avantages :</span><span class="sxs-lookup"><span data-stu-id="88134-113">Advantages:</span></span>  
  
    -   <span data-ttu-id="88134-114">La marge d'UC supplémentaire peut être utilisée par un autre MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-114">The extra CPU headroom can be utilized by another message-box</span></span>  
  
    -   <span data-ttu-id="88134-115">Moins de licences serveur SQL sont requises.</span><span class="sxs-lookup"><span data-stu-id="88134-115">Fewer SQL server licenses are required</span></span>  
  
    -   <span data-ttu-id="88134-116">Le tronçon réseau est éliminé.</span><span class="sxs-lookup"><span data-stu-id="88134-116">Network hop is eliminated</span></span>  
  
-   <span data-ttu-id="88134-117">Ajoutez la base de données secondaire MessageBox sur un autre serveur physique.</span><span class="sxs-lookup"><span data-stu-id="88134-117">Add the secondary MessageBox database on a different physical server</span></span>  
  
     <span data-ttu-id="88134-118">Dans ce cas utilisez un serveur physique dédié avec sa propre E/S en tant que base de données MessageBox supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="88134-118">In this case, use a dedicated physical server with its own IO as the extra MessageBox database.</span></span>  
  
 <span data-ttu-id="88134-119">La figure suivante montre un scénario dans lequel le niveau SQL subit une évolution horizontale d'une base de données MessageBox vers trois bases de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-119">The following figure shows a scenario where SQL tier is scaled-out from one MessageBox database to three MessageBoxes databases.</span></span>  
  
 <span data-ttu-id="88134-120">![Montée en puissance parallèle de MSGBOX](../core/media/scaleoutmsgbox.gif "ScaleOutMSGBOX")</span><span class="sxs-lookup"><span data-stu-id="88134-120">![Scale out MSGBOX](../core/media/scaleoutmsgbox.gif "ScaleOutMSGBOX")</span></span>  
  
## <a name="when-to-scale-out-the-messagebox-database"></a><span data-ttu-id="88134-121">Quand procéder à l'évolution horizontale de la base de données MessageBox</span><span class="sxs-lookup"><span data-stu-id="88134-121">When to Scale-out the MessageBox database</span></span>  
  
-   <span data-ttu-id="88134-122">La base de données MessageBox devient le goulot d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="88134-122">The MessageBox database becomes the bottleneck.</span></span> <span data-ttu-id="88134-123">Ces engorgements peuvent être notamment :</span><span class="sxs-lookup"><span data-stu-id="88134-123">Those bottlenecks can be:</span></span>  
  
    -   <span data-ttu-id="88134-124">**Processeur** en cas de scénarios d’orchestration très coûteux et complexes, la base de données MessageBox consomme des ressources du processeur élevées.</span><span class="sxs-lookup"><span data-stu-id="88134-124">**CPU** In case of very expensive and complex orchestration scenarios, the MessageBox database consumes heavy CPU resources.</span></span> <span data-ttu-id="88134-125">L'ajout d'une autre base de données MessageBox dans laquelle la publication est activée doit aider à augmenter le débit.</span><span class="sxs-lookup"><span data-stu-id="88134-125">Adding another publishing the MessageBox database should help increase the throughput.</span></span>  
  
    -   <span data-ttu-id="88134-126">**Contention de verrouillage** des scénarios complexes avec plusieurs instances d’hôte ou orchestrations ont tendance à créer des conflits de verrouillage sur la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-126">**Lock Contention** Complex scenarios with multiple host instances or orchestrations tend to create lock contention on the MessageBox database.</span></span> <span data-ttu-id="88134-127">Là encore, l'ajout d'une autre base de données MessageBox dans laquelle la publication est activée doit aider à augmenter le débit.</span><span class="sxs-lookup"><span data-stu-id="88134-127">Again, adding another publishing MessageBox database should help increase the throughput.</span></span>  
  
-   <span data-ttu-id="88134-128">L'évolution verticale ne résout pas l'engorgement.</span><span class="sxs-lookup"><span data-stu-id="88134-128">Scaling up doesn’t address the bottleneck.</span></span> <span data-ttu-id="88134-129">Par exemple, si la base de données principale MessageBox est liée par un conflit de verrouillage, l'évolution horizontale est la seule option possible.</span><span class="sxs-lookup"><span data-stu-id="88134-129">For example, if the Master MessageBox database is lock contention bound, scaling-out is the only option.</span></span>  
  
-   <span data-ttu-id="88134-130">L'évolution verticale est trop onéreuse.</span><span class="sxs-lookup"><span data-stu-id="88134-130">Scaling-up is too expensive.</span></span> <span data-ttu-id="88134-131">Par exemple, si la mise à niveau du serveur à quatre processeurs vers un serveur à huit processeurs est plus coûteuse que d'ajouter un autre ordinateur à quatre processeurs, l'évolution horizontale est plus intéressante.</span><span class="sxs-lookup"><span data-stu-id="88134-131">For example, if upgrading the existing quad proc server to 8 way server is more expensive than adding another quad proc, scale-out is better option.</span></span>  
  
## <a name="when-you-cant-scale-out-the-sql-tier"></a><span data-ttu-id="88134-132">Cas dans lesquels l'évolution horizontale du niveau SQL est impossible</span><span class="sxs-lookup"><span data-stu-id="88134-132">When You Can’t Scale-out the SQL Tier</span></span>  
 <span data-ttu-id="88134-133">En théorie, le niveau SQL doit pouvoir évoluer horizontalement tant que la base de données principale MessageBox ne devient pas le goulot d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="88134-133">In theory, the SQL tier should scale indefinitely as long as the Master MessageBox database is not the bottleneck.</span></span> <span data-ttu-id="88134-134">Pour cela, faites de la base de données principale MessageBox une base de données MessageBox n'acceptant pas la publication afin qu'elle n'effectue que le routage.</span><span class="sxs-lookup"><span data-stu-id="88134-134">To achieve this, consider making the Master MessageBox database a non-publishing database so it only does routing.</span></span> <span data-ttu-id="88134-135">Toutefois, dès que la base de données principale est engorgée par un conflit de verrouillage, vous ne pouvez plus faire évoluer horizontalement le niveau SQL.</span><span class="sxs-lookup"><span data-stu-id="88134-135">But, once the Master is bottlenecked by lock contention, you cannot scale out the SQL tier any more.</span></span>  
  
## <a name="scale-out-strategies-and-considerations"></a><span data-ttu-id="88134-136">Stratégies et recommandations en matière d'évolution horizontale</span><span class="sxs-lookup"><span data-stu-id="88134-136">Scale-out Strategies and Considerations</span></span>  
  
-   <span data-ttu-id="88134-137">Faites évoluer la base de données principale MessageBox verticalement puis horizontalement.</span><span class="sxs-lookup"><span data-stu-id="88134-137">First scale-up the Master MessageBox database and then scale out.</span></span>  
  
-   <span data-ttu-id="88134-138">Montée en charge horizontale de 1 à 3 bases de données MessageBox SQL au lieu de 1 à 2.</span><span class="sxs-lookup"><span data-stu-id="88134-138">Scaling-out from 1 to 3 SQL MessageBox databases instead of 1 to 2.</span></span> <span data-ttu-id="88134-139">Envisagez la topologie de serveur SQL 1 illustrée la figure ci-dessus intitulée « 4 BizTalk Server, la topologie du serveur SQL 1 » et supposent que le serveur SQL server est lié à l’UC, en d’autres termes, le traitement de l’UC est un goulot d’étranglement.</span><span class="sxs-lookup"><span data-stu-id="88134-139">Consider the 1 SQL server topology illustrated in the figure above titled "4 BizTalk Server, 1 SQL Server Topology," and assume that the SQL server is CPU bound, in other words, the CPU processing is a bottleneck.</span></span> <span data-ttu-id="88134-140">Si vous n'ajoutez qu'une base de données MessageBox à cette topologie, la base de données principale Messagebox restera liée à l'UC et la base de données secondaire MessageBox sera sous-utilisée.</span><span class="sxs-lookup"><span data-stu-id="88134-140">If you add only one MessageBox database to this topology, the Master Messagebox will still be CPU bound and the secondary MessageBox database will be under-utilized.</span></span> <span data-ttu-id="88134-141">Le facteur d’échelle est donc presque de 1.</span><span class="sxs-lookup"><span data-stu-id="88134-141">So, the scaling factor is almost 1.</span></span> <span data-ttu-id="88134-142">Si vous désactivez la publication sur la base de données principale MessageBox et dédiez la base de données principale MessageBox uniquement pour effectuer un routage, la base de données secondaire MessageBox effectuera la publication.</span><span class="sxs-lookup"><span data-stu-id="88134-142">If you disable publishing on the Master MessageBox database and dedicate the Master MessageBox database only to do routing, the secondary MessageBox database will do the publishing.</span></span> <span data-ttu-id="88134-143">Cependant, cela ne permettra pas d'augmenter le débit global dans la mesure où la base de données secondaire MessageBox devient le seul éditeur et demeure l'engorgement.</span><span class="sxs-lookup"><span data-stu-id="88134-143">This will not help increase overall throughput though since the secondary MessageBox database is the only publisher and still becomes the bottleneck.</span></span> <span data-ttu-id="88134-144">Par conséquent, le meilleur moyen de procéder à une évolution horizontale dans ce scénario consiste à ajouter 2 bases de données secondaires MessageBox et à désactiver la publication sur la base de données principale MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-144">So, adding 2 secondary MessageBox databases and disabling the publishing on the Master MessageBox database would be the recommended way to scale-out in this scenario.</span></span>  
  
-   <span data-ttu-id="88134-145">La base de données principale MessageBox devient à terme le goulot d'étranglement.</span><span class="sxs-lookup"><span data-stu-id="88134-145">The Master MessageBox database will eventually be the bottleneck.</span></span> <span data-ttu-id="88134-146">Par conséquent, l'ordinateur physique hébergeant la base de données principale MessageBox doit être plus rapide et plus puissant.</span><span class="sxs-lookup"><span data-stu-id="88134-146">So, the physical computer hosting the Master MessageBox database should be faster and bigger.</span></span>  
  
-   <span data-ttu-id="88134-147">Pour limiter l'envoi de données sur le réseau (et la surcharge DTC associée), pensez à installer plusieurs bases de données MessageBox sur le même ordinateur physique, avec des lecteurs dédiés.</span><span class="sxs-lookup"><span data-stu-id="88134-147">To minimize sending data over the network (and the associated DTC overhead), consider placing multiple MessageBox databases on the same physical computer with dedicated drives.</span></span> <span data-ttu-id="88134-148">Vérifiez dans le même temps que l'ordinateur hébergeant ces bases de données n'est pas engorgé car les ressources sont partagées par plusieurs bases de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-148">At the same time, make sure that the computer holding these multiple databases is not bottlenecked as the resources are being shared by multiple MessageBox databases.</span></span>  
  
-   <span data-ttu-id="88134-149">Toutes les bases de données secondaires MessageBox doivent utiliser du matériel comparable parce que le travail est réparti de manière homogène entre les bases de données MessageBox acceptant la publication.</span><span class="sxs-lookup"><span data-stu-id="88134-149">All secondary MessageBox databases should use comparable hardware because work is evenly distributed among the publishing MessageBox databases.</span></span>  
  
-   <span data-ttu-id="88134-150">Puisque vous pouvez faire évoluer horizontalement des bases de données secondaires MessageBox tant que la base de données principale MessageBox n'est pas engorgée, ces bases secondaires peuvent s'exécuter sur des ordinateurs possédant des ressources d'UC inférieures à celles requises par le serveur de la base de données principale MessageBox.</span><span class="sxs-lookup"><span data-stu-id="88134-150">Since you can scale out secondary MessageBox databases as long as the master MessageBox database is not bottlenecked, secondary MessageBox databases can run on computers with less CPU resources than is required by the master MessageBox database server.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="88134-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="88134-151">See Also</span></span>  
 <span data-ttu-id="88134-152">[Évolution horizontale du niveau de BizTalk Server](../core/scaling-out-the-biztalk-server-tier.md) </span><span class="sxs-lookup"><span data-stu-id="88134-152">[Scaling Out the BizTalk Server Tier](../core/scaling-out-the-biztalk-server-tier.md) </span></span>  
 <span data-ttu-id="88134-153">[Mise à l’échelle verticale du niveau de BizTalk Server](../core/scaling-up-the-biztalk-server-tier.md) </span><span class="sxs-lookup"><span data-stu-id="88134-153">[Scaling Up the BizTalk Server Tier](../core/scaling-up-the-biztalk-server-tier.md) </span></span>  
 <span data-ttu-id="88134-154">[L’évolution verticale du niveau SQL Server](../core/scaling-up-the-sql-server-tier.md) </span><span class="sxs-lookup"><span data-stu-id="88134-154">[Scaling Up the SQL Server Tier](../core/scaling-up-the-sql-server-tier.md) </span></span>  
 <span data-ttu-id="88134-155">[Mise à l’échelle des hôtes de réception](../core/scaled-out-receiving-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="88134-155">[Scaled-Out Receiving Hosts](../core/scaled-out-receiving-hosts.md) </span></span>  
 <span data-ttu-id="88134-156">[Mise à l’échelle des hôtes de traitement](../core/scaled-out-processing-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="88134-156">[Scaled-Out Processing Hosts](../core/scaled-out-processing-hosts.md) </span></span>  
 <span data-ttu-id="88134-157">[Mise à l’échelle des hôtes d’envoi](../core/scaled-out-sending-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="88134-157">[Scaled-Out Sending Hosts](../core/scaled-out-sending-hosts.md) </span></span>  
 <span data-ttu-id="88134-158">[À l’aide de Cluster Windows Server pour fournir une haute disponibilité pour BizTalk Server Hosts2](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="88134-158">[Using Windows Server Cluster to Provide High Availability for BizTalk Server Hosts2](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="88134-159">[Bases de données à grande échelle](../core/scaled-out-databases.md) </span><span class="sxs-lookup"><span data-stu-id="88134-159">[Scaled-Out Databases](../core/scaled-out-databases.md) </span></span>  
 [<span data-ttu-id="88134-160">Mise en cluster les bases de données BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="88134-160">Clustering the BizTalk Server Databases</span></span>](../core/clustering-the-biztalk-server-databases1.md)