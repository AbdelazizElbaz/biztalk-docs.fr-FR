---
title: "Procédure pas à pas : Personnalisé traitement du Message avec l’adaptateur WCF-NetTcp | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b56b7492-2ea0-4c63-8f1b-430eb277517d
caps.latest.revision: "32"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 9a7123d908f25e6575eaaba4f9a92608f17c88be
ms.sourcegitcommit: 3fd1c85d9dc2ce7b77da75a5c2087cc48cfcbe50
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2018
---
# <a name="walkthrough-custom-message-processing-with-the-wcf-nettcp-adapter"></a><span data-ttu-id="a958f-102">Procédure pas à pas : Personnalisé traitement du Message avec l’adaptateur WCF-NetTcp</span><span class="sxs-lookup"><span data-stu-id="a958f-102">Walkthrough: Custom Message Processing with the WCF-NetTcp Adapter</span></span>
<span data-ttu-id="a958f-103">Dans cette procédure pas à pas, un client [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] soumet un message [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] contenant des données d'image JPEG binaires imbriquées à un emplacement de réception BizTalk à l'aide de l'adaptateur WCF-NetTcp.</span><span class="sxs-lookup"><span data-stu-id="a958f-103">In this walkthrough a [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] client submits a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message containing embedded binary JPEG image data to a BizTalk receive location using the WCF-NetTcp adapter.</span></span> <span data-ttu-id="a958f-104">L’image JPEG codée en binaire est extraite à l’aide d’une instruction XPath (avec codage de nœud Base64) via le **corps du Message entrant** paramètres de configuration de l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="a958f-104">The binary encoded JPEG image gets extracted by using an XPath statement (with Base64 Node encoding) through the **Inbound Message Body** settings in the adapter’s configuration.</span></span> <span data-ttu-id="a958f-105">Un traitement XPath diffère de la méthode par défaut que [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] utilise pour gérer les messages entrants.</span><span class="sxs-lookup"><span data-stu-id="a958f-105">XPath processing differs from the default method that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses to handle incoming messages.</span></span> <span data-ttu-id="a958f-106">Dans la méthode par défaut, l’adaptateur obtient le contenu entier de la **corps** élément de la [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] de message, puis l’envoie à la base de données MessageBox de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="a958f-106">In the default method, the adapter obtains the entire contents of the **Body** element of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message, and then submits it to the BizTalk MessageBox database.</span></span> <span data-ttu-id="a958f-107">Le traitement de message XPath extrait des éléments spécifiques d'un message [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] entrant pour créer un message BizTalk personnalisé.</span><span class="sxs-lookup"><span data-stu-id="a958f-107">XPath message processing extracts specific parts of an incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message to create a custom BizTalk message.</span></span> <span data-ttu-id="a958f-108">Dans cet exemple, le traitement XPath localise un élément XML nommé **SendPicture** en entrant [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message (qui est au format XML).</span><span class="sxs-lookup"><span data-stu-id="a958f-108">In this sample XPath processing locates an XML element named **SendPicture** in the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message (which is in XML format).</span></span> <span data-ttu-id="a958f-109">Après avoir trouvé cet élément, XPath en extrait la valeur sous forme d'objet Base64 codé en binaire, puis place cette valeur binaire dans un message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="a958f-109">After finding that element, XPath extracts the element's value as a binary Base64 encoded object, and places that binary value into a BizTalk message.</span></span> <span data-ttu-id="a958f-110">Le message est publié dans la base de données MessageBox, puis transféré vers un port d'envoi FILE à l'aide d'un abonnement de filtre de port d'envoi.</span><span class="sxs-lookup"><span data-stu-id="a958f-110">The message is published to the MessageBox database, then output to a FILE send port with the help of a send port filter subscription.</span></span> <span data-ttu-id="a958f-111">Cet exemple n'utilise aucune orchestration. Tout le traitement est effectué via la messagerie BizTalk à l'aide de XPath.</span><span class="sxs-lookup"><span data-stu-id="a958f-111">No orchestrations are used in this sample, and all the processing is done through BizTalk messaging using XPath.</span></span>  
  
 <span data-ttu-id="a958f-112">Un adaptateur [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] est utilisé pour communiquer avec les clients [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] et les services à distance [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] à partir de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-112">A [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapter is used to communicate with [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] clients and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] remote services from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  <span data-ttu-id="a958f-113">Il permet la publication d'orchestrations et de schémas en tant que services [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)], et offre à une orchestration la possibilité d'utiliser des services WCF externes.</span><span class="sxs-lookup"><span data-stu-id="a958f-113">It allows orchestrations and schemas to be published as [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services, and also provides the ability for an orchestration to consume external WCF services.</span></span> <span data-ttu-id="a958f-114">L’adaptateur WCF-NetTcp utilise la **NetTcpBinding** liaison, ce qui signifie que le transport TCP à l’aide d’un encodage de message binaire optimisé.</span><span class="sxs-lookup"><span data-stu-id="a958f-114">The WCF-NetTcp adapter uses the **NetTcpBinding** binding, which means the TCP transport using an optimized binary message encoding.</span></span> <span data-ttu-id="a958f-115">L'adaptateur WCF-NetTcp consiste en un adaptateur d'envoi et un adaptateur de réception.</span><span class="sxs-lookup"><span data-stu-id="a958f-115">The WCF-NetTcp adapter consists of both a send adapter and a receive adapter.</span></span> <span data-ttu-id="a958f-116">Il fournit un accès total aux fonctionnalités de sécurité, de fiabilité et de transaction SOAP.</span><span class="sxs-lookup"><span data-stu-id="a958f-116">It provides full access to SOAP security, reliability, and transaction features.</span></span>  
  
 <span data-ttu-id="a958f-117">Une fois cette procédure pas à pas terminée, vous saurez comment effectuer les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="a958f-117">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="a958f-118">À l'aide de la console Administration de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], importer un fichier MSI pour créer un port d'envoi, un port de réception et un emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="a958f-118">By using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, import an MSI file to create a send port, a receive port, and a receive location.</span></span>  
  
-   <span data-ttu-id="a958f-119">À l’aide de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration de la console, configurez un [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] emplacement de réception pour exécuter une instruction XPath pour extraire les données à partir de la **SendPicture** élément de la [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span><span class="sxs-lookup"><span data-stu-id="a958f-119">By using the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive location to run an XPath statement to extract data from the **SendPicture** element of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a958f-120">Le **hosttrusted** élément spécifie si l’hôte associé au Gestionnaire de réception est approuvé.</span><span class="sxs-lookup"><span data-stu-id="a958f-120">The **hosttrusted** element specifies whether the host associated with the receive handler is trusted.</span></span> <span data-ttu-id="a958f-121">Dans le fichier bindings.xml, il est défini sur son paramètre par défaut, `false`, parce que, dans cet exemple, nous ne nous préoccupons pas du service d''authentification unique de l'entreprise (SSO) de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-121">In the bindings.xml file, it is set to its default setting of `false` because in this sample we don't care about the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Enterprise Single Sign-On service (SSO).</span></span> <span data-ttu-id="a958f-122">Ce dernier permet la transmission d'informations d'identification utilisateur par le biais de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] pour l'intégration d'applications de tierce partie avec [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-122">SSO allows the passing of user credentials through [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to integrate third-party applications with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="a958f-123">Un paramètre `false` empêche le transit d'un message BizTalk via le service BizTalk dans le cadre du traitement d'authentification unique.</span><span class="sxs-lookup"><span data-stu-id="a958f-123">A `false` setting prevents a BizTalk message from passing through the BizTalk service as part of the SSO processing.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="a958f-124">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="a958f-124">Prerequisites</span></span>  
 <span data-ttu-id="a958f-125">Pour exécuter la procédure décrite dans cet exemple, assurez-vous que votre environnement installe les composants requis suivants :</span><span class="sxs-lookup"><span data-stu-id="a958f-125">To perform the steps in this sample ensure that your environment installs the following prerequisites;</span></span>  
  
-   <span data-ttu-id="a958f-126">L’ordinateur qui génère les assemblys et exécute le processus de déploiement et l’ordinateur qui exécute l’exemple, requièrent Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]et Microsoft BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="a958f-126">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft BizTalk Server.</span></span>  
  
-   <span data-ttu-id="a958f-127">L’ordinateur utilisé pour générer les assemblys et exécuter le processus de déploiement requiert Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="a958f-127">The computer used to build the assemblies and run the deployment process requires Microsoft Visual Studio.</span></span>  
  
-   <span data-ttu-id="a958f-128">L'ordinateur qui exécute l'exemple requiert les adaptateurs [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] et les outils d'administration de [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-128">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="a958f-129">Il s’agit des options d’installation lors de l’installation de Microsoft BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="a958f-129">These are options to install during setup of Microsoft BizTalk Server.</span></span>  
  
-   <span data-ttu-id="a958f-130">Sur les ordinateurs utilisés pour effectuer des tâches d'administration, vous devez exécuter un compte d'utilisateur membre du groupe Administrateurs [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] pour configurer les paramètres d'application de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] à l'intérieur de la console Administration de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-130">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="a958f-131">Ce compte d'utilisateur doit également être membre du groupe Administrateurs local pour le déploiement d'application, la gestion d'instances de l'hôte et d'autres tâches éventuellement requises.</span><span class="sxs-lookup"><span data-stu-id="a958f-131">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  
  
-   <span data-ttu-id="a958f-132">Sur n’importe quel ordinateur qui nécessite [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] fonctionnalité, effectuez la procédure d’installation unique pour le [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] exemples [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span><span class="sxs-lookup"><span data-stu-id="a958f-132">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  
  
-   <span data-ttu-id="a958f-133">Sur l'ordinateur qui exécute l'exemple et importe un fichier .msi dans [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], assurez-vous que l'hôte n'est pas approuvé, sans quoi l'importation échoue.</span><span class="sxs-lookup"><span data-stu-id="a958f-133">On the computer that runs the sample and imports an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  
  
-   <span data-ttu-id="a958f-134">Vous devez télécharger le code de procédure pas à pas et l’extraire sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="a958f-134">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="a958f-135">Cette procédure pas à pas est une partie de l’ensemble du [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] package de la procédure pas à pas de carte.</span><span class="sxs-lookup"><span data-stu-id="a958f-135">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="a958f-136">Vous pouvez télécharger le fichier **WCFAdapterWalkthroughs.exe** à partir de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] centre de développement sur [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span><span class="sxs-lookup"><span data-stu-id="a958f-136">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  
  
### <a name="configure-the-wcfcustommessageprocessing-application-and-artifacts"></a><span data-ttu-id="a958f-137">Configuration de l'application WCFCustomMessageProcessing et d'artefacts</span><span class="sxs-lookup"><span data-stu-id="a958f-137">Configure the WCFCustomMessageProcessing application and artifacts</span></span>  
  
1.  <span data-ttu-id="a958f-138">Dans le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] console d’Administration, avec le bouton droit **Applications**, sélectionnez **importation**, puis sélectionnez **fichier MSI**.</span><span class="sxs-lookup"><span data-stu-id="a958f-138">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **Applications**, select **Import**, and then select **MSI file**.</span></span> <span data-ttu-id="a958f-139">Accédez à la **C:\WCFCustomMessageProcessing\WCFCustomMessageProcessing.msi** de fichiers, puis cliquez sur **ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="a958f-139">Go to the **C:\WCFCustomMessageProcessing\WCFCustomMessageProcessing.msi** file, and then click **Open**.</span></span> <span data-ttu-id="a958f-140">Cela crée les artefacts suivants pour cette application :</span><span class="sxs-lookup"><span data-stu-id="a958f-140">This creates the following artifacts for this application:</span></span>  
  
    -   <span data-ttu-id="a958f-141">**FileSP** port d’envoi : l’emplacement sur le système de fichiers local **C:\WCFCustomMessageProcessing\Out** où les données d’image JPEG sont envoyées par [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] en tant que la sortie finale de l’exemple de traitement.</span><span class="sxs-lookup"><span data-stu-id="a958f-141">**FileSP** send port: The location on the local file system of **C:\WCFCustomMessageProcessing\Out** where the JPEG image data is sent by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as the final output of the sample processing.</span></span> <span data-ttu-id="a958f-142">Vous pouvez afficher le filtre de port d’envoi **BTS. RecievePortName = NetTcpRP** configuré dans le **FileSP Properties** boîte de dialogue sous **filtres**.</span><span class="sxs-lookup"><span data-stu-id="a958f-142">You can view the send port filter of **BTS.RecievePortName = NetTcpRP** configured in the **FileSP Properties** dialog box under **Filters**.</span></span> <span data-ttu-id="a958f-143">Le filtre est associé au port de réception NetTcp.</span><span class="sxs-lookup"><span data-stu-id="a958f-143">The filter is associated with the NetTcp receive port.</span></span> <span data-ttu-id="a958f-144">Emplacement de sortie du port d’envoi tout message accepté sur NetTcpRP port de réception est envoyé à la FileSP **C:\WCFCustomMessageProcessing\Out** après le traitement XPath sur le message de l’exécution de l’emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="a958f-144">Any messages accepted on the NetTcpRP receive port will be sent to the FileSP send port output location of **C:\WCFCustomMessageProcessing\Out** after the receive location executes the XPath processing on the message.</span></span>  
  
    -   <span data-ttu-id="a958f-145">**NetTcpRP** port de réception : le port qui contient logiquement le **NetTcpRL** emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="a958f-145">**NetTcpRP** receive port: The port that logically contains the **NetTcpRL** receive location.</span></span>  
  
    -   <span data-ttu-id="a958f-146">**NetTcpRL** emplacement de réception : il utilise la valeur par défaut **PassThroughTransmit** données entrant d’image de pipeline et l’adaptateur WCF-NetTcp pour exécuter une instruction XPath pour extraire l’image JPEG [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span><span class="sxs-lookup"><span data-stu-id="a958f-146">**NetTcpRL** receive location: This uses the default **PassThroughTransmit** pipeline and the WCF-NetTcp adapter to run an XPath statement to pull the JPEG image data out of the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message.</span></span>  
  
### <a name="alternative-steps-to-configure-the-wcfcustommessageprocessing-application"></a><span data-ttu-id="a958f-147">Autres étapes pour configurer l'application WCFCustomMessageProcessing</span><span class="sxs-lookup"><span data-stu-id="a958f-147">Alternative steps to configure the WCFCustomMessageProcessing application</span></span>  
  
-   <span data-ttu-id="a958f-148">Ou bien, voici la procédure manuelle pour configurer l’application sans utiliser le **C:\WCFCustomMessageProcessing\bindings.xml** fichier.</span><span class="sxs-lookup"><span data-stu-id="a958f-148">Alternatively, here are the manual steps to configure the application without using the **C:\WCFCustomMessageProcessing\bindings.xml** file.</span></span> <span data-ttu-id="a958f-149">Il est inutile de les exécuter si le processus d'importation de fichier de liaison précédent fonctionne correctement.</span><span class="sxs-lookup"><span data-stu-id="a958f-149">You do not need to do this if the previous binding file import process works correctly.</span></span>  <span data-ttu-id="a958f-150">En revanche, la lecture de ces étapes enrichira probablement votre connaissance de l'utilité du fichier MSI.</span><span class="sxs-lookup"><span data-stu-id="a958f-150">But, reading it may increase your knowledge of what is going on with the MSI file.</span></span>  
  
-   <span data-ttu-id="a958f-151">Créer un port de réception unidirectionnel (**NetTcpRP**) et un emplacement de réception (**NetTcpRL**).</span><span class="sxs-lookup"><span data-stu-id="a958f-151">Create a one-way receive port (**NetTcpRP**) and a receive location (**NetTcpRL**).</span></span>  
  
    1.  <span data-ttu-id="a958f-152">Développez le **WCFCustomMessageProcessing** application, avec le bouton droit **Ports de réception**, sélectionnez **nouveau**, puis sélectionnez **Port de réception unidirectionnel**.</span><span class="sxs-lookup"><span data-stu-id="a958f-152">Expand the **WCFCustomMessageProcessing** application, right-click **Receive Ports**, select **New**, and select **One-way Receive Port**.</span></span> <span data-ttu-id="a958f-153">Dans le **propriétés du Port de réception** boîte de dialogue, entrez `NetTcpRP` pour **nom**, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a958f-153">In the **Receive Port Properties** dialog box, enter `NetTcpRP` for **Name**, and click **OK**.</span></span>  
  
    2.  <span data-ttu-id="a958f-154">Avec le bouton droit le **NetTcpRP** port de réception, sélectionnez **nouveau**, puis sélectionnez **un emplacement de réception**.</span><span class="sxs-lookup"><span data-stu-id="a958f-154">Right-click the **NetTcpRP** receive port, select **New**, and select **Receive Location**.</span></span> <span data-ttu-id="a958f-155">Dans le **propriétés de l’emplacement de réception** boîte de dialogue, entrez `NetTcRL` pour **nom**.</span><span class="sxs-lookup"><span data-stu-id="a958f-155">In the **Receive Location Properties** dialog box, enter `NetTcRL` for **Name**.</span></span> <span data-ttu-id="a958f-156">Dans le **Transport** , cliquez sur le **Type** zone de liste déroulante, sélectionnez **WCF-NetTcp** dans la liste déroulante, puis cliquez sur **configurer**.</span><span class="sxs-lookup"><span data-stu-id="a958f-156">In the **Transport** section, click the **Type** drop-down list box, select **WCF-NetTcp** from the drop-down list, and then click **Configure**.</span></span>  
  
    3.  <span data-ttu-id="a958f-157">Sur le **général** , entrez **NET.TCP://localhost/nettcprl/image** dans les **adresse (URI)** champ.</span><span class="sxs-lookup"><span data-stu-id="a958f-157">On the **General** tab, enter **net.tcp://localhost/NetTcpRL/Image** in the **Address(URI)** field.</span></span>  
  
    4.  <span data-ttu-id="a958f-158">Sur le **sécurité** onglet, définissez la **mode de sécurité** à **None.**</span><span class="sxs-lookup"><span data-stu-id="a958f-158">On the **Security** tab, set the **Security mode** to **None.**</span></span>  
  
    5.  <span data-ttu-id="a958f-159">Sur le **Message** onglet, sélectionnez le **chemin d’accès** est définie sur le **le corps du message BizTalk entrant**et entrez `/*[local-name()="SendPicture" and namespace-uri()='http://tempuri.org/']/*[local-name()="stream"]` pour l’expression de chemin de corps.</span><span class="sxs-lookup"><span data-stu-id="a958f-159">On the **Message** tab, select the **Path** option for the **Inbound BizTalk message body**, and enter `/*[local-name()="SendPicture" and namespace-uri()='http://tempuri.org/']/*[local-name()="stream"]` for the body path expression.</span></span> <span data-ttu-id="a958f-160">Sélectionnez **Base64** comme le **codage de nœud**.</span><span class="sxs-lookup"><span data-stu-id="a958f-160">Select **Base64** as the **Node Encoding**.</span></span> <span data-ttu-id="a958f-161">Le **chemin d’accès** option est définie sur la valeur, car le corps de la [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] reçoit est au format suivant :  **\<SendPicture xmlns = « http://tempuri.org/ »\> \<flux\>*réel base 64 encodé des données image binaires*\</stream\>\</SendPicture\>**</span><span class="sxs-lookup"><span data-stu-id="a958f-161">The **Path** option is set to value because the body of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives is in the following format: **\<SendPicture xmlns="http://tempuri.org/"\>\<stream\>*actual base 64 encoded binary image data*\</stream\>\</SendPicture\>**</span></span>  
  
    6.  <span data-ttu-id="a958f-162">Dans le **propriétés de l’emplacement de réception** boîte de dialogue, cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a958f-162">In the **Receive Location Properties** dialog box, click **OK**.</span></span>  
  
-   <span data-ttu-id="a958f-163">Créez un port d'envoi de fichier unidirectionnel (FileSP) abonné au port de réception NetTcpRP.</span><span class="sxs-lookup"><span data-stu-id="a958f-163">Create a one-way file send port (FileSP) subscribed to the NetTcpRP receive port.</span></span>  
  
    1.  <span data-ttu-id="a958f-164">Avec le bouton droit **Ports d’envoi**, sélectionnez **nouveau**, puis sélectionnez **Port de réception unidirectionnel**.</span><span class="sxs-lookup"><span data-stu-id="a958f-164">Right-click **Send Ports**, select **New**, and select **One-way Receive Port**.</span></span> <span data-ttu-id="a958f-165">Sélectionnez **Port statique unidirectionnel**.</span><span class="sxs-lookup"><span data-stu-id="a958f-165">Select **Static One-way Port**.</span></span> <span data-ttu-id="a958f-166">Entrez `FileSP` pour **nom**.</span><span class="sxs-lookup"><span data-stu-id="a958f-166">Enter `FileSP` for **Name**.</span></span>  
  
    2.  <span data-ttu-id="a958f-167">Dans le **Transport** , cliquez sur le **Type** zone de liste déroulante, sélectionnez **fichier** dans la liste déroulante, puis cliquez sur **configurer**.</span><span class="sxs-lookup"><span data-stu-id="a958f-167">In the **Transport** section, click the **Type** drop-down list box, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    3.  <span data-ttu-id="a958f-168">Sous **dossier de Destination** entrez `C:\WCFCustomMessageProcessing\Out`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="a958f-168">Under **Destination Folder** enter `C:\WCFCustomMessageProcessing\Out`, and click **OK**.</span></span>  
  
    4.  <span data-ttu-id="a958f-169">Cliquez sur **filtres**, sélectionnez `BTS.ReceivePortName == NetTcpRP`, puis cliquez sur **OK.**</span><span class="sxs-lookup"><span data-stu-id="a958f-169">Click **Filters**, select `BTS.ReceivePortName == NetTcpRP`, and then click **OK.**</span></span>  
  
### <a name="configure-the-send-port-and-run-the-application"></a><span data-ttu-id="a958f-170">Configuration du port d'envoi et exécution de l'application</span><span class="sxs-lookup"><span data-stu-id="a958f-170">Configure the send port and run the application</span></span>  
  
1.  <span data-ttu-id="a958f-171">Cliquez sur le **WCFCustomMessageProcessing** application et sélectionnez **Démarrer**.</span><span class="sxs-lookup"><span data-stu-id="a958f-171">Right-click the **WCFCustomMessageProcessing** application and select **Start**.</span></span> <span data-ttu-id="a958f-172">Cela a pour effet d'inscrire l'emplacement de réception NetTcpRL et de démarrer le port d'envoi FileSP.</span><span class="sxs-lookup"><span data-stu-id="a958f-172">That will enlist the NetTcpRL receive location and start the FileSP send port.</span></span>  
  
2.  <span data-ttu-id="a958f-173">Dans [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], ouvrez le `Client.sln` de fichiers à partir de la **c : wcfcustommessageprocessing\client** dossier.</span><span class="sxs-lookup"><span data-stu-id="a958f-173">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], open up the `Client.sln` file from the **C:WCFCustomMessageProcessing\Client** folder.</span></span> <span data-ttu-id="a958f-174">Dans l’Explorateur de solutions, cliquez sur le **Client** de projet et sélectionnez **Build**.</span><span class="sxs-lookup"><span data-stu-id="a958f-174">In Solution Explorer, right-click the **Client** project and select **Build**.</span></span>  
  
3.  <span data-ttu-id="a958f-175">Dans [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], sélectionnez **déboguer**, puis sélectionnez **démarrer sans débogage** pour exécuter l’application Client.exe.</span><span class="sxs-lookup"><span data-stu-id="a958f-175">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], select **Debug**, and then select **Start Without Debugging** to run the Client.exe application.</span></span> <span data-ttu-id="a958f-176">Une invite de commandes s'affiche, indiquant que l'image a été soumise à [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a958f-176">A command prompt will appear saying the image was submitted to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
4.  <span data-ttu-id="a958f-177">Observez la sortie du fichier {GUID} .jpg réussie dans le dossier de fichiers de port envoi de **C:\WCFCustomMessageProcessing\Out**. Celle-ci indique que le traitement d'application pour extraire le fichier JPEG et l'écrire dans un port d'envoi FILE a réussi.</span><span class="sxs-lookup"><span data-stu-id="a958f-177">Observe the successful {GUID}.jpg file output to the send port file folder of **C:\WCFCustomMessageProcessing\Out**. This shows that the application processing to extract the JPEG file and write it out to a FILE send port completed successfully.</span></span>