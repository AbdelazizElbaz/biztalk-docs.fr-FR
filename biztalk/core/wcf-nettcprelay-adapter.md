---
title: Adaptateur WCF-NetTcpRelay | Documents Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 7f6c6afc-6aa9-4962-91e6-1fcd92744534
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1c8ca33c5568d7a36777e8ed08adea70f476a80f
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/28/2017
---
# <a name="wcf-nettcprelay-adapter"></a>Adaptateur WCF-NetTcpRelay
Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] utilise le **WCF-NetTcpRelay** adaptateur pour recevoir et envoyer des demandes de service WCF via le [NetTcpRelayBinding classe](https://msdn.microsoft.com/library/azure/microsoft.servicebus.nettcprelaybinding.aspx).  

Cette rubrique répertorie les étapes pour configurer un **WCF-NetTcpRelay** emplacement de réception et à l’aide du port d’envoi du [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Console d’Administration.  

## <a name="before-you-begin"></a>Avant de commencer

En commençant par [!INCLUDE[bts2016_md](../includes/bts2016-md.md)], cet adaptateur peut utiliser Access Control Service (ACS) ou la Signature d’accès partagé (SAS) pour athenticate avec Service Bus. Nous recommandons à l’aide de la Signature d’accès partagé (SAS) lors de l’authentification avec Service Bus. 

Lorsque vous créez un espace de noms Service Bus, l’espace de noms Access Control (ACS) n’est pas créé automatiquement. Si vous utilisez des services ACS pour l’authentification, vous devez créer un nouvel espace de noms ACS. Consultez [adaptateur SB-Messaging](../core/sb-messaging-adapter.md) pour plus d’informations, y compris les étapes pour récupérer les valeurs de clé des services ACS.
  
## <a name="create-the-receive-location"></a>Pour créer un emplacement de réception
 
> [!NOTE]
>  Avant d’exécuter la procédure suivante, vous devez avoir déjà ajouté un unidirectionnel port de réception. Consultez [la création d’un Port de réception](../core/how-to-create-a-receive-port.md).  
  
1.  Dans la console Administration de BizTalk, développez **Administration de BizTalk Server**, développez **groupe BizTalk**, développez **Applications**, puis développez l’application vous vous souhaitez créer un emplacement de réception.  
  
2.  Dans le volet gauche de la console Administration de BizTalk, cliquez sur le nœud **Port de réception** . Dans le volet droit, cliquez avec le bouton droit sur le port de réception associé à un emplacement de réception existant ou auquel associer un nouvel emplacement, puis cliquez sur **Propriétés**.  
  
3.  Dans le volet gauche de la boîte de dialogue **Propriétés des ports de réception** , sélectionnez **Emplacements de réception**, puis dans le volet droit, double-cliquez sur un emplacement de réception existant ou cliquez sur **Nouveau** pour créer un emplacement de réception.  
  
4.  Dans la liste déroulante **Type** de la section **Transport** de la boîte de dialogue **Propriétés de l'emplacement de réception** , sélectionnez **WCF-NetTcpRelay** , puis cliquez sur **Configurer** pour configurer les propriétés de transport de l'emplacement de réception.  
  
5.  Sous l'onglet **Général** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , configurez l'adresse et l'identité du point de terminaison de l'emplacement de réception WCF-NetTcpRelay.  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Adresse (URI)**|Obligatoire. Indiquer l'adresse URI complète de cet emplacement de réception. En règle générale, l'URI est au format suivant :<br /><br /> `sb://<Namespace>.servicebus.windows.net/`|  
    |**Identité du point de terminaison**|Ce paramètre est facultatif. Spécifier l'identité du point de terminaison. Ces paramètres permettent au point de terminaison d'authentifier cet emplacement de réception. Lors du processus d'établissement de liaison entre le point de terminaison et l'emplacement de réception, l'infrastructure WCF (Windows Communication Foundation) garantit que l'identité du point de terminaison correspond aux valeurs de cet élément.<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est une chaîne vide.|  
  
6.  Sous l'onglet **Liaison** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , configurez le délai d'expiration et les propriétés de transaction.  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Ouvrez le délai d’attente (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération d'ouverture de canal soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Envoyer le délai d’attente (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération d'envoi soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**. En cas d'utilisation d'un port de réception de requête-réponse, cette valeur indique une période pour la réalisation de l'intégralité de l'interaction, même si le client renvoie un message volumineux.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Délai d’attente Close (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération de fermeture de canal soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Taille maximale des messages reçus (octets)**|Indiquer la taille maximale en octets d'un message comprenant des en-têtes et pouvant être reçu sur le câble. La taille des messages est limitée par la quantité de mémoire allouée pour chacun d'eux. Vous pouvez vous servir de cette propriété afin de limiter les expositions aux attaques de type refus de service.<br /><br /> L’adaptateur WCF-NetTcpRelay tire parti du [NetTcpRelayBinding](https://msdn.microsoft.com/library/azure/microsoft.servicebus.nettcprelaybinding.aspx) classe dans le mode de transfert mis en mémoire tampon pour communiquer avec un point de terminaison. Pour le mode de transport de mise en mémoire tampon, la [NetTcpRelayBindingBase.MaxBufferSize](https://msdn.microsoft.com/library/azure/microsoft.servicebus.nettcprelaybindingbase.maxbuffersize.aspx) propriété est toujours égale à la valeur de cette propriété.<br /><br /> Valeur par défaut : 65536<br /><br /> Valeur maximale : 2147483647|  
    |**Nombre maximal d’appels simultané**|Spécifier le nombre d'appels simultanés par instance de service unique. Les appels excédentaires sont mis en file d'attente. La définition de cette valeur sur 0 équivaut à la définir sur **Int32.MaxValue**.<br /><br /> Valeur par défaut : 200|  
  
7.  Sous l'onglet **Sécurité** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , définissez les fonctionnalités de sécurité de l'emplacement de réception WCF-NetTcpRelay.  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Mode de sécurité**|Spécifier le type de sécurité utilisé. Les valeurs valides sont les suivantes :<br /><br /> -                          **Aucun**: les Messages ne sont pas sécurisés pendant le transfert.<br /><br /> - **Transport**: sécurité du Transport est assurée à l’aide de **TLS sur TCP** ou **SPNego**. Il est possible de contrôler le niveau de protection avec ce mode. Si la propriété **Type d'informations d'identification du client du transport** est définie sur **Aucun** ou sur **Certificat** dans ce mode de sécurité, vous devez fournir le certificat de service de cet emplacement de réception par le biais de la propriété **Certificat de service - Empreinte** .<br /><br /> - **Message**: la sécurité est fournie à l’aide de la sécurité des messages SOAP. Par défaut, l'élément SOAP **Body** est chiffré et signé. Ce mode offre un grand nombre de fonctions, telles que la disponibilité des informations d'identification du service au niveau du client hors bande, et la suite d'algorithme à utiliser. Si la propriété **Type d'informations d'identification du client du message**est définie sur **Aucun**, **Certificat** ou **Nom d'utilisateur** dans ce mode de sécurité, vous devez fournir le certificat de service de cet emplacement de réception via la propriété **Certificat de service - Empreinte** .<br /><br /> -                          **TransportWithMessageCredential**: sécurité de Transport est associée à la sécurité des messages. La sécurité du transport est assurée par le biais de **TLS sur TCP** ou **SPNego** . Elle garantit l'intégrité, la confidentialité et l'authentification du serveur. Si la propriété **Type d'informations d'identification du client du message**est définie sur **Windows**, **Certificat** ou **Nom d'utilisateur** dans ce mode de sécurité, vous devez fournir le certificat de service de cet emplacement de réception via la propriété **Certificat de service - Empreinte** .<br /><br /> **Remarque :** ce mode de sécurité ne peut pas être utilisé avec le **type d’informations d’identification du client du Transport** propriété, **aucun**.<br /><br /> La valeur par défaut est **Transport**.|  
    |**Niveau de protection de transport**|Définir la sécurité au niveau du transport TCP. La signature des messages limite le risque qu'un tiers puisse falsifier le message pendant son transfert. Le chiffrement garantit la confidentialité des données pendant le transport. Les valeurs valides sont les suivantes :<br /><br /> -                          **Aucun**: aucune protection.<br /><br /> - **Signe**: les Messages sont signés.<br /><br /> - **EncryptAndSign**: les Messages sont chiffrés et signés.<br /><br /> La valeur par défaut est **EncryptAndSign**.|  
    |**Type d’informations d’identification client du message**|Spécifier le type d'informations d'identification à utiliser lors de l'authentification du client à l'aide de la sécurité basée sur le message. Cette opération est requise uniquement si le **mode de sécurité** est défini sur **Message** ou **TransportWithMessageCredential**. Les valeurs valides sont les suivantes :<br /><br /> -                          **Aucun**: Cela permet au service d’interagir avec les clients anonymes. Cela signifie que ce client ne fournit aucune information d'identification.<br /><br /> - **Windows**: autorise les échanges SOAP d’être dans le contexte authentifié d’informations d’identification Windows. Les informations d'identification du client sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security Kerberos Token Profile 1.0** . Vous devez créer les comptes d'utilisateur de domaine ou locaux correspondant aux informations d'identification du client. En outre, l'élément **userPrincipalName** du client doit être configuré avec le nom de compte d'utilisateur exécutant ce gestionnaire de réception.<br /><br /> - **Nom d’utilisateur**: les Clients sont authentifiés sur cet emplacement de réception avec un **nom d’utilisateur** informations d’identification. Les informations d'identification sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security UsernameToken Profile 1.0** . Vous devez créer les comptes d'utilisateur de domaine ou locaux correspondant aux informations d'identification du client.<br /><br /> -**Certificat**: les Clients sont authentifiés sur cet emplacement à l’aide du certificat client spécifié par le biais de réception le **certificat de Service - empreinte** propriété. Les informations d'identification sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security X509 Token Profile 1.0** . Pour authentifier les certificats client, la chaîne de certificat de l'autorité de certification des certificats du client doit être installée dans le magasin de certificats des autorités de certification racines de confiance de cet ordinateur. De plus, vous devez fournir le certificat de service pour cet emplacement via la propriété **Certificat de service - Empreinte** .<br /><br /> La valeur par défaut est **Windows**.|  
    |**Suite algorithmique**|Spécifier les algorithmes de chiffrement et Key Wrap du message. Ces algorithmes sont associés à ceux définis dans la spécification Security Policy Language (WS-SecurityPolicy). Les valeurs possibles sont :<br /><br /> -                          **Basic128**: utiliser le chiffrement Aes128, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic128Rsa15**: utiliser le Aes128 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> -                          **Basic128Sha256**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic128Sha256Rsa15**: utiliser le Aes128 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic192**: utiliser le chiffrement Aes192, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **Basic192Rsa15**: utiliser le Aes192 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> -                          **Basic192Sha256**: utiliser le Aes192 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic192Sha256Rsa15**: utiliser le Aes192 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic256**: utiliser le chiffrement Aes256, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic256Rsa15**: utiliser le Aes256 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic256Sha256**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **Basic256Sha256Rsa15**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **TripleDes**: utiliser le chiffrement TripleDes, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **TripleDesRsa15**: utiliser le chiffrement TripleDes, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **TripleDesSha256**: utiliser le TripleDes pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **TripleDesSha256Rsa15**: utiliser le TripleDes pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> La valeur par défaut est **Basic256**.|  
    |**Service - empreinte numérique du certificat**|Spécifier l'empreinte du certificat X.509 pour cet emplacement de réception permettant au client d'authentifier le service. Pour sélectionner l'empreinte, accédez au magasin **Personnel** dans l'emplacement **Utilisateur actuel** à l'aide du bouton **Parcourir** .<br /><br /> **Remarque :** vous devez installer le certificat de service dans le **utilisateur actuel** emplacement du compte d’utilisateur du Gestionnaire de réception hébergeant cet emplacement de réception.<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 40<br /><br /> La valeur par défaut est une chaîne vide.|  
    |**Type d’authentification du client relais**|Spécifier l'option permettant de s'authentifier auprès du point de terminaison de relais de Service Bus à partir duquel le message est reçu. Les valeurs valides sont les suivantes :<br /><br /> -                          **Aucun**: aucune authentification n’est requise.<br /><br /> -                          **RelayAccessToken**: spécifiez cette option pour utiliser un jeton de sécurité pour autoriser avec le point de terminaison de relais Service Bus.<br /><br /> La valeur par défaut est **RelayAccessToken**.|  
    |**Activer la découverte de service**|Activer cette case à cocher pour indiquer si le comportement du service est publié dans le Registre du service.<br /><br /> -                          **Nom d’affichage** – spécifiez le nom sous lequel le service est publié dans le Registre de Service.<br /><br /> - **Mode de découverte** : définir le mode de découverte pour le service publié dans le Registre de Service. Pour plus d’informations sur les modes de détection, consultez [https://msdn.microsoft.com/library/microsoft.servicebus.discoverytype.aspx](https://msdn.microsoft.com/library/microsoft.servicebus.discoverytype.aspx).|  
    |**Service de contrôle d’accès**|S’applique aux [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] et [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] 2013.<br/><br/>Si vous définissez **Type d'authentification du client relais** sur **RelayAccessToken**, cliquez sur le bouton **Modifier** et spécifiez les informations suivantes :<br /><br /> - **Uri STS du Service de contrôle d’accès** – définissez cette propriété sur `https://<Namespace>-sb.accesscontrol.windows.net/`, où \<espace de noms\> est votre espace de noms Service Bus.<br /><br /> - **Nom de l’émetteur** – spécifiez le nom de l’émetteur. Généralement, il s'agit du propriétaire.<br /><br /> - **Clé de l’émetteur** – spécifiez la clé de l’émetteur.<br /><br /> |  
        |**Informations de connexion de service Bus** | Nouveau commençant par [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].<br/><br/>Choisir d’utiliser la Signature d’accès partagé (SAS) ou le Service Access Control (ACS) de l’espace de noms Service Bus. <br/><br/>Sélectionnez une option, puis **modifier** pour entrer les informations de clé :<br/><br/> - **Signature d’accès partagé** : entrez le nom de clé d’accès et la clé d’accès. Les deux valeurs sont répertoriées dans le [portail Azure](https://portal.azure.com).<br/> - **Le Service de contrôle d’accès** : entrez l’URI STS (`https://<yourNamespace>-sb.accesscontrol.windows.net/`), nom de l’émetteur et la clé de l’émetteur. Utilisation de Windows PowerShell pour extraire ces valeurs, comme décrit dans [adaptateur SB-Messaging](../core/sb-messaging-adapter.md). |
  
8.  Sous l'onglet **Messages** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , spécifiez la sélection de données pour l'élément SOAP **Body** .  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**: Enveloppe \<soap : Envelope\>**|Créer le corps du message BizTalk à partir de la totalité de l' **enveloppe** SOAP d'un message entrant.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Corps : contenu de \<soap : Body\> élément**|Utiliser le contenu de l'élément SOAP **Body** d'un message entrant pour créer le corps du message BizTalk. Si l'élément **Body** a plusieurs éléments enfants, seul le premier élément devient le corps du message BizTalk.<br /><br /> Il s'agit du paramètre par défaut.|  
    |**Chemin--contenu localisé par le chemin du corps**|Utiliser l'expression de chemin de corps de la zone de texte **Expression du chemin du corps** pour créer le corps du message BizTalk. L'expression du chemin du corps est évaluée en fonction de l'élément enfant immédiat de l'élément SOAP **Body** d'un message entrant.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Expression de chemin de corps**|Taper l'expression de chemin de corps afin d'identifier une partie spécifique du message entrant utilisée pour créer le corps du message BizTalk. Cette expression de chemin de corps est évaluée en fonction de l'élément enfant immédiat de l'élément SOAP **Body** d'un message entrant. Si cette expression de chemin de corps retourne plusieurs nœuds, seul le premier devient le corps du message BizTalk. Cette propriété est requise si l'option **Chemin -- contenu localisé par le chemin du corps** est sélectionnée.<br /><br /> Type : Chaîne<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est une chaîne vide.|  
    |**Codage de nœud**|Spécifier le type de codage utilisé par l'adaptateur de réception WCF-NetTcpRelay pour décoder le nœud identifié par l'expression de chemin de corps de la zone de texte **Expression du chemin du corps** . Cette propriété est requise si l'option **Chemin -- contenu localisé par le chemin du corps** est sélectionnée. Les valeurs valides sont les suivantes :<br /><br /> - **Base64**: codage Base64.<br /><br /> - **Hex**: codage hexadécimal.<br /><br /> -                          **Chaîne**: codage de texte - UTF-8<br /><br /> -                          **XML**: les adaptateurs WCF créent le corps du message BizTalk avec le XML externe du nœud sélectionné par l’expression de chemin d’accès au corps de la **expression de chemin de corps** zone de texte.<br /><br /> La valeur par défaut est **XML**.|  
    |**Corps : Corps du message de réponse de BizTalk**|Utiliser le corps du message BizTalk pour créer le contenu de l'élément SOAP **Body** d'un message de réponse sortant. Cette propriété est valide uniquement pour des emplacements de réception de type requête-réponse.<br /><br /> Il s'agit du paramètre par défaut.|  
    |**Modèle--contenu spécifié par le modèle**|Utiliser le modèle fourni dans la zone de texte **XML** pour créer le contenu de l'élément SOAP **Body** d'un message sortant. Cette propriété est valide uniquement pour des emplacements de réception de type requête-réponse.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**XML**|Indiquer le modèle XML du contenu de l'élément SOAP **Body** d'un message sortant. Cette propriété est requise si l'option **Corps -- corps du message de réponse BizTalk** est activée. Cette propriété est valide uniquement pour des emplacements de réception de type requête-réponse.<br /><br /> Type : Chaîne<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est  **\<bts-msg-body xmlns = « http://www.microsoft.com/schemas/bts2007 » encoding = « xml »\>**.|
    |**Suspendre le message de demande en cas d’échec**|Spécifier s'il faut interrompre le message de requête dont le traitement entrant a échoué en raison d'une erreur de pipeline de réception ou d'un échec de routage.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Inclure les détails de l’exception dans les erreurs**|Spécifier s'il faut retourner des messages d'erreur SOAP en cas d'échec afin de faciliter le débogage.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
  
9. Cliquez sur **OK**.  
  
10. Entrez les valeurs appropriées dans la boîte de dialogue **Propriétés de l'emplacement de réception** pour terminer la configuration de l'emplacement de réception, puis cliquez sur **OK** pour enregistrer les paramètres. Pour plus d’informations sur la **propriétés des emplacements de réception** boîte de dialogue, consultez [la création d’un emplacement de réception](../core/how-to-create-a-receive-location.md). 
  
## <a name="create-the-send-port"></a>Pour créer un port d'envoi
  
1.  Dans la console Administration de BizTalk, créez un port d'envoi ou double-cliquez sur un port d'envoi existant pour le modifier. Pour plus d’informations, consultez [la création d’un Port d’envoi](../core/how-to-create-a-send-port2.md). Configurez toutes les options de port d’envoi et spécifiez **WCF-NetTcpRelay** pour le **Type** option dans le **Transport** section de la **général**onglet.  
  
2.  Sur le **général** sous l’onglet du **Transport** , cliquez sur le **configurer** bouton.  
  
3.  Dans le **propriétés du Transport WCF-NetTcpRelay** boîte de dialogue le **général** onglet, spécifiez les éléments suivants :  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Adresse (URI)**|Obligatoire. Spécifier l’URI complet pour le port d’envoi. En règle générale, l'URI est au format suivant :<br /><br /> `sb://<Namespace>.servicebus.windows.net/`<br /><br /> Longueur maximale : 255<br /><br /> Valeur par défaut : net.tcp://localhost/|  
    |**Identité du point de terminaison**|Ce paramètre est facultatif. Spécifier l’identité du point de terminaison auquel ce port d’envoi envoie le message. Ces paramètres permettent au port d’envoi d’authentifier le point de terminaison. Lors du processus de négociation entre le port d’envoi et de point de terminaison, l’infrastructure Windows Communication Foundation (WCF) garantit que l’identité du point de terminaison correspond aux valeurs de cet élément. Les valeurs qui peuvent être spécifiés pour le **identité du point de terminaison** propriété diffèrent en fonction de la configuration de sécurité.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Action**|Spécifiez le **Action SOAP** champ d’en-tête pour les messages sortants. Cette propriété peut également être définie via la propriété de contexte de message **WCF. Action** dans un pipeline ou une orchestration. Vous pouvez spécifier cette valeur de deux manières différentes : le format d’action unique et le format de mappage d’action. Si vous définissez cette propriété dans le format d’action unique, par exemple, http://contoso.com/Svc/Op1-le **SOAPAction** en-tête pour les messages sortants sont toujours défini sur la valeur spécifiée dans cette propriété.<br /><br /> Si vous définissez cette propriété dans le format de mappage d’action, sortant **SOAPAction** en-tête est déterminé par le **BTS. Opération** propriété de contexte. Par exemple, si cette propriété est définie au format XML suivant et le **BTS. Opération** est définie sur Op1, l’adaptateur d’envoi WCF `uses http://contoso.com/Svc/Op1` pour sortant **SOAPAction** en-tête.<br /><br /> `<BtsActionMapping> <Operation Name="Op1" Action="http://contoso.com/Svc/Op1" /> <Operation Name="Op2" Action="http://contoso.com/Svc/Op2" /> </BtsActionMapping>`<br /><br /> Si les messages sortants proviennent d’un port d’orchestration, les instances d’orchestration définir dynamiquement le **BTS. Opération** propriété avec le nom de l’opération du port. Si les messages sortants sont acheminés avec le routage basé sur le contenu, vous pouvez définir le **BTS. Opération** propriété dans les composants de pipeline.<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est une chaîne vide.|  
  
4.  Sous l'onglet **Liaison** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , configurez le délai d'expiration et les propriétés de transaction.  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Ouvrez le délai d’attente (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération d'ouverture de canal soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Envoyer le délai d’attente (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération d'envoi soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**. En cas d’utilisation d’un port d’envoi sollicitation-réponse, cette valeur indique une période pour la réalisation de l’intégralité de l’interaction, même si le service renvoie un message volumineux.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Délai d’attente Close (hh:mmss)**|Spécifier une valeur de période qui indique l'intervalle de temps donné pour qu'une opération de fermeture de canal soit réalisée. Cette valeur doit être supérieure ou égale à la valeur **System.TimeSpan.Zero**.<br /><br /> Valeur par défaut : 00:01:00<br /><br /> Valeur maximale :  23:59:59|  
    |**Taille maximale des messages reçus (octets)**|Indiquer la taille maximale en octets d'un message comprenant des en-têtes et pouvant être reçu sur le câble. La taille des messages est limitée par la quantité de mémoire allouée pour chacun d'eux. Vous pouvez vous servir de cette propriété afin de limiter les expositions aux attaques de type refus de service.<br /><br /> L’adaptateur WCF-NetTcpRelay tire parti du [NetTcpRelayBinding](https://msdn.microsoft.com/library/azure/microsoft.servicebus.nettcprelaybinding.aspx) classe dans le mode de transfert mis en mémoire tampon pour communiquer avec un point de terminaison. Pour le mode de transport de mise en mémoire tampon, la [NetTcpRelayBindingBase.MaxBufferSize](https://msdn.microsoft.com/library/azure/microsoft.servicebus.nettcprelaybindingbase.maxbuffersize.aspx) propriété est toujours égale à la valeur de cette propriété.<br /><br /> Valeur par défaut : 65536<br /><br /> Valeur maximale : 2147483647|  
  
5.  Dans le **propriétés du Transport WCF-NetTcpRelay** boîte de dialogue le **sécurité** onglet, définissez les fonctionnalités de sécurité du port d’envoi WCF-NetTcpRelay.  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Mode de sécurité**|Spécifier le type de sécurité utilisé. Les valeurs valides sont les suivantes :<br /><br /> - **Aucun**: les Messages ne sont pas sécurisés pendant le transfert.<br /><br /> - **Transport**: sécurité du Transport est assurée à l’aide de **TLS sur TCP** ou **SPNego**. Il est possible de contrôler le niveau de protection avec ce mode.<br /><br /> -                          **Message**: la sécurité est fournie à l’aide de la sécurité des messages SOAP. Par défaut, l'élément SOAP **Body** est chiffré et signé. Ce mode offre un grand nombre de fonctions, telles que la disponibilité des informations d'identification du service au niveau du client hors bande, et la suite d'algorithme à utiliser.<br /><br /> - **TransportWithMessageCredential**: sécurité de Transport est associée à la sécurité des messages. Sécurité du transport est assurée par **TLS sur TCP**, ou **SPNego**et garantit l’intégrité, la confidentialité et l’authentification du serveur. La sécurité du message SOAP assure l'authentification du client. Pour utiliser ce mode, la chaîne du certificat d'Autorité de certification du certificat X.509 du service doit être installée dans le magasin de certificats des autorités de certification racines de confiance de cet ordinateur afin que le service puisse être authentifié sur le port d'envoi.<br /><br /> **Remarque :** ce mode de sécurité ne peut pas être utilisé avec le **type d’informations d’identification du client du Transport** propriété, **aucun**.<br /><br /> La valeur par défaut est **Transport**.|  
    |**Niveau de protection de transport**|Définir la sécurité au niveau du transport TCP. La signature des messages limite le risque qu'un tiers puisse falsifier le message pendant son transfert. Le chiffrement garantit la confidentialité des données pendant le transport. Les valeurs valides sont les suivantes :<br /><br /> -                          **Aucun**: aucune protection.<br /><br /> - **Signe**: les Messages sont signés.<br /><br /> -                          **EncryptAndSign**: les Messages sont chiffrés et signés.<br /><br /> La valeur par défaut est **EncryptAndSign**.|  
    |**Type d’informations d’identification client du message**|Spécifier le type d'informations d'identification à utiliser lors de l'authentification du client à l'aide de la sécurité basée sur le message. Cette opération est requise uniquement si le **mode de sécurité** est défini sur **Message** ou **TransportWithMessageCredential**. Les valeurs valides sont les suivantes :<br /><br /> - **Aucun**: Cela permet au service d’interagir avec les clients anonymes. Cela signifie que ce port d'envoi ne fournit aucune information d'identification. La chaîne de certificats d’autorité de certification pour le certificat X.509 du service doit être installée dans le magasin de certificats Autorités de Certification racines de confiance de cet ordinateur afin que le service puisse être authentifié au port d’envoi.<br /><br /> -                          **Windows**: autorise les échanges SOAP d’être dans le contexte authentifié d’informations d’identification Windows. Le compte d'utilisateur sous lequel le port d'envoi s'exécute permet aux services d'authentifier ce port d'envoi. Les informations d'identification du client sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security Kerberos Token Profile 1.0** . Vous devez configurer le **nom d’utilisateur principal** propriété le nom de compte d’utilisateur en cours d’exécution du service de destination à l’aide de la **Éditeur d’identités** boîte de dialogue.<br /><br /> - **Nom d’utilisateur**: ce port d’envoi est authentifié auprès des services avec un **nom d’utilisateur** informations d’identification. Les informations d'identification sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security UsernameToken Profile 1.0** . Cette option nécessite de configurer le **informations d’identification Client** propriété. La chaîne de certificats d’autorité de certification pour le certificat X.509 du service doit être installée dans le magasin de certificats Autorités de Certification racines de confiance de cet ordinateur afin que le service puisse être authentifié au port d’envoi.<br /><br /> - **Certificat**: ce port d’envoi est authentifié auprès des services à l’aide du certificat client spécifié via la **certificat Client - empreinte** propriété. Les informations d'identification sont transmises via l'élément d' **en-tête** SOAP à l'aide du protocole **WSS SOAP Message Security X509 Token Profile 1.0** . La chaîne de certificats d’autorité de certification pour le certificat X.509 du service doit être installée dans le magasin de certificats Autorités de Certification racines de confiance de cet ordinateur afin que le service puisse être authentifié au port d’envoi.<br /><br /> La valeur par défaut est **Windows**.|  
    |**Suite algorithmique**|Spécifier les algorithmes de chiffrement et Key Wrap du message. Ces algorithmes sont associés à ceux définis dans la spécification Security Policy Language (WS-SecurityPolicy). Les valeurs possibles sont :<br /><br /> - **Basic128**: utiliser le chiffrement Aes128, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **Basic128Rsa15**: utiliser le Aes128 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> -                          **Basic128Sha256**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic128Sha256Rsa15**: utiliser le Aes128 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic192**: utiliser le chiffrement Aes192, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic192Rsa15**: utiliser le Aes192 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic192Sha256**: utiliser le Aes192 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **Basic192Sha256Rsa15**: utiliser le Aes192 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> -                          **Basic256**: utiliser le chiffrement Aes256, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **Basic256Rsa15**: utiliser le Aes256 pour le chiffrement du message, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **Basic256Sha256**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **Basic256Sha256Rsa15**: utiliser le Aes256 pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> -                          **TripleDes**: utiliser le chiffrement TripleDes, Sha1 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> - **TripleDesRsa15**: utiliser le chiffrement TripleDes, Sha1 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> - **TripleDesSha256**: utiliser le TripleDes pour le chiffrement du message, Sha256 pour le condensat du message et Rsa-oaep-mgf1p pour key wrap.<br /><br /> -                          **TripleDesSha256Rsa15**: utiliser le TripleDes pour le chiffrement du message, Sha256 pour le condensat du message et Rsa15 pour key wrap.<br /><br /> La valeur par défaut est **Basic256**.|  
    |**Client - empreinte numérique du certificat**|Spécifier l'empreinte du certificat X.509 pour l'authentification de ce port d'envoi auprès d'un service. Pour sélectionner l'empreinte, accédez au magasin **Personnel** dans l'emplacement **Utilisateur actuel** à l'aide du bouton **Parcourir** .<br /><br /> **Remarque :** vous devez installer le certificat client dans le **utilisateur actuel** emplacement du compte d’utilisateur pour le Gestionnaire d’envoi hébergeant ce port d’envoi.<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 40<br /><br /> La valeur par défaut est une chaîne vide.|  
    |**Informations d’identification utilisateur**|Spécifiez les informations d’identification pour l’envoi de messages lors de l’utilisation **nom d’utilisateur** pour le **type d’informations d’identification de client de Message** propriété. Vous pouvez spécifier la propriété en cliquant sur le **modifier les informations d’identification** bouton.<br /><br /> La valeur par défaut est **n’utilisez pas l’authentification unique sur**.|  
    |**Utiliser l’identité du service ACS**|S’applique aux [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)] et [!INCLUDE[btsBizTalkServerNoVersion_md](../includes/btsbiztalkservernoversion-md.md)] 2013.<br/><br/>Activez cette case à cocher et cliquez sur **modifier** et fournir les valeurs suivantes pour s’authentifier auprès du Service Bus.<br /><br /> - **Uri STS du Service de contrôle d’accès** – définissez cette propriété sur `https://<Namespace>-sb.accesscontrol.windows.net/`, où \<espace de noms\> est votre espace de noms Service Bus.<br /><br /> - **Nom de l’émetteur** – spécifiez le nom de l’émetteur. Généralement, il s'agit du propriétaire.<br /><br /> - **Clé de l’émetteur** – spécifiez la clé de l’émetteur.|  
    |**Informations de connexion de service Bus** | Nouveau commençant par [!INCLUDE[bts2016_md](../includes/bts2016-md.md)].<br/><br/>Choisir d’utiliser la Signature d’accès partagé (SAS) ou le Service Access Control (ACS) de l’espace de noms Service Bus. <br/><br/>Sélectionnez une option, puis **modifier** pour entrer les informations de clé :<br/><br/> - **Signature d’accès partagé** : entrez le nom de clé d’accès et la clé d’accès. Les deux valeurs sont répertoriées dans le [portail Azure](https://portal.azure.com).<br/> - **Le Service de contrôle d’accès** : entrez l’URI STS (`https://<yourNamespace>-sb.accesscontrol.windows.net/`), nom de l’émetteur et la clé de l’émetteur. Utilisation de Windows PowerShell pour extraire ces valeurs, comme décrit dans [adaptateur SB-Messaging](../core/sb-messaging-adapter.md). |
  
6.  Sous l'onglet **Messages** de la boîte de dialogue **Propriétés du transport WCF-NetTcpRelay** , spécifiez la sélection de données pour l'élément SOAP **Body** .  
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Corps : Corps du message de demande de BizTalk**|Le corps du message BizTalk permet de créer le contenu de SOAP **corps** élément d’un message sortant.<br /><br /> Il s'agit du paramètre par défaut.|  
    |**Modèle--contenu spécifié par le modèle**|Utiliser le modèle fourni dans la zone de texte **XML** pour créer le contenu de l'élément SOAP **Body** d'un message sortant.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**XML**|Indiquer le modèle XML du contenu de l'élément SOAP **Body** d'un message sortant. Cette propriété est requise si l'option **Corps -- corps du message de réponse BizTalk** est activée.<br /><br /> Type : Chaîne<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est < bts-msg-body<br /><br /> xmlns="http://www.microsoft.com/schemas/bts2007" encoding="xml"/>|  
    |**: Enveloppe \<soap : Envelope\>**|Créer le corps du message BizTalk à partir de l’ensemble SOAP **enveloppe** d’un entrant. Cette propriété est valide uniquement pour des ports de sollicitation-réponse.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Corps : contenu de \<soap : Body\> élément**|Utiliser le contenu de l'élément SOAP **Body** d'un message entrant pour créer le corps du message BizTalk. Si l'élément **Body** a plusieurs éléments enfants, seul le premier élément devient le corps du message BizTalk. Cette propriété est valide uniquement pour des ports de sollicitation-réponse.<br /><br /> Il s'agit du paramètre par défaut.|  
    |**Chemin--contenu localisé par le chemin du corps**|Utiliser l'expression de chemin de corps de la zone de texte **Expression du chemin du corps** pour créer le corps du message BizTalk. L'expression du chemin du corps est évaluée en fonction de l'élément enfant immédiat de l'élément SOAP **Body** d'un message entrant. Cette propriété est valide uniquement pour des ports de sollicitation-réponse.<br /><br /> Par défaut, cette case à cocher est désactivée.|  
    |**Expression de chemin de corps**|Taper l'expression de chemin de corps afin d'identifier une partie spécifique du message entrant utilisée pour créer le corps du message BizTalk. Cette expression de chemin de corps est évaluée par rapport à l’élément enfant immédiat de SOAP **corps** nœud d’un message entrant. Si cette expression de chemin de corps retourne plusieurs nœuds, seul le premier devient le corps du message BizTalk. Cette propriété est requise si l'option **Chemin -- contenu localisé par le chemin du corps** est sélectionnée. Cette propriété est valide uniquement pour des ports de sollicitation-réponse.<br /><br /> Type : Chaîne<br /><br /> Longueur minimale : 0<br /><br /> Longueur maximale : 32767<br /><br /> La valeur par défaut est une chaîne vide.|  
    |**Codage de nœud**|Spécifiez le type de codage qui utilise de l’adaptateur d’envoi WCF-NetTcpRelay pour décoder le nœud identifié par l’expression de chemin d’accès au corps de la **expression de chemin de corps** zone de texte. Cette propriété est requise si l'option **Chemin -- contenu localisé par le chemin du corps** est sélectionnée. Cette propriété est valide uniquement pour des ports de sollicitation-réponse. Les valeurs valides sont les suivantes :<br /><br /> -                          **Base64**: codage Base64.<br /><br /> - **Hex**: codage hexadécimal.<br /><br /> - **Chaîne**: codage de texte - UTF-8<br /><br /> -                          **XML**: les adaptateurs WCF créent le corps du message BizTalk avec le XML externe du nœud sélectionné par l’expression de chemin d’accès au corps de la **expression de chemin de corps** zone de texte.<br /><br /> La valeur par défaut est **XML**.|  
    |**Propager le message d’erreur**|Activer cette case à cocher pour acheminer le message dont le traitement sortant a échoué vers une application abonnée (un autre port de réception ou une planification d’orchestration). Désactiver la case à cocher pour interrompre les messages ayant échoué et générer un accusé de réception négatif (NACK). Cette propriété est valide uniquement pour des ports de sollicitation-réponse.<br /><br /> Par défaut, l’option est sélectionnée.|  
  
7.  Cliquez sur **OK** et **OK** pour enregistrer les paramètres.  
  
## <a name="set-maxconnections-in-the-handler"></a>MaxConnections ensemble dans le Gestionnaire

1.  Dans le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Console d’Administration, développez [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration, développez **groupe BizTalk**, développez **paramètres de plateforme**, puis développez **cartes**.  
  
2.  Dans la liste des adaptateurs, sélectionnez **WCF-NetTcpRelay**, puis sélectionnez l’envoi ou le Gestionnaire de réception.  
  
3.  Dans **propriétés du Gestionnaire d’adaptateur**, dans le **général** onglet, sélectionnez **propriétés**.  
  
4.  Dans le **gestionnaire** onglet :   
  
    |Utiliser|Pour effectuer cette opération|  
    |--------------|----------------|  
    |**Nombre maximal de connexions**|Spécifiez le nombre maximal de connexions entrantes (Gestionnaire de réception) et les connexions sortantes (Gestionnaire d’envoi) pour chaque point de terminaison de mise en cache dans le pool de connexions. Cela limite le nombre de connexions sortantes mises en cache pour chaque point de terminaison unique distant. Vous devez choisir une valeur supérieure au nombre maximal de connexions sortantes que vous voulez mettre en cache pour chaque point de terminaison unique distant. Si le nombre de connexions actives dépasse cette valeur maximale, le service peut sembler pour les ports d’envoi WCF-NetTcpRelay en cours d’exécution sous ce gestionnaire d’envoi.<br /><br /> La valeur par défaut est 10.|  
  
5.  Sélectionnez **OK** pour enregistrer vos modifications.  

## <a name="see-also"></a>Voir aussi
[Adaptateur SB-Messaging](../core/sb-messaging-adapter.md)

[Utilisation des adaptateurs](../core/using-adapters.md)