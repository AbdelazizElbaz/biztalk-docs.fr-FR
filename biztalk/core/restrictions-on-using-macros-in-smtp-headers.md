---
title: "Restrictions sur l’utilisation des Macros dans les en-têtes SMTP | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- configuring [SMTP adapters], restrictions
- macros, SMTP headers [SMTP adapters]
- SMTP adapters, macros
- SMTP adapters, restrictions
- configuring [SMTP adapters], SMTP headers
- SMTP adapters, SMTP headers
- configuring [SMTP adapters], macros
- SMTP headers
ms.assetid: ceab0917-cb3c-423b-a15f-63747ab1d8da
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a5bf13f97d3cee4bf5930c448c3444aead898624
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="restrictions-on-using-macros-in-smtp-headers"></a><span data-ttu-id="a11ba-102">Restrictions sur l’utilisation des Macros dans les en-têtes SMTP</span><span class="sxs-lookup"><span data-stu-id="a11ba-102">Restrictions on Using Macros in SMTP Headers</span></span>
<span data-ttu-id="a11ba-103">Un ensemble de macros prédéfini permet de générer de manière dynamique les propriétés **Objet**, **À**, **De**et **Cc** de l'en-tête d'un message SMTP.</span><span class="sxs-lookup"><span data-stu-id="a11ba-103">You can form the **Subject**, **To**, **From**, and **CC** properties on an SMTP message header dynamically by using a predefined set of macros.</span></span> <span data-ttu-id="a11ba-104">Avant d'envoyer un message, le gestionnaire d'envoi SMTP remplace les macros d'un en-tête par leurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="a11ba-104">Before sending a message, the SMTP send handler substitutes all the macros in headers with their values.</span></span> <span data-ttu-id="a11ba-105">Vous pouvez faire appel à plusieurs macros lors de la constitution d'un en-tête.</span><span class="sxs-lookup"><span data-stu-id="a11ba-105">You can use several different macros when forming one header.</span></span>  
  
 <span data-ttu-id="a11ba-106">Le gestionnaire d'envoi SMTP ne remplace pas la macro dans la propriété d'en-tête **À**, **De**ou **Cc** si l'une des conditions suivantes est remplie :</span><span class="sxs-lookup"><span data-stu-id="a11ba-106">The SMTP send handler does not substitute macros in the **To**, **From**, or **CC** header if any of the following are true:</span></span>  
  
-   <span data-ttu-id="a11ba-107">La propriété système correspondante n'est pas définie.</span><span class="sxs-lookup"><span data-stu-id="a11ba-107">The corresponding system property is not set.</span></span>  
  
-   <span data-ttu-id="a11ba-108">La macro est mal orthographiée.</span><span class="sxs-lookup"><span data-stu-id="a11ba-108">The macro is misspelled.</span></span>  
  
-   <span data-ttu-id="a11ba-109">La valeur de la macro contient des symboles d'en-têtes SMTP non valides.</span><span class="sxs-lookup"><span data-stu-id="a11ba-109">The value for the macro contains symbols that are not valid for the SMTP headers.</span></span>  
  
 <span data-ttu-id="a11ba-110">Si une des conditions suivantes est remplie, l’envoi SMTP gestionnaire laisse les macros comme elles sont, par exemple, **%sourceparty%@somedomain.com**  ou **Message de %sourceparty%**.</span><span class="sxs-lookup"><span data-stu-id="a11ba-110">If any of these conditions are met, the SMTP send handler leaves the macros as they are, for example, **%SourceParty%@somedomain.com** or **Message from %SourceParty%**.</span></span>  
  
 <span data-ttu-id="a11ba-111">Le tableau suivant répertorie les macros auxquelles vous pouvez faire appel pour générer les en-têtes **À**, **Cc**et **Objet** .</span><span class="sxs-lookup"><span data-stu-id="a11ba-111">The following table lists the macros you can use to build the **To**, **CC**, and **Subject** headers.</span></span>  
  
|<span data-ttu-id="a11ba-112">Macro</span><span class="sxs-lookup"><span data-stu-id="a11ba-112">Macro</span></span>|<span data-ttu-id="a11ba-113">Description</span><span class="sxs-lookup"><span data-stu-id="a11ba-113">Description</span></span>|<span data-ttu-id="a11ba-114">Pour utilisation avec À</span><span class="sxs-lookup"><span data-stu-id="a11ba-114">For use with To</span></span>|<span data-ttu-id="a11ba-115">Pour utilisation avec Cc</span><span class="sxs-lookup"><span data-stu-id="a11ba-115">For use with CC</span></span>|<span data-ttu-id="a11ba-116">Pour utilisation avec Objet</span><span class="sxs-lookup"><span data-stu-id="a11ba-116">For use with Subject</span></span>|  
|-----------|-----------------|---------------------|---------------------|--------------------------|  
|<span data-ttu-id="a11ba-117">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="a11ba-117">%MessageID%</span></span>|<span data-ttu-id="a11ba-118">GUID (Globally Unique Identifier) du message dans BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="a11ba-118">Globally unique identifier (GUID) of the message in BizTalk Server.</span></span> <span data-ttu-id="a11ba-119">La valeur provient de la propriété de contexte de message **BTS.MessageID**.</span><span class="sxs-lookup"><span data-stu-id="a11ba-119">The value comes from the message context property **BTS.MessageID**.</span></span>|<span data-ttu-id="a11ba-120">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-120">No</span></span>|<span data-ttu-id="a11ba-121">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-121">No</span></span>|<span data-ttu-id="a11ba-122">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-122">Yes</span></span>|  
|<span data-ttu-id="a11ba-123">%datetime_bts2000%</span><span class="sxs-lookup"><span data-stu-id="a11ba-123">%datetime_bts2000%</span></span>|<span data-ttu-id="a11ba-124">Date et heure UTC au format AAAAMMJJhhmmsss, où sss correspond aux secondes et aux millisecondes (par exemple, 199707121035234 signifie 1997/07/12, 10:35:23 et 400 millisecondes).</span><span class="sxs-lookup"><span data-stu-id="a11ba-124">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).</span></span>|<span data-ttu-id="a11ba-125">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-125">No</span></span>|<span data-ttu-id="a11ba-126">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-126">No</span></span>|<span data-ttu-id="a11ba-127">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-127">Yes</span></span>|  
|<span data-ttu-id="a11ba-128">%datetime%</span><span class="sxs-lookup"><span data-stu-id="a11ba-128">%datetime%</span></span>|<span data-ttu-id="a11ba-129">Date et heure UTC au format AAAA-MM-JJThhmmss (par exemple, 1997-07-12T103508).</span><span class="sxs-lookup"><span data-stu-id="a11ba-129">UTC date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).</span></span>|<span data-ttu-id="a11ba-130">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-130">No</span></span>|<span data-ttu-id="a11ba-131">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-131">No</span></span>|<span data-ttu-id="a11ba-132">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-132">Yes</span></span>|  
|<span data-ttu-id="a11ba-133">%datetime.tz%</span><span class="sxs-lookup"><span data-stu-id="a11ba-133">%datetime.tz%</span></span>|<span data-ttu-id="a11ba-134">Heure et date locales ainsi que le fuseau horaire GMT au format AAAA-MM-JJThhmmssTZD (par exemple, 1997-07-12T103508+800).</span><span class="sxs-lookup"><span data-stu-id="a11ba-134">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508+800).</span></span>|<span data-ttu-id="a11ba-135">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-135">No</span></span>|<span data-ttu-id="a11ba-136">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-136">No</span></span>|<span data-ttu-id="a11ba-137">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-137">Yes</span></span>|  
|<span data-ttu-id="a11ba-138">%time%</span><span class="sxs-lookup"><span data-stu-id="a11ba-138">%time%</span></span>|<span data-ttu-id="a11ba-139">Heure UTC au format hhmmss.</span><span class="sxs-lookup"><span data-stu-id="a11ba-139">UTC time in the format hhmmss.</span></span>|<span data-ttu-id="a11ba-140">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-140">No</span></span>|<span data-ttu-id="a11ba-141">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-141">No</span></span>|<span data-ttu-id="a11ba-142">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-142">Yes</span></span>|  
|<span data-ttu-id="a11ba-143">%time.tz%</span><span class="sxs-lookup"><span data-stu-id="a11ba-143">%time.tz%</span></span>|<span data-ttu-id="a11ba-144">Heure locale ainsi que le fuseau horaire GMT au format hhmmssTZD (par exemple, 124525+530).</span><span class="sxs-lookup"><span data-stu-id="a11ba-144">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525+530).</span></span>|<span data-ttu-id="a11ba-145">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-145">No</span></span>|<span data-ttu-id="a11ba-146">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-146">No</span></span>|<span data-ttu-id="a11ba-147">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-147">Yes</span></span>|  
|<span data-ttu-id="a11ba-148">%SourceParty%</span><span class="sxs-lookup"><span data-stu-id="a11ba-148">%SourceParty%</span></span>|<span data-ttu-id="a11ba-149">Nom du tiers source qui a envoyé le message à l'adaptateur FILE.</span><span class="sxs-lookup"><span data-stu-id="a11ba-149">Name of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="a11ba-150">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-150">No</span></span>|<span data-ttu-id="a11ba-151">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-151">No</span></span>|<span data-ttu-id="a11ba-152">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-152">Yes</span></span>|  
|<span data-ttu-id="a11ba-153">%SourcePartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="a11ba-153">%SourcePartyQualifier%</span></span>|<span data-ttu-id="a11ba-154">Qualificateur du tiers source qui a envoyé le message à l'adaptateur FILE.</span><span class="sxs-lookup"><span data-stu-id="a11ba-154">Qualifier of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="a11ba-155">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-155">No</span></span>|<span data-ttu-id="a11ba-156">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-156">No</span></span>|<span data-ttu-id="a11ba-157">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-157">Yes</span></span>|  
|<span data-ttu-id="a11ba-158">%DestinationParty%</span><span class="sxs-lookup"><span data-stu-id="a11ba-158">%DestinationParty%</span></span>|<span data-ttu-id="a11ba-159">Nom du tiers de destination.</span><span class="sxs-lookup"><span data-stu-id="a11ba-159">Name of the destination party.</span></span> <span data-ttu-id="a11ba-160">La valeur provient de la propriété de contexte de message **BTS.DestinationParty**.</span><span class="sxs-lookup"><span data-stu-id="a11ba-160">The value comes from the message context property **BTS.DestinationParty**.</span></span>|<span data-ttu-id="a11ba-161">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-161">Yes</span></span>|<span data-ttu-id="a11ba-162">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-162">Yes</span></span>|<span data-ttu-id="a11ba-163">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-163">Yes</span></span>|  
|<span data-ttu-id="a11ba-164">%DestinationPartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="a11ba-164">%DestinationPartyQualifier%</span></span>|<span data-ttu-id="a11ba-165">Qualificateur du tiers de destination.</span><span class="sxs-lookup"><span data-stu-id="a11ba-165">Qualifier of the destination party.</span></span> <span data-ttu-id="a11ba-166">La valeur provient de la propriété de contexte de message **BTS.DestinationPartyQualifier**.</span><span class="sxs-lookup"><span data-stu-id="a11ba-166">The value comes from the message context property **BTS.DestinationPartyQualifier**.</span></span>|<span data-ttu-id="a11ba-167">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-167">No</span></span>|<span data-ttu-id="a11ba-168">Non</span><span class="sxs-lookup"><span data-stu-id="a11ba-168">No</span></span>|<span data-ttu-id="a11ba-169">Oui</span><span class="sxs-lookup"><span data-stu-id="a11ba-169">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a11ba-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a11ba-170">See Also</span></span>  
 [<span data-ttu-id="a11ba-171">Restrictions relatives à la configuration de l’adaptateur SMTP</span><span class="sxs-lookup"><span data-stu-id="a11ba-171">Restrictions When Configuring the SMTP Adapter</span></span>](../core/restrictions-when-configuring-the-smtp-adapter.md)