---
title: Cette Orchestration | Documents Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- errors, systems
- errors, applications
- applications, errors
- orchestrations, errors [process management solutions]
- process management solution tutorial, errors
ms.assetid: ac154e76-9dfe-433a-948b-e098df705fe5
caps.latest.revision: "27"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a1b79a1c6d9e6fada206ba0298913fe8f369783c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="the-exceptionhandler-orchestration"></a><span data-ttu-id="6808a-102">Orchestration ExceptionHandler</span><span class="sxs-lookup"><span data-stu-id="6808a-102">The ExceptionHandler Orchestration</span></span>
<span data-ttu-id="6808a-103">La solution de gestion des processus d'entreprise utilise deux types d'exceptions : les exceptions de système et les exceptions d'application.</span><span class="sxs-lookup"><span data-stu-id="6808a-103">The Business Process Management solution uses two kinds of exceptions: system exceptions and application exceptions.</span></span> <span data-ttu-id="6808a-104">Les exceptions de système incluent des erreurs de ressource, telles qu'un échec de connexion réseau.</span><span class="sxs-lookup"><span data-stu-id="6808a-104">System exceptions include things like resource errors—a network connection failing, for example.</span></span> <span data-ttu-id="6808a-105">Il se peut qu'un tel problème puisse se résoudre de lui-même après un intervalle afin que la solution tente à nouveau toutes les opérations qui produisent des exceptions de système.</span><span class="sxs-lookup"><span data-stu-id="6808a-105">There is a chance that such a problem may resolve itself after an interval so that the solution retries all operations that produce system exceptions.</span></span> <span data-ttu-id="6808a-106">Les exceptions d'application sont produites par des problèmes moins susceptibles de se résoudre d'eux-mêmes, tels que des erreurs logiques ou une certaine forme d'incohérence.</span><span class="sxs-lookup"><span data-stu-id="6808a-106">Application exceptions are produced by things less likely to resolve themselves, such as logical errors or some form of inconsistency.</span></span> <span data-ttu-id="6808a-107">La solution utilise le **ExceptionHandlerOrch** orchestration pour traiter les erreurs système et application.</span><span class="sxs-lookup"><span data-stu-id="6808a-107">The solution uses the **ExceptionHandlerOrch** orchestration to process both system and application errors.</span></span>  
  
 <span data-ttu-id="6808a-108">Étapes de traitement des commandes (**CableOrder1**, **CableOrder2**) et leurs orchestrations satellites (**activer**, **analyser**,  **Annuler**, **modification**, **Complete**, **Validate**) utilisent tous **ExceptionHandlerOrch**.</span><span class="sxs-lookup"><span data-stu-id="6808a-108">The order processing stages (**CableOrder1**, **CableOrder2**) and their satellite orchestrations (**Activate**, **Analyze**, **Cancel**, **Change**, **Complete**, **Validate**) all use **ExceptionHandlerOrch**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6808a-109">Vous pouvez souhaiter lire cette section avec les **ExceptionHandlerOrch** orchestration ouverte dans Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="6808a-109">You may want to read this section with the **ExceptionHandlerOrch** orchestration open in Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span></span>  
  
## <a name="application-errors"></a><span data-ttu-id="6808a-110">Erreurs d'application</span><span class="sxs-lookup"><span data-stu-id="6808a-110">Application Errors</span></span>  
 <span data-ttu-id="6808a-111">Le Gestionnaire d’exceptions connecte d’abord l’erreur en appelant le **PostError** méthode de la **ErrorHandler** de l’objet dans le **utilitaires** assembly.</span><span class="sxs-lookup"><span data-stu-id="6808a-111">The exception handler first logs the error by calling the **PostError** method of the **ErrorHandler** object in the **Utilities** assembly.</span></span> <span data-ttu-id="6808a-112">Le gestionnaire d'exceptions vérifie ensuite si l'erreur était une erreur système ou d'application.</span><span class="sxs-lookup"><span data-stu-id="6808a-112">The exception handler then tests whether the error was a system error or an application error.</span></span> <span data-ttu-id="6808a-113">La capture d'écran suivante montre la branche d'orchestration qui traite les exceptions d'application :</span><span class="sxs-lookup"><span data-stu-id="6808a-113">The following screenshot shows the orchestration branch that processes application exceptions:</span></span>  
  
 <span data-ttu-id="6808a-114">![Branche d’application de l’orchestration Exceptionhandler](../core/media/applicationerrorbranchofexceptionhandler.gif "ApplicationErrorBranchofExceptionHandler")</span><span class="sxs-lookup"><span data-stu-id="6808a-114">![Application Branch of ExceptionHandler Orchestrati](../core/media/applicationerrorbranchofexceptionhandler.gif "ApplicationErrorBranchofExceptionHandler")</span></span>  
  
 <span data-ttu-id="6808a-115">Pour une erreur d’application, l’orchestration construit une chaîne décrivant l’erreur et appelle le **ErrorHandlerOrch** orchestration.</span><span class="sxs-lookup"><span data-stu-id="6808a-115">For an application error, the orchestration constructs a string describing the error and calls the **ErrorHandlerOrch** orchestration.</span></span> <span data-ttu-id="6808a-116">Cette orchestration envoie l'erreur aux opérations où un opérateur décide de réparer l'erreur ou de terminer l'opération.</span><span class="sxs-lookup"><span data-stu-id="6808a-116">This orchestration sends the error to operations where an operator decides whether to fix the error or terminate the operation.</span></span> <span data-ttu-id="6808a-117">Si l'opérateur répare l'erreur, le message réparé revient de l'orchestration ErrorHandlerOrch et l'opération est tentée à nouveau.</span><span class="sxs-lookup"><span data-stu-id="6808a-117">If the operator fixes the error, the repaired message comes back from the ErrorHandlerOrch orchestration and the operation is retried.</span></span> <span data-ttu-id="6808a-118">Le Gestionnaire d’exceptions pour cela, en appelant le **Invoke** méthode de la **Recaller** de l’objet dans le **utilitaires** assembly.</span><span class="sxs-lookup"><span data-stu-id="6808a-118">The exception handler does this by calling the **Invoke** method of the **Recaller** object in the **Utilities** assembly.</span></span> <span data-ttu-id="6808a-119">Le **Recaller** objet utilise la réflexion pour appeler le code qui a provoqué l’erreur.</span><span class="sxs-lookup"><span data-stu-id="6808a-119">The **Recaller** object uses reflection to call the code that caused the error.</span></span>  
  
 <span data-ttu-id="6808a-120">Si l’appel à **Invoke** réussit, la fermeture de gestionnaire de l’exception.</span><span class="sxs-lookup"><span data-stu-id="6808a-120">If the call to **Invoke** succeeds, the exception handler exits.</span></span> <span data-ttu-id="6808a-121">Sinon, il exécute une boucle et tente de l’appel à **Invoke** à nouveau.</span><span class="sxs-lookup"><span data-stu-id="6808a-121">Otherwise, it loops back and attempts the call to **Invoke** again.</span></span> <span data-ttu-id="6808a-122">Pour plus d’informations sur la **Recaller** d’objets, consultez [l’objet Recaller](../core/the-recaller-object.md).</span><span class="sxs-lookup"><span data-stu-id="6808a-122">For more information about the **Recaller** object, see [The Recaller Object](../core/the-recaller-object.md).</span></span>  
  
## <a name="system-errors"></a><span data-ttu-id="6808a-123">Erreurs système</span><span class="sxs-lookup"><span data-stu-id="6808a-123">System Errors</span></span>  
 <span data-ttu-id="6808a-124">Le diagramme suivant illustre la branche d’erreur de système de la **ExceptionHandler** orchestration :</span><span class="sxs-lookup"><span data-stu-id="6808a-124">The following diagram shows the system error branch of the **ExceptionHandler** orchestration:</span></span>  
  
 <span data-ttu-id="6808a-125">![Erreur du système de l’Orchestration ExceptionHandler](../core/media/systemerrorbranchofexceptionhandler.gif "SystemErrorBranchofExceptionHandler")</span><span class="sxs-lookup"><span data-stu-id="6808a-125">![System Error of ExceptionHandler Orchestration](../core/media/systemerrorbranchofexceptionhandler.gif "SystemErrorBranchofExceptionHandler")</span></span>  
  
 <span data-ttu-id="6808a-126">Une erreur système, le Gestionnaire d’exceptions appelle d’abord la **CheckInterrupt** orchestration, puis attend une minute.</span><span class="sxs-lookup"><span data-stu-id="6808a-126">For a system error, the exception handler first calls the **CheckInterrupt** orchestration and then waits for one minute.</span></span> <span data-ttu-id="6808a-127">Cette attente permet aux erreurs temporaires, à court terme, telles que des problèmes de connexion réseau, de se résoudre avant une nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="6808a-127">The wait allows for temporary, short-term errors such as network connection problems, to clear before trying again.</span></span> <span data-ttu-id="6808a-128">Lors d'appels distants, le risque d'un problème réseau existe toujours.</span><span class="sxs-lookup"><span data-stu-id="6808a-128">When making remote calls there is always the chance of a network problem.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6808a-129">Dans une conception pouvant être interrompue, en règle générale, vous voulez vérifier l'existence d'une interruption pendant ou immédiatement après une période d'attente afin de voir si une interruption a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="6808a-129">In an interruptible design, as a general rule, you want to test for an interrupt during or immediately after any waiting period to see if an interrupt has occurred.</span></span>  
  
 <span data-ttu-id="6808a-130">Après le délai d’attente, le Gestionnaire utilise la **Invoke** méthode de la **Recaller** objet pour exécuter le code d’origine.</span><span class="sxs-lookup"><span data-stu-id="6808a-130">After the wait, the handler uses the **Invoke** method of the **Recaller** object to run the original code.</span></span> <span data-ttu-id="6808a-131">Si l'appel aboutit, le gestionnaire se ferme.</span><span class="sxs-lookup"><span data-stu-id="6808a-131">If the call succeeds, the handler exits.</span></span> <span data-ttu-id="6808a-132">Dans le cas contraire, le gestionnaire essaie à deux nouvelles reprises d'exécuter le code d'origine.</span><span class="sxs-lookup"><span data-stu-id="6808a-132">Otherwise, the handler will try two more times to run the original code.</span></span> <span data-ttu-id="6808a-133">Si les trois tentatives échouent, le gestionnaire construit une chaîne d’erreur et appelle le **ErrorHandlerOrch** orchestration.</span><span class="sxs-lookup"><span data-stu-id="6808a-133">If all three attempts fail, the handler constructs an error string and calls the **ErrorHandlerOrch** orchestration.</span></span>  
  
 <span data-ttu-id="6808a-134">Si le traitement d'une exception de système provoque une exception, le bloc d'exception l'intercepte :</span><span class="sxs-lookup"><span data-stu-id="6808a-134">If processing a system exception causes an exception, the exception block catches it:</span></span>  
  
 <span data-ttu-id="6808a-135">![Gestionnaire d’exceptions pour la branche d’erreurs système](../core/media/exceptionhandlerofsystemerrorbranch.gif "ExceptionHandlerofSystemErrorBranch")</span><span class="sxs-lookup"><span data-stu-id="6808a-135">![Exception Handler for System Error Branch](../core/media/exceptionhandlerofsystemerrorbranch.gif "ExceptionHandlerofSystemErrorBranch")</span></span>  
  
 <span data-ttu-id="6808a-136">Le gestionnaire d'exceptions teste le type d'exception et décrémente le compte de tentatives s'il s'agit d'une exception de système ou définit un indicateur pour spécifier une exception d'application.</span><span class="sxs-lookup"><span data-stu-id="6808a-136">The exception handler tests the type of the exception and either decrements the retry counter if it's a system exception, or sets a flag to indicate an application exception.</span></span>  
  
## <a name="the-errorhandlerorch-orchestration"></a><span data-ttu-id="6808a-137">Orchestration ErrorHandlerOrch</span><span class="sxs-lookup"><span data-stu-id="6808a-137">The ErrorHandlerOrch Orchestration</span></span>  
 <span data-ttu-id="6808a-138">Le diagramme suivant illustre la première partie de la **ErrorHandlerOrch** orchestration :</span><span class="sxs-lookup"><span data-stu-id="6808a-138">The following diagram shows the first part of the **ErrorHandlerOrch** orchestration:</span></span>  
  
 <span data-ttu-id="6808a-139">![Orchestration de gestionnaire d’erreurs, première partie](../core/media/errorhandlerfirstpart.gif "ErrorHandlerFirstPart")</span><span class="sxs-lookup"><span data-stu-id="6808a-139">![Error Handler Orchestration, First Part](../core/media/errorhandlerfirstpart.gif "ErrorHandlerFirstPart")</span></span>  
  
 <span data-ttu-id="6808a-140">Le **ErrorHandlerOrch** orchestration premiers tests les **IsBadOrder** paramètre pour voir si l’erreur est une commande incorrecte (**IsBadOrder** a la valeur true) ou une autre erreur.</span><span class="sxs-lookup"><span data-stu-id="6808a-140">The **ErrorHandlerOrch** orchestration first tests the **IsBadOrder** parameter to see if the error is a bad order (**IsBadOrder** is true) or some other error.</span></span> <span data-ttu-id="6808a-141">Si l'erreur est une commande incorrecte, elle attribue la destination du message à partir de l'adresse de l'expéditeur de la commande d'origine et renvoie le message au système de service client.</span><span class="sxs-lookup"><span data-stu-id="6808a-141">If the error is a bad order, it assigns the destination of the message from the original order return address and sends the message back to the customer service system.</span></span> <span data-ttu-id="6808a-142">Si l'erreur n'est pas une commande incorrecte, l'orchestration crée un message d'erreur de commande et l'envoie au système d'opérations.</span><span class="sxs-lookup"><span data-stu-id="6808a-142">If the error is not a bad order, the orchestration creates an order error message and sends it to the operations system.</span></span>  
  
 <span data-ttu-id="6808a-143">Après chaque erreur, l'orchestration écoute un message de réponse ou un message d'interruption :</span><span class="sxs-lookup"><span data-stu-id="6808a-143">After either error, the orchestration then listens for a response message or an interrupt message:</span></span>  
  
 <span data-ttu-id="6808a-144">![ErrorHandler, deuxième partie](../core/media/errorhandlersecondpart.gif "ErrorHandlerSecondPart")</span><span class="sxs-lookup"><span data-stu-id="6808a-144">![Error Handler Second Part](../core/media/errorhandlersecondpart.gif "ErrorHandlerSecondPart")</span></span>  
  
 <span data-ttu-id="6808a-145">Si l'orchestration reçoit une réponse, elle la renvoie à l'appelant.</span><span class="sxs-lookup"><span data-stu-id="6808a-145">If the orchestration receives a response, it returns to the caller.</span></span> <span data-ttu-id="6808a-146">Si l’orchestration reçoit un message d’interruption, il transmet le message à un port d’interruption et lève une personnalisée **InterruptException**.</span><span class="sxs-lookup"><span data-stu-id="6808a-146">If the orchestration receives an interrupt message, it passes the message on to an interrupt port and throws a custom **InterruptException**.</span></span>  
  
 <span data-ttu-id="6808a-147">Pour plus d’informations sur la façon dont la solution utilise et gère les interruptions, consultez [d’interruption de la gestion dans la Solution de gestion des processus métier](../core/interrupt-handling-in-the-business-process-management-solution.md).</span><span class="sxs-lookup"><span data-stu-id="6808a-147">For more information about how the solution uses and handles interrupts, see [Interrupt Handling in the Business Process Management Solution](../core/interrupt-handling-in-the-business-process-management-solution.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6808a-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6808a-148">See Also</span></span>  
 <span data-ttu-id="6808a-149">[Gestion des exceptions dans la Solution gestion des processus d’entreprise](../core/exception-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="6808a-149">[Exception Handling in the Business Process Management Solution](../core/exception-handling-in-the-business-process-management-solution.md) </span></span>  
 <span data-ttu-id="6808a-150">[Exceptions personnalisées](../core/custom-exceptions.md) </span><span class="sxs-lookup"><span data-stu-id="6808a-150">[Custom Exceptions](../core/custom-exceptions.md) </span></span>  
 <span data-ttu-id="6808a-151">[Gestion des interruptions dans la Solution gestion des processus d’entreprise](../core/interrupt-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="6808a-151">[Interrupt Handling in the Business Process Management Solution](../core/interrupt-handling-in-the-business-process-management-solution.md) </span></span>  
 [<span data-ttu-id="6808a-152">Objet Recaller</span><span class="sxs-lookup"><span data-stu-id="6808a-152">The Recaller Object</span></span>](../core/the-recaller-object.md)