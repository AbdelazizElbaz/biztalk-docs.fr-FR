---
title: "Comment ajouter un Script de pré-traitement ou de post-traitement à une Application | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- managing [applications], adding scripts
- managing [scripts], applications
- applications, scripts
- managing [scripts], adding
- scripts, adding to applications
- scripts
ms.assetid: 729cb236-b9cf-468a-8b98-a24d86e60d3c
caps.latest.revision: "21"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2d0646bc9e896e7b4e4d9264efba7c9bb5f0eb66
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-add-a-pre--or-post-processing-script-to-an-application"></a><span data-ttu-id="41528-102">Ajout d'un script de prétraitement ou de post-traitement à une application</span><span class="sxs-lookup"><span data-stu-id="41528-102">How to Add a Pre- or Post-processing Script to an Application</span></span>
<span data-ttu-id="41528-103">Cette rubrique décrit comment ajouter un script de pré-traitement ou de post-traitement à une application à l'aide de la console Administration de BizTalk Server ou de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="41528-103">This topic describes how to use the BizTalk Server Administration console or the command line to add a pre- or post-processing script to an application.</span></span> <span data-ttu-id="41528-104">Lorsque vous ajoutez un script à une application, le script est inclus dans le fichier .msi de l'application et s'exécute quand l'application est importée, installée ou désinstallée.</span><span class="sxs-lookup"><span data-stu-id="41528-104">When you add a script to an application, the script is included in the application .msi file, and runs when the application is imported, installed, or uninstalled.</span></span>  
  
 <span data-ttu-id="41528-105">Lorsque vous ajoutez un script, vous devez préciser s'il s'agit d'un script de pré-traitement qui s'exécute avant l'importation ou l'installation d'une application, ou d'un script de post-traitement qui s'exécute après l'importation ou l'installation.</span><span class="sxs-lookup"><span data-stu-id="41528-105">When you add a script, you must specify whether it is a pre-preprocessing script, which will run before application import or installation starts, or a post-processing script, which will run after application import or installation completes.</span></span> <span data-ttu-id="41528-106">Scripts de pré-traitement et de post-traitement s’exécutent aussi pendant la désinstallation, dans l’ordre inverse de leur exécution lors de l’installation : scripts de pré-traitement s’exécutent après la désinstallation et exécutent des scripts de post-traitement avant la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-106">Pre- and post-processing scripts also run at uninstallation, in the opposite order to that in which they ran at installation: pre-processing scripts run after uninstallation and post-processing scripts run before uninstallation.</span></span>  
  
 <span data-ttu-id="41528-107">Vous pouvez également supprimer un script d'une application.</span><span class="sxs-lookup"><span data-stu-id="41528-107">You can also remove a script from an application.</span></span> <span data-ttu-id="41528-108">Pour obtenir des instructions, consultez [suppression antérieur ou un Script de post-traitement à partir d’une Application](../core/how-to-remove-a-pre-or-post-processing-script-from-an-application.md).</span><span class="sxs-lookup"><span data-stu-id="41528-108">For instructions, see [How to Remove a Pre- or Post-processing Script from an Application](../core/how-to-remove-a-pre-or-post-processing-script-from-an-application.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="41528-109">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="41528-109">Prerequisites</span></span>  
 <span data-ttu-id="41528-110">Pour effectuer les procédures décrites dans cette rubrique, vous devez être connecté avec un compte qui est membre du groupe Administrateurs de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="41528-110">To perform the procedures in this topic, you must be logged on with an account that is a member of the BizTalk Server Administrators group.</span></span> <span data-ttu-id="41528-111">Pour plus d’informations sur les autorisations, consultez [autorisations requises pour déployer et gérer une Application BizTalk](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span><span class="sxs-lookup"><span data-stu-id="41528-111">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
## <a name="to-add-a-script-to-an-application"></a><span data-ttu-id="41528-112">Pour ajouter un script à une application</span><span class="sxs-lookup"><span data-stu-id="41528-112">To add a script to an application</span></span>  
  
#### <a name="using-the-biztalk-server-administration-console"></a><span data-ttu-id="41528-113">Utilisation de la console Administration de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="41528-113">Using the BizTalk Server Administration console</span></span>  
  
1.  <span data-ttu-id="41528-114">Cliquez sur **Démarrer**, cliquez sur **tous les programmes**, cliquez sur [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], puis cliquez sur **Administration de BizTalk Server**.</span><span class="sxs-lookup"><span data-stu-id="41528-114">Click **Start**, click **All Programs**, click [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2.  <span data-ttu-id="41528-115">Développez le groupe BizTalk, puis Applications, et cliquez avec le bouton droit sur le dossier de l'application à laquelle vous souhaitez ajouter un script.</span><span class="sxs-lookup"><span data-stu-id="41528-115">Expand the BizTalk group, expand Applications, and then right-click the folder of the application to which you want to add a script.</span></span>  
  
3.  <span data-ttu-id="41528-116">Pointez sur **ajouter**, effectuez l’une des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="41528-116">Point to **Add**, and do one of the following:</span></span>  
  
    -   <span data-ttu-id="41528-117">Cliquez sur **Scripts de pré-traitement** si vous souhaitez que le script à exécuter avant l’importation de l’application ou l’installation ou après la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-117">Click **Pre-processing Scripts** if you want the script to run before application import or installation begins or after uninstallation.</span></span>  
  
    -   <span data-ttu-id="41528-118">Cliquez sur **Scripts de post-traitement** si vous souhaitez que le script s’exécute après l’importation ou l’installation, ou avant la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-118">Click **Post-processing Scripts** if you want the script to run after application import or installation, or before uninstallation.</span></span>  
  
4.  <span data-ttu-id="41528-119">Cliquez sur **ajouter** et recherchez le fichier de script à ajouter.</span><span class="sxs-lookup"><span data-stu-id="41528-119">Click **Add** and browse to the script file to add.</span></span>  
  
5.  <span data-ttu-id="41528-120">Sélectionnez le fichier de script, cliquez sur **ouvrir**.</span><span class="sxs-lookup"><span data-stu-id="41528-120">Select the script file and click **Open**.</span></span>  
  
6.  <span data-ttu-id="41528-121">Si vous souhaitez remplacer un fichier de script qui existe déjà dans l’application, sélectionnez le **remplacer tous les** case à cocher.</span><span class="sxs-lookup"><span data-stu-id="41528-121">If you want to overwrite a script file that already exists in the application, select the **Overwrite all** check box.</span></span> <span data-ttu-id="41528-122">Le fichier de script doit porter le même nom que celui qui doit être remplacé.</span><span class="sxs-lookup"><span data-stu-id="41528-122">The script file must have the same file name as the one being added to be overwritten.</span></span> <span data-ttu-id="41528-123">Sinon, le nouveau script est ajouté et le script existant demeure inchangé dans l'application.</span><span class="sxs-lookup"><span data-stu-id="41528-123">Otherwise the new script will be added, and the existing script will remain in the application unchanged.</span></span>  
  
7.  <span data-ttu-id="41528-124">Cliquez sur le **type de fichier** liste déroulante, puis cliquez sur le type de fichier, soit **System.BizTalk : preprocessingscript** ou **System.BizTalk : postprocessingscript**.</span><span class="sxs-lookup"><span data-stu-id="41528-124">Click the **File type** drop-down list and click the file type – either **System.BizTalk:PreprocessingScript** or **System.BizTalk:PostprocessingScript**.</span></span>  
  
8.  <span data-ttu-id="41528-125">Si nécessaire, dans **l’emplacement de Destination** tapez le chemin d’accès où vous souhaitez que le script de fichier pour être copié lorsque l’application est installée, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="41528-125">If necessary, in **Destination location** type the path where you want the script file to be copied when the application is installed, and then click **OK**.</span></span> <span data-ttu-id="41528-126">Le chemin d'accès par défaut installe le script dans le dossier d'installation de l'application (%BTAD_InstallDir%).</span><span class="sxs-lookup"><span data-stu-id="41528-126">The default path will install the script to the application installation folder (%BTAD_InstallDir%).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="41528-127">Si vous n'indiquez pas de chemin d'accès, le script ne sera pas copié dans le système de fichiers local lors de l'installation.</span><span class="sxs-lookup"><span data-stu-id="41528-127">If you do not provide this path, the script will not be copied to the local file system on installation.</span></span> <span data-ttu-id="41528-128">Si ce script doit être exécuté pendant la désinstallation d'une application, vous devez indiquer le chemin d'accès, sinon le script ne sera pas copié dans le système de fichiers local et ne pourra pas être exécuté pendant une désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-128">If the script should run when the application is uninstalled, be sure to provide this path; otherwise the script will not be present on the local file system and will not run during uninstallation.</span></span>  
  
 <span data-ttu-id="41528-129">Le script est ajouté à l'application et s'affiche dans le dossier Ressources de l'application.</span><span class="sxs-lookup"><span data-stu-id="41528-129">The script is added to the application and is displayed in the Resources folder of the application.</span></span>  
  
#### <a name="using-the-command-line"></a><span data-ttu-id="41528-130">À l’aide de la ligne de commande</span><span class="sxs-lookup"><span data-stu-id="41528-130">Using the command line</span></span>  
  
1.  <span data-ttu-id="41528-131">Ouvrez une invite de commandes comme suit : cliquez sur **Démarrer**, cliquez sur **exécuter**, type `cmd`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="41528-131">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="41528-132">Tapez la commande suivante en utilisant les valeurs appropriées, comme décrit dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="41528-132">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
     <span data-ttu-id="41528-133">**BTSTask AddResource** [**« ApplicationName » :***valeur*] **/Type:System.BizTalk:PreProcessingScript**&#124; **System.BizTalk : postprocessingscript** [**/overwrite**] **/Source :***valeur* [**facultatif /Destination :**  *valeur*] [**/Server :***valeur*] [**/Database :***valeur*] [**/Property:Args = »**  *liste d’arguments***»**]</span><span class="sxs-lookup"><span data-stu-id="41528-133">**BTSTask AddResource** [**/ApplicationName:***value*] **/Type:System.BizTalk:PreProcessingScript**&#124;**System.BizTalk:PostProcessingScript** [**/Overwrite**] **/Source:***value* [**/Destination:***value*] [**/Server:***value*] [**/Database:***value*][**/Property:Args="***argument list***"**]</span></span>  
  
     <span data-ttu-id="41528-134">Exemple :</span><span class="sxs-lookup"><span data-stu-id="41528-134">Example:</span></span>  
  
     <span data-ttu-id="41528-135">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:PreProcessingScript /overwrite/source : facultatif de /Destination « Scripts\MyScript.vbs C:\Source » : « C:\New Scripts\MyScript.vbs » /Server:MyDatabaseServer Server /Property:args = « argument1 argument2 »**</span><span class="sxs-lookup"><span data-stu-id="41528-135">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:PreProcessingScript /Overwrite /Source:"C:\Source Scripts\MyScript.vbs" /Destination:"C:\New Scripts\MyScript.vbs" /Server:MyDatabaseServer /Database:BizTalkMgmtDb /Property:Args="argument1 argument2"**</span></span>  
  
    |<span data-ttu-id="41528-136">Paramètre</span><span class="sxs-lookup"><span data-stu-id="41528-136">Parameter</span></span>|<span data-ttu-id="41528-137">Valeur</span><span class="sxs-lookup"><span data-stu-id="41528-137">Value</span></span>|  
    |---------------|-----------|  
    |<span data-ttu-id="41528-138">**/ ApplicationName**</span><span class="sxs-lookup"><span data-stu-id="41528-138">**/ApplicationName**</span></span>|<span data-ttu-id="41528-139">Nom de l'application BizTalk à laquelle ajouter le script.</span><span class="sxs-lookup"><span data-stu-id="41528-139">Name of the BizTalk application to which to add the script.</span></span> <span data-ttu-id="41528-140">Si le nom de l'application n'est pas spécifié, l'application utilisée est l'application BizTalk définie par défaut.</span><span class="sxs-lookup"><span data-stu-id="41528-140">If the application name is not specified, the default BizTalk application is used.</span></span> <span data-ttu-id="41528-141">Si le nom comprend des espaces, vous devez le placer entre guillemets doubles («).</span><span class="sxs-lookup"><span data-stu-id="41528-141">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="41528-142">**Type**</span><span class="sxs-lookup"><span data-stu-id="41528-142">**/Type**</span></span>|<span data-ttu-id="41528-143">**System.BizTalk : preprocessingscript** ou **System.BizTalk : postprocessingscript**, selon le type de script à ajouter.</span><span class="sxs-lookup"><span data-stu-id="41528-143">**System.BizTalk:PreProcessingScript** or **System.BizTalk:PostProcessingScript**, depending on the type of script to add.</span></span> <span data-ttu-id="41528-144">Utilisez **System.BizTalk : preprocessingscript** si vous souhaitez que le script à exécuter avant l’importation ou l’installation ou après la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-144">Use **System.BizTalk:PreProcessingScript** if you want the script to run before application import or installation or after uninstallation.</span></span> <span data-ttu-id="41528-145">Utilisez **System.BizTalk : postprocessingscript** si vous souhaitez que le script s’exécute après l’importation ou l’installation, ou avant la désinstallation.</span><span class="sxs-lookup"><span data-stu-id="41528-145">Use **System.BizTalk:PostProcessingScript** if you want the script to run after application import or installation, or before uninstallation.</span></span>|  
    |<span data-ttu-id="41528-146">**/ Remplacer**</span><span class="sxs-lookup"><span data-stu-id="41528-146">**/Overwrite**</span></span>|<span data-ttu-id="41528-147">Met à jour un script existant.</span><span class="sxs-lookup"><span data-stu-id="41528-147">Update an existing script.</span></span> <span data-ttu-id="41528-148">Si cette option n'est pas spécifiée et qu'un script, dont le nom est le même que celui du fichier de script à ajouter, existe déjà dans l'application, l'opération d'ajout échoue.</span><span class="sxs-lookup"><span data-stu-id="41528-148">If not specified, and a script file already exists in the application that has the same name as the script file being added, the add operation will fail.</span></span>|  
    |<span data-ttu-id="41528-149">**/ Source**</span><span class="sxs-lookup"><span data-stu-id="41528-149">**/Source**</span></span>|<span data-ttu-id="41528-150">Chemin d'accès complet du fichier de script, nom du fichier inclus.</span><span class="sxs-lookup"><span data-stu-id="41528-150">Full path of the script file, including the file name.</span></span> <span data-ttu-id="41528-151">Si le chemin d'accès comprend des espaces, vous devez le placer entre guillemets doubles (").</span><span class="sxs-lookup"><span data-stu-id="41528-151">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="41528-152">**Et de destination**</span><span class="sxs-lookup"><span data-stu-id="41528-152">**/Destination**</span></span>|<span data-ttu-id="41528-153">Chemin d'accès complet de l'emplacement où le fichier de script doit être copié lorsque l'application est installée à partir du fichier .MSI.</span><span class="sxs-lookup"><span data-stu-id="41528-153">Full path of the location where the script file is to be copied when the application is installed from the MSI file.</span></span> <span data-ttu-id="41528-154">Si ce paramètre n'est pas défini, le fichier n'est pas copié dans le système de fichiers local lors de l'installation.</span><span class="sxs-lookup"><span data-stu-id="41528-154">If not provided, the file is not copied to the local file system during installation.</span></span> <span data-ttu-id="41528-155">Si le chemin d'accès comprend des espaces, vous devez le placer entre guillemets doubles (").</span><span class="sxs-lookup"><span data-stu-id="41528-155">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="41528-156">**/ Serveur**</span><span class="sxs-lookup"><span data-stu-id="41528-156">**/Server**</span></span>|<span data-ttu-id="41528-157">Nom de l'instance SQL Server hébergeant la base de données de gestion BizTalk et indiqué sous la forme NomServeur\NomInstance,Port.</span><span class="sxs-lookup"><span data-stu-id="41528-157">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="41528-158">Le nom de l'instance est uniquement requis lorsqu'il est différent du nom du serveur.</span><span class="sxs-lookup"><span data-stu-id="41528-158">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="41528-159">Le port est uniquement requis lorsque le serveur SQL Server utilise un numéro de port autre que celui par défaut (1433).</span><span class="sxs-lookup"><span data-stu-id="41528-159">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="41528-160">Exemples :</span><span class="sxs-lookup"><span data-stu-id="41528-160">Examples:</span></span><br /><br /> <span data-ttu-id="41528-161">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="41528-161">Server=MyServer</span></span><br /><br /> <span data-ttu-id="41528-162">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="41528-162">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="41528-163">Si vous n'indiquez pas de nom pour l'instance SQL Server, le nom d'instance utilisé est celui de l'instance SQL Server exécutée sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="41528-163">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
    |<span data-ttu-id="41528-164">**/ Base de données**</span><span class="sxs-lookup"><span data-stu-id="41528-164">**/Database**</span></span>|<span data-ttu-id="41528-165">Nom de la base de données de gestion BizTalk.</span><span class="sxs-lookup"><span data-stu-id="41528-165">Name of the BizTalk Management database.</span></span> <span data-ttu-id="41528-166">Si vous ne l'indiquez pas, la base de données utilisée est la base de données de gestion BizTalk s'exécutant au sein de l'instance locale de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="41528-166">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
    |<span data-ttu-id="41528-167">**/Property:args =**</span><span class="sxs-lookup"><span data-stu-id="41528-167">**/Property:Args=**</span></span>|<span data-ttu-id="41528-168">Zéro ou plusieurs arguments.</span><span class="sxs-lookup"><span data-stu-id="41528-168">Zero or more arguments.</span></span> <span data-ttu-id="41528-169">Les arguments fournis ici sont transmis au script lorsque ce dernier est appelé.</span><span class="sxs-lookup"><span data-stu-id="41528-169">The arguments provided here will be passed into the script when it is invoked.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="41528-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="41528-170">See Also</span></span>  
 <span data-ttu-id="41528-171">[Gestion des Scripts de pré-traitement et post-traitement](../core/managing-pre-and-post-processing-scripts.md) </span><span class="sxs-lookup"><span data-stu-id="41528-171">[Managing Pre- and Post-processing Scripts](../core/managing-pre-and-post-processing-scripts.md) </span></span>  
 <span data-ttu-id="41528-172">[Commande AddResource : Script de prétraitement](../core/addresource-command-preprocessing-script.md) </span><span class="sxs-lookup"><span data-stu-id="41528-172">[AddResource Command: Preprocessing Script](../core/addresource-command-preprocessing-script.md) </span></span>  
 [<span data-ttu-id="41528-173">Commande AddResource : Script de post-traitement</span><span class="sxs-lookup"><span data-stu-id="41528-173">AddResource Command: Postprocessing Script</span></span>](../core/addresource-command-postprocessing-script.md)