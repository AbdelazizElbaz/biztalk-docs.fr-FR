---
title: "Recommandations de sécurité pour les adaptateurs WCF | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- WCF adapters, security
- security, WCF adapters
ms.assetid: bbaaca56-9ad5-4122-a8e9-6e975d308230
caps.latest.revision: "13"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 77ea0334e2d6164091e54321de8e1dccab5c07bd
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="wcf-adapters-security-recommendations"></a><span data-ttu-id="44c7e-102">Recommandations de sécurité pour les adaptateurs WCF</span><span class="sxs-lookup"><span data-stu-id="44c7e-102">WCF Adapters Security Recommendations</span></span>
[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="44c7e-103"> utilise les adaptateurs WCF pour publier (recevoir) et utiliser (envoyer) les services WCF.</span><span class="sxs-lookup"><span data-stu-id="44c7e-103"> uses the WCF adapters to publish (receive) and consume (send) WCF services.</span></span> <span data-ttu-id="44c7e-104">Nous vous recommandons de respecter les informations suivantes pour la sécurisation et le déploiement des adaptateurs WCF dans votre environnement.</span><span class="sxs-lookup"><span data-stu-id="44c7e-104">We recommend that you follow these guidelines for securing and deploying the WCF adapters in your environment.</span></span>  
  
 <span data-ttu-id="44c7e-105">Pour plus d’informations sur les adaptateurs WCF, consultez [adaptateurs WCF](../core/wcf-adapters.md).</span><span class="sxs-lookup"><span data-stu-id="44c7e-105">For more information about the WCF adapters, see [WCF Adapters](../core/wcf-adapters.md).</span></span> <span data-ttu-id="44c7e-106">Pour plus d’informations sur les services WCF, consultez [à l’aide des Services WCF](../core/using-wcf-services.md)s.</span><span class="sxs-lookup"><span data-stu-id="44c7e-106">For more information about WCF services, see [Using WCF Services](../core/using-wcf-services.md)s.</span></span>  
  
## <a name="security-recommendations-for-all-wcf-adapters"></a><span data-ttu-id="44c7e-107">Recommandations de sécurité pour tous les adaptateurs WCF</span><span class="sxs-lookup"><span data-stu-id="44c7e-107">Security Recommendations for All WCF Adapters</span></span>  
  
-   <span data-ttu-id="44c7e-108">Vous pouvez utiliser l'authentification unique de l'entreprise (SSO) dans les scénarios où vous devez effectuer le mappage du contenu de l'utilisateur frontal vers les informations d'identification stockées dans le système principal.</span><span class="sxs-lookup"><span data-stu-id="44c7e-108">You can use Enterprise Single Sign-On (SSO) in scenarios where you need to map the content of the front-end user to credentials in a back-end system.</span></span>  
  
-   <span data-ttu-id="44c7e-109">Certains services ne doivent pas publier de métadonnées.</span><span class="sxs-lookup"><span data-stu-id="44c7e-109">Not all services must publish metadata.</span></span> <span data-ttu-id="44c7e-110">Si vous désactivez la publication des métadonnées, vous réduisez la surface d'attaque de votre service et limitez les risques de divulgation d'informations involontaire.</span><span class="sxs-lookup"><span data-stu-id="44c7e-110">Leaving metadata publishing disabled reduces the attack surface for your service and lowers the risk of unintentional information disclosure.</span></span> <span data-ttu-id="44c7e-111">Pour plus d’informations sur les problèmes de sécurité liés aux métadonnées, consultez « Security Considerations with Metadata » à [http://go.microsoft.com/fwlink/?LinkId=196671](http://go.microsoft.com/fwlink/?LinkId=196671).</span><span class="sxs-lookup"><span data-stu-id="44c7e-111">For more information about security issues related to metadata, see "Security Considerations with Metadata" at [http://go.microsoft.com/fwlink/?LinkId=196671](http://go.microsoft.com/fwlink/?LinkId=196671).</span></span>  
  
-   <span data-ttu-id="44c7e-112">Les combinaisons de liaisons de point de terminaison des métadonnées et de liaisons de points de terminaison de service ne sont pas toutes valides.</span><span class="sxs-lookup"><span data-stu-id="44c7e-112">Not all combinations of metadata endpoint bindings and service endpoint bindings are valid.</span></span> <span data-ttu-id="44c7e-113">Dans certains cas, les configurations de liaison d'un point de terminaison des métadonnées doivent être conformes aux configurations de liaison de son point de terminaison de service.</span><span class="sxs-lookup"><span data-stu-id="44c7e-113">In some cases, the binding configurations for a metadata endpoint must be in agreement with the binding configurations of its service endpoint.</span></span> <span data-ttu-id="44c7e-114">Par exemple, lorsque les métadonnées sont utilisées depuis le même emplacement que l'emplacement de réception, le point de terminaison des métadonnées ne peut pas être configuré avec un mode de sécurité impliquant le transport HTTP si l'emplacement de réception utilise un mode de sécurité basé sur HTTPS.</span><span class="sxs-lookup"><span data-stu-id="44c7e-114">For example, when metadata is served from the same location as the receive location, the metadata endpoint cannot be configured with a security mode requiring the HTTP transport if the receive location uses a security mode that relies on HTTPS.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="44c7e-115">Lors de la publication des métadonnées via le transport HTTP pour un point de terminaison de service avec le même emplacement mais nécessitant un mode de sécurité qui s’appuie sur le transport HTTPS, dans le fichier Web.config que l’Assistant Publication WCF BizTalk génère, vous devez définir les deux le **httpsGetEnabled** et **httpGetEnabled** attributs **true**.</span><span class="sxs-lookup"><span data-stu-id="44c7e-115">When publishing metadata through the HTTP transport for a service endpoint with the same location but requiring a security mode that relies on the HTTPS transport, in the Web.config file that the BizTalk WCF Publishing Wizard generates, you must set both of the **httpsGetEnabled** and **httpGetEnabled** attributes to **true**.</span></span>  
  
-   <span data-ttu-id="44c7e-116">Les adaptateurs WCF exploitent les fonctions de sécurité de Windows Communication Foundation (WCF) pour communiquer.</span><span class="sxs-lookup"><span data-stu-id="44c7e-116">The WCF adapters leverage the security features of Windows Communication Foundation (WCF) to communicate.</span></span> <span data-ttu-id="44c7e-117">Il est important de comprendre les capacités et limitations de WCF en termes de sécurité.</span><span class="sxs-lookup"><span data-stu-id="44c7e-117">It is important to understand the capabilities and limitations of WCF in terms of security.</span></span> <span data-ttu-id="44c7e-118">Pour plus d’informations sur les fonctionnalités de sécurité de WCF, consultez « Windows Communication Foundation Security » à [http://go.microsoft.com/fwlink/?LinkId=87806](http://go.microsoft.com/fwlink/?LinkId=87806).</span><span class="sxs-lookup"><span data-stu-id="44c7e-118">For more information about the security features of WCF, see "Windows Communication Foundation Security" at [http://go.microsoft.com/fwlink/?LinkId=87806](http://go.microsoft.com/fwlink/?LinkId=87806).</span></span>  
  
## <a name="security-recommendations-for-the-isolated-wcf-adapters"></a><span data-ttu-id="44c7e-119">Recommandations de sécurité pour les adaptateurs WCF isolés</span><span class="sxs-lookup"><span data-stu-id="44c7e-119">Security Recommendations for the Isolated WCF Adapters</span></span>  
  
-   <span data-ttu-id="44c7e-120">Pour obtenir des recommandations de sécurité pour la publication de services Web, consultez [activation des Services Web](../core/enabling-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="44c7e-120">For security recommendations for publishing Web services, see [Enabling Web Services](../core/enabling-web-services.md).</span></span>  
  
-   <span data-ttu-id="44c7e-121">Les adaptateurs WCF isolés tels que les adaptateurs WCF-CustomIsolated, WCF-BasicHttp et WCF-WSHttp exploitent le protocole Hypertext Transfer Protocol (HTTP) pour envoyer et recevoir des messages depuis et vers [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="44c7e-121">The isolated WCF adapters such as the WCF-CustomIsolated, WCF-BasicHttp, and WCF-WSHttp adapters leverage the Hypertext Transfer Protocol (HTTP) to send and receive messages to and from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="44c7e-122">Vous devez donc suivre les recommandations de sécurité pour sécuriser les services Internet (IIS).</span><span class="sxs-lookup"><span data-stu-id="44c7e-122">Therefore, you must follow the security recommendations for securing Internet Information Services (IIS).</span></span>  
  
-   <span data-ttu-id="44c7e-123">Lorsque vous créez un pool d'applications pour l'emplacement de réception d'un WCF isolé, vous devez le configurer pour qu'il s'exécute sous un compte qui est membre du groupe [!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)] pour l'hôte isolé qui exécute l'adaptateur de réception WCF, ainsi que du groupe Internet Information Services Worker Process (groupe IIS_WPG).</span><span class="sxs-lookup"><span data-stu-id="44c7e-123">When you create an application pool for an isolated WCF receive location, you must configure it to run under an account that is a member of the [!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)] group for the isolated host running the WCF receive adapter and the Internet Information Services Worker Process group (IIS_WPG group).</span></span> <span data-ttu-id="44c7e-124">Vous devez ensuite configurer l'instance d'hôte pour que l'adaptateur de réception WCF puisse utiliser ce compte.</span><span class="sxs-lookup"><span data-stu-id="44c7e-124">You must then configure the host instance for the WCF receive adapter to use this account.</span></span> <span data-ttu-id="44c7e-125">Si vous remplacez le compte du groupe IIS_WPG, vous devez vous assurer de mettre également à jour l'instance d'hôte pour qu'elle s'exécute sous le nouveau compte.</span><span class="sxs-lookup"><span data-stu-id="44c7e-125">If you change the account for the IIS_WPG group, you must ensure that you also update the host instance to run under the new account.</span></span>  
  
## <a name="security-recommendations-for-the-wcf-custom-adapter"></a><span data-ttu-id="44c7e-126">Recommandations de sécurité pour l'adaptateur WCF-Custom</span><span class="sxs-lookup"><span data-stu-id="44c7e-126">Security Recommendations for the WCF-Custom Adapter</span></span>  
  
-   <span data-ttu-id="44c7e-127">Si un emplacement de réception WCF-Custom se produit à utiliser le pilote du noyau HTTP (HTTP.sys) tels que les **httpsTransport** élément de liaison pour les communications Secure Sockets Layer (SSL), l’emplacement de réception doit disposer d’un certificat inscrit pour chaque socket (combinaison adresse IP/port).</span><span class="sxs-lookup"><span data-stu-id="44c7e-127">If a WCF-Custom receive location happens to use the HTTP kernel-mode driver (HTTP.sys) such as the **httpsTransport** binding element for Secure Sockets Layer (SSL) communications, the receive location must have a certificate registered for each socket (IP address/port combination).</span></span> <span data-ttu-id="44c7e-128">Utilisez l'outil HttpCfg.exe pour lier un certificat SSL à un port sur l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="44c7e-128">Use the HttpCfg.exe tool to bind an SSL certificate to a port on the computer.</span></span> <span data-ttu-id="44c7e-129">Pour plus d’informations, consultez « Comment à : configurer un Port avec un certificat SSL » à [http://go.microsoft.com/fwlink/?LinkId=86384](http://go.microsoft.com/fwlink/?LinkId=86384).</span><span class="sxs-lookup"><span data-stu-id="44c7e-129">For more information, see "How To: Configure a Port with An SSL Certificate" at [http://go.microsoft.com/fwlink/?LinkId=86384](http://go.microsoft.com/fwlink/?LinkId=86384).</span></span>  
  
## <a name="security-recommendations-for-the-wcf-netmsmq-adapter"></a><span data-ttu-id="44c7e-130">Recommandations de sécurité pour l'adaptateur WCF-NetMsmq</span><span class="sxs-lookup"><span data-stu-id="44c7e-130">Security Recommendations for the WCF-NetMsmq Adapter</span></span>  
  
-   <span data-ttu-id="44c7e-131">Pour utiliser l’adaptateur WCF-NetMsmq, vous devez configurer les paramètres de sécurité MSMQ pour l’adaptateur WCF-NetMsmq de la même façon que pour les [netMsmqBinding](http://go.microsoft.com/fwlink/?LinkId=87813).</span><span class="sxs-lookup"><span data-stu-id="44c7e-131">To use the WCF-NetMsmq adapter, you have to configure MSMQ security settings for the WCF-NetMsmq adapter in the same way as for the [netMsmqBinding](http://go.microsoft.com/fwlink/?LinkId=87813).</span></span> <span data-ttu-id="44c7e-132">Pour plus d’informations sur la façon de configurer les paramètres de sécurité MSMQ pour la **netMsmqBinding**, consultez « Troubleshooting Queued Messaging » à l’adresse [http://go.microsoft.com/fwlink/?LinkId=87816](http://go.microsoft.com/fwlink/?LinkId=87816).</span><span class="sxs-lookup"><span data-stu-id="44c7e-132">For more information about how to configure MSMQ security settings for the **netMsmqBinding**, see "Troubleshooting Queued Messaging" at [http://go.microsoft.com/fwlink/?LinkId=87816](http://go.microsoft.com/fwlink/?LinkId=87816).</span></span>  
  
## <a name="wcf-adapters-use-the-chaintrust-mode-to-validate-certificates"></a><span data-ttu-id="44c7e-133">Les adaptateurs WCF utilisent le mode ChainTrust pour valider les certificats.</span><span class="sxs-lookup"><span data-stu-id="44c7e-133">WCF Adapters Use the ChainTrust Mode to Validate Certificates.</span></span>  
  
-   <span data-ttu-id="44c7e-134">Étant donné que WCF standard adaptateurs de réception utilisent le [ChainTrust](http://go.microsoft.com/fwlink/?LinkId=88960) mode pour valider les certificats de client et le service, vous devez installer la chaîne de certificats d’autorité de certification pour valider les certificats X.509.</span><span class="sxs-lookup"><span data-stu-id="44c7e-134">Because the standard WCF receive adapters use the [ChainTrust](http://go.microsoft.com/fwlink/?LinkId=88960) mode to validate the client and service certificates, you must install the CA certificate chain to validate the X.509 certificates.</span></span> <span data-ttu-id="44c7e-135">Pour modifier ce comportement par défaut, vous pouvez utiliser WCF-Custom ou l’adaptateur WCF-CustomIsolated.</span><span class="sxs-lookup"><span data-stu-id="44c7e-135">You can use the WCF-Custom or the WCF-CustomIsolated adapter to change this default behavior.</span></span>  
  
## <a name="security-auditing-for-the-wcf-adapters"></a><span data-ttu-id="44c7e-136">Audit de sécurité pour les adaptateurs WCF</span><span class="sxs-lookup"><span data-stu-id="44c7e-136">Security Auditing for the WCF Adapters</span></span>  
  
-   <span data-ttu-id="44c7e-137">Les adaptateurs WCF n'utilisent pas les fonctions d'audit de sécurité WCF par défaut.</span><span class="sxs-lookup"><span data-stu-id="44c7e-137">The WCF adapters do not use the WCF security auditing features by default.</span></span> <span data-ttu-id="44c7e-138">Il existe différentes façons d'activer les fonctions d'audit de sécurité WCF pour les adaptateurs WCF.</span><span class="sxs-lookup"><span data-stu-id="44c7e-138">There are several ways to enable the WCF security auditing features for the WCF adapters.</span></span> <span data-ttu-id="44c7e-139">Pour plus d’informations sur les fonctionnalités d’audit de sécurité WCF, consultez « Auditing Security Events » à [http://go.microsoft.com/fwlink/?LinkId=88975](http://go.microsoft.com/fwlink/?LinkId=88975).</span><span class="sxs-lookup"><span data-stu-id="44c7e-139">For more information about the WCF security auditing features, see "Auditing Security Events" at [http://go.microsoft.com/fwlink/?LinkId=88975](http://go.microsoft.com/fwlink/?LinkId=88975).</span></span>  
  
-   <span data-ttu-id="44c7e-140">Pour utiliser la sécurité WCF avec l’adaptateur de réception WCF-Custom, les fonctionnalités d’audit, vous pouvez configurer le **ServiceSecurityAuditBehavior** pour les emplacements de réception.</span><span class="sxs-lookup"><span data-stu-id="44c7e-140">To use the WCF security auditing features with the WCF-Custom receive adapter, you can configure the **ServiceSecurityAuditBehavior** for the receive locations.</span></span>  
  
-   <span data-ttu-id="44c7e-141">Pour les adaptateurs WCF In-process, vous pouvez activer les compteurs de performance via le fichier BTSNTSvc.exe.config.</span><span class="sxs-lookup"><span data-stu-id="44c7e-141">For the in-process WCF adapters, you can enable the performance counters through the BTSNTSvc.exe.config file.</span></span> <span data-ttu-id="44c7e-142">Pour les adaptateurs WCF isolés, vous pouvez activer le suivi WCF en modifiant le fichier Web.config que l'Assistant Publication de services WCF BizTalk crée dans le dossier de l'application Web.</span><span class="sxs-lookup"><span data-stu-id="44c7e-142">For the isolated WCF adapters, you can enable WCF tracing by modifying the Web.config file that the BizTalk WCF Service Publishing Wizard creates in the Web application folder.</span></span> <span data-ttu-id="44c7e-143">Pour modifier le fichier de configuration BTSNtSvc.exe.config ou Web.config, ouvrez-le, puis configurez le suivi WCF, comme décrit dans l'exemple de configuration suivant :</span><span class="sxs-lookup"><span data-stu-id="44c7e-143">To modify BTSNtSvc.exe.config or Web.config, open the configuration file, and then configure WCF tracing, as indicated in the following configuration example:</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="44c7e-144">Le fichier BTSNTSvc.exe.config est toujours situé dans le même répertoire que le fichier BTSNTSvc.exe (généralement, [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)].</span><span class="sxs-lookup"><span data-stu-id="44c7e-144">The BTSNTSvc.exe.config file is always located in the same directory as the BTSNTSvc.exe file, which is usually [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)].</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="44c7e-145">Une fois le fichier BTSNTSvc.exe.config modifié, vous devez redémarrer les instances d'hôte exécutant les emplacements de réception WCF In-process.</span><span class="sxs-lookup"><span data-stu-id="44c7e-145">After modifying the BTSNTSvc.exe.config file, you must restart the host instances running the in-process WCF receive locations.</span></span>  
  
    ```  
    <configuration>  
        <system.serviceModel>  
          <diagnostics performanceCounters="All" />  
          <behaviors>  
            <serviceBehaviors>  
              <behavior name="ServiceBehaviorConfiguration">  
                <serviceSecurityAudit  
                          auditLogLocation="Application"  
                          suppressAuditFailure="true"  
                          serviceAuthorizationAuditLevel="SuccessOrFailure"  
    messageAuthenticationAuditLevel="SuccessOrFailure" />  
              </behavior>  
            </serviceBehaviors>  
          </behaviors>  
          <services>  
            <service name="Microsoft.BizTalk.Adapter.Wcf.Runtime.BizTalkServiceInstance" behaviorConfiguration="ServiceBehaviorConfiguration">  
            </service>  
          </services>        
        </system.serviceModel>  
    </configuration>  
    ```  
  
-   <span data-ttu-id="44c7e-146">Vous pouvez également utiliser un compteur de performances lié à la sécurité tel que Security Calls Not Authorized pour gérer les adaptateurs WCF.</span><span class="sxs-lookup"><span data-stu-id="44c7e-146">You can also use a security-related performance counter such as Security Calls Not Authorized to monitor the WCF adapters.</span></span> <span data-ttu-id="44c7e-147">Pour plus d’informations sur l’activation des compteurs de performance WCF, consultez [compteurs de Performance des adaptateurs WCF](../core/wcf-adapters-performance-counters.md).</span><span class="sxs-lookup"><span data-stu-id="44c7e-147">For more information about how to enable the WCF performance counters, see [WCF Adapters Performance Counters](../core/wcf-adapters-performance-counters.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="44c7e-148">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="44c7e-148">See Also</span></span>  
 [<span data-ttu-id="44c7e-149">Planification de la sécurité</span><span class="sxs-lookup"><span data-stu-id="44c7e-149">Planning for Security</span></span>](../core/planning-for-security.md)