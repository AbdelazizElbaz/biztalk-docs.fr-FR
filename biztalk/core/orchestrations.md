---
title: Orchestrations | Documents Microsoft
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- orchestrations
- correlations, orchestrations
- orchestrations, correlations
- orchestrations, deploying
- deploying, orchestrations
- orchestrations, about orchestrations
ms.assetid: fb01f78a-b805-46be-a7d9-2b7597daab96
caps.latest.revision: "8"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 73fb7a4af3a8ef7da8e9da97047006470eb8cc18
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="orchestrations"></a><span data-ttu-id="45d15-102">Orchestrations</span><span class="sxs-lookup"><span data-stu-id="45d15-102">Orchestrations</span></span>
<span data-ttu-id="45d15-103">*Orchestrations* sont des processus d’entreprise exécutables qui peuvent s’abonner à (réception) et publier des messages (envoyer) via la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="45d15-103">*Orchestrations* are executable business processes that can subscribe to (receive) and publish (send) messages through the MessageBox database.</span></span> <span data-ttu-id="45d15-104">Les orchestrations peuvent en outre construire de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="45d15-104">In addition, orchestrations can construct new messages.</span></span> <span data-ttu-id="45d15-105">Les messages sont reçus à l’aide de l’abonnement et l’infrastructure de routage de [cycle de vie d’un Message](../core/lifecycle-of-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="45d15-105">Messages are received using the subscription and routing infrastructure discussed in [Lifecycle of a Message](../core/lifecycle-of-a-message.md).</span></span> <span data-ttu-id="45d15-106">Lorsque des abonnements sont définis pour les orchestrations, une nouvelle instance est activée et le message est remis, ou, dans le cas d'abonnements d'instance, l'instance est réalimentée si nécessaire et le message est ensuite remis.</span><span class="sxs-lookup"><span data-stu-id="45d15-106">When subscriptions are filled for orchestrations, a new instance is activated and the message is delivered, or in the case of instance subscriptions, the instance is rehydrated if necessary and the message is then delivered.</span></span> <span data-ttu-id="45d15-107">Lorsque des messages sont envoyés à partir d'une orchestration, ils sont publiés dans la base de données MessageBox de la même manière que lorsqu'un message arrive sur un emplacement de réception, les propriétés appropriées sont insérées dans la base de données pour être utilisées dans le routage.</span><span class="sxs-lookup"><span data-stu-id="45d15-107">When messages are sent from an orchestration, they are published to the MessageBox in the same manner as a message arriving on a receive location with the appropriate properties getting inserted into the database for use in routing.</span></span>  
  
 <span data-ttu-id="45d15-108">Les messages construits dans une orchestration doivent être placés dans la base de données MessageBox et être référencés par l'instance de l'orchestration. N'ayant pas encore été envoyés, ils ne doivent toutefois pas être publiés.</span><span class="sxs-lookup"><span data-stu-id="45d15-108">Messages that are constructed in an orchestration must be placed in the MessageBox database and referenced by the orchestration instance, but they should not be published because they have not yet been sent.</span></span> <span data-ttu-id="45d15-109">Le sous-service XLANG/s appelle l'API de l'agent des messages pour insérer directement les messages.</span><span class="sxs-lookup"><span data-stu-id="45d15-109">The XLANG/s subservice makes calls to the Message Agent API to insert messages directly.</span></span> <span data-ttu-id="45d15-110">Cela permet au moteur d'orchestration d'insérer le corps du message dans la base MessageBox et de l'associer directement à l'instance d'orchestration en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="45d15-110">This allows the orchestration engine to insert the message body into the MessageBox and have it directly associated with the running orchestration instance.</span></span> <span data-ttu-id="45d15-111">La persistance du message construit dans la base de données MessageBox est réalisée avec des points de persistance dans l'orchestration qui constituent une optimisation supplémentaire des opérations de base de données.</span><span class="sxs-lookup"><span data-stu-id="45d15-111">The persistence of the constructed message in the MessageBox database is coordinated with persistence points in the orchestration as an additional optimization of database operations.</span></span>  
  
 <span data-ttu-id="45d15-112">Dans les orchestrations, le concept de liaison semble donner un aperçu différent de la publication et de l'abonnement.</span><span class="sxs-lookup"><span data-stu-id="45d15-112">The concept in orchestrations that makes the publish and subscribe seem to act differently is binding.</span></span> <span data-ttu-id="45d15-113">Les ports d'orchestration sont des ports logiques qui décrivent une interaction.</span><span class="sxs-lookup"><span data-stu-id="45d15-113">Orchestration ports are logical ports that describe an interaction.</span></span> <span data-ttu-id="45d15-114">Vous devez lier ces ports logiques à un port physique pour que les messages soient remis, mais ce processus de liaison revient en fait à configurer des abonnements pour le routage des messages.</span><span class="sxs-lookup"><span data-stu-id="45d15-114">You must bind these logical ports to a physical port so that messages are delivered, but this binding process is nothing more than configuring subscriptions for message routing.</span></span>  
  
 <span data-ttu-id="45d15-115">Il existe quatre options de base pour lier ces ports :</span><span class="sxs-lookup"><span data-stu-id="45d15-115">There are four basic options for binding these ports:</span></span>  
  
-   <span data-ttu-id="45d15-116">Spécifier maintenant (spécification des ports directement dans l'orchestration)</span><span class="sxs-lookup"><span data-stu-id="45d15-116">Specify Now (specifying ports directly in the orchestration)</span></span>  
  
-   <span data-ttu-id="45d15-117">Spécifier plus tard (spécification des ports au moment du déploiement)</span><span class="sxs-lookup"><span data-stu-id="45d15-117">Specify Later (specifying ports at deployment time)</span></span>  
  
-   <span data-ttu-id="45d15-118">Utilisation d'un port d'envoi dynamique pour lequel l'adresse est définie dans le code de l'orchestration</span><span class="sxs-lookup"><span data-stu-id="45d15-118">Using a dynamic send port where the address is set in the orchestration code</span></span>  
  
-   <span data-ttu-id="45d15-119">Création d'une liaison directe depuis l'orchestration vers la base de données MessageBox ou une autre orchestration</span><span class="sxs-lookup"><span data-stu-id="45d15-119">Creating a direct binding from the orchestration to either the MessageBox database or to another orchestration</span></span>  
  
## <a name="deploying-orchestrations"></a><span data-ttu-id="45d15-120">Déploiement des orchestrations</span><span class="sxs-lookup"><span data-stu-id="45d15-120">Deploying Orchestrations</span></span>  
 <span data-ttu-id="45d15-121">Lorsqu'une liaison est spécifiée au moment de la conception, le port physique correspondant aux paramètres configurés dans l'orchestration est créé lors du déploiement de l'orchestration.</span><span class="sxs-lookup"><span data-stu-id="45d15-121">When a binding is specified at design time, the physical port that matches the parameters configured in the orchestration is created when the orchestration is deployed.</span></span> <span data-ttu-id="45d15-122">Lorsque la liaison est configurée au moment du déploiement, tout port correspondant aux paramètres du port logique peut être lié au port de l'orchestration.</span><span class="sxs-lookup"><span data-stu-id="45d15-122">When the binding is configured at deployment time, any port that matches the requirements of the logical port can be bound to the orchestration port.</span></span> <span data-ttu-id="45d15-123">Dans le cadre de la liaison dynamique, un port physique est créé de la même façon qu'avec l'option Spécifier maintenant, mais il s'agit d'un port d'envoi dynamique sans informations d'adresse configurées.</span><span class="sxs-lookup"><span data-stu-id="45d15-123">For dynamic binding, a physical port is created just as with the Specify Now option, but the port is a dynamic send port that has no address information configured.</span></span>  
  
 <span data-ttu-id="45d15-124">Là où la situation se complique, c'est que même si un port d'envoi d'une orchestration est lié à un port d'envoi physique, le message peut être remis à d'autres abonnés.</span><span class="sxs-lookup"><span data-stu-id="45d15-124">A confusing concept is that while a send port in an orchestration is bound to a physical send port, this does not preclude that message from getting delivered to other subscribers.</span></span> <span data-ttu-id="45d15-125">En d'autres termes, si un autre port d'envoi possède un abonnement au message envoyé au port lié par le biais de ses filtres, le message est envoyé aux deux ports d'envoi.</span><span class="sxs-lookup"><span data-stu-id="45d15-125">That is, if another send port happens to have a subscription, through its filters, for the message being sent to the bound port, both send ports receive the message.</span></span> <span data-ttu-id="45d15-126">La liaison permet simplement de créer l'abonnement de sorte que le message envoyé depuis l'orchestration corresponde toujours aux critères du port d'envoi lié.</span><span class="sxs-lookup"><span data-stu-id="45d15-126">Binding simply creates the subscription such that the message sent from the orchestration always matches the criteria for the bound send port.</span></span> <span data-ttu-id="45d15-127">De même, le port d’orchestration lié à un port de réception crée l’abonnement approprié en fonction de l’ID de message type et receive port.</span><span class="sxs-lookup"><span data-stu-id="45d15-127">Likewise, the orchestration port bound to a receive port creates the appropriate subscription based on message type and receive port ID.</span></span> <span data-ttu-id="45d15-128">Les abonnements garantissent que les messages sortants vers et depuis l’orchestration sont bien remis aux ports liés, mais les messages toujours passent par la même publication et abonnement décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="45d15-128">The subscriptions guarantee that the messages going in and out of the orchestration get delivered to the bound ports, but the messages still go through the same publish and subscribe mechanism described earlier.</span></span>  
  
 <span data-ttu-id="45d15-129">L'option de liaison directe est probablement l'option de liaison la plus difficile à comprendre.</span><span class="sxs-lookup"><span data-stu-id="45d15-129">Probably the most misunderstood, and misused or underused binding option is the Direct binding option.</span></span> <span data-ttu-id="45d15-130">La liaison directe permet à une orchestration de publier des messages dans la base de données MessageBox avec diverses propriétés de routage, de manière similaire à la publication des messages par les emplacements de réception.</span><span class="sxs-lookup"><span data-stu-id="45d15-130">Direct binding allows an orchestration to publish messages to the MessageBox database with varying routing properties much like messages are published by receive locations.</span></span> <span data-ttu-id="45d15-131">Dans la messagerie directe simple, le message est publié dans la base de données MessageBox avec ses propriétés promues pour être acheminé comme tout autre message publié que BizTalk Server reçoit.</span><span class="sxs-lookup"><span data-stu-id="45d15-131">In simple direct messaging, the message is published to the MessageBox with its promoted properties to be routed like any other published message received into BizTalk Server.</span></span> <span data-ttu-id="45d15-132">Cela permet à tous les abonnés de recevoir le message. Dans ce système cependant, au moins un abonné doit exister, faute de quoi, l'orchestration reçoit une erreur signalant l'échec du routage.</span><span class="sxs-lookup"><span data-stu-id="45d15-132">This enables any subscriber to receive this message, but requires that at least one subscriber exist or the orchestration will receive a routing failure error.</span></span>  
  
 <span data-ttu-id="45d15-133">Une autre option de liaison directe consiste à utiliser des ports d'autocorrélation.</span><span class="sxs-lookup"><span data-stu-id="45d15-133">Another option for direct binding is to use self-correlating ports.</span></span> <span data-ttu-id="45d15-134">Les ports d'autocorrélation sont des ports qui créent un jeton de corrélation unique pour l'utiliser dans la corrélation des messages avec les instances.</span><span class="sxs-lookup"><span data-stu-id="45d15-134">Self-correlating ports are ports that create a unique correlation token and use that token alone in correlating messages between instances.</span></span> <span data-ttu-id="45d15-135">Ce type de port est couramment utilisé pour appeler ou démarrer une orchestration transmettant un paramètre de port.</span><span class="sxs-lookup"><span data-stu-id="45d15-135">The most common use of a self-correlating port is to call or start an orchestration passing in a port parameter.</span></span> <span data-ttu-id="45d15-136">Dans l'orchestration appelée, le port peut être utilisé pour envoyer un message, alors que dans l'orchestration d'appel, le même port peut servir à recevoir un message.</span><span class="sxs-lookup"><span data-stu-id="45d15-136">In the called orchestration, the port can be used to send a message, while in the calling orchestration the same port can be used to receive a message.</span></span> <span data-ttu-id="45d15-137">Le port possédant un jeton de corrélation unique, le message est réacheminé vers l'orchestration d'appel.</span><span class="sxs-lookup"><span data-stu-id="45d15-137">Because the port has a unique correlation token, the message is routed back to the calling orchestration.</span></span> <span data-ttu-id="45d15-138">Les ports d'autocorrélation font office de canaux de communication privés entre les instances d'orchestration.</span><span class="sxs-lookup"><span data-stu-id="45d15-138">Self-correlation ports act as private communication channels between orchestration instances.</span></span>  
  
 <span data-ttu-id="45d15-139">La dernière option consiste à utiliser l'orchestration d'un partenaire dans laquelle, pour l'orchestration d'appel comme pour l'orchestration appelée, le port est configuré à l'aide du même type de port partagé, et, dans la configuration du port, le même port est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="45d15-139">The final option is to use a partner orchestration in which, in both the calling orchestration and the called orchestration, the port is configured using the same shared port type and in the port configuration, the same port is selected.</span></span> <span data-ttu-id="45d15-140">Par exemple, dans Orch1 et Orch2, Orch2.MyDirectPort est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="45d15-140">For example, in both Orch1 and Orch2, Orch2.MyDirectPort is selected.</span></span> <span data-ttu-id="45d15-141">Ce type de liaison définit un abonnement pour l'orchestration de réception en fonction du type d'orchestration d'envoi, du nom du port et du nom de l'opération.</span><span class="sxs-lookup"><span data-stu-id="45d15-141">This type of binding sets up a subscription for the receiving orchestration based on the sending orchestration type, the port name, and the operation name.</span></span> <span data-ttu-id="45d15-142">Ce processus garantit une fois de plus que les messages seront acheminés vers la bonne instance.</span><span class="sxs-lookup"><span data-stu-id="45d15-142">This again ensures that the messages get routed to the correct instance.</span></span>  
  
 <span data-ttu-id="45d15-143">Toutes les options de messagerie directe utilisent le modèle de publication et d'abonnement sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="45d15-143">All of the direct messaging options use the underlying publish and subscribe model.</span></span> <span data-ttu-id="45d15-144">La différence entre ces options réside dans les propriétés utilisées pour la création des abonnements et le routage, et dans les cas d'utilisation qu'elles permettent de résoudre.</span><span class="sxs-lookup"><span data-stu-id="45d15-144">The difference between these options is in the properties that are used for creating subscriptions and routing, and in the use cases they help solve.</span></span>  
  
 <span data-ttu-id="45d15-145">L'un des problèmes courants rencontrés lors de l'utilisation de ports liés directs dans les orchestrations est qu'une orchestration peut publier un message auquel elle est également abonnée.</span><span class="sxs-lookup"><span data-stu-id="45d15-145">One common problem encountered when using direct bound ports in orchestrations is that an orchestration may publish a message that it is also subscribed to.</span></span> <span data-ttu-id="45d15-146">Supposons, par exemple, qu'une orchestration est configurée pour être activée par un message PurchaseOrder.</span><span class="sxs-lookup"><span data-stu-id="45d15-146">For example, an orchestration is configured to be activated by a PurchaseOrder message.</span></span> <span data-ttu-id="45d15-147">Cette orchestration utilise un port direct pour publier le message PurchaseOrder dans MessageBox.</span><span class="sxs-lookup"><span data-stu-id="45d15-147">This orchestration uses a direct port to publish the PurchaseOrder message to the MessageBox.</span></span> <span data-ttu-id="45d15-148">Cependant, en plus de recevoir le message comme prévu, une autre instance de l'orchestration est démarrée, car celle-ci est également abonnée aux messages PurchaseOrder.</span><span class="sxs-lookup"><span data-stu-id="45d15-148">However, in addition to receiving the message as expected, another instance of an orchestration is started because it too had a subscription for PurchaseOrder messages.</span></span> <span data-ttu-id="45d15-149">Ce type de traitement s'engage dans une boucle sans fin et un développeur peut mettre un certain temps avant de comprendre ce qui s'est passé.</span><span class="sxs-lookup"><span data-stu-id="45d15-149">The processing gets into an endless loop and it may take some time for a developer to figure out what has happened.</span></span>  
  
## <a name="correlation"></a><span data-ttu-id="45d15-150">Correlation</span><span class="sxs-lookup"><span data-stu-id="45d15-150">Correlation</span></span>  
 <span data-ttu-id="45d15-151">*Corrélation* dans les orchestrations est le mécanisme de réception des messages connexes dans la même instance d’orchestration en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="45d15-151">*Correlation* in orchestrations is the mechanism for receiving related messages into the same running orchestration instance.</span></span> <span data-ttu-id="45d15-152">Dans le Concepteur d'orchestration, un développeur procède de la manière suivante pour utiliser une corrélation :</span><span class="sxs-lookup"><span data-stu-id="45d15-152">In the Orchestration Designer a developer follows these general steps to use a correlation:</span></span>  
  
-   <span data-ttu-id="45d15-153">Il définit un type de corrélation qui inclut les propriétés promues utilisées pour mettre en relation des messages.</span><span class="sxs-lookup"><span data-stu-id="45d15-153">Defines a correlation type that includes the promoted properties that are used to relate messages.</span></span>  
  
-   <span data-ttu-id="45d15-154">Il définit un ensemble de corrélations constituant une instance du type de corrélation défini plus avant.</span><span class="sxs-lookup"><span data-stu-id="45d15-154">Defines a correlation set that is an instance of the correlation type just defined.</span></span>  
  
-   <span data-ttu-id="45d15-155">Il spécifie si les ports d'envoi et de réception initient ou suivent un ensemble de corrélations donné.</span><span class="sxs-lookup"><span data-stu-id="45d15-155">For the send and receive ports, specifies whether they initiate or follow a given correlation set.</span></span>  
  
 <span data-ttu-id="45d15-156">Les abonnements d'instance entrent en jeu lorsqu'un ensemble de corrélations est initié, par exemple lorsque des abonnements sont créés pour tous les ports qui suivent cet ensemble de corrélations pour la réception des messages.</span><span class="sxs-lookup"><span data-stu-id="45d15-156">Instance subscriptions come into play when a correlation set is initiated, as this is when subscriptions are created for all of those ports that follow this correlation set to receive messages.</span></span> <span data-ttu-id="45d15-157">Le type de corrélation définissant les propriétés utilisées pour la corrélation, le moteur d'orchestration peut les extraire du message envoyé ou reçu par l'action initiatrice.</span><span class="sxs-lookup"><span data-stu-id="45d15-157">Because the correlation type defines the properties to be used for correlation, the orchestration engine can extract these properties from the message being sent or received by the initiating action.</span></span> <span data-ttu-id="45d15-158">Ces valeurs sont ensuite utilisées pour définir des abonnements pour toutes les actions restantes qui suivent cet ensemble de corrélations.</span><span class="sxs-lookup"><span data-stu-id="45d15-158">These values are then used to define subscriptions for all of the remaining actions which follow this correlation set.</span></span>  
  
 <span data-ttu-id="45d15-159">Il est important que les propriétés promues des messages reçus dans BizTalk Server et destinés à être utilisés dans une corrélation soient correctement définies et promues dans le contexte de message.</span><span class="sxs-lookup"><span data-stu-id="45d15-159">It is important that messages received into BizTalk Server and intended for use in a correlation have their promoted properties correctly defined and promoted to the message context.</span></span> <span data-ttu-id="45d15-160">La plupart des propriétés sont promues lorsqu'un composant désassembleur dans un pipeline extrait les valeurs lors de la réception initiale du message.</span><span class="sxs-lookup"><span data-stu-id="45d15-160">Most properties get promoted when a disassembler component in a pipeline extracts the values when the message is initially received.</span></span> <span data-ttu-id="45d15-161">De ce fait, il n'est pas possible d'utiliser le pipeline de réception PassThrough pour recevoir des messages devant être corrélés à une instance d'orchestration en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="45d15-161">For this reason, it is not possible to use the PassThrough receive pipeline to receive messages that must be correlated to a running instance of an orchestration.</span></span> <span data-ttu-id="45d15-162">Ce problème survient lorsque vous utilisez l'adaptateur de réception SOAP pour recevoir des messages de corrélation, car le pipeline PassThrough est le pipeline de réception utilisé par défaut lorsque vous travaillez dans l'Assistant Publication de services Web.</span><span class="sxs-lookup"><span data-stu-id="45d15-162">This issue arises when you use the SOAP receive adapter to receive correlated messages, because the PassThrough pipeline is the default value for the receive pipeline when using the Web Services Publishing Wizard.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="45d15-163">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="45d15-163">See Also</span></span>  
 <span data-ttu-id="45d15-164">[Artefacts](../core/artifacts.md) </span><span class="sxs-lookup"><span data-stu-id="45d15-164">[Artifacts](../core/artifacts.md) </span></span>  
 [<span data-ttu-id="45d15-165">Création d’Orchestrations à l’aide du Concepteur d’Orchestration</span><span class="sxs-lookup"><span data-stu-id="45d15-165">Creating Orchestrations Using Orchestration Designer</span></span>](../core/creating-orchestrations-using-orchestration-designer.md)