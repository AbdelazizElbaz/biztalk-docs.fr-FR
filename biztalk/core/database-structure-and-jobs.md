---
title: "Structure et les travaux de base de données | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- PurgeSubscriptionsJob_BizTalkMsgBoxDb job
- MessageBox database, jobs [SQL Server Agent]
- DTA Purge and Archive (BizTalkDTADb) job
- TrackedMessages_Copy_BizTalkMsgBoxDb job
- MessageBox_Message_Cleanup_BizTalkMsgBoxDb job
- MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job
- Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], MessageBox database
- CleanupBTFExpiredEntriesJob_BizTalkMgmtDb job
- databases, structure
- Tracking database, jobs [SQL Server Agent]
- jobs [SQL Server Agent], Management database
- Backup BizTalk Server (BizTalkMgmtDb) job
- databases, SQL Server Agent jobs
- Business Rules Engine, jobs [SQL Server Agent]
- jobs, databases
- Management database, jobs [SQL Server Agent]
- MessageBox_UpdateStats_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], Business Rules Engine
- Rules_Database_Cleanup_BizTalkRuleEngineDb job
- MessageBox_Parts_Cleanup_BizTalkMsgBoxDb job
- jobs [SQL Server Agent], Tracking database
- MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb job
ms.assetid: f5f6b17d-0f5e-4821-a7eb-c345234ffc65
caps.latest.revision: "23"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bf98ef7fe236261fd3ee65ac6f4695455ba8c704
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="database-structure-and-jobs"></a><span data-ttu-id="f13fb-102">Structure et travaux de base de données</span><span class="sxs-lookup"><span data-stu-id="f13fb-102">Database Structure and Jobs</span></span>
<span data-ttu-id="f13fb-103">Cette rubrique présente la structure et les travaux de base de données de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="f13fb-103">This topic discusses the database structure and database jobs for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="database-write-diagram"></a><span data-ttu-id="f13fb-104">Schéma d'écriture dans une base de données</span><span class="sxs-lookup"><span data-stu-id="f13fb-104">Database Write Diagram</span></span>  
 <span data-ttu-id="f13fb-105">L'illustration ci-dessous montre les processus et entités qui écrivent dans les bases de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="f13fb-105">The following figure shows the processes and entities that write to the BizTalk Server databases.</span></span>  
  
 <span data-ttu-id="f13fb-106">![Processus d’écriture dans les bases de données BizTalk Server](../core/media/ebiz-ops-backup.gif "ebiz_ops_backup")</span><span class="sxs-lookup"><span data-stu-id="f13fb-106">![Processes that write to BizTalk Server databases](../core/media/ebiz-ops-backup.gif "ebiz_ops_backup")</span></span>  
  
        Database write diagram showing the processes and entities that write to the BizTalk Server databases  
  
## <a name="biztalk-server-database-jobs"></a><span data-ttu-id="f13fb-107">Travaux de base de données BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="f13fb-107">BizTalk Server Database Jobs</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="f13fb-108"> inclut les travaux d'Agent SQL Server suivants pour faciliter la gestion des bases de données BizTalk Server :</span><span class="sxs-lookup"><span data-stu-id="f13fb-108"> includes the following SQL Server Agent jobs to assist you in managing the BizTalk Server databases:</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f13fb-109">Les noms des travaux changent en fonction des noms de base de données donnés pendant la configuration.</span><span class="sxs-lookup"><span data-stu-id="f13fb-109">The names of the jobs change depending on the database names given during configuration.</span></span> <span data-ttu-id="f13fb-110">Si vous avez déployé plusieurs bases de données MessageBox dans votre environnement, il existera plusieurs travaux pour chaque MessageBox.</span><span class="sxs-lookup"><span data-stu-id="f13fb-110">If you have deployed multiple MessageBox databases in your environment, there will be several jobs for each MessageBox.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="f13fb-111">Dans la base de données de gestion BizTalk (BizTalkMgmtDb), il existe une procédure stockée nommée **adm_CleanupMgmtDB**.</span><span class="sxs-lookup"><span data-stu-id="f13fb-111">In the BizTalk Management (BizTalkMgmtDb) database, there's a stored procedure named **adm_CleanupMgmtDB**.</span></span> <span data-ttu-id="f13fb-112">**N’EXÉCUTEZ PAS CETTE PROCÉDURE STOCKÉE !**</span><span class="sxs-lookup"><span data-stu-id="f13fb-112">**DO NOT RUN THIS STORED PROCEDURE!**</span></span> <span data-ttu-id="f13fb-113">Si vous l'exécutez, toutes les entrées de la base de données seront supprimées.</span><span class="sxs-lookup"><span data-stu-id="f13fb-113">If you do run this stored procedure, all the entries in the database will be deleted.</span></span>  
  
|<span data-ttu-id="f13fb-114">Travail</span><span class="sxs-lookup"><span data-stu-id="f13fb-114">Job</span></span>|<span data-ttu-id="f13fb-115"> Description</span><span class="sxs-lookup"><span data-stu-id="f13fb-115">Description</span></span>|  
|---------|-----------------|  
|<span data-ttu-id="f13fb-116">Backup BizTalk Server (BizTalkMgmtDb)</span><span class="sxs-lookup"><span data-stu-id="f13fb-116">Backup BizTalk Server (BizTalkMgmtDb)</span></span>|<span data-ttu-id="f13fb-117">Ce travail effectue des sauvegardes complètes des bases et fichiers journaux des bases de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="f13fb-117">This job performs full database and log backups of the BizTalk Server databases.</span></span> <span data-ttu-id="f13fb-118">Pour plus d’informations sur la configuration et l’exécution de cette tâche, consultez [sauvegarde et restauration de bases de données BizTalk Server](../core/backing-up-and-restoring-biztalk-server-databases.md).</span><span class="sxs-lookup"><span data-stu-id="f13fb-118">For more information about configuring and running this job, see [Backing Up and Restoring BizTalk Server Databases](../core/backing-up-and-restoring-biztalk-server-databases.md).</span></span>|  
|<span data-ttu-id="f13fb-119">CleanupBTFExpiredEntriesJob_BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-119">CleanupBTFExpiredEntriesJob_BizTalkMgmtDb</span></span>|<span data-ttu-id="f13fb-120">Ce travail nettoie les anciennes entrées BizTalk Framework (BTF) de la base de données de gestion BizTalk (BizTalkMgmtDb).</span><span class="sxs-lookup"><span data-stu-id="f13fb-120">This job cleans up expired BizTalk Framework (BTF) entries in the BizTalk Management (BizTalkMgmtDb) database.</span></span>|  
|<span data-ttu-id="f13fb-121">DTA Purge and Archive (BizTalkDTADb)</span><span class="sxs-lookup"><span data-stu-id="f13fb-121">DTA Purge and Archive (BizTalkDTADb)</span></span>|<span data-ttu-id="f13fb-122">Ce travail archive automatiquement les données dans la base de données des suivis BizTalk (BizTalkDTADb) et purge les données obsolètes.</span><span class="sxs-lookup"><span data-stu-id="f13fb-122">This job automatically archives data in the BizTalk Tracking (BizTalkDTADb) database and purges obsolete data.</span></span> <span data-ttu-id="f13fb-123">Pour plus d’informations sur la configuration et l’exécution de cette tâche, consultez [l’archivage et la purge de la base de données de suivi BizTalk](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span><span class="sxs-lookup"><span data-stu-id="f13fb-123">For more information about configuring and running this job, see [Archiving and Purging the BizTalk Tracking Database](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span></span>|  
|<span data-ttu-id="f13fb-124">MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-124">MessageBox_DeadProcesses_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-125">Ce travail détecte le moment où une instance d'hôte BizTalk Server (service NT) s'arrête et libère le travail qu'elle a effectué pour qu'une autre instance d'hôte puisse à son tour travailler dessus.</span><span class="sxs-lookup"><span data-stu-id="f13fb-125">This job detects when a BizTalk Server host instance (NT service) has stopped and releases all work that was being done by that host instance so that it can be worked on by another host instance.</span></span>|  
|<span data-ttu-id="f13fb-126">MessageBox_Message_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-126">MessageBox_Message_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-127">Ce travail supprime tous les messages qui ne sont plus référencés par aucun abonné dans les tables de base de données MessageBox BizTalk (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="f13fb-127">This job removes all messages that are no longer being referenced by any subscribers in the BizTalk MessageBox (BizTalkMsgBoxDb) database tables.</span></span> <span data-ttu-id="f13fb-128">**Attention :** il s’agit d’un travail non planifié, qui est lancé par le travail MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb.</span><span class="sxs-lookup"><span data-stu-id="f13fb-128">**Caution:**  This is an unscheduled job which is started by the MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb job.</span></span> <span data-ttu-id="f13fb-129">Ne lancez pas ce travail manuellement.</span><span class="sxs-lookup"><span data-stu-id="f13fb-129">Do not manually start this job.</span></span>|  
|<span data-ttu-id="f13fb-130">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-130">MessageBox_Message_ManageRefCountLog_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-131">Ce travail gère les journaux des compteurs de références des messages et détermine le moment à partir duquel un message n'est plus référencé par aucun abonné.</span><span class="sxs-lookup"><span data-stu-id="f13fb-131">This job manages the reference count logs for messages and determines when a message is no longer referenced by any subscriber.</span></span> <span data-ttu-id="f13fb-132">**Remarque :** bien que ce travail de l’Agent SQL Server est planifié pour exécuter une fois par minute, la procédure stockée qui est appelée par ce travail contient la logique pour vous assurer que la procédure stockée s’exécute en permanence.</span><span class="sxs-lookup"><span data-stu-id="f13fb-132">**Note:**  Even thought this SQL Server Agent job is scheduled to run once per minute, the stored procedure that is called by this job contains logic to ensure that the stored procedure runs continually.</span></span> <span data-ttu-id="f13fb-133">Il s'agit d'un comportement par défaut qui ne doit pas être modifié.</span><span class="sxs-lookup"><span data-stu-id="f13fb-133">This is by design behavior and should not be modified.</span></span>|  
|<span data-ttu-id="f13fb-134">MessageBox_Parts_Cleanup_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-134">MessageBox_Parts_Cleanup_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-135">Ce travail supprime toutes les parties des messages qui ne sont plus référencées par aucun message dans les tables de base de données MessageBox BizTalk (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="f13fb-135">This job removes all message parts that are no longer being referenced by any messages in the BizTalk MessageBox (BizTalkMsgBoxDb) database tables.</span></span> <span data-ttu-id="f13fb-136">Tous les messages se composent d'une ou plusieurs parties qui contiennent véritablement les données des messages.</span><span class="sxs-lookup"><span data-stu-id="f13fb-136">All messages are made up of one or more message parts, which contain the actual message data.</span></span>|  
|<span data-ttu-id="f13fb-137">MessageBox_UpdateStats_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-137">MessageBox_UpdateStats_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-138">Ce travail met manuellement à jour les statistiques de la base de données MessageBox BizTalk (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="f13fb-138">This job manually updates the statistics for the BizTalk MessageBox (BizTalkMsgBoxDb) database.</span></span>|  
|<span data-ttu-id="f13fb-139">Analyser BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="f13fb-139">Monitor BizTalk Server</span></span>|<span data-ttu-id="f13fb-140">Ce travail analyse les bases de données BizTalkMgmtDb, BizTalkMsgBoxDb et BizTalkDTADb pour détecter les problèmes connus, y compris les instances orphelines.</span><span class="sxs-lookup"><span data-stu-id="f13fb-140">This job scans the BizTalkMgmtDb, BizTalkMsgBoxDb and BizTalkDTADb database for any known issues, including orphaned instances.</span></span>|  
|<span data-ttu-id="f13fb-141">Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-141">Operations_OperateOnInstances_OnMaster_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-142">Ce travail est nécessaire pour les déploiements de la base de données MessageBox multiples.</span><span class="sxs-lookup"><span data-stu-id="f13fb-142">This job is needed for multiple MessageBox deployments.</span></span> <span data-ttu-id="f13fb-143">Il effectue de façon asynchrone des actions opérationnelles, telles qu'un arrêt en bloc sur la MessageBox principale une fois ces modifications appliquées à la MessageBox subordonnée.</span><span class="sxs-lookup"><span data-stu-id="f13fb-143">It asynchronously performs operational actions such as bulk terminate on the master MessageBox after those changes have been applied to the subordinate MessageBox.</span></span>|  
|<span data-ttu-id="f13fb-144">PurgeSubscriptionsJob_BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-144">PurgeSubscriptionsJob_BizTalkMsgBoxDb</span></span>|<span data-ttu-id="f13fb-145">Ce travail purge les prédicats d'abonnement inutilisés dans la base de données MessageBox BizTalk Server (BizTalkMsgBoxDb).</span><span class="sxs-lookup"><span data-stu-id="f13fb-145">This job purges unused subscription predicates from the BizTalk Server MessageBox (BizTalkMsgBoxDb) database.</span></span>|  
|<span data-ttu-id="f13fb-146">Rules_Database_Cleanup_BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="f13fb-146">Rules_Database_Cleanup_BizTalkRuleEngineDb</span></span>|<span data-ttu-id="f13fb-147">Ce travail purge automatiquement les anciennes données d'audit de la base de données du moteur de règles (BizTalkRuleEngineDb) tous les 90 jours.</span><span class="sxs-lookup"><span data-stu-id="f13fb-147">This job automatically purges old audit data from the Rule Engine (BizTalkRuleEngineDb) database every 90 days.</span></span> <span data-ttu-id="f13fb-148">Ce travail purge également les anciennes données d'historique (notifications de déploiement/d'annulation de déploiement) de la base de données du moteur de règles (BizTalkRuleEngineDb) tous les 3 jours.</span><span class="sxs-lookup"><span data-stu-id="f13fb-148">This job also purges old history data (deploy/undeploy notifications) from the Rule Engine (BizTalkRuleEngineDb) database every 3 days.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="f13fb-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f13fb-149">See Also</span></span>  
 [<span data-ttu-id="f13fb-150">Le moteur de messagerie</span><span class="sxs-lookup"><span data-stu-id="f13fb-150">The Messaging Engine</span></span>](../core/the-messaging-engine.md)