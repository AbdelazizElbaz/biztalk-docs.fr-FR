---
title: "Migrer à partir de l’adaptateur MSMQT vers l’adaptateur MSMQ | Documents Microsoft"
ms.custom: 
ms.date: 12/07/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 97126f70-0be5-4a2f-bcba-173fd932b6de
caps.latest.revision: 
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 1696e732bdbd005b01f16834a075fe69460602f9
ms.sourcegitcommit: 32f380810b90b70e5df7be72a6a14988a747868e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/28/2018
---
# <a name="migrate-from-the-msmqt-adapter-to-the-msmq-adapter"></a><span data-ttu-id="b24dd-102">Migrer à partir de l’adaptateur MSMQT vers l’adaptateur MSMQ</span><span class="sxs-lookup"><span data-stu-id="b24dd-102">Migrate from the MSMQT Adapter to the MSMQ Adapter</span></span>
<span data-ttu-id="b24dd-103">Cette rubrique décrit les aspects à prendre en compte en relation avec la livraison chronologique de bout en bout des messages, la cohérence transactionnelle, la haute disponibilité et l'évolutivité avant de procéder à la migration des solutions de l'adaptateur BizTalk Message Queuing (MSMQT) vers l'adaptateur Message Queuing (MSMQ).</span><span class="sxs-lookup"><span data-stu-id="b24dd-103">This topic discusses points to consider regarding end-to-end ordered delivery, transactional consistency, high availability, and scalability before migrating solutions from the BizTalk Message Queuing (MSMQT) adapter to the Message Queuing (MSMQ) adapter.</span></span> <span data-ttu-id="b24dd-104">Dans le cadre de cette rubrique, la livraison chronologique des messages, la cohérence transactionnelle, la haute disponibilité et l'évolutivité sont définies comme suit :</span><span class="sxs-lookup"><span data-stu-id="b24dd-104">For purposes of this topic ordered delivery, transactional consistency, high availability, and scalability are defined as follows:</span></span>  
  
-   <span data-ttu-id="b24dd-105">**Livraison chronologique des messages.**</span><span class="sxs-lookup"><span data-stu-id="b24dd-105">**Ordered delivery.**</span></span> <span data-ttu-id="b24dd-106">Garantie que les messages sont envoyés depuis BizTalk Server dans l'ordre dans lequel ils ont été reçus.</span><span class="sxs-lookup"><span data-stu-id="b24dd-106">Guarantee that messages are sent out of BizTalk Server in the same order that they are received.</span></span>  
  
-   <span data-ttu-id="b24dd-107">**Cohérence transactionnelle.**</span><span class="sxs-lookup"><span data-stu-id="b24dd-107">**Transactional consistency.**</span></span> <span data-ttu-id="b24dd-108">Garantie que les messages traités ne sont pas perdus ou dupliqués en raison d'une défaillance matérielle, logicielle ou du réseau.</span><span class="sxs-lookup"><span data-stu-id="b24dd-108">Guarantee that messages being processed are not lost or duplicated due to hardware, software, or network failure.</span></span>  
  
-   <span data-ttu-id="b24dd-109">**Haute disponibilité.**</span><span class="sxs-lookup"><span data-stu-id="b24dd-109">**High availability.**</span></span> <span data-ttu-id="b24dd-110">Garantie que les services utilisés pour traiter les messages sont toujours disponibles pour le traitement.</span><span class="sxs-lookup"><span data-stu-id="b24dd-110">Guarantee that services used to process messages are always available for processing.</span></span>  
  
-   <span data-ttu-id="b24dd-111">**Évolutivité.**</span><span class="sxs-lookup"><span data-stu-id="b24dd-111">**Scalability.**</span></span> <span data-ttu-id="b24dd-112">Possibilité d'augmenter la capacité existante de traitement des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-112">Ability to increase existing message-processing capacity.</span></span>  
  
## <a name="end-to-end-ordered-delivery"></a><span data-ttu-id="b24dd-113">Livraison chronologique de bout en bout des messages</span><span class="sxs-lookup"><span data-stu-id="b24dd-113">End-to-End Ordered Delivery</span></span>  
 <span data-ttu-id="b24dd-114">L'adaptateur MSMQT assure la livraison chronologique de bout en bout des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-114">The MSMQT adapter ensures end-to-end ordered delivery of messages.</span></span> <span data-ttu-id="b24dd-115">Ainsi, si une application MSMQ envoie les messages 1, 2 et 3 à un emplacement de réception lié à l'adaptateur MSMQT, ces messages sont remis à une orchestration ou un port d'envoi dans BizTalk Server dans le même ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-115">This means that if an MSMQ application sends messages 1, 2, and 3 to a receive location bound to the MSMQT adapter, then these messages are delivered to an orchestration or send port in BizTalk Server in the same order: 1, 2, 3.</span></span> <span data-ttu-id="b24dd-116">Par exemple, cette fonctionnalité peut être utile pour les opérations boursières qui doivent être transmises et exécutées dans l'ordre dans lequel elles ont été reçues.</span><span class="sxs-lookup"><span data-stu-id="b24dd-116">One use of this functionality might include stock market trades that must be submitted and executed in the same order that they are received.</span></span>  
  
 <span data-ttu-id="b24dd-117">La livraison chronologique de bout en bout des messages avec MSMQT requiert le fonctionnement conjoint de divers composants.</span><span class="sxs-lookup"><span data-stu-id="b24dd-117">End-to-end in-order delivery with MSMQT requires many components to be working together.</span></span> <span data-ttu-id="b24dd-118">La séquence d'événements suivante illustre cet aspect avec l'adaptateur MSMQT :</span><span class="sxs-lookup"><span data-stu-id="b24dd-118">The following sequence of events illustrates how this is done with the MSMQT adapter:</span></span>  
  
1.  <span data-ttu-id="b24dd-119">L'API MSMQ sur un ordinateur distant reçoit les messages 1, 2 et 3 et les transmet à une file d'attente locale transactionnelle dans le même ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-119">The MSMQ API on a remote computer receives messages 1, 2, and 3 in order and pushes them into a transactional, local queue in the same order: 1, 2, 3.</span></span>  
  
2.  <span data-ttu-id="b24dd-120">Un client MSMQ sur l'ordinateur distant extrait les messages de la file d'attente et les envoie à la file d'attente MSMQT dans l'ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-120">An MSMQ client on the remote computer takes the messages from the queue and sends them to the MSMQT queue in order: 1, 2, 3.</span></span>  
  
3.  <span data-ttu-id="b24dd-121">L'adaptateur MSMQT reçoit les messages dans l'ordre 1, 2, 3 et les transmet au composant MessageAgent de BizTalk dans le même ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-121">The MSMQT adapter receives the messages in order 1, 2, 3 and hands them to the BizTalk MessageAgent component in the same order: 1, 2, 3.</span></span>  
  
4.  <span data-ttu-id="b24dd-122">Le composant MessageAgent de BizTalk vérifie que les messages sont envoyés à la base de données MessageBox dans l'ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-122">The BizTalk MessageAgent component ensures that the messages are sent to the MessageBox in order: 1, 2, 3.</span></span>  
  
5.  <span data-ttu-id="b24dd-123">La base de données MessageBox achemine les messages et, si ceux-ci sont acheminés à la même instance d'une orchestration ou d'un port d'envoi, vérifie qu'ils sont remis à cette instance dans le même ordre : 1, 2, 3.</span><span class="sxs-lookup"><span data-stu-id="b24dd-123">The MessageBox routes the messages and ensures that if they are routed to the same instance of an orchestration or a send port, that they are delivered to this instance in the same order: 1, 2, 3.</span></span>  
  
 <span data-ttu-id="b24dd-124">Dans BizTalk Server 2004, MSMQT a été le seul adaptateur capable d’assurer de bout en fin de livraison chronologique des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-124">In BizTalk Server 2004, MSMQT was the only adapter capable of guaranteeing end-to end ordered delivery.</span></span> <span data-ttu-id="b24dd-125">Tous les autres adaptateurs BizTalk intégrés peuvent modifier l'ordre des messages au cours des étapes 3 à 5 indiquées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="b24dd-125">All of the other integrated BizTalk adapters can potentially change the order of the messages in steps 3 through 5 listed above.</span></span> <span data-ttu-id="b24dd-126">La plupart des autres adaptateurs intégrés effectuent l'étape 3 à l'aide d'un composant appelé Gestionnaire de points de terminaison. Celui-ci étant multithread par nature, il ne conserve pas l'ordre des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-126">Most of the other integrated adapters complete step 3 by the use of a component known as the End Point Manager, which is inherently multithreaded and therefore does not preserve order.</span></span> <span data-ttu-id="b24dd-127">L’adaptateur BizTalk Server 2004 MSMQ utilisé une fonctionnalité « Traitement en série » qui conserve l’ordre de l’étape 3, mais il ne demande pas puis au composant MessageAgent préserver l’ordre à l’avenir, afin que les messages peuvent être acheminés à une orchestration ou port d’envoi de manière désordonnée.</span><span class="sxs-lookup"><span data-stu-id="b24dd-127">The BizTalk Server 2004 MSMQ adapter used a "Serial Processing" feature that preserves order for step 3, but it does not then ask the MessageAgent to preserve order going forward, so the messages may be routed to an orchestration or send port out of order.</span></span>  
  
 <span data-ttu-id="b24dd-128">**Livraison chronologique des messages avec l’adaptateur MSMQ de bout en bout**</span><span class="sxs-lookup"><span data-stu-id="b24dd-128">**End-to-end ordered delivery with the MSMQ adapter**</span></span>  
  
 <span data-ttu-id="b24dd-129">Pour obtenir une livraison chronologique des messages avec l’adaptateur MSMQ de bout en bout, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b24dd-129">To achieve end-to-end ordered delivery with the MSMQ adapter, follow these steps:</span></span>  
  
1.  <span data-ttu-id="b24dd-130">Activer la **livraison chronologique des messages** propriété sur la réception de l’orchestration d’abonnement de port ou le port d’envoi.</span><span class="sxs-lookup"><span data-stu-id="b24dd-130">Enable the **Ordered Delivery** property on the receive port for the subscribing orchestration or send port.</span></span> <span data-ttu-id="b24dd-131">Dans BizTalk Server, les ports dans les orchestrations et ports d’envoi doivent une **livraison chronologique des messages** option de configuration.</span><span class="sxs-lookup"><span data-stu-id="b24dd-131">In BizTalk Server, receive ports in orchestrations and send ports have an **Ordered Delivery** configuration option.</span></span> <span data-ttu-id="b24dd-132">Lorsque celle-ci est activée, le port de réception de l'orchestration ou le port d'envoi demande à la base de données MessageBox de lui remettre les messages dans l'ordre dans lequel ils ont été envoyés à la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="b24dd-132">If this option is enabled, then the orchestration receive port or the send port asks the MessageBox to deliver messages to it in the same order they were submitted into the MessageBox.</span></span>  
  
2.  <span data-ttu-id="b24dd-133">Définir le **traitement chronologique** propriété pour l’emplacement de réception qui est lié à l’adaptateur MSMQ sur `True`.</span><span class="sxs-lookup"><span data-stu-id="b24dd-133">Set the **Ordered Processing** property for the receive location that is bound to the MSMQ adapter to `True`.</span></span> <span data-ttu-id="b24dd-134">Dans BizTalk Server, les emplacements que l’utilisation du transport MSMQ peut être configurée pour utiliser le traitement chronologique, qui, s’il est activé, permet de s’assurer que les messages sont envoyés vers la MessageBox dans le même ordre qu’ils ont été reçus de réception.</span><span class="sxs-lookup"><span data-stu-id="b24dd-134">In BizTalk Server, receive locations that use the MSMQ transport can be configured to use Ordered Processing which, if enabled, ensures that messages are sent to the MessageBox in the same order that they were received.</span></span>  
  
3.  <span data-ttu-id="b24dd-135">Définir le **transactionnel** propriété pour l’emplacement de réception qui est lié à l’adaptateur MSMQ sur `True`.</span><span class="sxs-lookup"><span data-stu-id="b24dd-135">Set the **Transactional** property for the receive location that is bound to the MSMQ adapter to `True`.</span></span>  
  
4.  <span data-ttu-id="b24dd-136">Vérifiez que les files d'attentes MSMQ surveillées par les emplacements de réception MSMQ sont marquées comme « transactionnelles ».</span><span class="sxs-lookup"><span data-stu-id="b24dd-136">Ensure that any MSMQ queues that are being monitored by the MSMQ receive locations are marked as "Transactional".</span></span> <span data-ttu-id="b24dd-137">Cette propriété doit être définie sur les files d'attente pour assurer la livraison chronologique des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-137">This property must be set on the queues to ensure ordered delivery of messages.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b24dd-138">La livraison chronologique des messages n'est garantie que si la ou les files d'attente MSMQ surveillées par les emplacements de réception BizTalk sont traitées par un seul ordinateur.</span><span class="sxs-lookup"><span data-stu-id="b24dd-138">Ordered delivery is guaranteed only if the MSMQ queue or queues that are being monitored by BizTalk receive locations is/are serviced by only one computer.</span></span> <span data-ttu-id="b24dd-139">Une telle configuration peut présenter des problèmes d'évolutivité, comme décrit ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="b24dd-139">This can present problems for scalability, as described below.</span></span>  
  
## <a name="transaction-usage-when-processing-messages-with-the-msmqt-adapter-vs-the-msmq-adapter"></a><span data-ttu-id="b24dd-140">Utilisation des transactions lors du traitement des messages avec l'adaptateur MSMQT et l'adaptateur MSMQ</span><span class="sxs-lookup"><span data-stu-id="b24dd-140">Transaction Usage When Processing Messages with the MSMQT Adapter vs. the MSMQ Adapter</span></span>  
 <span data-ttu-id="b24dd-141">Le traitement des messages par les adaptateurs MSMQT et MSMQ diffère du point de vue de l'utilisation des transactions.</span><span class="sxs-lookup"><span data-stu-id="b24dd-141">With regard to transaction usage, there is a key difference between how the MSMQT and MSMQ adapters process messages.</span></span>  
  
 <span data-ttu-id="b24dd-142">Lorsque l'adaptateur MSMQT est utilisé, les processus ayant trait à la réception d'un message du réseau et à son traitement avec BizTalk Server sont gérés sous une seule transaction.</span><span class="sxs-lookup"><span data-stu-id="b24dd-142">When using the MSMQT adapter, the process of receiving a message from the network and processing it with BizTalk Server is handled under a single transaction.</span></span> <span data-ttu-id="b24dd-143">De même, les messages d'accusé de réception générés pour l'expéditeur indiquent que le message a été reçu et traité par BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b24dd-143">When using the MSMQT adapter, ACK messages generated for the sender are an indication that the message has been received and has been successfully processed by BizTalk Server.</span></span>  
  
 <span data-ttu-id="b24dd-144">Lorsque l'adaptateur MSMQ est utilisé, les processus ayant trait à la réception d'un message du réseau et à son traitement avec BizTalk Server sont gérés sous deux transactions distinctes (une pour la réception du réseau et une pour le traitement avec BizTalk Server).</span><span class="sxs-lookup"><span data-stu-id="b24dd-144">When using the MSMQ adapter, the processes of receiving a message from the network and processing it with BizTalk Server are handled under two separate transactions, one for receiving from the network and one for processing it with BizTalk Server.</span></span> <span data-ttu-id="b24dd-145">De même, les messages d'accusé de réception générés pour l'expéditeur indiquent seulement que le message a été reçu du réseau, pas qu'il a été traité par BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b24dd-145">When using the MSMQ adapter, ACK messages generated for the sender are only an indication that the message has been successfully received from the network, not that the message has been successfully processed by BizTalk Server.</span></span> <span data-ttu-id="b24dd-146">L'expéditeur reçoit un accusé de réception du serveur Microsoft Message Queuing lorsque le message est reçu du réseau et conservé dans la file d'attente MSMQ locale, que BizTalk Server soit installé ou non.</span><span class="sxs-lookup"><span data-stu-id="b24dd-146">The sender receives an ACK from the Microsoft Message Queuing server when the message is received from the network and persisted into the local MSMQ queue regardless of whether BizTalk Server is installed.</span></span> <span data-ttu-id="b24dd-147">Une fois le message conservé dans la file d'attente MSMQ, l'adaptateur MSMQ le récupère, le traite et le publie dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="b24dd-147">After the message has been persisted to the MSMQ queue, the BizTalk MSMQ adapter picks it up, processes it, and publishes it to the MessageBox.</span></span> <span data-ttu-id="b24dd-148">En cas d'échec de ce processus, le message est envoyé à la file d'attente des messages interrompus de BizTalk ou conservé dans la file d'attente MSMQ locale (lorsque le traitement transactionnel est utilisé), et l'expéditeur n'est pas informé de l'échec du traitement du message dans BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b24dd-148">If this process fails, the message is either sent to the BizTalk suspended queue or left in the local MSMQ queue (when using transactional processing), and the sender has no indication that the message failed processing in BizTalk Server.</span></span>  
  
 <span data-ttu-id="b24dd-149">Si votre architecture inclut la réception d'accusés de réception en cas de traitement réussi des messages par BizTalk Server, vous pouvez ajouter les accusés de réception au niveau de l'application si vous effectuez une migration de l'adaptateur MSMQT vers l'adaptateur MSMQ.</span><span class="sxs-lookup"><span data-stu-id="b24dd-149">If your architecture requires that you receive ACKs when your messages are successfully processed by BizTalk Server, then you must add application-level ACKs if you are migrating from the MSMQT adapter to the MSMQ adapter.</span></span> <span data-ttu-id="b24dd-150">Vous devez mettre à jour votre orchestration et l'application d'envoi pour implémenter les accusés de réception au niveau de l'application.</span><span class="sxs-lookup"><span data-stu-id="b24dd-150">You will need to update your orchestration and sending application to implement application-level ACKs.</span></span>  
  
## <a name="high-availability-transactional-in-order"></a><span data-ttu-id="b24dd-151">Haute disponibilité (transactionnelle, chronologique)</span><span class="sxs-lookup"><span data-stu-id="b24dd-151">High Availability (Transactional, in Order)</span></span>  
 <span data-ttu-id="b24dd-152">Pour fournir une haute disponibilité de l’adaptateur MSMQT vous pouvez ajouter plusieurs ordinateurs à l’hôte de réception et configurer l’équilibrage de charge réseau (NLB) pour la tolérance de panne, ou vous pouvez mettre en cluster l’hôte BizTalk par défaut.</span><span class="sxs-lookup"><span data-stu-id="b24dd-152">To provide high availability for the MSMQT adapter you can either add multiple computers to the receive host and configure Network Load Balancing (NLB) for fault tolerance or you can cluster the default BizTalk Host.</span></span> <span data-ttu-id="b24dd-153">Si vous exécutez l'adaptateur MSMQT avec l'équilibrage de la charge réseau, les autres serveurs gèrent la charge d'un serveur tombé en panne.</span><span class="sxs-lookup"><span data-stu-id="b24dd-153">If you are running the MSMQT adapter in conjunction with NLB, if one server goes down the other servers handle the load.</span></span> <span data-ttu-id="b24dd-154">Si vous exécutez les gestionnaires de l'adaptateur MSMQT sur un hôte en cluster, l'échec d'un nœud d'hôte provoque l'échec du logiciel du cluster via l'hôte en cluster sur l'autre nœud.</span><span class="sxs-lookup"><span data-stu-id="b24dd-154">If you are running the MSMQT adapter handlers on a clustered host, if one host node fails, cluster software fails over the clustered host to the other node.</span></span> <span data-ttu-id="b24dd-155">Lorsque l'adaptateur MSMQ est utilisé, l'équilibrage de la charge réseau ne fonctionne pas si vous devez utiliser le traitement transactionnel sans perte de données car l'adaptateur MSMQ utilise les files d'attente MSMQ locales pour le stockage intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="b24dd-155">When using the MSMQ adapter, NLB does not work if you need transactional processing with no data loss because the MSMQ adapter uses local MSMQ queues for intermediate storage.</span></span> <span data-ttu-id="b24dd-156">Dans ce cas, si un message remis à une file d'attente MSMQ locale n'est pas consommé par l'adaptateur MSMQ, il est perdu lorsque l'ordinateur échoue.</span><span class="sxs-lookup"><span data-stu-id="b24dd-156">In this scenario, if a message has been delivered to the local MSMQ queue but has not been consumed by the MSMQ adapter, the message is lost if the computer fails.</span></span>  
  
 <span data-ttu-id="b24dd-157">Pour fournir une haute disponibilité et la cohérence transactionnelle avec l’adaptateur MSMQ, vous devez procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="b24dd-157">To provide high availability and transactional consistency with the MSMQ adapter, you should do the following:</span></span>  
  
1.  <span data-ttu-id="b24dd-158">Configurez Microsoft Message Queuing (MSMQ) en tant que ressource mise en cluster dans un groupe de clusters de serveurs Windows Server sur vos serveurs BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="b24dd-158">Configure Microsoft Message Queuing (MSMQ) as a clustered resource in a Windows Server cluster group on your BizTalk servers.</span></span>  
  
2.  <span data-ttu-id="b24dd-159">Configurez le gestionnaire de réception de l'adaptateur MSMQ dans une instance d'hôte BizTalk préalablement définie en tant que ressource de cluster dans le même groupe de clusters que la ressource MSMQ en cluster.</span><span class="sxs-lookup"><span data-stu-id="b24dd-159">Configure the MSMQ adapter receive handler in a BizTalk Host instance that has been configured as a cluster resource in the same cluster group as the clustered MSMQ resource.</span></span>  
  
3.  <span data-ttu-id="b24dd-160">Configurez la ressource de cluster pour l'instance d'hôte BizTalk afin qu'elle maintienne une dépendance sur la ressource MSMQ en cluster.</span><span class="sxs-lookup"><span data-stu-id="b24dd-160">Configure the cluster resource for the BizTalk Host instance so that it maintains a dependency on the clustered MSMQ resource.</span></span>  
  
 <span data-ttu-id="b24dd-161">Pour implémenter la livraison chronologique des messages avec cette architecture, suivez les étapes présentées précédemment sous « De bout en bout livraison chronologique des messages avec l’adaptateur MSMQ. »</span><span class="sxs-lookup"><span data-stu-id="b24dd-161">To implement ordered delivery with this architecture, follow the steps presented earlier under "End-to-end ordered delivery with the MSMQ adapter."</span></span>  
  
## <a name="high-availability-nontransactional-not-in-order"></a><span data-ttu-id="b24dd-162">Haute disponibilité (non transactionnelle, non chronologique)</span><span class="sxs-lookup"><span data-stu-id="b24dd-162">High Availability (Nontransactional, Not in Order)</span></span>  
 <span data-ttu-id="b24dd-163">Pour implémenter la haute disponibilité sans le traitement transactionnel à l'aide de l'adaptateur MSMQ, vous devez implémenter l'équilibrage de la charge réseau et exécuter les instances d'un hôte configuré avec les gestionnaires d'envoi et de réception MSMQ sur plusieurs serveurs BizTalk derrière l'équilibrage de la charge réseau.</span><span class="sxs-lookup"><span data-stu-id="b24dd-163">If you need high availability but do not need transactional processing, you can achieve this with the MSMQ adapter by implementing NLB and running instances of a host configured with the MSMQ send and receive handlers on multiple BizTalk servers behind NLB.</span></span> <span data-ttu-id="b24dd-164">Lors de l’implémentation d’équilibrage de charge réseau avec MSMQ vous devez suivre les meilleures pratiques décrites dans l’article de la Base de connaissances Microsoft [899611 : comment Message Queuing peut fonctionner sur l’équilibrage de charge réseau (NLB)](https://support.microsoft.com/help/899611/how-message-queuing-can-function-over-network-load-balancing-nlb).</span><span class="sxs-lookup"><span data-stu-id="b24dd-164">When implementing NLB with MSMQ you should follow best practices as documented in Microsoft Knowledge Base article [899611 : How Message Queuing can function over Network Load Balancing (NLB)](https://support.microsoft.com/help/899611/how-message-queuing-can-function-over-network-load-balancing-nlb).</span></span> <span data-ttu-id="b24dd-165">Dans ce scénario, l'échec d'un des serveurs BizTalk provoque l'indisponibilité des messages exécutés dans l'instance d'hôte sur ce serveur jusqu'à la récupération du serveur BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b24dd-165">In this scenario, if one of the BizTalk servers fails, the messages that are running in the host instance on that BizTalk server will be unavailable until the BizTalk server is recovered.</span></span> <span data-ttu-id="b24dd-166">Dans cette configuration, la haute disponibilité est assurée comme suit : si l'un des serveurs BizTalk n'est pas disponible, l'équilibrage de la charge réseau achemine les demandes vers l'autre serveur BizTalk.</span><span class="sxs-lookup"><span data-stu-id="b24dd-166">This configuration provides high availability because if one of the BizTalk servers is not available, NLB routes requests to the other BizTalk server.</span></span>  
  
## <a name="scalability-nontransactional-not-in-order"></a><span data-ttu-id="b24dd-167">Évolutivité (non transactionnelle, non chronologique)</span><span class="sxs-lookup"><span data-stu-id="b24dd-167">Scalability (Nontransactional, Not in Order)</span></span>  
 <span data-ttu-id="b24dd-168">Pour implémenter l'évolutivité, suivez les directives relatives à la haute disponibilité (non transactionnelle) et ajoutez des instances d'hôte supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="b24dd-168">You can achieve scalability by following the guidelines for high availability (nontransactional) and adding additional host instances.</span></span> <span data-ttu-id="b24dd-169">Cette architecture favorise la livraison rapide et l'évolutivité, mais n'assure pas la livraison chronologique des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-169">This architecture provides fast delivery as well as scalability, but does not provide ordered delivery.</span></span>  
  
## <a name="scalability-transactional-not-in-order"></a><span data-ttu-id="b24dd-170">Évolutivité (transactionnelle, non chronologique)</span><span class="sxs-lookup"><span data-stu-id="b24dd-170">Scalability (Transactional, Not in Order)</span></span>  
 <span data-ttu-id="b24dd-171">Pour implémenter la livraison transactionnelle des messages sans livraison chronologique, vous pouvez combiner l'équilibrage de la charge réseau avec MSMQ et le clustering Windows.</span><span class="sxs-lookup"><span data-stu-id="b24dd-171">For transactional delivery of messages without ordered delivery, you can combine the use of NLB with MSMQ and Windows clustering.</span></span> <span data-ttu-id="b24dd-172">Cette architecture requiert la configuration d'au moins deux groupes de cluster dans deux environnements en cluster Windows distincts en suivant les étapes de la section « Haute disponibilité (transactionnelle, chronologique) » pour chaque cluster Windows.</span><span class="sxs-lookup"><span data-stu-id="b24dd-172">This architecture requires that you configure at least two cluster groups on two separate Windows Cluster environments following the steps under "High Availability (Transactional, in Order)" for each Windows Cluster.</span></span> <span data-ttu-id="b24dd-173">Vous devez ensuite implémenter l'équilibrage de la charge réseau pour répartir la charge entre les groupes de cluster.</span><span class="sxs-lookup"><span data-stu-id="b24dd-173">You then implement NLB to distribute load between the cluster groups.</span></span> <span data-ttu-id="b24dd-174">Comme l'équilibrage de la charge réseau n'est pas pris en charge sur un cluster Windows, ce scénario requiert une solution d'équilibrage de la charge réseau matérielle.</span><span class="sxs-lookup"><span data-stu-id="b24dd-174">Because Windows NLB is not supported running on a Windows Cluster, this scenario requires a hardware NLB solution.</span></span> <span data-ttu-id="b24dd-175">Le diagramme suivant illustre cette architecture.</span><span class="sxs-lookup"><span data-stu-id="b24dd-175">The following diagram illustrates this architecture.</span></span>  
  
 <span data-ttu-id="b24dd-176">![Équilibrage de charge entre les groupes de clusters](../core/media/scaleclusteredmsmqwithnlb.gif "ScaleClusteredMSMQwithNLB")</span><span class="sxs-lookup"><span data-stu-id="b24dd-176">![Load balancing between cluster groups](../core/media/scaleclusteredmsmqwithnlb.gif "ScaleClusteredMSMQwithNLB")</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b24dd-177">Cette architecture n'assure pas la livraison chronologique des messages.</span><span class="sxs-lookup"><span data-stu-id="b24dd-177">This architecture does not provide ordered delivery.</span></span>  
  
## <a name="scalability-transactional-in-order"></a><span data-ttu-id="b24dd-178">Évolutivité (transactionnelle, chronologique)</span><span class="sxs-lookup"><span data-stu-id="b24dd-178">Scalability (Transactional, in Order)</span></span>  
 <span data-ttu-id="b24dd-179">L'évolution horizontale d'une architecture qui assure la haute disponibilité, la cohérence transactionnelle et la livraison chronologique des messages pose problème si MSMQ 3.0 ou une version antérieure est utilisée. En effet, les lectures transactionnelles à distance ne sont pas prises en charge sauf si l'ordinateur BizTalk Server et le serveur MSMQ distant exécutent MSMQ 4.0.</span><span class="sxs-lookup"><span data-stu-id="b24dd-179">Scaling out an architecture that provides high availability, transactional consistency, and ordered delivery is problematic when using MSMQ 3.0 or earlier because remote transactional reads are not supported unless both the BizTalk Server computer and the remote MSMQ server are running MSMQ 4.0.</span></span> <span data-ttu-id="b24dd-180">Lorsque MSMQ 3.0 ou une version antérieure est utilisée, vous devez procéder à l'évolution horizontale à l'aide de plusieurs files d'attente MSMQ locales.</span><span class="sxs-lookup"><span data-stu-id="b24dd-180">When using MSMQ 3.0 or earlier, scale out must be achieved using multiple local MSMQ queues.</span></span> <span data-ttu-id="b24dd-181">Dans ce cas, si la connexion TCP/IP entre la session MSMQ et l'équilibrage de la charge réseau est interrompue, elle peut être restaurée par l'équilibrage de la charge réseau vers un autre ordinateur, ce qui peut entraîner une livraison non chronologique.</span><span class="sxs-lookup"><span data-stu-id="b24dd-181">Furthermore, in this scenario, if the TCP/IP connection for the MSMQ session to the NLB is broken, it may subsequently be restored by NLB to a different computer, which can cause out-of-order delivery.</span></span>  
  
 <span data-ttu-id="b24dd-182">Pour contourner cette limitation, vous pouvez équilibrer manuellement la charge associée à la livraison des messages en affectant des files d'attente de destination à différents ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="b24dd-182">One possible workaround to this limitation is to manually load balance message delivery by allocating destination queues to different computers.</span></span> <span data-ttu-id="b24dd-183">Pour ce faire, vous devez lier des instances d'hôte BizTalk spécifiques à des files d'attente MSMQ spécifiques.</span><span class="sxs-lookup"><span data-stu-id="b24dd-183">You can so this by tying specific BizTalk Host instances to specific MSMQ queues.</span></span> <span data-ttu-id="b24dd-184">Par exemple, si vous recevez un grand nombre de document d'un partenaire commercial particulier, créez un hôte distinct et une file d'attente de réception sur un serveur BizTalk particulier pour ce partenaire commercial uniquement.</span><span class="sxs-lookup"><span data-stu-id="b24dd-184">So for example, if you receive a large number of documents from one particular trading partner, create a separate host and receive queue on a particular BizTalk server for just that trading partner.</span></span>  
  
 <span data-ttu-id="b24dd-185">Si possible, exécutez MSMQ 4.0 sur les ordinateurs distants lorsque les lectures transactionnelles distantes et l'équilibrage de la charge sont requis.</span><span class="sxs-lookup"><span data-stu-id="b24dd-185">If possible, run MSMQ 4.0 on remote computers when both remote transactional reads and load balancing are required.</span></span>  
  
## <a name="summary"></a><span data-ttu-id="b24dd-186">Résumé</span><span class="sxs-lookup"><span data-stu-id="b24dd-186">Summary</span></span>  
 <span data-ttu-id="b24dd-187">Le tableau suivant récapitule les architectures que vous pouvez implémenter pour prendre en charge les fonctionnalités spécifiques.</span><span class="sxs-lookup"><span data-stu-id="b24dd-187">The following table summarizes the architectures that you can implement to accommodate specific functionality.</span></span>  
  
|<span data-ttu-id="b24dd-188">**Fonctionnalités**</span><span class="sxs-lookup"><span data-stu-id="b24dd-188">**Functionality**</span></span>|<span data-ttu-id="b24dd-189">**Équilibrage de charge réseau, ni cluster**</span><span class="sxs-lookup"><span data-stu-id="b24dd-189">**Neither NLB nor cluster**</span></span>|<span data-ttu-id="b24dd-190">**NLB**</span><span class="sxs-lookup"><span data-stu-id="b24dd-190">**NLB**</span></span>|<span data-ttu-id="b24dd-191">**Cluster**</span><span class="sxs-lookup"><span data-stu-id="b24dd-191">**Cluster**</span></span>|<span data-ttu-id="b24dd-192">**Équilibrage de charge réseau et le cluster**</span><span class="sxs-lookup"><span data-stu-id="b24dd-192">**NLB and cluster**</span></span>|  
|-----------------------|---------------------------------|-------------|-----------------|-------------------------|  
|<span data-ttu-id="b24dd-193">Livraison chronologique des messages de bout en bout</span><span class="sxs-lookup"><span data-stu-id="b24dd-193">End-to-end ordered delivery</span></span>|<span data-ttu-id="b24dd-194">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-194">Yes</span></span>|<span data-ttu-id="b24dd-195">Non</span><span class="sxs-lookup"><span data-stu-id="b24dd-195">No</span></span>|<span data-ttu-id="b24dd-196">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-196">Yes</span></span>|<span data-ttu-id="b24dd-197">Possible avec une configuration manuelle</span><span class="sxs-lookup"><span data-stu-id="b24dd-197">Possible with manual configuration</span></span>|  
|<span data-ttu-id="b24dd-198">Cohérence transactionnelle</span><span class="sxs-lookup"><span data-stu-id="b24dd-198">Transactional consistency</span></span>|<span data-ttu-id="b24dd-199">Non (les messages peuvent être perdus ou dupliqués en cas de défaillance du service)</span><span class="sxs-lookup"><span data-stu-id="b24dd-199">No (messages can be lost or duplicated if service failure occurs)</span></span>|<span data-ttu-id="b24dd-200">non</span><span class="sxs-lookup"><span data-stu-id="b24dd-200">No</span></span>|<span data-ttu-id="b24dd-201">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-201">Yes</span></span>|<span data-ttu-id="b24dd-202">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-202">Yes</span></span>|  
|<span data-ttu-id="b24dd-203">Haute disponibilité</span><span class="sxs-lookup"><span data-stu-id="b24dd-203">Highly available</span></span>|<span data-ttu-id="b24dd-204">non</span><span class="sxs-lookup"><span data-stu-id="b24dd-204">No</span></span>|<span data-ttu-id="b24dd-205">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-205">Yes</span></span>|<span data-ttu-id="b24dd-206">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-206">Yes</span></span>|<span data-ttu-id="b24dd-207">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-207">Yes</span></span>|  
|<span data-ttu-id="b24dd-208">Évolutivité</span><span class="sxs-lookup"><span data-stu-id="b24dd-208">Scalable</span></span>|<span data-ttu-id="b24dd-209">non</span><span class="sxs-lookup"><span data-stu-id="b24dd-209">No</span></span>|<span data-ttu-id="b24dd-210">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-210">Yes</span></span>|<span data-ttu-id="b24dd-211">Non</span><span class="sxs-lookup"><span data-stu-id="b24dd-211">No</span></span>|<span data-ttu-id="b24dd-212">Oui</span><span class="sxs-lookup"><span data-stu-id="b24dd-212">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="b24dd-213">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b24dd-213">See Also</span></span>  
 [<span data-ttu-id="b24dd-214">À l’aide de Cluster Windows Server pour fournir une haute disponibilité pour BizTalk Server Hosts2</span><span class="sxs-lookup"><span data-stu-id="b24dd-214">Using Windows Server Cluster to Provide High Availability for BizTalk Server Hosts2</span></span>](../core/use-windows-cluster-to-provide-high-availability-for-biztalk-hosts.md)