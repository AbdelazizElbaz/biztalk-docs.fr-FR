---
title: "Générer un MDN sortant | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 12d7da1c-0d3c-42d4-9388-29f499353d13
caps.latest.revision: "20"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a903cc72a41362f6843449a4d635878706f2ea1e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="generating-an-outgoing-mdn"></a><span data-ttu-id="07a09-102">Génération d'une réponse MDN sortante</span><span class="sxs-lookup"><span data-stu-id="07a09-102">Generating an Outgoing MDN</span></span>
<span data-ttu-id="07a09-103">Les pipelines de réception AS2 génèrent une réponse MDN (Message Disposition Notification) à un message entrant.</span><span class="sxs-lookup"><span data-stu-id="07a09-103">The AS2 receive pipelines generate an MDN (Message Disposition Notification) response for an incoming message.</span></span> <span data-ttu-id="07a09-104">Cette opération est effectuée par le composant de pipeline du Désassembleur EDI dans le pipeline de réception AS2EDIReceive (en réponse à un message EDI) ou par le composant de pipeline du Désassembleur AS2 dans le pipeline de réception AS2Receive (en réponse à un message non EDI).</span><span class="sxs-lookup"><span data-stu-id="07a09-104">This is performed by the EDI Disassembler pipeline component in the AS2EDIReceive receive pipeline (in response to an EDI-encoded message) or the AS2 Disassembler pipeline component in the AS2Receive receive pipeline (in response to a non-EDI-encoded message).</span></span>  
  
## <a name="when-and-how-an-mdn-is-generated"></a><span data-ttu-id="07a09-105">Circonstances provoquant la génération d'un MDN</span><span class="sxs-lookup"><span data-stu-id="07a09-105">When and How an MDN is Generated</span></span>  
 <span data-ttu-id="07a09-106">En général, un MDN est généré en fonction des en-têtes AS2 du message AS2 d'origine, de la façon suivante :</span><span class="sxs-lookup"><span data-stu-id="07a09-106">An MDN is normally generated based upon the AS2 headers in the original AS2 message, as follows:</span></span>  
  
-   <span data-ttu-id="07a09-107">Si l'en-tête Disposition-Notification-To est présent dans le message AS2, un MDN sera envoyé.</span><span class="sxs-lookup"><span data-stu-id="07a09-107">An MDN will be sent if the Disposition-Notification-To header is present in the AS2 message.</span></span>  
  
-   <span data-ttu-id="07a09-108">Si les en-têtes Disposition-Notification-To et Receipt-Delivery-Option sont présents dans le message, le MDN sera envoyé de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="07a09-108">If the Disposition-Notification-To header and the Receipt-Delivery-Option header are present in the message, the MDN will be sent asynchronously.</span></span> <span data-ttu-id="07a09-109">Il est envoyé à l'URL contenue dans l'en-tête Receipt-Delivery-Option sur une connexion différente de celle du message d'origine.</span><span class="sxs-lookup"><span data-stu-id="07a09-109">It will be sent to the URL in the Receipt-Delivery-Option header, over a different connection than the original message.</span></span>  
  
-   <span data-ttu-id="07a09-110">Si l'en-tête Disposition-Notification-To est présent dans le message, mais que l'en-tête Receipt-Delivery-Option ne l'est pas, le MDN est envoyé de manière synchrone sur la même connexion que le message d'origine.</span><span class="sxs-lookup"><span data-stu-id="07a09-110">If the Disposition-Notification-To header is present in the message, but the Receipt-Delivery-Option header is not present in the message, the MDN will be sent synchronously over the same connection as the original message.</span></span>  
  
 <span data-ttu-id="07a09-111">Le Désassembleur crée l'en-tête AS2-From dans le MDN à partir de l'en-tête AS2-To contenu dans le message AS2 reçu. Il crée également l'en-tête AS2-To dans le MDN à partir de l'en-tête AS2-From contenu dans le message AS2 reçu.</span><span class="sxs-lookup"><span data-stu-id="07a09-111">The Disassembler creates the AS2-From header in the MDN from the AS2-To header in the received AS2 message, and it creates the AS2-To header in the MDN from the AS2-From header in the received AS2 message.</span></span>  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="07a09-112"> vous permet de remplacer ces paramètres en indiquant si un MDN sera généré, et comment il le sera, en fonction des propriétés d'un accord AS2 d'un tiers.</span><span class="sxs-lookup"><span data-stu-id="07a09-112"> enables you to override these settings, specifying whether an MDN will be generated and how it will be generated based upon a party's AS2 agreement properties.</span></span> <span data-ttu-id="07a09-113">Vous remplacer les paramètres d’en-tête AS2 du message à l’aide de la **utiliser les paramètres de l’accord pour validation et MDN au lieu de l’en-tête de message** propriété dans l’onglet d’accord AS2 unidirectionnel de la **propriétés de l’accord**boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="07a09-113">You override the AS2 header settings in the message using the **Use agreement settings for validation and MDN instead of message header** property in the one-way AS2 agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="07a09-114">Cette propriété vous permet d'envoyer un MDN même si l'en-tête AS2 n'en appelle pas, ou d'envoyer un MDN de manière asynchrone lorsque l'en-tête AS2 spécifie une connexion synchrone.</span><span class="sxs-lookup"><span data-stu-id="07a09-114">This property enables you to send an MDN even if the AS2 header does not call for one, or to send the MDN asynchronously when the AS2 header specifies a synchronous connection.</span></span>  
  
 <span data-ttu-id="07a09-115">Si vous définissez la **utiliser les paramètres de l’accord pour validation et MDN au lieu de l’en-tête de message** propriété, les valeurs dans le **exiger le MDN** section de la **paramètres MDN de l’expéditeur** page dans l’onglet d’accord AS2 unidirectionnel de la **propriétés de l’accord** boîte de dialogue sera utilisée pour le MDN, comme suit :</span><span class="sxs-lookup"><span data-stu-id="07a09-115">If you set the **Use agreement settings for validation and MDN instead of message header** property, the values in the **Request MDN** section of the **Sender MDN Settings** page in the one-way AS2 agreement tab of the **Agreement Properties** dialog box will be used for the MDN, as follows:</span></span>  
  
-   <span data-ttu-id="07a09-116">Un MDN est envoyé si la **exiger le MDN** propriété est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="07a09-116">An MDN will be sent if the **Request MDN** property is selected.</span></span>  
  
-   <span data-ttu-id="07a09-117">Si le **exiger le MDN** propriété est sélectionnée et le **exiger le MDN asynchrone** propriété est sélectionnée, le MDN est envoyé de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="07a09-117">If the **Request MDN** property is selected, and the **Request asynchronous MDN** property is selected, the MDN will be sent asynchronously.</span></span> <span data-ttu-id="07a09-118">Le MDN est envoyé à l’URL qui le **Receipt-Delivery-Option (URL)** est définie sur, sur une connexion différente de celle du message d’origine.</span><span class="sxs-lookup"><span data-stu-id="07a09-118">The MDN will be sent to the URL that the **Receipt-Delivery-Option (URL)** property is set to, over a different connection than the original message.</span></span>  
  
-   <span data-ttu-id="07a09-119">Si le **exiger le MDN** propriété est sélectionnée, mais la **exiger le MDN asynchrone** propriété n’est pas sélectionnée, le MDN sera envoyé de manière synchrone sur la même connexion que le message d’origine.</span><span class="sxs-lookup"><span data-stu-id="07a09-119">If the **Request MDN** property is selected, but the **Request asynchronous MDN** property is not selected, the MDN will be sent synchronously over the same connection as the original message.</span></span>  
  
 <span data-ttu-id="07a09-120">Si le **utiliser les paramètres de l’accord pour validation et MDN au lieu de l’en-tête de message** propriété est définie, AS2-à partir de la propriété dans le message d’en-tête sera utilisé pour générer le MDN, mais AS2-pour seront prises dans les propriétés de l’accord, et le pipeline signe le MDN conformément à la **exiger le MDN signé** propriété.</span><span class="sxs-lookup"><span data-stu-id="07a09-120">If the **Use agreement settings for validation and MDN instead of message header** property is set, the AS2-From property in the message header will be used in generating the MDN, but AS2-To will be taken from the agreement properties, and the pipeline will sign the MDN according to the **Request Signed MDN** property.</span></span> <span data-ttu-id="07a09-121">Les en-têtes AS2 correspondent aux propriétés de l'accord de la façon suivante :</span><span class="sxs-lookup"><span data-stu-id="07a09-121">The AS2 headers correspond to the agreement properties as follows:</span></span>  
  
|<span data-ttu-id="07a09-122">Propriétés de l'accord</span><span class="sxs-lookup"><span data-stu-id="07a09-122">Agreement Property</span></span>|<span data-ttu-id="07a09-123">En-tête AS2 dans le message</span><span class="sxs-lookup"><span data-stu-id="07a09-123">AS2 Header in the Message</span></span>|  
|------------------------|-------------------------------|  
|<span data-ttu-id="07a09-124">Générer un MDN</span><span class="sxs-lookup"><span data-stu-id="07a09-124">Generate MDN</span></span>|<span data-ttu-id="07a09-125">Disposition-Notification-To</span><span class="sxs-lookup"><span data-stu-id="07a09-125">Disposition-Notification-To</span></span>|  
|<span data-ttu-id="07a09-126">Signer le MDN</span><span class="sxs-lookup"><span data-stu-id="07a09-126">Sign MDN</span></span>|<span data-ttu-id="07a09-127">Signed-Receipt-Protocol</span><span class="sxs-lookup"><span data-stu-id="07a09-127">Signed-Receipt-Protocol</span></span>|  
|<span data-ttu-id="07a09-128">Receipt-Delivery-Option</span><span class="sxs-lookup"><span data-stu-id="07a09-128">Receipt-Delivery-Option</span></span>|<span data-ttu-id="07a09-129">Receipt-Delivery-Option</span><span class="sxs-lookup"><span data-stu-id="07a09-129">Receipt-Delivery-Option</span></span>|  
  
 <span data-ttu-id="07a09-130">Si un MDN est activé, le pipeline de réception promeut les propriétés de contexte suivantes :</span><span class="sxs-lookup"><span data-stu-id="07a09-130">If an MDN is enabled, the receive pipeline will promote the following context properties:</span></span>  
  
-   `EdiIntAS.DispositionMode`  
  
-   `EdiIntAS.DispositionType`  
  
 <span data-ttu-id="07a09-131">Ces propriétés de contexte doivent toutes deux être promues pour que le MDN soit généré.</span><span class="sxs-lookup"><span data-stu-id="07a09-131">Both of these context properties must be promoted in order for the MDN to be generated.</span></span> <span data-ttu-id="07a09-132">Pour plus d’informations sur ces propriétés de contexte, consultez [propriétés de contexte AS2](../core/as2-context-properties.md).</span><span class="sxs-lookup"><span data-stu-id="07a09-132">For more information about these context properties, see [AS2 Context Properties](../core/as2-context-properties.md).</span></span>  
  
 <span data-ttu-id="07a09-133">Si les paramètres de configuration et les en-têtes du message entrant ne sont pas cohérents, le pipeline génère un MDN négatif.</span><span class="sxs-lookup"><span data-stu-id="07a09-133">If the configuration settings and the headers in the incoming message are inconsistent, the pipeline will generate a negative MDN.</span></span>  
  
 <span data-ttu-id="07a09-134">Si le MDN est exigé dans les propriétés de l'accord, le pipeline de réception tente d'envoyer un MDN même si une erreur se produit dans le traitement AS2.</span><span class="sxs-lookup"><span data-stu-id="07a09-134">If the MDN is requested in the agreement properties, the receive pipeline will attempt to send an MDN even if an error occurs in AS2 processing.</span></span>  
  
## <a name="how-the-receive-pipeline-processes-a-generated-mdn"></a><span data-ttu-id="07a09-135">Traitement par le pipeline de réception d'un MDN généré</span><span class="sxs-lookup"><span data-stu-id="07a09-135">How the Receive Pipeline Processes a Generated MDN</span></span>  
 <span data-ttu-id="07a09-136">Si un MDN est généré conformément aux règles ci-dessus, le pipeline de réception AS2EDIReceive ou AS2Receive traite le MDN de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="07a09-136">If an MDN is generated according to the above rules, the AS2EDIReceive or AS2Receive receive pipeline will process the MDN as follows:</span></span>  
  
-   <span data-ttu-id="07a09-137">Effectue une copie du message MDN (au format câblé) et la stocke dans la base de données de non répudiation, si activé dans les propriétés de l'accord unidirectionnel AS2.</span><span class="sxs-lookup"><span data-stu-id="07a09-137">Makes a copy of the MDN (in wire format), and stores it in the non-repudiation database, if enabled in the one-way AS2 agreement properties.</span></span>  
  
-   <span data-ttu-id="07a09-138">Effectue le traitement MIME, y compris l'application d'une signature numérique, si activé dans les propriétés de l'accord unidirectionnel AS2.</span><span class="sxs-lookup"><span data-stu-id="07a09-138">Performs MIME processing, including applying a digital signature, if enabled in the one-way AS2 agreement properties.</span></span>  
  
-   <span data-ttu-id="07a09-139">Calcule le MIC (Message Integrity Check) pour la charge du message AS2 et l'ajoute au champ d'extension Received-content-MIC du MDN.</span><span class="sxs-lookup"><span data-stu-id="07a09-139">Calculates the MIC (Message Integrity Check) for the AS2 message payload and appends it to the Received-content-MIC extension field of the MDN.</span></span> <span data-ttu-id="07a09-140">L’algorithme qui sera appliqué au MIC est déterminé par l’en-tête signed-receipt-micalg du message entrant ou **algorithme de signature** propriété sur le **paramètres MDN de l’expéditeur** page de l’unidirectionnel onglet d’accord de la **propriétés de l’accord** boîte de dialogue (lorsque les propriétés de message entrant sont remplacées).</span><span class="sxs-lookup"><span data-stu-id="07a09-140">The algorithm to be applied for the MIC is determined by the signed-receipt-micalg header of the incoming message or the **Signing Algorithm** property on the **Sender MDN Settings** page of the one-way agreement tab of the **Agreement Properties** dialog box (when the inbound message properties are overridden).</span></span> <span data-ttu-id="07a09-141">Il peut s'agir de SHA1 ou de MD5.</span><span class="sxs-lookup"><span data-stu-id="07a09-141">It can be either SHA1 or MD5.</span></span> <span data-ttu-id="07a09-142">La valeur de l'algorithme est également incluse dans le MDN.</span><span class="sxs-lookup"><span data-stu-id="07a09-142">The value of the algorithm is also included in the MDN.</span></span>  
  
-   <span data-ttu-id="07a09-143">Crée des entrées de corrélation dans la base de données de non-répudiation.</span><span class="sxs-lookup"><span data-stu-id="07a09-143">Makes correlation entries in the non-repudiation database.</span></span>  
  
-   <span data-ttu-id="07a09-144">Effectue une copie du message MDN.</span><span class="sxs-lookup"><span data-stu-id="07a09-144">Makes a copy of the MDN message.</span></span>  
  
-   <span data-ttu-id="07a09-145">Si le MDN doit être transmis de manière synchrone, le pipeline définit la propriété `EdiIntAS.IsAS2AsynchronousMDN` sur la valeur False ; s'il doit être transmis de manière asynchrone, le pipeline définit cette propriété sur la valeur True.</span><span class="sxs-lookup"><span data-stu-id="07a09-145">If the MDN is to be transmitted synchronously, the pipeline sets the `EdiIntAS.IsAS2AsynchronousMDN` property to False; if asynchronously, it sets the property to True.</span></span>  
  
-   <span data-ttu-id="07a09-146">Si le MDN doit être transmis de manière synchrone, le pipeline d'envoi AS2Send associé au port de réception bidirectionnel récupèrera le MDN en fonction de la propriété `EdiIntAS.IsAS2AsynchronousMDN` (ayant la valeur False) et des jetons de corrélation.</span><span class="sxs-lookup"><span data-stu-id="07a09-146">If the MDN is to be transmitted synchronously, the AS2Send send pipeline associated with the two-way receive port will pick up the MDN based upon the `EdiIntAS.IsAS2AsynchronousMDN` property (set to False) and the correlation tokens.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="07a09-147">Vous pouvez également configurer un port d'envoi qui s'abonne au MDN synchrone sortant.</span><span class="sxs-lookup"><span data-stu-id="07a09-147">You can also set up a send port that subscribes to the outgoing synchronous MDN.</span></span> <span data-ttu-id="07a09-148">Pour cela, définissez le filtre de port d'envoi sur `EdiIntAS.IsAS2MdnResponseMessage==True`.</span><span class="sxs-lookup"><span data-stu-id="07a09-148">To do so, set the send port filter to `EdiIntAS.IsAS2MdnResponseMessage==True`.</span></span>  
  
-   <span data-ttu-id="07a09-149">Si le MDN doit être transmis de manière asynchrone, le pipeline de réception achemine le MDN vers la MessageBox.</span><span class="sxs-lookup"><span data-stu-id="07a09-149">If the MDN is to be transmitted asynchronously, the receive pipeline routes the MDN to the MessageBox.</span></span> <span data-ttu-id="07a09-150">Vous devez configurer un port d'envoi pour qu'il s'abonne au MDN en définissant le filtre de port d'envoi sur la valeur `IsAS2AsynchronousMdn==True`.</span><span class="sxs-lookup"><span data-stu-id="07a09-150">You must set up a send port to subscribe to the MDN, setting the send port filter to `IsAS2AsynchronousMdn==True`.</span></span> <span data-ttu-id="07a09-151">Le pipeline d'envoi AS2Send récupère le message en fonction de cette propriété et des jetons de corrélation.</span><span class="sxs-lookup"><span data-stu-id="07a09-151">The AS2Send send pipeline picks up the message based upon that property and the correlation tokens.</span></span> <span data-ttu-id="07a09-152">Si le port d'envoi est dynamique, il achemine le MDN en fonction de l'adresse indiquée sur la ligne Receipt-Delivery-Notification de l'en-tête du message.</span><span class="sxs-lookup"><span data-stu-id="07a09-152">If the send port is dynamic, it will route the MDN based to the address in the Receipt-Delivery-Notification line in the header of the message.</span></span> <span data-ttu-id="07a09-153">Si le port d'envoi est statique, il achemine le message en fonction de la propriété Transport - URI du port d'envoi.</span><span class="sxs-lookup"><span data-stu-id="07a09-153">If the send port is static, it will route the message based upon Transport URI property of the send port.</span></span>  
  
## <a name="mdn-generation-rules"></a><span data-ttu-id="07a09-154">Règles de génération d'un MDN</span><span class="sxs-lookup"><span data-stu-id="07a09-154">MDN Generation Rules</span></span>  
 <span data-ttu-id="07a09-155">Les règles suivantes s'appliquent à la génération de MDN :</span><span class="sxs-lookup"><span data-stu-id="07a09-155">The following rules apply to MDN generation:</span></span>  
  
-   <span data-ttu-id="07a09-156">Lorsque l'expéditeur d'un message exige spécifiquement un accusé de réception signé mais qu'une erreur se produit dans le traitement du contenu du message, le récepteur du message est tenu de renvoyer un accusé de réception signé bien que la transaction elle-même ne soit pas valide.</span><span class="sxs-lookup"><span data-stu-id="07a09-156">When a message sender specifically requests a signed receipt, but there is error in processing the contents of the message, the message receiver must still return a signed receipt, even though the transaction itself may not be valid.</span></span> <span data-ttu-id="07a09-157">La raison de l'erreur de traitement du contenu du message doit être définie dans disposition-field.</span><span class="sxs-lookup"><span data-stu-id="07a09-157">The reason for the error in processing the contents of the message must be set in the "disposition-field".</span></span>  
  
-   <span data-ttu-id="07a09-158">Lorsque la requête d'accusé de réception de MDN précise de façon explicite que l'accusé de réception doit être signé, mais que le récepteur du message d'origine ne prend pas en charge le format de protocole demandé ou l'algorithme MIC requis, un accusé de réception signé ou non signé doit être renvoyé.</span><span class="sxs-lookup"><span data-stu-id="07a09-158">When the request for the MDN receipt explicitly specifies that the receipt be signed, but the receiver of the original message cannot support either the requested protocol format or the requested MIC algorithm, then either a signed or unsigned receipt should be returned.</span></span>  
  
-   <span data-ttu-id="07a09-159">Si une signature n'est pas explicitement exigée, ou que le paramètre de requête d'accusé de réception signé n'est pas reconnu par l'accord du tiers destinataire, le tiers destinataire peut renvoyer un accusé de réception non signé, un accusé de réception signé ou aucun accusé de réception.</span><span class="sxs-lookup"><span data-stu-id="07a09-159">When a signature is not explicitly requested, or if the signed receipt request parameter is not recognized by the agreement for the receiving party, then the receiving party may return an unsigned receipt, a signed receipt, or no receipt.</span></span>  
  
## <a name="mic-generation"></a><span data-ttu-id="07a09-160">Génération de MIC</span><span class="sxs-lookup"><span data-stu-id="07a09-160">MIC Generation</span></span>  
 <span data-ttu-id="07a09-161">Lorsqu'un MDN est exigé, le récepteur du message d'origine génère un MIC (Message Integrity Check) et l'ajoute au MDN.</span><span class="sxs-lookup"><span data-stu-id="07a09-161">When an MDN is required, the receiver of the original message generates an MIC (Message Integrity Check) and adds it to the MDN.</span></span> <span data-ttu-id="07a09-162">Lorsque l'échange EDI fait partie d'un type de contenu MIME à parties multiples, le MIC doit être calculé sur tout le contenu à parties multiples, y compris sur l'échange EDI et les en-têtes MIME.</span><span class="sxs-lookup"><span data-stu-id="07a09-162">When the EDI interchange is part of a multi-part MIME content-type, the MIC must be calculated across the entire multi-part content, including the EDI interchange and the MIME headers.</span></span> <span data-ttu-id="07a09-163">Pour les messages chiffrés, non signés, le MIC à renvoyer est calculé en fonction de l'en-tête et du contenu MIME déchiffrés.</span><span class="sxs-lookup"><span data-stu-id="07a09-163">For encrypted, unsigned messages, the MIC to be returned is calculated on the decrypted MIME header and content.</span></span> <span data-ttu-id="07a09-164">Pour les messages non chiffrés, non signés, le MIC doit être calculé en fonction du contenu du message sans les en-têtes MIME.</span><span class="sxs-lookup"><span data-stu-id="07a09-164">For unsigned, unencrypted messages, the MIC must be calculated over the message contents without the MIME headers.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="07a09-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="07a09-165">See Also</span></span>  
 [<span data-ttu-id="07a09-166">Réception des Messages AS2 par BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="07a09-166">How BizTalk Server Receives AS2 Messages</span></span>](../core/how-biztalk-server-receives-as2-messages.md)