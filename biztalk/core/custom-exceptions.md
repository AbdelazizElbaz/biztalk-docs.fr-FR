---
title: "Exceptions personnalisées | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- process management solution tutorial, compensation blocks
- compensation blocks, process management solutions
- process management solution tutorial, custom exceptions
- Terminate shape [Orchestration Designer], called orchestrations
- process management solution tutorial, errors
ms.assetid: 0c923303-82ad-4a20-9c7c-5e38c477993a
caps.latest.revision: "14"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bfead2aadc237d27e0fb8ed28a776dd1e4f5c6f6
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="custom-exceptions"></a><span data-ttu-id="bf299-102">Exceptions personnalisées</span><span class="sxs-lookup"><span data-stu-id="bf299-102">Custom Exceptions</span></span>
<span data-ttu-id="bf299-103">En cas d'erreur irrécupérable, la solution de gestion des processus d'entreprise utilise une combinaison de gestionnaires d'exception et d'exceptions personnalisées.</span><span class="sxs-lookup"><span data-stu-id="bf299-103">For situations where there is an unrecoverable error, the Business Process Management solution uses a combination of exception handlers and custom exceptions.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="bf299-104">La gestion des Exceptions</span><span class="sxs-lookup"><span data-stu-id="bf299-104">Handling Exceptions</span></span>  
 <span data-ttu-id="bf299-105">Au lieu d’utiliser **Terminate** formes dans les orchestrations appelées, vous pouvez utiliser le modèle de lever des exceptions qui sont gérées par l’orchestration racine.</span><span class="sxs-lookup"><span data-stu-id="bf299-105">Rather than using **Terminate** shapes in called orchestrations you can use the pattern of throwing exceptions that are handled by the root orchestration.</span></span> <span data-ttu-id="bf299-106">Ainsi, l'orchestration possédant la connaissance de contexte la plus étendue est en mesure de prendre une décision relative à la gestion de l'exception.</span><span class="sxs-lookup"><span data-stu-id="bf299-106">This allows the orchestration with the widest knowledge of context to make the decision about handling the exception.</span></span> <span data-ttu-id="bf299-107">Le fait que les orchestrations subordonnées lèvent des exceptions personnalisées permet de communiquer des informations plus spécifiques à l'orchestration racine.</span><span class="sxs-lookup"><span data-stu-id="bf299-107">Having the subordinate orchestrations throw custom exceptions enables you to communicate more specific information to the root orchestration.</span></span>  
  
 <span data-ttu-id="bf299-108">La solution de gestion des processus d'entreprise suit ce modèle.</span><span class="sxs-lookup"><span data-stu-id="bf299-108">The business process management solution follows this pattern.</span></span> <span data-ttu-id="bf299-109">Il existe quatre racine, ou les orchestrations recours, dans la solution : **OrderBroker**, **OrderManager**, **CableOrder1**, et **CableOrder2**.</span><span class="sxs-lookup"><span data-stu-id="bf299-109">There are four root, or uncalled, orchestrations in the solution: **OrderBroker**, **OrderManager**, **CableOrder1**, and **CableOrder2**.</span></span> <span data-ttu-id="bf299-110">Trois orchestrations racines recevoir et de gérer des exceptions personnalisées : **OrderManager**, **CableOrder1**, et **CableOrder2**.</span><span class="sxs-lookup"><span data-stu-id="bf299-110">Three of the root orchestrations receive and handle custom exceptions: **OrderManager**, **CableOrder1**, and **CableOrder2**.</span></span>  
  
 <span data-ttu-id="bf299-111">Notez que certaines orchestrations racines utilisent la **Terminate** forme et que le **Terminate** apparaît juste avant le point de terminaison normal de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="bf299-111">Note that some of the root orchestrations use the **Terminate** shape and that the **Terminate** shape appears just before the normal end point of the orchestration.</span></span> <span data-ttu-id="bf299-112">L’orchestration utilise toujours le **Terminate** mettre en forme en cas d’erreur afin que l’orchestration est enregistrée comme terminée, plutôt que comme terminé, mais avec un message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="bf299-112">The orchestration still uses the **Terminate** shape in case of an error so that the orchestration is recorded as terminated, rather than as completed but with an error message.</span></span> <span data-ttu-id="bf299-113">Ceci permet à la solution de suivre facilement les instances ayant échoué, en plus d'enregistrer l'erreur.</span><span class="sxs-lookup"><span data-stu-id="bf299-113">This allows the solution to track failed instances easily in addition to recording the error.</span></span>  
  
 <span data-ttu-id="bf299-114">Pour plus d’informations sur la **Terminate** mettre en forme, consultez [comment configurer la forme Terminer](../core/how-to-configure-the-terminate-shape.md).</span><span class="sxs-lookup"><span data-stu-id="bf299-114">For more information about the **Terminate** shape, see [How to Configure the Terminate Shape](../core/how-to-configure-the-terminate-shape.md).</span></span> <span data-ttu-id="bf299-115">Pour plus d’informations sur la **ThrowException** mettre en forme, consultez [comment configurer la forme lever d’Exception](../core/how-to-configure-the-throw-exception-shape.md).</span><span class="sxs-lookup"><span data-stu-id="bf299-115">For more information about the **ThrowException** shape, see [How to Configure the Throw Exception Shape](../core/how-to-configure-the-throw-exception-shape.md).</span></span>  
  
## <a name="the-custom-exceptions"></a><span data-ttu-id="bf299-116">Exceptions personnalisées</span><span class="sxs-lookup"><span data-stu-id="bf299-116">The Custom Exceptions</span></span>  
 <span data-ttu-id="bf299-117">Chacune des trois exceptions personnalisées suivantes suit le même modèle.</span><span class="sxs-lookup"><span data-stu-id="bf299-117">Each of the following three custom exceptions follows the same pattern.</span></span> <span data-ttu-id="bf299-118">Le fait d'avoir des types distincts permet au code de différencier les différentes exceptions.</span><span class="sxs-lookup"><span data-stu-id="bf299-118">Having distinct types allows the code to distinguish different exceptions.</span></span>  
  
|<span data-ttu-id="bf299-119">Exception</span><span class="sxs-lookup"><span data-stu-id="bf299-119">Exception</span></span>|<span data-ttu-id="bf299-120">Levée par (Orchestration)</span><span class="sxs-lookup"><span data-stu-id="bf299-120">Thrown By (Orchestration)</span></span>|  
|---------------|---------------------------------|  
|<span data-ttu-id="bf299-121">**ActivateException**</span><span class="sxs-lookup"><span data-stu-id="bf299-121">**ActivateException**</span></span>|<span data-ttu-id="bf299-122">**Modification**</span><span class="sxs-lookup"><span data-stu-id="bf299-122">**Change**</span></span>|  
|<span data-ttu-id="bf299-123">**CableOrderException**</span><span class="sxs-lookup"><span data-stu-id="bf299-123">**CableOrderException**</span></span>|<span data-ttu-id="bf299-124">**Activer**, **CableOrder1**</span><span class="sxs-lookup"><span data-stu-id="bf299-124">**Activate**, **CableOrder1**</span></span>|  
|<span data-ttu-id="bf299-125">**InterruptException**</span><span class="sxs-lookup"><span data-stu-id="bf299-125">**InterruptException**</span></span>|<span data-ttu-id="bf299-126">**CableOrder1**, **CheckInterrupt**, **ErrorHandlerOrch**</span><span class="sxs-lookup"><span data-stu-id="bf299-126">**CableOrder1**, **CheckInterrupt**, **ErrorHandlerOrch**</span></span>|  
  
 <span data-ttu-id="bf299-127">Toutes les exceptions personnalisées sont définies dans le **utilitaires** assembly.</span><span class="sxs-lookup"><span data-stu-id="bf299-127">All of the custom exceptions are defined in the **Utilities** assembly.</span></span> <span data-ttu-id="bf299-128">et appartiennent à la classe .NET.</span><span class="sxs-lookup"><span data-stu-id="bf299-128">The custom exceptions are all .NET classes.</span></span> <span data-ttu-id="bf299-129">Toutes les classes d’exceptions personnalisées héritent de .NET **ApplicationException** classe qui hérite à son tour à la **System.Exception** classe.</span><span class="sxs-lookup"><span data-stu-id="bf299-129">All of the custom exception classes inherit from the .NET **ApplicationException** class which in turn inherits from the **System.Exception** class.</span></span> <span data-ttu-id="bf299-130">Comme il est possible que les exceptions puissent être mises en attente (sérialisées et stockées dans la base de données), elles doivent implémenter un constructeur de désérialisation.</span><span class="sxs-lookup"><span data-stu-id="bf299-130">Because there is a possibility that the exception may be dehydrated (serialized and stored in the database), the exceptions must implement a deserialization constructor.</span></span> <span data-ttu-id="bf299-131">Un constructeur de désérialisation est un constructeur qui accepte deux arguments : un objet SerializationInfo et un objet StreamingContext.</span><span class="sxs-lookup"><span data-stu-id="bf299-131">A deserialization constructor is a constructor that takes two arguments: a SerializationInfo object, and a StreamingContext object.</span></span> <span data-ttu-id="bf299-132">Le constructeur de désérialisation est utilisé lors de la réactivation de l'exception.</span><span class="sxs-lookup"><span data-stu-id="bf299-132">The deserialization constructor will be used during rehydration of the exception.</span></span> <span data-ttu-id="bf299-133">Étant donné que la **ApplicationException** classe implémente déjà un constructeur de désérialisation, le constructeur de l’exception personnalisée appelle simplement le constructeur de désérialisation base (ApplicationException).</span><span class="sxs-lookup"><span data-stu-id="bf299-133">Because the **ApplicationException** class already implements a deserialization constructor, the constructor for the custom exception simply invokes the base (ApplicationException) deserialization constructor.</span></span> <span data-ttu-id="bf299-134">Par exemple, le **InterruptException** inclut le constructeur suivant :</span><span class="sxs-lookup"><span data-stu-id="bf299-134">For example, the **InterruptException** includes the following constructor:</span></span>  
  
```  
// "info" is the object holding the serialized object data.  
// "context" is the contextual information about the source  
// or destination.  
public InterruptException(SerializationInfo info,  
                  StreamingContext context) : base(info, context) { }  
```  
  
 <span data-ttu-id="bf299-135">Pour plus d'informations sur la sérialisation personnalisée, consultez la rubrique Sérialisation personnalisée dans le Guide du développeur [!INCLUDE[btsDotNetFramework](../includes/btsdotnetframework-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bf299-135">For more detailed information about custom serialization, see Custom Serialization in the [!INCLUDE[btsDotNetFramework](../includes/btsdotnetframework-md.md)] Developer's Guide.</span></span>  
  
## <a name="nested-exception-handlers-and-compensation-blocks"></a><span data-ttu-id="bf299-136">Gestionnaires d'exceptions imbriqués et blocs de compensation</span><span class="sxs-lookup"><span data-stu-id="bf299-136">Nested Exception Handlers and Compensation Blocks</span></span>  
 <span data-ttu-id="bf299-137">Outre leur utilisation comme exceptions spécialisées, les exceptions personnalisées servent également d'indicateur de tri à plusieurs emplacements.</span><span class="sxs-lookup"><span data-stu-id="bf299-137">In addition to serving as specialized exceptions, the custom exceptions in several places also serve as a sort flag.</span></span> <span data-ttu-id="bf299-138">Dans le **modification** orchestration, il existe deux emplacements que l’opération d’annulation doit être restaurée.</span><span class="sxs-lookup"><span data-stu-id="bf299-138">In the **Change** orchestration, there are two places that the Cancel operation must be rolled back.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bf299-139">Vous pouvez souhaiter lire cette section avec les **modification** orchestration ouvrir dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bf299-139">You may want to read this section with the **Change** orchestration open in Visual Studio.</span></span>  
  
 <span data-ttu-id="bf299-140">En haut de l’orchestration, si l’appel à la **Annuler** orchestration échoue, le **CancelCompensation** bloc s’exécute et annule le **Annuler** transaction.</span><span class="sxs-lookup"><span data-stu-id="bf299-140">At the top of the orchestration, if the call to the **Cancel** orchestration fails, the **CancelCompensation** block executes and rolls back the **Cancel** transaction.</span></span> <span data-ttu-id="bf299-141">Si tout se passe bien, l’orchestration appelle ensuite la **activer** orchestration.</span><span class="sxs-lookup"><span data-stu-id="bf299-141">If all goes well, the orchestration then calls the **Activate** orchestration.</span></span>  
  
 <span data-ttu-id="bf299-142">Si le **activer** opération échoue, le **Annuler** transaction doit également être annulée.</span><span class="sxs-lookup"><span data-stu-id="bf299-142">If the **Activate** operation fails, the **Cancel** transaction must also be rolled back.</span></span> <span data-ttu-id="bf299-143">Toutefois, le Gestionnaire d’exceptions pour l’appel à **activer** ne sait rien sur le **Annuler** transaction.</span><span class="sxs-lookup"><span data-stu-id="bf299-143">However, the exception handler for the call to **Activate** knows nothing about the **Cancel** transaction.</span></span> <span data-ttu-id="bf299-144">Afin de gérer ce genre de situation, un gestionnaire d'exceptions est disponible pour l'intégralité de l'orchestration.</span><span class="sxs-lookup"><span data-stu-id="bf299-144">To handle this, there is an exception handler for the entire orchestration.</span></span> <span data-ttu-id="bf299-145">Ce gestionnaire, car il contient le **Annuler** étendue, il connaît la **Annuler** transaction.</span><span class="sxs-lookup"><span data-stu-id="bf299-145">This handler, because it contains the **Cancel** scope, knows about the **Cancel** transaction.</span></span> <span data-ttu-id="bf299-146">Intercepte l’exception levée à partir de la **activer** étendue (le **ActivateException**), restaure les **Annuler** transaction, puis lève à nouveau l’exception Pour que l’orchestration qui a appelé le **modification** orchestration peut effectuer un traitement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="bf299-146">The handler catches the exception thrown from the **Activate** scope (the **ActivateException**), rolls back the **Cancel** transaction, and then throws the exception again so that the orchestration that called the **Change** orchestration can perform any additional processing.</span></span>  
  
 <span data-ttu-id="bf299-147">Notez que cette conception compense uniquement le **Annuler** si le **activer** échoue.</span><span class="sxs-lookup"><span data-stu-id="bf299-147">Notice that this design only compensates the **Cancel** if the **Activate** fails.</span></span> <span data-ttu-id="bf299-148">Si le **Annuler** échoue et lève une exception, le **Annuler** jamais a eu lieu et ne doit pas être compensé.</span><span class="sxs-lookup"><span data-stu-id="bf299-148">If the **Cancel** fails and throws an exception, the **Cancel** never took place and should not be compensated.</span></span>  
  
 <span data-ttu-id="bf299-149">Pour plus d’informations sur les blocs de compensation et la **compenser** mettre en forme, consultez [comment configurer la forme compenser](../core/how-to-configure-the-compensate-shape.md).</span><span class="sxs-lookup"><span data-stu-id="bf299-149">For more information about compensation blocks and the **Compensate** shape, see [How to Configure the Compensate Shape](../core/how-to-configure-the-compensate-shape.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bf299-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bf299-150">See Also</span></span>  
 <span data-ttu-id="bf299-151">[Gestion des exceptions dans la Solution gestion des processus d’entreprise](../core/exception-handling-in-the-business-process-management-solution.md) </span><span class="sxs-lookup"><span data-stu-id="bf299-151">[Exception Handling in the Business Process Management Solution](../core/exception-handling-in-the-business-process-management-solution.md) </span></span>  
 [<span data-ttu-id="bf299-152">L’Orchestration ExceptionHandler</span><span class="sxs-lookup"><span data-stu-id="bf299-152">The ExceptionHandler Orchestration</span></span>](../core/the-exceptionhandler-orchestration.md)