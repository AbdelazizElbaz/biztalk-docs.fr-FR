---
title: Configurer le travail de sauvegarde de BizTalk Server | Documents Microsoft
ms.custom: 
ms.date: 11/02/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 026622c9-fcb4-4db0-af48-1379feb30372
caps.latest.revision: "42"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 67765cfacc7753d649c14677c5399e9c2c7b1e39
ms.sourcegitcommit: 6095645d541bf84f39ff5f342f782284c22e875b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/06/2017
---
# <a name="configure-the-backup-biztalk-server-job"></a><span data-ttu-id="2c227-102">Configurer le travail de sauvegarde de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="2c227-102">Configure the Backup BizTalk Server Job</span></span>
<span data-ttu-id="2c227-103">Répertorie les étapes nécessaires pour configurer le travail de sauvegarde de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-103">Lists the steps necessary to configure the Backup BizTalk Server job.</span></span>  

## <a name="overview"></a><span data-ttu-id="2c227-104">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="2c227-104">Overview</span></span>
<span data-ttu-id="2c227-105">Une fois que vous installez et configurez BizTalk Server, configurez la sauvegarde [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tâche pour sauvegarder vos données.</span><span class="sxs-lookup"><span data-stu-id="2c227-105">After you install and configure BizTalk Server, configure the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up your data.</span></span> <span data-ttu-id="2c227-106">Le **sauvegarde de BizTalk Server (BizTalkMgmtDb)** le travail inclut les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="2c227-106">The **Backup BizTalk Server (BizTalkMgmtDb)** job includes the following steps:</span></span>

-   <span data-ttu-id="2c227-107">Étape 1 – **Option de Compression Set**: activer ou désactiver la compression lors de la sauvegarde</span><span class="sxs-lookup"><span data-stu-id="2c227-107">Step 1 – **Set Compression Option**: Enable or disable compression during backup</span></span>

-   <span data-ttu-id="2c227-108">Étape 2 : **BackupFull**: exécutions de base de données des sauvegardes complètes de bases de données BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="2c227-108">Step 2 – **BackupFull**: Runs full database backups of the BizTalk Server databases</span></span>

-   <span data-ttu-id="2c227-109">Étape 3 : **MarkAndBackUpLog**: sauvegarde les journaux de base de données BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="2c227-109">Step 3 – **MarkAndBackUpLog**: Backs up the BizTalk Server database logs</span></span>

-   <span data-ttu-id="2c227-110">Étape 4 : **effacer l’historique de sauvegarde**: choisissez la durée de conservation de l’historique de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="2c227-110">Step 4 – **Clear Backup History**: Choose how long the backup history is kept</span></span>

<span data-ttu-id="2c227-111">Pour configurer cette tâche, vous devez :</span><span class="sxs-lookup"><span data-stu-id="2c227-111">To configure this job, you'll need to:</span></span>  
  
-   <span data-ttu-id="2c227-112">Identifier les serveurs SQL principal et de destination et autres options de sauvegarde</span><span class="sxs-lookup"><span data-stu-id="2c227-112">Identify the primary and destination SQL Servers and other backup options</span></span>
  
-   <span data-ttu-id="2c227-113">Choisissez un compte d’utilisateur Windows pour sauvegarder vos bases de données et de créer une connexion SQL Server pour ce compte</span><span class="sxs-lookup"><span data-stu-id="2c227-113">Choose a Windows user account to back up your databases and create a SQL Server login for this account</span></span>
  
-   <span data-ttu-id="2c227-114">mapper les connexions SQL Server au rôle de base de données BTS_BACKUP_USERS dans les bases de données BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-114">Map SQL Server logins to the BTS_BACKUP_USERS database role in the BizTalk Server databases</span></span>
  
-   <span data-ttu-id="2c227-115">Assurez-vous que le service MSDTC est actif sur tous les nœuds.</span><span class="sxs-lookup"><span data-stu-id="2c227-115">Ensure MSDTC service is active on all nodes.</span></span> <span data-ttu-id="2c227-116">Sinon, Échec de l’ajout d’un serveur lié entre le nœud source et le nœud de destination</span><span class="sxs-lookup"><span data-stu-id="2c227-116">Else, adding a linked server between the source node and the destination node fails</span></span>
  
## <a name="before-you-begin"></a><span data-ttu-id="2c227-117">Avant de commencer</span><span class="sxs-lookup"><span data-stu-id="2c227-117">Before you begin</span></span>  
  
-   <span data-ttu-id="2c227-118">Certaines opérations de sauvegarde et de configuration nécessitent l’appartenance au rôle sysadmin SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-118">Certain configuration and backup operations require membership in the sysadmin SQL Server role.</span></span> <span data-ttu-id="2c227-119">Pour sauvegarder votre [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de données, vous devez être connecté sur le serveur principal avec un compte qui est membre du rôle de serveur sysadmin SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-119">To back up your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must be signed in the primary server with an account that is a member of the SQL Server sysadmin Server role.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="2c227-120">configuration ajoute le rôle de base de données BTS_BACKUP_USERS.</span><span class="sxs-lookup"><span data-stu-id="2c227-120"> configuration adds the BTS_BACKUP_USERS database role.</span></span> <span data-ttu-id="2c227-121">Le compte d’utilisateur utilisé pour sauvegarder vos bases de données ne nécessite pas d’autorisations de l’administrateur système (rôle de SQL Server sysadmin) sur tous les serveurs SQL qui peuvent être impliqués dans une sauvegarde, à l’exception du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="2c227-121">The user account you use to back up your databases does not require System Administrator (sysadmin SQL Server role) permissions on all the SQL Servers that may be involved in a backup, except for the primary server.</span></span>  
  
-   <span data-ttu-id="2c227-122">Décidez à laquelle l’authentification dans le compte que vous utilisez pour exécuter votre [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] les sauvegardes de base de données.</span><span class="sxs-lookup"><span data-stu-id="2c227-122">Decide which sign in account you use to run your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] database backups.</span></span> <span data-ttu-id="2c227-123">Vous pouvez utiliser un compte local, voire plusieurs comptes. Toutefois, il est souvent plus simple de créer un compte d'utilisateur de domaine Windows dédié à cette fin.</span><span class="sxs-lookup"><span data-stu-id="2c227-123">You can use a local account, and you can use more than one account, but it is generally simpler and more secure to create one dedicated Windows domain user account specifically for this purpose.</span></span> <span data-ttu-id="2c227-124">Vous devez configurer un compte de connexion SQL Server pour cet utilisateur. Celui-ci doit être mappé à une connexion SQL Server pour tous les serveurs SQL participant au processus de sauvegarde, en tant que serveur principal (source) ou secondaire (destination).</span><span class="sxs-lookup"><span data-stu-id="2c227-124">You must configure a SQL Server logon account for this user, and the user must be mapped to a SQL Server login for all of the SQL Servers that participate in the backup process, either as primary (source) or secondary (destination) servers.</span></span> <span data-ttu-id="2c227-125">Affecter l’utilisateur au rôle de base de données BizTalk BTS_BACKUP_USERS pour chacune de la [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de données vous sauvegardez.</span><span class="sxs-lookup"><span data-stu-id="2c227-125">Assign this user to the BizTalk BTS_BACKUP_USERS database role for each of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases you back up.</span></span>  
  
-   <span data-ttu-id="2c227-126">Le travail de sauvegarde de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ne supprime pas les fichiers de sauvegarde obsolètes. Vous devez donc gérer ceux-ci manuellement afin de conserver de l'espace libre sur le disque.</span><span class="sxs-lookup"><span data-stu-id="2c227-126">The Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job does not delete outdated backup files, so you need to manually manage those backup files to conserve disk space.</span></span> <span data-ttu-id="2c227-127">Une fois que vous avez créé une sauvegarde complète de vos bases de données, vous devez déplacer les fichiers de sauvegarde obsolètes vers un périphérique de stockage d'archives pour libérer de l'espace sur le disque principal.</span><span class="sxs-lookup"><span data-stu-id="2c227-127">After you have created a new full backup of your databases, you should move the outdated backup files onto an archival storage device to reclaim space on the primary disk.</span></span> <span data-ttu-id="2c227-128">Consultez le [packages SSIS](http://www.biztalkbill.com/2015/05/26/ssis-packages-to-help-management-biztalk-server-environments/) pour gérer ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="2c227-128">See the [SSIS packages](http://www.biztalkbill.com/2015/05/26/ssis-packages-to-help-management-biztalk-server-environments/) to manage these files.</span></span>  
  
-   [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="2c227-129">n’écrit pas les données de suivi directement à la base de données des suivis BizTalk ; au lieu de cela, il met en cache les données dans la base de données MessageBox et puis les déplace vers la base de données des suivis BizTalk.</span><span class="sxs-lookup"><span data-stu-id="2c227-129"> does not write tracking data directly to the BizTalk Tracking database; rather it caches the data in the MessageBox database, and then moves it to the BizTalk Tracking database.</span></span> <span data-ttu-id="2c227-130">Si des données MessageBox sont perdues, certaines données de suivi peuvent l'être également.</span><span class="sxs-lookup"><span data-stu-id="2c227-130">If MessageBox data loss occurs, some tracking data may also be lost.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="2c227-131">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="2c227-131">Prerequisites</span></span>  
* <span data-ttu-id="2c227-132">Connectez-vous à SQL Server à l’aide d’un compte qui est membre du rôle sysadmin SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-132">Sign in to SQL Server using an account that is a member of the sysadmin SQL Server role.</span></span>  
  
* <span data-ttu-id="2c227-133">Configurez l'exécution du service SQL Server Agent sous un compte de domaine (recommandé, même si des comptes locaux peuvent être utilisés), avec une connexion d'utilisateur mappée sur chaque instance de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2c227-133">Configure the SQL Server Agent service to run under a domain account (recommended, although local accounts can be used), with a mapped user login on each instance of SQL Server.</span></span>  
  
## <a name="configure-the-job"></a><span data-ttu-id="2c227-134">Configurer la tâche</span><span class="sxs-lookup"><span data-stu-id="2c227-134">Configure the job</span></span>  
  
1.  <span data-ttu-id="2c227-135">Sur le serveur SQL qui héberge la base de données de gestion BizTalk, ouvrez **SQL Server Management Studio**et vous connecter à votre [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2c227-135">On the SQL Server that hosts the BizTalk Management database, open **SQL Server Management Studio**, and connect to your [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span>  
  
2.  <span data-ttu-id="2c227-136">Développez **Agent SQL Server**, puis **Travaux**.</span><span class="sxs-lookup"><span data-stu-id="2c227-136">Expand **SQL Server Agent**, and expand **Jobs**.</span></span>  
  
3.  <span data-ttu-id="2c227-137">Cliquez avec le bouton droit sur **Sauvegarde de BizTalk Server (BizTalkMgmtDb)** et sélectionnez **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="2c227-137">Right-click **Backup BizTalk Server (BizTalkMgmtDb)** and select **Properties**.</span></span> <span data-ttu-id="2c227-138">Dans les propriétés du travail, sélectionnez **Étapes**.</span><span class="sxs-lookup"><span data-stu-id="2c227-138">In the job properties, select **Steps**.</span></span>  
  
4.  <span data-ttu-id="2c227-139">Sélectionnez le **définir l’Option de Compression** pas à pas, puis sélectionnez **modifier**:</span><span class="sxs-lookup"><span data-stu-id="2c227-139">Select the **Set Compression Option** step, and select **Edit**:</span></span>  

    <span data-ttu-id="2c227-140">Cette étape appelle les `sp_SetBackupCompression` procédure stockée dans la base de gestion BizTalk (BizTalkMgmtDb) pour définir la valeur sur le `adm_BackupSettings` table.</span><span class="sxs-lookup"><span data-stu-id="2c227-140">This step calls the `sp_SetBackupCompression` stored procedure in the BizTalk management database (BizTalkMgmtDb) to set the value on the `adm_BackupSettings` table.</span></span> <span data-ttu-id="2c227-141">La procédure stockée possède un seul paramètre :  **@bCompression** .</span><span class="sxs-lookup"><span data-stu-id="2c227-141">The stored procedure has one parameter: **@bCompression**.</span></span> <span data-ttu-id="2c227-142">Par défaut, il est défini **0** (compression de la sauvegarde est désactivée).</span><span class="sxs-lookup"><span data-stu-id="2c227-142">By default, it is set to **0** (backup compression is off).</span></span> <span data-ttu-id="2c227-143">Pour appliquer la compression, remplacez la valeur par **1**:</span><span class="sxs-lookup"><span data-stu-id="2c227-143">To apply compression, change the value to **1**:</span></span>  
  
    ```  
    exec [dbo].[sp_SetBackupCompression] @bCompression = 1 /*0 - Do not use Compression, 1 - Use Compression */  
    ```  
  
     <span data-ttu-id="2c227-144">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="2c227-144">Select **OK**.</span></span>  
  
5.  <span data-ttu-id="2c227-145">Sélectionnez le **BackupFull** pas à pas, puis sélectionnez **modifier**.</span><span class="sxs-lookup"><span data-stu-id="2c227-145">Select the **BackupFull** step, and select **Edit**.</span></span> <span data-ttu-id="2c227-146">Dans le **commande** zone, mettre à jour les valeurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="2c227-146">In the **Command** box, update the parameter values:</span></span>  
  
    1. <span data-ttu-id="2c227-147">**Fréquence**: la valeur par défaut est **d** (quotidienne) ; ce qui est le paramètre recommandé.</span><span class="sxs-lookup"><span data-stu-id="2c227-147">**Frequency**: The default is **d** (daily); which is the recommended setting.</span></span> <span data-ttu-id="2c227-148">Les valeurs **h** (horaire), **w** (hebdomadaire), **m** (mensuelle) et **y** (annuelle) sont également disponibles.</span><span class="sxs-lookup"><span data-stu-id="2c227-148">Other values include **h** (hourly), **w** (weekly), **m** (monthly), or **y** (yearly).</span></span>  
  
    2. <span data-ttu-id="2c227-149">**Name**: la valeur par défaut est **BTS**.</span><span class="sxs-lookup"><span data-stu-id="2c227-149">**Name**: The default is **BTS**.</span></span> <span data-ttu-id="2c227-150">Cette valeur est utilisée dans le nom du fichier de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="2c227-150">The name is used as part of the backup file name.</span></span>  
  
    3. <span data-ttu-id="2c227-151">**Emplacement des fichiers de sauvegarde**: remplacez '*\<chemin d’accès de destination >*» avec le chemin d’accès complet (le chemin d’accès doit inclure les guillemets simples) à l’ordinateur et le dossier dans lequel vous souhaitez sauvegarder le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] bases de données.</span><span class="sxs-lookup"><span data-stu-id="2c227-151">**Location of backup files**: Replace '*\<destination path>*' with the full path (the path must include the single quotes) to the computer and folder where you want to back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  

        > [!IMPORTANT]
        >  - <span data-ttu-id="2c227-152">Si vous entrez un chemin d’accès local, vous devez copier manuellement tous les fichiers dans le même dossier sur le système de destination chaque fois que la sauvegarde [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] travail crée de nouveaux fichiers.</span><span class="sxs-lookup"><span data-stu-id="2c227-152">If you enter a local path, then you have to manually copy all the files to the same folder on the destination system whenever the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job creates new files.</span></span>  
        >   
        >      <span data-ttu-id="2c227-153">Pour spécifier un chemin d’accès à distance, entrez un partage UNC tel que \\ \\  *\<nom_serveur >*\\*\<SharedDrive >* \\ , où  *\<nom_serveur >* est le nom du serveur où vous voulez les fichiers, et  *\<SharedDrive >* est le nom du lecteur partagé ou du dossier.</span><span class="sxs-lookup"><span data-stu-id="2c227-153">To specify a remote path, enter a UNC share such as \\\\*\<ServerName>*\\*\<SharedDrive>*\\, where *\<ServerName>* is the name of the server where you want the files, and *\<SharedDrive>* is name of the shared drive or folder.</span></span>  
        >   
        >      <span data-ttu-id="2c227-154">La sauvegarde de données sur un réseau peut faire l’objet d’éventuels problèmes réseau.</span><span class="sxs-lookup"><span data-stu-id="2c227-154">Backing up data over a network is subject to any network issues.</span></span> <span data-ttu-id="2c227-155">Si vous utilisez un emplacement distant, vérifiez que la sauvegarde a réussi lorsque le travail de sauvegarde de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] termine.</span><span class="sxs-lookup"><span data-stu-id="2c227-155">When using a remote location, verify the backup succeeded when the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job finishes.</span></span>  
        > - <span data-ttu-id="2c227-156">Pour éviter de perdre des données, configurez un disque distinct pour la sauvegarde et le stockage des données des bases de données et des journaux.</span><span class="sxs-lookup"><span data-stu-id="2c227-156">To avoid potential data loss, configure the backup disk to be a different disk than the database data and log disks.</span></span> <span data-ttu-id="2c227-157">Cette étape est nécessaire afin que vous puissiez accéder aux sauvegardes en cas de défaillance du disque de stockage des données ou des journaux.</span><span class="sxs-lookup"><span data-stu-id="2c227-157">This is necessary so you can access the backups if the data or log disk fails.</span></span>  

    4. <span data-ttu-id="2c227-158">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="2c227-158">Optional.</span></span> <span data-ttu-id="2c227-159">**Force une sauvegarde complète après des échecs de sauvegarde partielles** (@ForceFullBackupAfterPartialSetFailure) : la valeur par défaut est **0**.</span><span class="sxs-lookup"><span data-stu-id="2c227-159">**Force full backup after partial backup failures** (@ForceFullBackupAfterPartialSetFailure): The default is **0**.</span></span> <span data-ttu-id="2c227-160">Si une sauvegarde du journal échoue, aucune sauvegarde complète ne sont exécutées jusqu'à ce que le prochain intervalle de fréquence de sauvegarde complète.</span><span class="sxs-lookup"><span data-stu-id="2c227-160">If a log backup fails, no full backups are ran until the next full backup frequency interval is reached.</span></span> <span data-ttu-id="2c227-161">Remplacez par **1** si vous souhaitez une sauvegarde complète est exécutée chaque fois qu’un échec de sauvegarde de journal se produit.</span><span class="sxs-lookup"><span data-stu-id="2c227-161">Replace with **1** if you want a full backup ran whenever a log backup failure occurs.</span></span>
    
    5. <span data-ttu-id="2c227-162">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="2c227-162">Optional.</span></span> <span data-ttu-id="2c227-163">**Heure de l’heure locale pour le processus de sauvegarde à exécuter**: la valeur par défaut est NULL.</span><span class="sxs-lookup"><span data-stu-id="2c227-163">**Local time hour for the backup process to run**: The default is NULL.</span></span> <span data-ttu-id="2c227-164">La tâche de sauvegarde n’est pas associée avec le fuseau horaire de le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ordinateur et s’exécute à minuit UTC (0000) de temps.</span><span class="sxs-lookup"><span data-stu-id="2c227-164">The backup job is not associated with the time zone of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, and runs at midnight UTC time (0000).</span></span> <span data-ttu-id="2c227-165">Si vous souhaitez sauvegarde à une heure spécifique dans le fuseau horaire de le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ordinateur, entrez une valeur entière comprise entre 0 (minuit) et 23 (11 PM) en tant que l’heure de l’heure locale pour le **BackupHour** paramètre.</span><span class="sxs-lookup"><span data-stu-id="2c227-165">If you want to backup at a specific hour in the time zone of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, enter an integer value from 0 (midnight) to 23 (11 PM) as the local time hour for the **BackupHour** parameter.</span></span> 

    6. <span data-ttu-id="2c227-166">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="2c227-166">Optional.</span></span> <span data-ttu-id="2c227-167">**Utiliser l’heure locale** (@UseLocalTime) : indique la procédure pour utiliser l’heure locale.</span><span class="sxs-lookup"><span data-stu-id="2c227-167">**Use local time** (@UseLocalTime): Tells the procedure to use local time.</span></span> <span data-ttu-id="2c227-168">La valeur par défaut est 0 et utilise actuel UTC heure – GETUTCDATE() – 2007-05-04 01:34:11.933.</span><span class="sxs-lookup"><span data-stu-id="2c227-168">The default value is 0, and uses current UTC time – GETUTCDATE() – 2007-05-04 01:34:11.933.</span></span> <span data-ttu-id="2c227-169">Si la valeur 1, puis il utilise l’heure locale – GETDATE() – 2007-05-03 18:34:11.933</span><span class="sxs-lookup"><span data-stu-id="2c227-169">If set to 1, then it uses local time – GETDATE() – 2007-05-03 18:34:11.933</span></span>
  
    <span data-ttu-id="2c227-170">Dans l’exemple suivant, les sauvegardes quotidiennes sont créées à 14 h 00 et stockées sur le lecteur m:\ :</span><span class="sxs-lookup"><span data-stu-id="2c227-170">In the following example, daily backups are created at 2am, and stored in the m:\ drive:</span></span>  
  
    ```  
    exec [dbo].[sp_BackupAllFull_Schedule]   
    'd' /* Frequency */,   
    'BTS' /* Name */,   
    'm:\BizTalkBackups' /* location of backup files */,   
    0 /* 0 (default) or 1 ForceFullBackupAfterPartialSetFailure */,   
    '2' /* local time hour for the backup process to run */  
    ```  
  
     <span data-ttu-id="2c227-171">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="2c227-171">Select **OK**.</span></span>  
  
6.  <span data-ttu-id="2c227-172">Sélectionnez le **MarkAndBackupLog** pas à pas, puis sélectionnez **modifier**.</span><span class="sxs-lookup"><span data-stu-id="2c227-172">Select the **MarkAndBackupLog** step, and select **Edit**.</span></span> <span data-ttu-id="2c227-173">Dans le **commande** zone, mettre à jour les valeurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="2c227-173">In the **Command** box, update the parameter values:</span></span>  
  
    1.  <span data-ttu-id="2c227-174">**@MarkName**: Cela fait partie de la convention d’affectation de noms pour les fichiers de sauvegarde : <Server Name>  _<Database Name>  **_journal_**< nom de marque de journal >_<Timestamp></span><span class="sxs-lookup"><span data-stu-id="2c227-174">**@MarkName**: This is part of the naming convention for backup files: <Server Name>_<Database Name>**_Log_**< Log Mark Name >_<Timestamp></span></span>  
    
    2.  <span data-ttu-id="2c227-175">**@BackupPath**: Chemin de destination complet (y compris les guillemets simples) à l’ordinateur et le dossier dans lequel vous voulez stocker le [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] des journaux de base de données.</span><span class="sxs-lookup"><span data-stu-id="2c227-175">**@BackupPath**: Full destination path (including single quotes) to the computer and folder where you want to store the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] database logs.</span></span> <span data-ttu-id="2c227-176">Le  *\<chemin d’accès de destination >* peut être local ou un chemin d’accès UNC vers un autre serveur.</span><span class="sxs-lookup"><span data-stu-id="2c227-176">The *\<destination path>* may be local or a UNC path to another server.</span></span>  
  
     <span data-ttu-id="2c227-177">L'étape MarkAndBackupLog marque les journaux pour la sauvegarde, puis les sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="2c227-177">The MarkAndBackupLog step marks the logs for backup, and then backs them up.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="2c227-178">Pour éviter **perdre des données** et **amélioration des performances**, le  *\<chemin d’accès de destination >* doit être défini sur un autre ordinateur ou un disque dur, différente de celle utilisée pour stocker les journaux de base de données d’origine.</span><span class="sxs-lookup"><span data-stu-id="2c227-178">To avoid **potential data loss** and for **performance improvement**, the *\<destination path>* should be set to a different computer, or hard drive, different from what is used to store the original database logs.</span></span>  
  
     <span data-ttu-id="2c227-179">Sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="2c227-179">Select **OK**.</span></span>  
  
7.  <span data-ttu-id="2c227-180">Sélectionnez le **effacer l’historique de sauvegarde** pas à pas, puis sélectionnez **modifier**.</span><span class="sxs-lookup"><span data-stu-id="2c227-180">Select the **Clear Backup History** step, and select **Edit**.</span></span> <span data-ttu-id="2c227-181">Dans le **commande** zone, mettre à jour les valeurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="2c227-181">In the **Command** box, update the parameter values:</span></span>  
  
    1.  <span data-ttu-id="2c227-182">**@DaysToKeep**: Valeur par défaut est **14 jours**.</span><span class="sxs-lookup"><span data-stu-id="2c227-182">**@DaysToKeep**: Default value is **14 days**.</span></span> <span data-ttu-id="2c227-183">Détermine la durée pendant laquelle l’historique de sauvegarde est conservée le `Adm_BackupHistory` table.</span><span class="sxs-lookup"><span data-stu-id="2c227-183">Determines how long the backup history is kept in the `Adm_BackupHistory` table.</span></span> <span data-ttu-id="2c227-184">Effacer régulièrement de l’historique de sauvegarde vous permet d’assurer le `Adm_BackupHistory` table à une taille appropriée.</span><span class="sxs-lookup"><span data-stu-id="2c227-184">Periodically clearing the backup history helps maintain the `Adm_BackupHistory` table to an appropriate size.</span></span> 
    
    2.  <span data-ttu-id="2c227-185">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="2c227-185">Optional.</span></span> <span data-ttu-id="2c227-186">**@UseLocalTime**: Indique la procédure pour utiliser l’heure locale.</span><span class="sxs-lookup"><span data-stu-id="2c227-186">**@UseLocalTime**: Tells the procedure to use local time.</span></span> <span data-ttu-id="2c227-187">La valeur par défaut est 0 :</span><span class="sxs-lookup"><span data-stu-id="2c227-187">The default value is 0.</span></span> <span data-ttu-id="2c227-188">Il utilise actuel UTC heure – GETUTCDATE() – 2007-05-04 01:34:11.933.</span><span class="sxs-lookup"><span data-stu-id="2c227-188">It uses current UTC time – GETUTCDATE() – 2007-05-04 01:34:11.933.</span></span> <span data-ttu-id="2c227-189">Si la valeur 1, puis il utilise l’heure locale – GETDATE() – 2007-05-03 18:34:11.933</span><span class="sxs-lookup"><span data-stu-id="2c227-189">If set to 1, then it uses local time – GETDATE() – 2007-05-03 18:34:11.933</span></span>
  
    ```  
    exec [dbo].[sp_DeleteBackupHistory] @DaysToKeep=14, @UseLocalTime =1 
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="2c227-190">Cette étape **pas** supprimer les fichiers de sauvegarde à partir du chemin de destination.</span><span class="sxs-lookup"><span data-stu-id="2c227-190">This step **does not** delete backup files from the destination path.</span></span>  
    
     <span data-ttu-id="2c227-191">Sélectionnez **OK** et fermez toutes les fenêtres de propriétés.</span><span class="sxs-lookup"><span data-stu-id="2c227-191">Select **OK** and close all property windows.</span></span>  
  
8.  <span data-ttu-id="2c227-192">Ce paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="2c227-192">Optional.</span></span> <span data-ttu-id="2c227-193">Modifiez la planification de la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="2c227-193">Change the backup schedule.</span></span> <span data-ttu-id="2c227-194">Consultez [comment planifier le travail de sauvegarde de BizTalk Server](../core/how-to-schedule-the-backup-biztalk-server-job.md).</span><span class="sxs-lookup"><span data-stu-id="2c227-194">See [How to Schedule the Backup BizTalk Server Job](../core/how-to-schedule-the-backup-biztalk-server-job.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="2c227-195">Le travail de sauvegarde de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] est exécuté la première fois que vous le configurez.</span><span class="sxs-lookup"><span data-stu-id="2c227-195">The Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job runs the first time you configure it.</span></span> <span data-ttu-id="2c227-196">Par défaut, lors des exécutions suivantes, la sauvegarde [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tâche réalise une sauvegarde complète une fois par jour et effectue des sauvegardes de journal toutes les 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="2c227-196">By default, on subsequent runs, the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job completes a full backup once a day, and completes log backups every 15 minutes.</span></span>  
  
9. <span data-ttu-id="2c227-197">Avec le bouton droit le **sauvegarde de BizTalk Server** de la tâche, puis sélectionnez **activer**.</span><span class="sxs-lookup"><span data-stu-id="2c227-197">Right-click the **Backup BizTalk Server** job, and select **Enable**.</span></span> <span data-ttu-id="2c227-198">L'état doit passer à **Réussite**.</span><span class="sxs-lookup"><span data-stu-id="2c227-198">The status should change to **Success**.</span></span>  
  
## <a name="spforcefullbackup-stored-procedure"></a><span data-ttu-id="2c227-199">Procédure stockée sp_ForceFullBackup</span><span class="sxs-lookup"><span data-stu-id="2c227-199">sp_ForceFullBackup stored procedure</span></span>  
  
<span data-ttu-id="2c227-200">Le **sp_ForceFullBackup** procédure stockée dans le **BizTalkMgmtDb** base de données peut servir à exécuter ad hoc sauvegarde complète des fichiers journaux et de données.</span><span class="sxs-lookup"><span data-stu-id="2c227-200">The **sp_ForceFullBackup** stored procedure in the **BizTalkMgmtDb** database can be used to run an ad-hoc full backup of the data and log files.</span></span> <span data-ttu-id="2c227-201">La procédure stockée met à jour la table adm_ForceFullBackup avec la valeur 1.</span><span class="sxs-lookup"><span data-stu-id="2c227-201">The stored procedure updates the adm_ForceFullBackup table with a value 1.</span></span> <span data-ttu-id="2c227-202">Lors de la prochaine exécution du travail de sauvegarde de [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], un jeu de sauvegarde de base de données complète est créé.</span><span class="sxs-lookup"><span data-stu-id="2c227-202">The next time the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job is ran, a full database backup set is created.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="2c227-203">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="2c227-203">Next Steps</span></span>  
 <span data-ttu-id="2c227-204">[Comment configurer le système de Destination pour l’envoi de journaux](../core/how-to-configure-the-destination-system-for-log-shipping.md) </span><span class="sxs-lookup"><span data-stu-id="2c227-204">[How to Configure the Destination System for Log Shipping](../core/how-to-configure-the-destination-system-for-log-shipping.md) </span></span>  
 [<span data-ttu-id="2c227-205">Comment planifier le travail de sauvegarde de BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="2c227-205">How to Schedule the Backup BizTalk Server Job</span></span>](../core/how-to-schedule-the-backup-biztalk-server-job.md)
