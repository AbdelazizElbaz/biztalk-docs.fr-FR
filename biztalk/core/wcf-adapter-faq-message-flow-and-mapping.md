---
title: "FAQ sur les adaptateurs WCF : Flux de messages et mappage | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 907e5c6a-a095-4b3a-9362-506832b6bc8c
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e58b11cff00d4b235a5c14e75663fdf7e581f782
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="wcf-adapter-faq-message-flow-and-mapping"></a><span data-ttu-id="4e9c5-102">FAQ sur les adaptateurs WCF : Flux de messages et mappage</span><span class="sxs-lookup"><span data-stu-id="4e9c5-102">WCF Adapter FAQ: Message Flow and Mapping</span></span>
## <a name="what-is-the-message-flow-within-the-wcf-and-biztalk-systems"></a><span data-ttu-id="4e9c5-103">Qu'est-ce que le flux de messages dans les systèmes WCF et BizTalk ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-103">What is the message flow within the WCF and BizTalk systems?</span></span>  
 <span data-ttu-id="4e9c5-104">Voici une description du flux d'un message WCF entrant vers BizTalk Server :</span><span class="sxs-lookup"><span data-stu-id="4e9c5-104">Here is a description of the flow of an incoming WCF message to BizTalk Server:</span></span>  
  
1.  <span data-ttu-id="4e9c5-105">Un message WCF arrive à un emplacement de réception et BizTalk Server instancie un service WCF hébergé.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-105">A WCF message arrives at a receive location, and BizTalk Server instantiates a hosted WCF service.</span></span>  
  
2.  <span data-ttu-id="4e9c5-106">Le service d'exécution WCF instancie la pile de canaux du service et ses écouteurs de canal.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-106">The WCF runtime instantiates the service’s channel stack and its channel listeners.</span></span> <span data-ttu-id="4e9c5-107">Une pile de canaux est une séquence d'étapes qui gèrent différentes tâches de traitement.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-107">A channel stack is a sequence of stages that handle differing processing tasks.</span></span> <span data-ttu-id="4e9c5-108">Chaque pile de canaux est constituée d'au moins un canal de transport (le plus souvent, un encodeur de message) et éventuellement d'un ou plusieurs canaux de protocole.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-108">Each channel stack consists of at least a transport channel, most often a message encoder, and zero or more protocol channels.</span></span> <span data-ttu-id="4e9c5-109">Le canal de transport lit le flux de messages entrant à l'arrivée.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-109">The transport channel reads the incoming message stream upon arrival.</span></span> <span data-ttu-id="4e9c5-110">Il invoque un encodeur pour interpréter le message et générer un objet message WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-110">It invokes an encoder to interpret the message and to produce a WCF Message object.</span></span> <span data-ttu-id="4e9c5-111">À ce stade, chaque canal de protocole peut opérer sur le message WCF par ordre.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-111">At this point each protocol channel will have an opportunity to operate on the WCF message in order.</span></span>  
  
3.  <span data-ttu-id="4e9c5-112">Le message WCF est reçu par un écouteur qui le transfère via la pile de canaux WCF configurée et le distribue à l'instance de service appropriée.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-112">The WCF message is received by a listener that forwards it through the configured WCF channel stack and dispatches it to the proper service instance.</span></span> <span data-ttu-id="4e9c5-113">Le message WCF est converti (mappé) en message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-113">At this point the WCF message is converted (mapped) to a BizTalk message.</span></span> <span data-ttu-id="4e9c5-114">Les en-têtes de message WCF sont écrits dans le contexte du message BizTalk, tandis que le corps du message WCF est écrit dans le corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-114">Briefly stated, the WCF message headers are written into the BizTalk message context, and the WCF message body is written into the  BizTalk message body part.</span></span> <span data-ttu-id="4e9c5-115">Le mappage détermine quelle partie du message WCF devient le corps du message BizTalk : enveloppe, corps ou sous-élément.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-115">Mapping controls what part of the WCF message becomes the BizTalk message body: Envelope, body, or sub-element.</span></span>  
  
4.  <span data-ttu-id="4e9c5-116">Les composants de pipeline configurés dans l'emplacement de réception traitent le message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-116">Any pipeline components configured in the receive location processes the BizTalk message.</span></span>  
  
5.  <span data-ttu-id="4e9c5-117">Le message BizTalk est stocké dans la base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-117">The BizTalk message is stored in the MessageBox database.</span></span>  
  
 <span data-ttu-id="4e9c5-118">Voici une description du flux d'un message WCF sortant de BizTalk Server :</span><span class="sxs-lookup"><span data-stu-id="4e9c5-118">Here is a description of the flow of an outgoing WCF message from BizTalk Server:</span></span>  
  
1.  <span data-ttu-id="4e9c5-119">Un message BizTalk est reçu par un port d'envoi conformément à son abonnement.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-119">A BizTalk message is received by a send port according to its subscription.</span></span>  
  
2.  <span data-ttu-id="4e9c5-120">Les composants de pipeline configurés dans le port d'envoi traitent le message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-120">Any pipeline components configured in the send port process the BizTalk message.</span></span>  
  
3.  <span data-ttu-id="4e9c5-121">Une pile de canaux WCF est instanciée et le message BizTalk est converti (mappé) en message WCF sur la base du contrat visible externe du service.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-121">A WCF channel stack is instantiated, and the BizTalk message is converted (mapped) into a WCF message based upon the service’s external visible contract.</span></span>  
  
4.  <span data-ttu-id="4e9c5-122">La pile de canaux WCF transmet le message WCF au service WCF externe.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-122">The WCF channel stack transmits the WCF message to the external WCF service.</span></span>  
  
## <a name="how-is-a-wcf-message-converted-mapped-into-a-biztalk-message"></a><span data-ttu-id="4e9c5-123">Comment un message WCF est-il converti (mappé) en message BizTalk ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-123">How is a WCF message converted (mapped) into a BizTalk message?</span></span>  
 <span data-ttu-id="4e9c5-124">Pour comprendre le mappage, il convient d'examiner la structure d'un message WCF et d'un message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-124">In order to understand the mapping, we need to look at the structure of a WCF message and a BizTalk message.</span></span>  
  
 <span data-ttu-id="4e9c5-125">Un message WCF est basé sur la structure de message SOAP et constitué de propriétés, d'en-têtes et d'un corps de message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-125">A WCF message is modeled on the SOAP message structure and consists of message properties, message headers, and a single message body.</span></span>  
  
-   <span data-ttu-id="4e9c5-126">Le **propriétés du message** sont des objets Common Language Runtime (CLR) qui sont attachés à l’objet du Message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-126">The **message properties** are Common Language Runtime (CLR) objects that are attached to the Message object.</span></span> <span data-ttu-id="4e9c5-127">Elles sont internes à la pile WCF et à l'application de l'utilisateur à chaque extrémité de la communication.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-127">Properties are internal to the WCF stack and the user’s application at each end of the communication.</span></span> <span data-ttu-id="4e9c5-128">Elles ne sont jamais directement transférées entre le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-128">They are never directly transferred between client and server.</span></span>  
  
-   <span data-ttu-id="4e9c5-129">**En-têtes de message**, cependant, peuvent être transférés entre client et serveur.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-129">**Message headers**, however, are transferred between client and server.</span></span> <span data-ttu-id="4e9c5-130">Il peut y avoir plusieurs en-têtes dans un message, mais il n'y a qu'un seul corps de message. Contrairement aux en-têtes, le corps de message est transmis.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-130">There can be many headers on a message, but there is only one message body, and unlike the headers the message body is streamed.</span></span> <span data-ttu-id="4e9c5-131">Les en-têtes et le corps de message sont définis sous la forme d'un ensemble d'informations XML.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-131">Both the message headers and the message body are defined as an XML Infoset.</span></span>  
  
-   <span data-ttu-id="4e9c5-132">Le **corps** message WCF est le contenu principal du message pour lequel les propriétés et en-têtes fournissent plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-132">The **body** of a WCF message is the main content of the message for which the properties and headers provide more information.</span></span>  
  
 <span data-ttu-id="4e9c5-133">Un message BizTalk présente une structure différente.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-133">A BizTalk message has a different structure.</span></span>  
  
-   <span data-ttu-id="4e9c5-134">Chaque message inclut un ensemble unique de propriétés de contexte.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-134">There is a single set of context properties on each message.</span></span> <span data-ttu-id="4e9c5-135">Chaque propriété de contexte est constituée d'une paire de nom/valeur d'espace de noms.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-135">Each context property consists of a namespace name/value pair.</span></span> <span data-ttu-id="4e9c5-136">Les propriétés de contexte peuvent être promues ou écrites.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-136">Context properties can be either promoted or written.</span></span> <span data-ttu-id="4e9c5-137">Si elles sont promues, elles peuvent faire partie des règles de routage exécutées au sein de BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-137">If they are promoted, they can take part in the routing rules that execute within BizTalk Server.</span></span>  
  
-   <span data-ttu-id="4e9c5-138">Les données d'un message dans BizTalk Server peuvent inclure plusieurs flux.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-138">The data of a message in BizTalk Server can consist of multiple streams.</span></span> <span data-ttu-id="4e9c5-139">Un message BizTalk est à parties multiples car chaque flux peut être lu indépendamment.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-139">A BizTalk message is multipart because each stream can be read independently.</span></span> <span data-ttu-id="4e9c5-140">L'une des parties du message est appelée corps.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-140">One of the message parts is special and it is referred to as the body part.</span></span>  
  
 <span data-ttu-id="4e9c5-141">La communication pouvant être bidirectionnelle, l'adaptateur WCF permet la configuration de la conversion ou du mappage particulier pour les sens entrant et sortant de l'échange du message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-141">Because the communication can sometimes be two-way, the WCF adapter allows the particular translation or mapping to be configured for both inbound and outbound directions of message exchange.</span></span> <span data-ttu-id="4e9c5-142">Cela concerne les emplacements de réception et les ports d'envoi dans BizTalk Server.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-142">This can be done for both the receive locations and send ports within BizTalk Server.</span></span>  
  
 <span data-ttu-id="4e9c5-143">Les adaptateurs WCF BizTalk prennent en charge diverses permutations de la conversion lors de l'exécution entre ces deux structures de message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-143">The BizTalk WCF adapters support a number of permutations of translating at run time between these two message structures.</span></span> <span data-ttu-id="4e9c5-144">Mappage est contrôlé via la **Messages** onglet dans le **propriétés du Transport** boîte de dialogue pour un adaptateur WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-144">Mapping is controlled through the **Messages** tab in the **Transport Properties** dialog box for a WCF adapter.</span></span> <span data-ttu-id="4e9c5-145">Par exemple, la conversion la plus évidente (par défaut) est celle qui transforme le corps d'un message WCF entrant en corps du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-145">For example, the most obvious translation, and the default, is when the body of an inbound WCF message becomes the body of the BizTalk message.</span></span> <span data-ttu-id="4e9c5-146">Pour plus d’informations sur les modes de mappage, consultez [http://go.microsoft.com/fwlink/?LinkID=119792](http://go.microsoft.com/fwlink/?LinkID=119792).</span><span class="sxs-lookup"><span data-stu-id="4e9c5-146">For more information about mapping modes, see [http://go.microsoft.com/fwlink/?LinkID=119792](http://go.microsoft.com/fwlink/?LinkID=119792).</span></span>  
  
## <a name="how-can-you-preserve-the-complete-incoming-wcf-message-inside-the-biztalk-message"></a><span data-ttu-id="4e9c5-147">Comment conserver le message WCF entrant complet au sein du message BizTalk ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-147">How can you preserve the complete incoming WCF message inside the BizTalk message?</span></span>  
 <span data-ttu-id="4e9c5-148">Une des options de corps de message BizTalk entrantes est la **enveloppe** option.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-148">One of the inbound BizTalk message body options is the **Envelope** option.</span></span> <span data-ttu-id="4e9c5-149">Elle permet de placer le message SOAP contenu dans l'élément soap:Envelope dans le corps du message BizTalk entrant.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-149">Choosing this option takes the entire SOAP message contained within the soap:Envelope element into the incoming BizTalk message body.</span></span> <span data-ttu-id="4e9c5-150">Le message BizTalk qui en résulte contient les balises d'enveloppe, tous les en-têtes et le corps.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-150">The resulting BizTalk message contains the Envelope tags, all the headers, and the body.</span></span>  
  
## <a name="how-can-you-extract-specific-elements-of-the-incoming-wcf-message-into-a-biztalk-message-or-map-elements-of-an-outgoing-biztalk-message-to-an-outgoing-wcf-message"></a><span data-ttu-id="4e9c5-151">Comment extraire des éléments spécifiques du message WCF entrant dans un message BizTalk ou mapper les éléments d'un message BizTalk sortant dans un message WCF sortant ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-151">How can you extract specific elements of the incoming WCF message into a BizTalk message, or map elements of an outgoing BizTalk message to an outgoing WCF message?</span></span>  
 <span data-ttu-id="4e9c5-152">Pour mapper une section d'un corps de message WCF ou BizTalk, utilisez l'option Chemin d'accès ou Modèle.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-152">To map a section of a WCF or BizTalk message body, use the Path or Template option.</span></span> <span data-ttu-id="4e9c5-153">Celles-ci permettent d'entrer une expression XPath pour extraire des parties spécifiques du corps du message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-153">This allows you to enter an XPath expression to extract specific parts of the message body.</span></span> <span data-ttu-id="4e9c5-154">La syntaxe XPath complète n'est pas prise en charge dans ce cas car l'extraction est transmise par flux et le lecteur doit toujours avancer.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-154">Full XPath syntax is not supported in this situation as the extraction is streamed and the reader must therefore always walk forward.</span></span> <span data-ttu-id="4e9c5-155">C’est pourquoi, dans le **Messages** onglet, elle est appelée « Chemin – contenu localisé par le chemin du corps » au lieu de « XPath – contenu localisé par le chemin du corps ».</span><span class="sxs-lookup"><span data-stu-id="4e9c5-155">This is why in the **Messages** tab it is called “Path – content located by body path” instead of “XPath – content located by body path.”</span></span>  
  
 <span data-ttu-id="4e9c5-156">Au niveau de la réception, utilisez une expression de chemin spécifiant la lecture des données depuis le message WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-156">On the receive side, use a Path expression that dictates how data is to be read from the WCF message.</span></span> <span data-ttu-id="4e9c5-157">Pour un message entrant, l'élément spécifique extrait par la déclaration de chemin est remplacé pour le contenu du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-157">For an inbound message, the specific element extracted by the Path statement gets substituted for the content of the BizTalk message.</span></span> <span data-ttu-id="4e9c5-158">L'adaptateur utilise cette expression de chemin pour localiser et extraire les données souhaitées pour le message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-158">The adapter uses this Path expression to locate and extract the desired data for the BizTalk message.</span></span>  
  
 <span data-ttu-id="4e9c5-159">Au niveau de l'envoi, utilisez un modèle pour créer un message WCF à partir du message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-159">On the send side, use a template to create a WCF message from the BizTalk message.</span></span> <span data-ttu-id="4e9c5-160">L'option de modèle pour les messages sortants est conçue pour permettre l'opposé de l'option XPath.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-160">The template option for outbound messages is designed to allow the exact opposite of the XPath option.</span></span> <span data-ttu-id="4e9c5-161">Dans la configuration d'adaptateur WCF, l'extrait de code XML est utilisé comme base de la structure du message sortant.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-161">In the WCF adapter configuration, the snippet of XML is used as the basis for the structure of the outbound message.</span></span> <span data-ttu-id="4e9c5-162">Le contenu du message BizTalk est inséré lors de l'exécution dans cette structure.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-162">The content of the BizTalk message is inserted at run time into this structure.</span></span>  
  
 <span data-ttu-id="4e9c5-163">Pour un message sortant, vous devez également choisir le type de l'élément écrit à l'aide du paramètre Codage de nœud (XML, Base64, Chaîne ou Hexadécimal).</span><span class="sxs-lookup"><span data-stu-id="4e9c5-163">For an outgoing message, you must also choose the type of the element written by using the Node Encoding setting from XML, Base64, String, or Hexadecimal.</span></span> <span data-ttu-id="4e9c5-164">Cette option est très utile pour extraire un flux de données binaires contenu dans un message WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-164">This option is very useful when you want to extract a binary data stream contained in a WCF message.</span></span> <span data-ttu-id="4e9c5-165">L'utilisation de cette fonctionnalité indique à l'adaptateur WCF d'utiliser les appels ReadContextAsBase64 sur le lecteur de corps du message WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-165">Using this feature instructs the WCF Adapter to use the ReadContextAsBase64 calls on the body Reader of the WCF Message.</span></span> <span data-ttu-id="4e9c5-166">Cet appel permet aux données binaires d'être lues directement via l'API XmlReader. Grâce à cette fonctionnalité, les données binaires peuvent être déplacées directement du transport WCF vers la base de données MessageBox de BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-166">This call allows binary data to be read directly through the XmlReader API, so using this feature binary data can be moved directly from the WCF Transport into the BizTalk MessageBox database.</span></span> <span data-ttu-id="4e9c5-167">En écrivant un chemin d'accès au nœud contenant les données binaires, vous pouvez extraire et placer celles-ci dans le message BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-167">By writing a path to the node containing the binary data you can pull it out and place it into the BizTalk message.</span></span>  
  
## <a name="how-do-you-access-wcf-message-properties-within-an-incoming-wcf-message"></a><span data-ttu-id="4e9c5-168">Comment accéder aux propriétés d'un message WCF entrant ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-168">How do you access WCF message properties within an incoming WCF message?</span></span>  
 <span data-ttu-id="4e9c5-169">Pour accéder aux propriétés d'un message WCF entrant avant qu'il ne soit transformé en message BizTalk, vous pouvez utiliser un composant de canal WCF personnalisé ou un point d'extensibilité de modèle de service avec un comportement WCF</span><span class="sxs-lookup"><span data-stu-id="4e9c5-169">To access properties within an incoming WCF message before it is transformed into a BizTalk message, you can use a custom WCF channel component or a service model extensibility point with a WCF behavior.</span></span> <span data-ttu-id="4e9c5-170">Par exemple, un **IDispatchMessageInspector** objet.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-170">For example, an **IDispatchMessageInspector** object.</span></span> <span data-ttu-id="4e9c5-171">Les adaptateurs BizTalk WCF-Custom et WCF-CustomIsolated offrent un moyen simple pour votre application à la puissance des comportements WCF à l’aide de la **comportement** onglet dans le **propriétés du Transport** boîte de dialogue Ces adaptateurs.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-171">The BizTalk WCF-Custom and WCF-CustomIsolated adapters provide a simple way for your application to plug into the power of WCF behaviors using the **Behavior** tab in the **Transport Properties** dialog for those adapters.</span></span>  
  
 <span data-ttu-id="4e9c5-172">Pour que les propriétés d'un message WCF soient accessibles à l'adaptateur WCF, celles-ci doivent d'abord être écrites dans le corps ou l'en-tête du message sous forme de contenu.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-172">To allow the properties of a WCF message to be available to the WCF adapter, those properties first have to be written into the message body or header as content.</span></span> <span data-ttu-id="4e9c5-173">Les en-têtes sont copiés dans le contexte du message BizTalk automatiquement.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-173">The headers are copied into the BizTalk message context automatically for you.</span></span> <span data-ttu-id="4e9c5-174">Si vous souhaitez une valeur de propriété promue, vous pouvez utiliser un composant de pipeline BizTalk personnalisé pour promouvoir la propriété de message WCF dans le contexte de message BizTalk depuis le **IComponent : Execute** (méthode).</span><span class="sxs-lookup"><span data-stu-id="4e9c5-174">If you want a property value promoted, you can use a custom BizTalk pipeline component to promote the WCF message property into the BizTalk message context from within the **IComponent:Execute** method.</span></span> <span data-ttu-id="4e9c5-175">L'utilisation des comportements WCF personnalisés avec les adaptateurs personnalisés WCF permet de tirer parti de l'extensibilité de WCF et de BizTalk pour accroître la puissance et la flexibilité de votre solution.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-175">Using custom WCF behaviors with the WCF custom adapters allows you to take advantage of both WCF and BizTalk extensibility to make your solution more powerful and flexible.</span></span> <span data-ttu-id="4e9c5-176">L'adaptateur WCF permet de combiner l'extensibilité de BizTalk et de WCF pour résoudre votre problème.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-176">The WCF adapter allows you to combine existing BizTalk and WCF extensibilities to solve your problem.</span></span>  
  
 <span data-ttu-id="4e9c5-177">Un raccourci est disponible dans l'adaptateur WCF pour ce cas de propriété commune.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-177">The good news is that there is a shortcut in the WCF adapter for this common property case.</span></span> <span data-ttu-id="4e9c5-178">Plutôt que de tirer parti de l'extensibilité, vous pouvez simplement faire en sorte que l'extension WCF crée une propriété « connue » qui soit comprise par l'adaptateur WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-178">Rather than writing to both extensibility stories, you can simply have the WCF extension create a new “well known” property that is understood by the WCF adapter.</span></span>  
  
 <span data-ttu-id="4e9c5-179">Pour écrire ou promouvoir les valeurs d'en-tête SOAP dans le contexte du message BizTalk, le message WCF doit contenir un ensemble de paires de valeurs constituées de noms de propriété et d'espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-179">In order to write or promote SOAP header values into the BizTalk message context, the WCF message must contain a collection of value pairs that consist of property names and namespaces.</span></span> <span data-ttu-id="4e9c5-180">Cela permet aux adaptateurs WCF de reconnaître que les valeurs d'en-tête doivent être écrites ou promues.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-180">This allows the WCF adapters to recognize that the header values are to be written or promoted.</span></span>  
  
 <span data-ttu-id="4e9c5-181">Un adaptateur WCF attend les propriétés suivantes dans les messages WCF pour écrire ou promouvoir les valeurs d'en-tête SOAP dans le contexte du message BizTalk :</span><span class="sxs-lookup"><span data-stu-id="4e9c5-181">A WCF adapter expects the following message properties in the WCF messages for writing or promoting SOAP header values to the BizTalk message context:</span></span>  
  
-   <span data-ttu-id="4e9c5-182">Pour promouvoir les valeurs d’en-tête SOAP dans le contexte de message BizTalk, les adaptateurs WCF recherchent la paire de clé **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/Promote** et la valeur **liste < KeyValuePair\<XmlQualifiedName, objet >>**.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-182">To promote the SOAP header values to the BizTalk message context, WCF adapters are looking for the pair of key **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/Promote** and value **List<KeyValuePair\<XmlQualifiedName, object>>**.</span></span> <span data-ttu-id="4e9c5-183">À l’aide de cette paire, les adaptateurs extraient l’espace de noms, le nom et la valeur de la **XmlQualifiedName** de l’objet et les utilisent pour promouvoir les valeurs d’en-tête.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-183">Using this pair, WCF adapters take the namespace, name, and value from the **XmlQualifiedName** object and use them for promoting the header values.</span></span>  
  
-   <span data-ttu-id="4e9c5-184">Pour écrire, mais pas la promotion, les valeurs d’en-tête SOAP dans le contexte de message BizTalk, les adaptateurs WCF recherchent la paire de clé **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/WriteToContext** et la valeur **Liste < KeyValuePair\<XmlQualifiedName, objet >>.**</span><span class="sxs-lookup"><span data-stu-id="4e9c5-184">To write, but not promote, the SOAP header values into the BizTalk message context, WCF adapters are looking for the pair of key **http://schemas.microsoft.com/BizTalk/2006/01/Adapters/WCF-properties/WriteToContext** and value **List<KeyValuePair\<XmlQualifiedName, object>>.**</span></span> <span data-ttu-id="4e9c5-185">À l'aide de cette paire, les adaptateurs WCF écrivent les valeurs dans le contexte du message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-185">Using this pair, WCF adapters write the values to the message context.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="4e9c5-186">Les propriétés promues doivent également être spécifiées dans le schéma de propriété BizTalk pour être acceptées par le moteur d'exécution BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-186">Promoted properties must also be specified in a BizTalk property schema in order to be accepted by the BizTalk runtime.</span></span>  
  
## <a name="you-have-an-existing-orchestration-or-send-port-etc-that-expects-a-biztalk-multipart-message-how-can-you-get-a-multipart-message-in-the-wcf-scenario"></a><span data-ttu-id="4e9c5-187">Une orchestration (ou un port d'envoi, etc.) attend un message à parties multiples BizTalk.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-187">You have an existing orchestration (or send port, etc.) that expects a BizTalk multipart message.</span></span> <span data-ttu-id="4e9c5-188">Comment obtenir un message à parties multiples dans le scénario WCF ?</span><span class="sxs-lookup"><span data-stu-id="4e9c5-188">How can you get a multipart message in the WCF scenario?</span></span>  
 <span data-ttu-id="4e9c5-189">Un message à parties multiples BizTalk est constitué d'une ou plusieurs parties de message.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-189">A BizTalk multipart message is composed of one or more message parts.</span></span> <span data-ttu-id="4e9c5-190">Toutefois, un message à parties multiples est un concept étranger à WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-190">However, WCF has no concept of a multipart message.</span></span> <span data-ttu-id="4e9c5-191">Comme WCF n'utilise pas les messages à parties multiples, les adaptateurs WCF BizTalk ne les utilisent pas davantage.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-191">Because WCF does not use multipart messages, the BizTalk WCF adapters also do not use them.</span></span> <span data-ttu-id="4e9c5-192">Cela pose problème si vous avez une orchestration ou un pipeline BizTalk écrit pour générer ou consommer des messages à parties multiples.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-192">The problem is that you may have an existing BizTalk orchestration or pipeline that is written to produce or consume multipart messages.</span></span>  
  
 <span data-ttu-id="4e9c5-193">Si vous devez placer un message à parties multiples dans BizTalk Server à l'aide d'un message WCF entrant et des adaptateurs WCF, affichez vos données à parties multiples dans votre message WCF.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-193">If you need to get a multipart message into BizTalk Server by using an incoming WCF message and the WCF adapters, render your multipart data as XML in your WCF message.</span></span> <span data-ttu-id="4e9c5-194">Développez un composant de pipeline BizTalk personnalisé pour traiter le flux XML entrant (message WCF) et créer le message à parties multiples BizTalk approprié pour votre application.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-194">Develop a custom BizTalk pipeline component to process the incoming XML stream (WCF message) and create the appropriate BizTalk multipart message for your application.</span></span> <span data-ttu-id="4e9c5-195">Ces étapes peuvent être effectuées dans l'ordre inverse au niveau de l'envoi le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="4e9c5-195">These steps can be done in reverse for the Send side if required.</span></span>