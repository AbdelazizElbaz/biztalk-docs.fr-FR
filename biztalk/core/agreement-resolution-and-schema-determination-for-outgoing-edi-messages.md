---
title: "Résolution de l’accord et détermination du schéma pour les Messages EDI sortants | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: e37aeb9d-1e95-464d-bb71-73653c1d4674
caps.latest.revision: "24"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4d33715d4f1683910269adf7b49965e31bce4840
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="agreement-resolution-and-schema-determination-for-outgoing-edi-messages"></a><span data-ttu-id="17546-102">Résolution de l'accord et détermination du schéma pour les messages EDI sortants</span><span class="sxs-lookup"><span data-stu-id="17546-102">Agreement Resolution and Schema Determination for Outgoing EDI Messages</span></span>
<span data-ttu-id="17546-103">Pour générer un message EDI vers un partenaire commercial, le pipeline d'envoi EDI doit effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="17546-103">To generate an EDI message to a trading partner, the EDI send pipeline must do the following:</span></span>  
  
-   <span data-ttu-id="17546-104">déterminer l'accord correspondant au message ;</span><span class="sxs-lookup"><span data-stu-id="17546-104">Determine the agreement that the message resolves to</span></span>  
  
-   <span data-ttu-id="17546-105">déterminer le schéma à utiliser pour valider le message.</span><span class="sxs-lookup"><span data-stu-id="17546-105">Determine the schema to use to validate the message</span></span>  
  
## <a name="agreement-resolution"></a><span data-ttu-id="17546-106">Résolution de l'accord</span><span class="sxs-lookup"><span data-stu-id="17546-106">Agreement Resolution</span></span>  
 <span data-ttu-id="17546-107">Le pipeline d'envoi EDI effectue une recherche d'accord par le biais d'une série d'étapes pour déterminer s'il existe une correspondance entre l'échange sortant et les propriétés d'un accord.</span><span class="sxs-lookup"><span data-stu-id="17546-107">The EDI send pipeline performs agreement lookup by performing a series of steps to determine whether there is a match between the outgoing interchange and the properties of an agreement.</span></span> <span data-ttu-id="17546-108">Une fois que [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] a déterminé l'accord, il identifie le schéma de document qui s'applique à l'échange (voir ci-après).</span><span class="sxs-lookup"><span data-stu-id="17546-108">Once [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement, it determines the document schema that applies to the interchange (see below).</span></span> <span data-ttu-id="17546-109">Il utilise les propriétés associées à l'accord correspondant et le schéma pertinent pour générer et valider le message sortant.</span><span class="sxs-lookup"><span data-stu-id="17546-109">It uses the properties associated with the matching agreement and the relevant schema to generate and validate the outgoing message.</span></span>  
  
 <span data-ttu-id="17546-110">Pour effectuer la résolution de l'accord, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] procède comme suit :</span><span class="sxs-lookup"><span data-stu-id="17546-110">To perform agreement resolution, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proceeds as follows:</span></span>  
  
1.  <span data-ttu-id="17546-111">Résout l'accord en faisant correspondre la propriété de contexte AgreementPartIDForSend à l'ID de l'accord unidirectionnel.</span><span class="sxs-lookup"><span data-stu-id="17546-111">Resolves the agreement by matching the AgreementPartIDForSend context property with the ID of the one-way agreement.</span></span> <span data-ttu-id="17546-112">Cette propriété doit être un type entier. Vous pouvez la définir dans un composant personnalisé car elle n'est pas définie par [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="17546-112">This property should be an integer type, it can be set in a custom component; it is not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
2.  <span data-ttu-id="17546-113">Si l'étape 1 échoue, résout l'accord en mettant en correspondance les trois propriétés de contexte suivantes avec les propriétés d'accord AgreementNameForSend, SenderPartyNameForSend, ReceiverPartyNameForSend.</span><span class="sxs-lookup"><span data-stu-id="17546-113">If step 1 does not succeed, resolves the agreement by matching all the following three context properties with the agreement properties: AgreementNameForSend, SenderPartyNameForSend, ReceiverPartyNameForSend.</span></span> <span data-ttu-id="17546-114">Notez que celles-ci doivent être définies de manière à être correctement associées à un accord.</span><span class="sxs-lookup"><span data-stu-id="17546-114">Note that all the three properties must be set in order to successfully resolve to an agreement.</span></span> <span data-ttu-id="17546-115">Vous pouvez les définir dans un composant personnalisé car elles ne sont pas définies par [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="17546-115">These properties can be set in a custom component; it is not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
3.  <span data-ttu-id="17546-116">Si l’étape 2 échoue, résout l’accord en faisant correspondre le nom du tiers dans les propriétés de contexte de message avec la propriété DestinationPartyName, qui est défini en tant que programme de résolution d’accord supplémentaire dans le **identificateurs** onglet de propriétés de l’accord.</span><span class="sxs-lookup"><span data-stu-id="17546-116">If step 2 does not succeed, resolves the agreement by matching the party name in the message context properties with the DestinationPartyName property, which is set as additional agreement resolver in the **Identifiers** tab of agreement properties.</span></span>  
  
4.  <span data-ttu-id="17546-117">En cas d'échec de l'étape 3, résout l'accord en mettant en correspondance les propriétés suivantes dans le contexte d'un message avec celles des propriétés d'accord DestinationPartySenderIdentifier, DestinationPartySenderQualifier, DestinationPartyReceiverIdentifier et DestinationPartyReceiverQualifier.</span><span class="sxs-lookup"><span data-stu-id="17546-117">If step 3 does not succeed, resolves the agreement by matching the following properties in the context of a message with those in agreement properties: DestinationPartySenderIdentifier, DestinationPartySenderQualifier, DestinationPartyReceiverIdentifier, and DestinationPartyReceiverQualifier.</span></span> <span data-ttu-id="17546-118">Notez que les quatre propriétés doivent être définies afin de résoudre correctement à un accord.</span><span class="sxs-lookup"><span data-stu-id="17546-118">Note that all the four properties must be set in order to successfully resolve to an agreement.</span></span> <span data-ttu-id="17546-119">Ces propriétés peuvent être définies dans un composant personnalisé ; ils ne sont pas activés par [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="17546-119">These properties can be set in a custom component; they are not set by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="17546-120">Pour plus d'informations, consultez les paragraphes ci-après.</span><span class="sxs-lookup"><span data-stu-id="17546-120">For more information, see below.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="17546-121">Si l'un des ensembles de propriétés de contexte ci-dessus est promu et que [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] ne parvient pas à trouver un accord associé à ces propriétés de contexte, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] suspend le message.</span><span class="sxs-lookup"><span data-stu-id="17546-121">If any of the above sets of context properties are promoted and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is unable to find an agreement associated with those context properties, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] suspends the message.</span></span>  
    >   
    >  <span data-ttu-id="17546-122">Si l'utilisateur écrit intentionnellement un ensemble de propriétés de contexte à des fins de résolution d'accord et si le résolveur ne parvient pas à identifier OnewayAgreement, le message est suspendu.</span><span class="sxs-lookup"><span data-stu-id="17546-122">If the user intentionally writes a set of context properties for agreement resolution, and if the resolver fails to identify the OnewayAgreement, then the message is suspended.</span></span> <span data-ttu-id="17546-123">En cas d'échec de la résolution d'un accord en fonction d'un ensemble de propriétés de contexte, un message d'avertissement est généré dans EventLog.</span><span class="sxs-lookup"><span data-stu-id="17546-123">On failure to resolve to an agreement based on a set of context properties, a corresponding warning message is thrown in the EventLog.</span></span>  
  
5.  <span data-ttu-id="17546-124">Si l'étape 4 échoue ou qu'aucune des propriétés de contexte ci-dessus n'est promue, le message EDI est mappé à un accord en faisant correspondre le port d'envoi abonné au message au port d'envoi associé à un accord.</span><span class="sxs-lookup"><span data-stu-id="17546-124">If step 4 does not succeed or none of the above context properties are promoted, then the EDI message is resolved to an agreement by matching the send port that subscribed to the message with the send port associated with an agreement.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="17546-125">Si le même port d'envoi est associé à plusieurs accords, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="17546-125">If the same send port is associated with multiple agreements, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will generate an error.</span></span>  
  
6.  <span data-ttu-id="17546-126">Si aucun accord n'est trouvé lors de l'étape 1, 2, 3 ou 4, le pipeline d'envoi utilise les paramètres d'accord de secours pour générer le message sortant.</span><span class="sxs-lookup"><span data-stu-id="17546-126">If no agreement is found in steps 1, 2, 3, or 4, the send pipeline uses the fallback agreement settings to generate the outgoing message.</span></span>  
  
 <span data-ttu-id="17546-127">**Résolution de l’accord en mettant en correspondance de l’expéditeur et récepteur les propriétés de contexte**</span><span class="sxs-lookup"><span data-stu-id="17546-127">**Agreement Resolution by Matching Sender and Receiver Context Properties**</span></span>  
  
 <span data-ttu-id="17546-128">Dans l'étape 2 ci-dessus, les quatre propriétés de contexte utilisées dans la correspondance sont les suivantes : EDI.DestinationPartySenderIdentifier, EDI.DestinationPartySenderQualifier, EDI.DestinationPartyReceiverIdentifier et EDI.DestinationPartyReceiverQualifier.</span><span class="sxs-lookup"><span data-stu-id="17546-128">In the second step above, the four context properties used in the match are EDI.DestinationPartySenderIdentifier, EDI.DestinationPartySenderQualifier, EDI.DestinationPartyReceiverIdentifier, and EDI.DestinationPartyReceiverQualifier.</span></span> <span data-ttu-id="17546-129">L'espace de noms de ces propriétés de contexte est `http://schemas.microsoft.com/Edi/PropertySchema`.</span><span class="sxs-lookup"><span data-stu-id="17546-129">The namespace for these context properties is `http://schemas.microsoft.com/Edi/PropertySchema`.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="17546-130">tente de faire correspondre ces valeurs avec l’expéditeur connexe et les identificateurs du récepteur et les qualificateurs dans les propriétés d’accord unidirectionnel.</span><span class="sxs-lookup"><span data-stu-id="17546-130"> attempts to match these values with the related sender and receiver identifiers and qualifiers in the one-way agreement properties.</span></span> <span data-ttu-id="17546-131">Pour X12, ces champs sont ISA05, ISA06, ISA07 et ISA08 dans le **identificateurs** page de l’onglet d’accord unidirectionnel de la **propriétés de l’accord** boîte de dialogue ; pour EDIFACT, ces champs sont UNB2.1, UNB2.2, UNB3.1 et UNB3.2 dans les **identificateurs** page de l’onglet d’accord unidirectionnel de la **propriétés de l’accord** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="17546-131">For X12, these fields are ISA05, ISA06, ISA07, and ISA08 in the **Identifiers** page of the one-way agreement tab in the **Agreement Properties** dialog box; for EDIFACT, these fields are UNB2.1, UNB2.2, UNB3.1, and UNB3.2 in the **Identifiers** page of the one-way agreement tab in the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="17546-132">Pour activer la résolution d'accord côté envoi à l'aide des quatre qualificateurs et identificateurs de l'expéditeur et du récepteur, vous devez définir les quatre propriétés de contexte</span><span class="sxs-lookup"><span data-stu-id="17546-132">To enable send-side agreement resolution using all four sender and receiver identifiers and qualifiers, you will have to set all four context properties.</span></span> <span data-ttu-id="17546-133">afin d'identifier l'accord de manière unique.</span><span class="sxs-lookup"><span data-stu-id="17546-133">Doing so uniquely identifies the agreement.</span></span> <span data-ttu-id="17546-134">L'utilisation de cette méthode de recherche d'accord offre une flexibilité accrue dans le cadre du traitement côté envoi.</span><span class="sxs-lookup"><span data-stu-id="17546-134">Using this method of agreement lookup gives you more flexibility in send-side processing.</span></span> <span data-ttu-id="17546-135">Par exemple, elle peut vous éviter de créer plusieurs ports d'envoi sous certaines circonstances et de faire appel à des filtres de port d'envoi complexes.</span><span class="sxs-lookup"><span data-stu-id="17546-135">For example, this method may enable you to avoid creating multiple send ports in some circumstances, and to avoid complicated send port filters.</span></span> <span data-ttu-id="17546-136">Elle vous évite également de devoir définir la propriété OneWayAgreementId (le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="17546-136">It also enables you to avoid setting the OneWayAgreementId property, if desired.</span></span>  
  
 <span data-ttu-id="17546-137">Si les quatre propriétés de contexte ont été définies pour un message et qu'aucune correspondance n'est trouvée entre celles-ci et les propriétés de propriété, le message est suspendu.</span><span class="sxs-lookup"><span data-stu-id="17546-137">If all four context properties have been set for a message, and no match is found between those context properties and the property properties, the message is suspended.</span></span> <span data-ttu-id="17546-138">L'accord est résolu à l'aide du port d'envoi associé à l'accord uniquement si aucune des quatre propriétés de contexte n'a été définie.</span><span class="sxs-lookup"><span data-stu-id="17546-138">The agreement will be resolved using the send port associated with an agreement only if all four context properties have not been set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="17546-139">Un message du pipeline EDI est transmis à l'étape réussie de la résolution d'accord jusqu'à ce qu'il soit résolu et que l'accord soit activé dans l'étape.</span><span class="sxs-lookup"><span data-stu-id="17546-139">A message in the EDI pipeline goes to the succeeding step in Agreement Resolution till the message gets resolved with the step having Agreement in enable state.</span></span> <span data-ttu-id="17546-140">Par exemple, si le message est résolu dans la première étape de la résolution d'accord mais que l'accord est désactivé, le message est transmis à l'étape réussie à des fins de résolution.</span><span class="sxs-lookup"><span data-stu-id="17546-140">For example, if the message gets resolved in the first step of Agreement Resolution but the Agreement is in a disabled state then the message goes to the succeeding step for resolution.</span></span>  
  
## <a name="schema-determination"></a><span data-ttu-id="17546-141">Détermination du schéma</span><span class="sxs-lookup"><span data-stu-id="17546-141">Schema Determination</span></span>  
 <span data-ttu-id="17546-142">Le pipeline d'envoi EDI détermine le schéma qui s'applique au message à partir des nom et espace de noms du schéma contenus dans le fichier XML intermédiaire de chaque document informatisé (soit en tant qu'informations de type de document soit dans le nœud racine).</span><span class="sxs-lookup"><span data-stu-id="17546-142">The EDI send pipeline determines the schema that applies to the message from the schema name and schema namespace contained in the intermediate XML file for each transaction set (either as doc type information or in the root node).</span></span>  
  
 <span data-ttu-id="17546-143">Pour un échange conservé, le pipeline d'envoi utilise les informations de type de document des documents informatisés spécifiques du fichier XML intermédiaire pour l'échange complet.</span><span class="sxs-lookup"><span data-stu-id="17546-143">For an interchange that has been preserved, the send pipeline uses the doc type information in the individual transaction sets of the intermediate XML file for the complete interchange.</span></span> <span data-ttu-id="17546-144">Il utilise les schémas de segment de contrôle pour le traitement des segments d'enveloppe.</span><span class="sxs-lookup"><span data-stu-id="17546-144">It uses the control segment schemas for processing the envelope segments.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="17546-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="17546-145">See Also</span></span>  
 [<span data-ttu-id="17546-146">Envoi des Messages EDI dans BizTalk Server</span><span class="sxs-lookup"><span data-stu-id="17546-146">How BizTalk Server Sends EDI Messages</span></span>](../core/how-biztalk-server-sends-edi-messages.md)