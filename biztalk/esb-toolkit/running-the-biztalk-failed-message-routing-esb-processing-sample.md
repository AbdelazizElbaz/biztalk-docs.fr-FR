---
title: "Échec de l’exemple de traitement ESB du routage de Message en cours d’exécution BizTalk | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d2a536a0-cfc8-4ba3-adcd-2b8b580bff85
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 81a2b225e5316d16e31d2ed2ca830387dc14048d
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/01/2017
---
# <a name="running-the-biztalk-failed-message-routing-esb-processing-sample"></a><span data-ttu-id="c4ee7-102">Échec de l’exemple de traitement ESB du routage de Message BizTalk en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="c4ee7-102">Running the BizTalk Failed Message Routing ESB Processing Sample</span></span>
<span data-ttu-id="c4ee7-103">L’exemple Microsoft BizTalk Échec de routage ESB de traitement du Message montre comment vous pouvez utiliser la [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] Exception Management Framework comme mécanisme d’universel à gérer, de sérialiser et de restituer des exceptions qui se produisent dans toutes les conditions dans BizTalk Server Serveur.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-103">The Microsoft BizTalk Failed Message Routing ESB Processing sample demonstrates how you can use the [!INCLUDE[esbToolkit](../includes/esbtoolkit-md.md)] Exception Management Framework as a universal mechanism to manage, serialize, and render exceptions occurring under all conditions in BizTalk Server.</span></span> <span data-ttu-id="c4ee7-104">Cela inclut les exceptions générées par BizTalk Échec de routage des messages mécanisme et erreur messages générés par l’infrastructure de gestion d’Exception à partir d’une orchestration.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-104">This includes exceptions generated by the BizTalk Failed Message Routing mechanism and fault messages generated by the Exception Management Framework from within an orchestration.</span></span>  
  
 <span data-ttu-id="c4ee7-105">Le mécanisme de routage des messages a échoué BizTalk est la facilité de gestion des erreurs de BizTalk Server ; en l’utilisant, le concepteur peut désigner la gestion automatique des échecs de messagerie comme alternative à traditionnel (maintenant) par défaut de l’insertion d’échec de messages dans la file d’attente « Suspendu ».</span><span class="sxs-lookup"><span data-stu-id="c4ee7-105">The BizTalk Failed Message Routing mechanism is the error-handling facility of BizTalk Server; by using it, the designer can designate automated handling of messaging failures as an alternative to the traditional (now default) behavior of placing failed messages in the "Suspended" queue.</span></span> <span data-ttu-id="c4ee7-106">Cette gestion automatique achemine un message d’erreur à n’importe quelle destination de routage abonnée, comme un port d’envoi ou d’une orchestration.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-106">This automated handling routes an error message to any subscribing routing destination, such as a send port or an orchestration.</span></span> <span data-ttu-id="c4ee7-107">Le message d’erreur est un clone du message d’origine avec toutes les propriétés précédemment promues rétrogradées et avec les propriétés sélectionnées associées à l’échec de la messagerie promue dans le contexte du message.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-107">The error message is a clone of the original message with all previously promoted properties demoted and with selected properties related to the specific messaging failure promoted into the message context.</span></span>  
  
 <span data-ttu-id="c4ee7-108">Pour activer le mécanisme de routage des messages a échoué BizTalk sur un port de réception ou un port d’envoi, sélectionnez le **activer le routage pour les messages ayant échoué** case à cocher, comme indiqué dans la Figure 1.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-108">To enable the BizTalk Failed Message Routing mechanism on a receive port or a send port, select the **Enable routing for failed messages** check box, as shown in Figure 1.</span></span>  
  
 <span data-ttu-id="c4ee7-109">![Routage activé](../esb-toolkit/media/ch6-enabledrouting.gif "§ 6-EnabledRouting")</span><span class="sxs-lookup"><span data-stu-id="c4ee7-109">![Enabled Routing](../esb-toolkit/media/ch6-enabledrouting.gif "Ch6-EnabledRouting")</span></span>  
  
 <span data-ttu-id="c4ee7-110">**Figure 1**</span><span class="sxs-lookup"><span data-stu-id="c4ee7-110">**Figure 1**</span></span>  
  
 <span data-ttu-id="c4ee7-111">**L’activation du mécanisme de routage des messages a échoué BizTalk**</span><span class="sxs-lookup"><span data-stu-id="c4ee7-111">**Enabling the BizTalk Failed Message Routing mechanism**</span></span>  
  
 <span data-ttu-id="c4ee7-112">Toutefois, il n'est pas un mécanisme similaire pour les erreurs ou les défaillances qui se produisent dans une orchestration.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-112">However, there is not a similar mechanism for errors or failures occurring in an orchestration.</span></span> <span data-ttu-id="c4ee7-113">Au lieu de cela, le code dans le Gestionnaire d’exceptions d’une orchestration peut profiter de l’API de Framework Exception Management pour émuler la fonctionnalité de la méthode de routage des messages a échoué BizTalk.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-113">Instead, code within the exception handler of an orchestration can take advantage of the Exception Management Framework API to emulate the functionality of the BizTalk Failed Message Routing mechanism.</span></span>  
  
 <span data-ttu-id="c4ee7-114">Dans cet exemple, l’emplacement de réception nommé EAIProcess.RequestPort_FILE récupère les fichiers copiés à l’emplacement \Source\Samples\Exception Handling\Test\Filedrop\EAIProcess.RequestPort.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-114">In this sample, the receive location named EAIProcess.RequestPort_FILE picks up files copied to the location \Source\Samples\Exception Handling\Test\Filedrop\EAIProcess.RequestPort.</span></span>  
  
 <span data-ttu-id="c4ee7-115">En outre, il est un port d’envoi générique appelé tous. Exceptions_FILE configuré pour utiliser le pipeline GlobalFaultProcessor installé dans le cadre de l’infrastructure de gestion d’Exception.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-115">Additionally, there is a generic send port named ALL.Exceptions_FILE configured to use the GlobalFaultProcessor pipeline installed as part of the Exception Management Framework.</span></span> <span data-ttu-id="c4ee7-116">Ce port s’abonne à toutes les exceptions qui se produisent dans le système, les deux BizTalk Échec de routage des messages de message et les messages d’erreur ESB, comme indiqué dans la Figure 2.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-116">This port subscribes to all exceptions occurring in the system, both BizTalk failed message routing messages and ESB fault messages, as shown in Figure 2.</span></span>  
  
 <span data-ttu-id="c4ee7-117">![Port d’envoi](../esb-toolkit/media/ch6-sendport.gif "§ 6-ports d’envoi")</span><span class="sxs-lookup"><span data-stu-id="c4ee7-117">![Send Port](../esb-toolkit/media/ch6-sendport.gif "Ch6-SendPort")</span></span>  
  
 <span data-ttu-id="c4ee7-118">**Figure 2**</span><span class="sxs-lookup"><span data-stu-id="c4ee7-118">**Figure 2**</span></span>  
  
 <span data-ttu-id="c4ee7-119">**Tous les. Abonnement de port pour tous les types d’exception ou d’échec d’envoi exceptions**</span><span class="sxs-lookup"><span data-stu-id="c4ee7-119">**The ALL.Exceptions send port subscription for all types of failure or exception**</span></span>  
  
 <span data-ttu-id="c4ee7-120">L’infrastructure de gestion d’Exception normalise toutes les exceptions dans un format unique et sérialise à l’aide d’une instruction de traitement InfoPath de Microsoft à l’emplacement \Source\Samples\Exception Handling\Test\Filedrop\All_Exceptions.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-120">The Exception Management Framework normalizes all exceptions to a single format and serializes them using a Microsoft InfoPath processing instruction to the location \Source\Samples\Exception Handling\Test\Filedrop\All_Exceptions.</span></span>  
  
## <a name="installation"></a><span data-ttu-id="c4ee7-121">Installation</span><span class="sxs-lookup"><span data-stu-id="c4ee7-121">Installation</span></span>  
 <span data-ttu-id="c4ee7-122">Tous les exemples de gestion d’exception utilisent le même jeu de services principaux et les artefacts de l’application BizTalk.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-122">All the exception management samples use the same set of core services and BizTalk application artifacts.</span></span> <span data-ttu-id="c4ee7-123">Par conséquent, vous devez installer les artefacts d’exemple de gestion d’exception qu’une seule fois pour être en mesure d’exécuter tous les l’exception des exemples de gestion.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-123">Therefore, you have to install the exception management sample artifacts only once to be able to run all the exception management samples.</span></span> <span data-ttu-id="c4ee7-124">Pour plus d’informations sur la façon d’installer les exemples de gestion des exceptions, consultez [installant les exemples de gestion des exceptions](../esb-toolkit/installing-the-exception-management-samples.md).</span><span class="sxs-lookup"><span data-stu-id="c4ee7-124">For information about how to install the exception management samples, see [Installing the Exception Management Samples](../esb-toolkit/installing-the-exception-management-samples.md).</span></span>  
  
## <a name="running-the-sample-application"></a><span data-ttu-id="c4ee7-125">Exécution de l'exemple d'application</span><span class="sxs-lookup"><span data-stu-id="c4ee7-125">Running the Sample Application</span></span>  
 <span data-ttu-id="c4ee7-126">**Pour exécuter l’exemple BizTalk Échec de routage ESB de traitement du Message**</span><span class="sxs-lookup"><span data-stu-id="c4ee7-126">**To run the BizTalk Failed Message Routing ESB Processing sample**</span></span>  
  
1.  <span data-ttu-id="c4ee7-127">Avant d’exécuter cet exemple pour la première fois, assurez-vous que la réception emplacement et envoyer une URL de port pointant vers les répertoires appropriés dans le dossier \Source\Samples\Exception Handling\Test\Filedrop.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-127">Before you run this sample for the first time, make sure that the receive location and send port URL point to the appropriate directories in the \Source\Samples\Exception Handling\Test\Filedrop folder.</span></span> <span data-ttu-id="c4ee7-128">L’emplacement de réception doit spécifier le dossier EAIProcess.RequestPort, et l’URL de port d’envoi doit spécifier le dossier All_Exceptions.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-128">The receive location should specify the folder EAIProcess.RequestPort, and the send port URL should specify the folder All_Exceptions.</span></span>  
  
2.  <span data-ttu-id="c4ee7-129">Si l’application GlobalBank.ESB n’est pas déjà en cours d’exécution, utilisez la Console Administration de BizTalk pour le démarrer.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-129">If the GlobalBank.ESB application is not already running, use the BizTalk Administration Console to start it.</span></span>  
  
3.  <span data-ttu-id="c4ee7-130">Copiez le fichier nommé FlatFileReceive_in.txt dans le dossier \Source\Samples\Exception Handling\Test\Data dans le dossier d’emplacement de réception nommé EAIProcess.RequestPort (dans le dossier \Source\Samples\Exception Handling\Test\Filedrop).</span><span class="sxs-lookup"><span data-stu-id="c4ee7-130">Copy the file named FlatFileReceive_in.txt from the folder \Source\Samples\Exception Handling\Test\Data into the receive location folder named EAIProcess.RequestPort (in the \Source\Samples\Exception Handling\Test\Filedrop folder).</span></span>  
  
4.  <span data-ttu-id="c4ee7-131">Ce message est un fichier texte, et il provoquera une exception.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-131">This message is a text file, and it will cause an exception.</span></span> <span data-ttu-id="c4ee7-132">Ouvrez le dossier nommé All_Exceptions (dans le dossier \Source\Samples\Exception Handling\Test\Filedrop), puis double-cliquez sur le message d’erreur pour l’ouvrir dans InfoPath à l’aide du modèle approprié.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-132">Open the folder named All_Exceptions (in the \Source\Samples\Exception Handling\Test\Filedrop folder), and then double-click the fault message to open it into InfoPath using the appropriate template.</span></span> <span data-ttu-id="c4ee7-133">Vous verrez que le mécanisme de gestion des exceptions de ESB sérialise le contenu de façon appropriée pour permettre d’InfoPath à rendre.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-133">You will see that the ESB Exception Handling mechanism serializes the content appropriately to allow InfoPath to render it.</span></span>  
  
5.  <span data-ttu-id="c4ee7-134">Ensuite, copiez le fichier nommé .xml soapmessage [1] à partir du dossier \Source\Samples\Exception Handling\Test\Data dans le EAIProcess.RequestPort réception dossier d’emplacement.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-134">Next, copy the file named soapmessage[1].xml from the folder \Source\Samples\Exception Handling\Test\Data into the EAIProcess.RequestPort receive location folder.</span></span>  
  
6.  <span data-ttu-id="c4ee7-135">Ce message est un document XML qui contient une section CDATA, et il provoquera une exception.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-135">This message is an XML document that contains a CDATA section, and it will cause an exception.</span></span> <span data-ttu-id="c4ee7-136">Ouvrez le dossier de sortie All_Exceptions et double-cliquez sur le message d’erreur pour l’ouvrir dans InfoPath.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-136">Open the All_Exceptions output folder and double-click the fault message to open it into InfoPath.</span></span> <span data-ttu-id="c4ee7-137">Vous verrez que le mécanisme de gestion des exceptions de ESB Sérialise ce contenu correctement pour permettre d’InfoPath à rendre.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-137">You will see that the ESB Exception Handling mechanism serializes this content appropriately to allow InfoPath to render it.</span></span>  
  
7.  <span data-ttu-id="c4ee7-138">Pour finir, copiez le fichier nommé Csqzav01.pdf à partir du dossier \Source\Samples\Exception Handling\Test\Data dans le EAIProcess.RequestPort les emplacement de réception.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-138">Finally, copy the file named Csqzav01.pdf from the folder \Source\Samples\Exception Handling\Test\Data into the EAIProcess.RequestPort receive location.</span></span>  
  
8.  <span data-ttu-id="c4ee7-139">Ce message est un fichier PDF, et il provoquera une exception.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-139">This message is a PDF file, and it will cause an exception.</span></span> <span data-ttu-id="c4ee7-140">Ouvrez le dossier de sortie All_Exceptions et double-cliquez sur le message d’erreur pour l’ouvrir dans InfoPath.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-140">Open the All_Exceptions output folder and double-click the fault message to open it in InfoPath.</span></span> <span data-ttu-id="c4ee7-141">Vous verrez que le mécanisme de gestion des exceptions de ESB sérialise et en Base 64 encode le contenu pour permettre d’InfoPath à restituer.</span><span class="sxs-lookup"><span data-stu-id="c4ee7-141">You will see that the ESB Exception Handling mechanism serializes and Base-64 encodes the content to allow InfoPath to render it.</span></span>