---
title: "Création d’un fournisseur de l’adaptateur personnalisé | Documents Microsoft"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: bb93acf8-fd9d-4315-8690-f0c152a954b5
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: feb9efa5ad879e86f32ca1963313dadc7e6a9d7e
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/20/2017
---
# <a name="creating-a-custom-adapter-provider"></a><span data-ttu-id="a7ce5-102">Création d’un fournisseur de l’adaptateur personnalisé</span><span class="sxs-lookup"><span data-stu-id="a7ce5-102">Creating a Custom Adapter Provider</span></span>
<span data-ttu-id="a7ce5-103">Après avoir exécuté un programme de résolution, comme décrit dans les sections précédentes, le service de résolution dynamique vérifie si le résultat est un point de terminaison (et pas une transformation).</span><span class="sxs-lookup"><span data-stu-id="a7ce5-103">After a resolver executes, as described in the previous sections, the dynamic resolution service checks whether the result is an endpoint (not a transformation).</span></span> <span data-ttu-id="a7ce5-104">S’il s’agit d’un point de terminaison, le service instancie le Gestionnaire d’adaptateur, qui est une instance de la **AdapterMgr** classe.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-104">If it is an endpoint, the service instantiates the adapter manager, which is an instance of the **AdapterMgr** class.</span></span>  
  
 <span data-ttu-id="a7ce5-105">Le Gestionnaire d’adaptateur valide et résout le type de transport et de l’emplacement de transport sortant.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-105">The adapter manager validates and fixes the transport type and the outbound transport location.</span></span> <span data-ttu-id="a7ce5-106">Si le type de transport est toujours pas résolu, et si l’URL commence par « http » ou « https », le Gestionnaire d’adaptateur définit le type de transport à « WCF-WSHttp ».</span><span class="sxs-lookup"><span data-stu-id="a7ce5-106">If the transport type is still not resolved, and if the URL begins with either "http" or "https", the adapter manager sets the transport type to "WCF-WSHttp".</span></span>  
  
 <span data-ttu-id="a7ce5-107">Ensuite, le Gestionnaire d’adaptateur vérifie que le type de transport correspond à un adaptateur Microsoft BizTalk Server valid et il retourne son espace de noms de propriété.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-107">Next, the adapter manager verifies that the transport type equates to a valid Microsoft BizTalk Server adapter, and then it returns its property namespace.</span></span> <span data-ttu-id="a7ce5-108">Ce processus s’exécute qu’une seule fois pour toutes les cartes et stocke les résultats dans un cache afin d’éviter la répétition de requêtes pour les autres messages entrants qui utilisent la même carte.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-108">This process runs only once for all adapters and stores the results in a cache to avoid repeated queries for other incoming messages that use the same adapter.</span></span>  
  
 <span data-ttu-id="a7ce5-109">Le Gestionnaire d’adaptateur utilise le type de transport (sans le «**://**« suffixe) pour déterminer le fournisseur de l’adaptateur approprié.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-109">The adapter manager uses the transport type (without the "**://**" suffix) to determine the appropriate adapter provider.</span></span> <span data-ttu-id="a7ce5-110">Un fournisseur de l’adaptateur est un assembly personnalisé doit implémenter la **IAdapterProvider** interface.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-110">An adapter provider is a custom assembly that must implement the **IAdapterProvider** interface.</span></span> <span data-ttu-id="a7ce5-111">Le fournisseur de l’adaptateur utilise les propriétés de la **résolution** de la structure dans le **dictionnaire** instance générée par le programme de résolution pour toutes les propriétés spécifiques au protocole du message qui permet de définir le Moteur d’exécution de Microsoft BizTalk Server pour effectuer la résolution dynamique.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-111">The adapter provider uses the properties of the **Resolution** structure in the **Dictionary** instance generated by the resolver to set all the protocol-specific properties of the message that enables the Microsoft BizTalk Server run-time engine to perform dynamic resolution.</span></span>  
  
 <span data-ttu-id="a7ce5-112">Comme avec le programme de résolution (décrite dans la section précédente), le mécanisme de résolution dynamique utilise les entrées dans le fichier de configuration Esb.config pour localiser des fournisseurs de carte.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-112">Like with the resolver (described in the previous section), the dynamic resolution mechanism uses entries in the Esb.config configuration file to locate adapter providers.</span></span> <span data-ttu-id="a7ce5-113">Le code XML suivant montre la section du fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-113">The following XML shows the section of the configuration file.</span></span>  
  
```xml  
<adapterProviders cacheManager= "Adapter Providers Cache Manager"  absoluteExpiration="3600">  
     <adapterProvider name="WCF-WSHttp" type="Microsoft.Practices.ESB.Adapter.WcfWSHttp.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfWSHttp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="Http,Https" />  
     <adapterProvider name="WCF-BasicHttp" type="Microsoft.Practices.ESB.Adapter.WcfBasicHttp.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfBasicHttp, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="Http,Https" />  
     <adapterProvider name="WCF-Custom" type="Microsoft.Practices.ESB.Adapter.WcfCustom.AdapterProvider, Microsoft.Practices.ESB.Adapter.WcfCustom, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="mssql" />  
     <adapterProvider name="SMTP" type="Microsoft.Practices.ESB.Adapter.SMTP.AdapterProvider, Microsoft.Practices.ESB.Adapter.SMTP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="smtp" />  
     <adapterProvider name="FTP" type="Microsoft.Practices.ESB.Adapter.FTP.AdapterProvider, Microsoft.Practices.ESB.Adapter.FTP, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22">  
          <adapterConfig>  
               <add name="DefaultUsername" value="anonymous" />  
               <add name="DefaultPassword" value="" />  
          </adapterConfig>  
     </adapterProvider>  
     <adapterProvider name="MQSeries" type="Microsoft.Practices.ESB.Adapter.MQSeries.AdapterProvider, Microsoft.Practices.ESB.Adapter.MQSeries, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="MQS" adapterAssembly="MQSeries, Version=3.0.1.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />  
     <adapterProvider name="FILE" type="Microsoft.Practices.ESB.Adapter.FILE.AdapterProvider, Microsoft.Practices.ESB.Adapter.FILE, Version=2.0.0.0, Culture=neutral, PublicKeyToken=c62dd63c784d6e22" moniker="File" />  
</adapterProviders>  
```  
  
## <a name="creating-a-custom-adapter-provider"></a><span data-ttu-id="a7ce5-114">Création d’un fournisseur de l’adaptateur personnalisé</span><span class="sxs-lookup"><span data-stu-id="a7ce5-114">Creating a Custom Adapter Provider</span></span>  
 <span data-ttu-id="a7ce5-115">Le Gestionnaire d’adaptateur (une instance de la **AdapterMgr** classe) recherche le fournisseur de l’adaptateur dans les fichiers de configuration et charge l’assembly approprié.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-115">The adapter manager (an instance of the **AdapterMgr** class) looks up the adapter provider in the configuration files and loads the appropriate assembly.</span></span> <span data-ttu-id="a7ce5-116">Le mécanisme de résolution dynamique met en cache chargé de toutes les implémentations concrètes de la **IAdapterProvider** interface afin d’éviter les répétées de la lecture des informations de configuration et de chargement lors de l’utilisent de plusieurs messages entrants de l’assembly le même fournisseur de l’adaptateur.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-116">The dynamic resolution mechanism caches all loaded concrete implementations of the **IAdapterProvider** interface to avoid repeated reading of configuration information and assembly loading when several incoming messages use the same adapter provider.</span></span>  
  
 <span data-ttu-id="a7ce5-117">Enfin, le Gestionnaire d’adaptateur s’exécute le **SetEndPoint** méthode de l’implémentation concrète de la **IAdapterProvider** interface et le composant de pipeline renvoie le message à BizTalk Base de données MessageBox.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-117">Finally, the adapter manager executes the **SetEndPoint** method of the concrete implementation of the **IAdapterProvider** interface, and the pipeline component returns the message to the BizTalk Message Box database.</span></span>  
  
 <span data-ttu-id="a7ce5-118">**Pour créer un fournisseur de l’adaptateur personnalisé**</span><span class="sxs-lookup"><span data-stu-id="a7ce5-118">**To create a custom adapter provider**</span></span>  
  
1.  <span data-ttu-id="a7ce5-119">Créer un assembly qui dérive de la **BaseAdapterProvider** classe de base et contient un **SetEndPoint** méthode qui définit le point de terminaison des propriétés de contexte du message.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-119">Create an assembly that derives from the **BaseAdapterProvider** base class and contains a **SetEndPoint** method that sets the endpoint context properties of the message.</span></span>  
  
2.  <span data-ttu-id="a7ce5-120">Inscrire le fournisseur de l’adaptateur en l’ajoutant à Esb.config les fichiers de configuration à l’aide un  **\<adapterProvider >** élément avec un nom pour la carte en tant que le **nom** attribut, l’entièrement nom qualifié de la classe en tant que le **type** d’attribut, le moniker comme le **moniker** attribut (plusieurs valeurs doivent être séparés par une virgule) et éventuellement l’assembly de l’adaptateur réel comme le **adapterAssembly** attribut.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-120">Register the adapter provider by adding it to Esb.config configuration files using an **\<adapterProvider>** element with a name for the adapter as the **name** attribute, the fully qualified name of the class as the **type** attribute, the moniker as the **moniker** attribute (multiple values should be separated by a comma), and optionally the assembly of the actual adapter as the **adapterAssembly** attribute.</span></span>  
  
3.  <span data-ttu-id="a7ce5-121">Enregistrer le nouvel assembly dans le global assembly cache.</span><span class="sxs-lookup"><span data-stu-id="a7ce5-121">Register the new assembly in the global assembly cache.</span></span>